You will be provided with a partial code base and an issue statement explaining a problem to resolve.

<issue>
Переписать BlockCombine с flow на stream
Вот тут оно уже было переписано и даже вмержено: https://github.com/ydb-platform/ydb/pull/9979

Однако на внутренних тестах yql (https://st.yandex-team.ru/YQL-19193) оно упало. Поэтому было откачено в: https://github.com/ydb-platform/ydb/pull/10575

Падение воспроизводится в более простом сценарии: достаточно убрать финализацию (`pragma dq.UseFinalizeByKey="false"`).
</issue>

I need you to solve the provided issue by generating a code fix that can be applied directly to the repository

Respond below:
