diff --git a/ydb/core/testlib/basics/feature_flags.h b/ydb/core/testlib/basics/feature_flags.h
index 333cc96d597e..04395a54f3fd 100644
--- a/ydb/core/testlib/basics/feature_flags.h
+++ b/ydb/core/testlib/basics/feature_flags.h
@@ -9,13 +9,13 @@ class TTestFeatureFlagsHolder {
 public:
     TFeatureFlags FeatureFlags;
 
-    #define FEATURE_FLAG_SETTER(name) \
-        TDerived& Set##name(std::optional<bool> value) { \
-            if (value) { \
-                FeatureFlags.Set##name(*value); \
-            } \
-            return *static_cast<TDerived*>(this); \
-        }
+#define FEATURE_FLAG_SETTER(name)                    \
+    TDerived& Set##name(std::optional<bool> value) { \
+        if (value) {                                 \
+            FeatureFlags.Set##name(*value);          \
+        }                                            \
+        return *static_cast<TDerived*>(this);        \
+    }
 
     FEATURE_FLAG_SETTER(AllowYdbRequestsWithoutDatabase)
     FEATURE_FLAG_SETTER(EnableSystemViews)
@@ -63,9 +63,10 @@ class TTestFeatureFlagsHolder {
     FEATURE_FLAG_SETTER(EnableResourcePools)
     FEATURE_FLAG_SETTER(EnableChangefeedsOnIndexTables)
     FEATURE_FLAG_SETTER(EnablePgSyntax)
-    FEATURE_FLAG_SETTER(EnableMetadataObjectsOnServerless)
+    FEATURE_FLAG_SETTER(EnableTieringInColumnShard)
+    FEATURE_FLAG_SETTER(EnableOlapCompression)
 
-    #undef FEATURE_FLAG_SETTER
+#undef FEATURE_FLAG_SETTER
 };
 
-} // NKikimr
+}   // namespace NKikimr
diff --git a/ydb/core/testlib/cs_helper.cpp b/ydb/core/testlib/cs_helper.cpp
index c6f05ec8c86f..dd26da35fa74 100644
--- a/ydb/core/testlib/cs_helper.cpp
+++ b/ydb/core/testlib/cs_helper.cpp
@@ -183,7 +183,7 @@ std::shared_ptr<arrow::RecordBatch> THelper::TestArrowBatch(ui64 pathIdBegin, ui
 TString THelper::GetTestTableSchema() const {
     TStringBuilder sb;
     sb << R"(Columns{ Name: "timestamp" Type : "Timestamp" NotNull : true })";
-    sb << R"(Columns{ Name: "resource_id" Type : "Utf8" })";
+    sb << R"(Columns{ Name: "resource_id" Type : "Utf8" DataAccessorConstructor{ ClassName: "SPARSED" } })";
     sb << "Columns{ Name: \"uid\" Type : \"Utf8\" NotNull : true StorageId : \"" + OptionalStorageId + "\" }";
     sb << R"(Columns{ Name: "level" Type : "Int32" })";
     sb << "Columns{ Name: \"message\" Type : \"Utf8\" StorageId : \"" + OptionalStorageId + "\" }";
@@ -198,7 +198,7 @@ TString THelper::GetTestTableSchema() const {
     return sb;
 }
 
-void THelper::CreateOlapTableWithStore(TString tableName /*= "olapTable"*/, TString storeName /*= "olapStore"*/, ui32 storeShardsCount /*= 4*/, ui32 tableShardsCount /*= 3*/) {
+void THelper::CreateSchemaOlapTablesWithStore(const TString tableSchema, TVector<TString> tableNames /*= "olapTable"*/, TString storeName /*= "olapStore"*/, ui32 storeShardsCount /*= 4*/, ui32 tableShardsCount /*= 3*/) {
     TActorId sender = Server.GetRuntime()->AllocateEdgeActor();
     CreateTestOlapStore(sender, Sprintf(R"(
             Name: "%s"
@@ -209,19 +209,25 @@ void THelper::CreateOlapTableWithStore(TString tableName /*= "olapTable"*/, TStr
                     %s
                 }
             }
-        )", storeName.c_str(), storeShardsCount, GetTestTableSchema().data()));
+        )", storeName.c_str(), storeShardsCount, tableSchema.data()));
 
     const TString shardingColumns = "[\"" + JoinSeq("\",\"", GetShardingColumns()) + "\"]";
 
-    TBase::CreateTestOlapTable(sender, storeName, Sprintf(R"(
-        Name: "%s"
-        ColumnShardCount: %d
-        Sharding {
-            HashSharding {
-                Function: %s
-                Columns: %s
-            }
-        })", tableName.c_str(), tableShardsCount, ShardingMethod.data(), shardingColumns.c_str()));
+    for (const TString& tableName : tableNames) {
+        TBase::CreateTestOlapTable(sender, storeName, Sprintf(R"(
+            Name: "%s"
+            ColumnShardCount: %d
+            Sharding {
+                HashSharding {
+                    Function: %s
+                    Columns: %s
+                }
+            })", tableName.c_str(), tableShardsCount, ShardingMethod.data(), shardingColumns.c_str()));
+    }
+}
+
+void THelper::CreateOlapTablesWithStore(TVector<TString> tableNames /*= {"olapTable"}*/, TString storeName /*= "olapStore"*/, ui32 storeShardsCount /*= 4*/, ui32 tableShardsCount /*= 3*/) {
+        CreateSchemaOlapTablesWithStore(GetTestTableSchema(), tableNames, storeName, storeShardsCount, tableShardsCount);
 }
 
 // Clickbench table
diff --git a/ydb/core/testlib/cs_helper.h b/ydb/core/testlib/cs_helper.h
index 7a9e3dad1bf3..95c8877b6ba6 100644
--- a/ydb/core/testlib/cs_helper.h
+++ b/ydb/core/testlib/cs_helper.h
@@ -27,11 +27,16 @@ class THelper: public THelperSchemaless {
     std::shared_ptr<arrow::Schema> GetArrowSchema() const;
     YDB_FLAG_ACCESSOR(WithJsonDocument, false);
     YDB_ACCESSOR(TString, OptionalStorageId, "__MEMORY");
+protected:
     TString ShardingMethod = "HASH_FUNCTION_CONSISTENCY_64";
+private:
     bool WithSomeNulls_ = false;
 protected:
-    void CreateOlapTableWithStore(TString tableName = "olapTable", TString storeName = "olapStore",
+    void CreateSchemaOlapTablesWithStore(const TString tableSchema, TVector<TString> tableName = {"olapTable"}, TString storeName = "olapStore",
+        ui32 storeShardsCount = 4, ui32 tableShardsCount = 3);
+    void CreateOlapTablesWithStore(TVector<TString> tableName = {"olapTable"}, TString storeName = "olapStore",
         ui32 storeShardsCount = 4, ui32 tableShardsCount = 3);
+
 public:
     using TBase::TBase;
 
@@ -43,9 +48,9 @@ class THelper: public THelperSchemaless {
 
     static constexpr const char * PROTO_SCHEMA = R"(
         Columns { Name: "timestamp" Type: "Timestamp" NotNull: true }
-        Columns { Name: "resource_id" Type: "Utf8" }
+        Columns { Name: "resource_id" Type: "Utf8" DataAccessorConstructor{ ClassName: "SPARSED" }}
         Columns { Name: "uid" Type: "Utf8" }
-        Columns { Name: "level" Type: "Int32" }
+        Columns { Name: "level" Type: "Int32" DataAccessorConstructor{ ClassName: "SPARSED" }}
         Columns { Name: "message" Type: "Utf8" }
         KeyColumnNames: "timestamp"
         Engine: COLUMN_ENGINE_REPLACING_TIMESERIES
diff --git a/ydb/core/testlib/test_client.cpp b/ydb/core/testlib/test_client.cpp
index 8c8d35d0228e..7c25835169a3 100644
--- a/ydb/core/testlib/test_client.cpp
+++ b/ydb/core/testlib/test_client.cpp
@@ -113,6 +113,7 @@
 #include <ydb/services/ext_index/service/executor.h>
 #include <ydb/core/tx/conveyor/service/service.h>
 #include <ydb/core/tx/conveyor/usage/service.h>
+#include <ydb/core/tx/limiter/grouped_memory/usage/service.h>
 #include <ydb/library/folder_service/mock/mock_folder_service_adapter.h>
 
 #include <ydb/core/client/server/ic_nodes_cache_service.h>
@@ -762,6 +763,11 @@ namespace Tests {
             const auto aid = Runtime->Register(actor, nodeIdx, appData.SystemPoolId, TMailboxType::Revolving, 0);
             Runtime->RegisterService(NCSIndex::MakeServiceId(Runtime->GetNodeId(nodeIdx)), aid, nodeIdx);
         }
+        {
+            auto* actor = NOlap::NGroupedMemoryManager::TScanMemoryLimiterOperator::CreateService(NOlap::NGroupedMemoryManager::TConfig(), new ::NMonitoring::TDynamicCounters());
+            const auto aid = Runtime->Register(actor, nodeIdx, appData.UserPoolId, TMailboxType::Revolving, 0);
+            Runtime->RegisterService(NOlap::NGroupedMemoryManager::TScanMemoryLimiterOperator::MakeServiceId(Runtime->GetNodeId(nodeIdx)), aid, nodeIdx);
+        }
         {
             auto* actor = NConveyor::TScanServiceOperator::CreateService(NConveyor::TConfig(), new ::NMonitoring::TDynamicCounters());
             const auto aid = Runtime->Register(actor, nodeIdx, appData.UserPoolId, TMailboxType::Revolving, 0);
diff --git a/ydb/core/testlib/ya.make b/ydb/core/testlib/ya.make
index 58502dca6227..5a63f36a639f 100644
--- a/ydb/core/testlib/ya.make
+++ b/ydb/core/testlib/ya.make
@@ -102,6 +102,7 @@ PEERDIR(
     ydb/services/ext_index/service
     ydb/services/ymq
     ydb/core/tx/conveyor/service
+    ydb/core/tx/limiter/grouped_memory/usage
     ydb/services/fq
     ydb/services/kesus
     ydb/services/persqueue_cluster_discovery
diff --git a/ydb/core/tx/columnshard/common/tests/shard_reader.cpp b/ydb/core/tx/columnshard/common/tests/shard_reader.cpp
deleted file mode 100644
index 2789a63e38a8..000000000000
--- a/ydb/core/tx/columnshard/common/tests/shard_reader.cpp
+++ /dev/null
@@ -1,4 +0,0 @@
-#include "shard_reader.h"
-
-namespace NKikimr::NOlap::NTests {
-}
diff --git a/ydb/core/tx/columnshard/common/tests/ya.make b/ydb/core/tx/columnshard/common/tests/ya.make
deleted file mode 100644
index 8b3c3809006b..000000000000
--- a/ydb/core/tx/columnshard/common/tests/ya.make
+++ /dev/null
@@ -1,14 +0,0 @@
-LIBRARY()
-
-SRCS(
-    shard_reader.cpp
-)
-
-PEERDIR(
-    ydb/core/formats/arrow/protos
-    contrib/libs/apache/arrow
-    ydb/core/formats/arrow
-    ydb/core/kqp/compute_actor
-)
-
-END()
diff --git a/ydb/core/tx/columnshard/hooks/testing/controller.h b/ydb/core/tx/columnshard/hooks/testing/controller.h
index bb011d168de4..a8e259877fd0 100644
--- a/ydb/core/tx/columnshard/hooks/testing/controller.h
+++ b/ydb/core/tx/columnshard/hooks/testing/controller.h
@@ -12,20 +12,21 @@ namespace NKikimr::NYDBTest::NColumnShard {
 class TController: public TReadOnlyController {
 private:
     using TBase = TReadOnlyController;
-    YDB_ACCESSOR_DEF(std::optional<TDuration>, LagForCompactionBeforeTierings);
-    YDB_ACCESSOR(std::optional<TDuration>, GuaranteeIndexationInterval, TDuration::Zero());
-    YDB_ACCESSOR(std::optional<TDuration>, PeriodicWakeupActivationPeriod, std::nullopt);
-    YDB_ACCESSOR(std::optional<TDuration>, StatsReportInterval, std::nullopt);
-    YDB_ACCESSOR(std::optional<ui64>, GuaranteeIndexationStartBytesLimit, 0);
-    YDB_ACCESSOR(std::optional<TDuration>, OptimizerFreshnessCheckDuration, TDuration::Zero());
-    YDB_ACCESSOR_DEF(std::optional<TDuration>, CompactionActualizationLag);
-    YDB_ACCESSOR_DEF(std::optional<TDuration>, TasksActualizationLag);
+    YDB_ACCESSOR_DEF(std::optional<TDuration>, OverrideRequestsTracePingCheckPeriod);
+    YDB_ACCESSOR_DEF(std::optional<TDuration>, OverrideLagForCompactionBeforeTierings);
+    YDB_ACCESSOR(std::optional<TDuration>, OverrideGuaranteeIndexationInterval, TDuration::Zero());
+    YDB_ACCESSOR(std::optional<TDuration>, OverridePeriodicWakeupActivationPeriod, std::nullopt);
+    YDB_ACCESSOR(std::optional<TDuration>, OverrideStatsReportInterval, std::nullopt);
+    YDB_ACCESSOR(std::optional<ui64>, OverrideGuaranteeIndexationStartBytesLimit, 0);
+    YDB_ACCESSOR(std::optional<TDuration>, OverrideOptimizerFreshnessCheckDuration, TDuration::Zero());
+    YDB_ACCESSOR_DEF(std::optional<TDuration>, OverrideCompactionActualizationLag);
+    YDB_ACCESSOR_DEF(std::optional<TDuration>, OverrideTasksActualizationLag);
+    YDB_ACCESSOR_DEF(std::optional<TDuration>, OverrideReadTimeoutClean);
     EOptimizerCompactionWeightControl CompactionControl = EOptimizerCompactionWeightControl::Force;
 
     YDB_ACCESSOR(std::optional<ui64>, OverrideReduceMemoryIntervalLimit, 1024);
     YDB_ACCESSOR_DEF(std::optional<ui64>, OverrideRejectMemoryIntervalLimit);
 
-    std::optional<TDuration> ReadTimeoutClean;
     std::optional<ui32> ExpectedShardsCount;
 
     THashMap<ui64, const ::NKikimr::NColumnShard::TColumnShard*> ShardActuals;
@@ -129,12 +130,16 @@ class TController: public TReadOnlyController {
     THashSet<TString> SharingIds;
 protected:
     virtual ::NKikimr::NColumnShard::TBlobPutResult::TPtr OverrideBlobPutResultOnCompaction(const ::NKikimr::NColumnShard::TBlobPutResult::TPtr original, const NOlap::TWriteActionsCollection& actions) const override;
-    virtual TDuration GetLagForCompactionBeforeTierings(const TDuration def) const override {
-        return LagForCompactionBeforeTierings.value_or(def);
+    virtual TDuration DoGetLagForCompactionBeforeTierings(const TDuration def) const override {
+        return OverrideLagForCompactionBeforeTierings.value_or(def);
     }
 
-    virtual TDuration GetCompactionActualizationLag(const TDuration def) const override {
-        return CompactionActualizationLag.value_or(def);
+    virtual TDuration DoGetPingCheckPeriod(const TDuration def) const override {
+        return OverrideRequestsTracePingCheckPeriod.value_or(def);
+    }
+
+    virtual TDuration DoGetCompactionActualizationLag(const TDuration def) const override {
+        return OverrideCompactionActualizationLag.value_or(def);
     }
 
 
@@ -143,8 +148,8 @@ class TController: public TReadOnlyController {
         return !DisabledBackgrounds.contains(id);
     }
 
-    virtual TDuration GetActualizationTasksLag(const TDuration d) const override {
-        return TasksActualizationLag.value_or(d);
+    virtual TDuration DoGetActualizationTasksLag(const TDuration d) const override {
+        return OverrideTasksActualizationLag.value_or(d);
     }
 
     virtual void DoOnTabletInitCompleted(const ::NKikimr::NColumnShard::TColumnShard& shard) override;
@@ -152,23 +157,29 @@ class TController: public TReadOnlyController {
     virtual void DoOnAfterGCAction(const ::NKikimr::NColumnShard::TColumnShard& shard, const NOlap::IBlobsGCAction& action) override;
 
     virtual bool DoOnWriteIndexComplete(const NOlap::TColumnEngineChanges& changes, const ::NKikimr::NColumnShard::TColumnShard& shard) override;
-    virtual TDuration GetGuaranteeIndexationInterval(const TDuration defaultValue) const override {
-        return GuaranteeIndexationInterval.value_or(defaultValue);
+    virtual TDuration DoGetGuaranteeIndexationInterval(const TDuration defaultValue) const override {
+        return OverrideGuaranteeIndexationInterval.value_or(defaultValue);
+    }
+    virtual TDuration DoGetPeriodicWakeupActivationPeriod(const TDuration defaultValue) const override {
+        return OverridePeriodicWakeupActivationPeriod.value_or(defaultValue);
     }
-    TDuration GetPeriodicWakeupActivationPeriod(const TDuration defaultValue) const override {
-        return PeriodicWakeupActivationPeriod.value_or(defaultValue);
+    virtual TDuration DoGetStatsReportInterval(const TDuration defaultValue) const override {
+        return OverrideStatsReportInterval.value_or(defaultValue);
     }
-    TDuration GetStatsReportInterval(const TDuration defaultValue) const override {
-        return StatsReportInterval.value_or(defaultValue);
+    virtual ui64 DoGetGuaranteeIndexationStartBytesLimit(const ui64 defaultValue) const override {
+        return OverrideGuaranteeIndexationStartBytesLimit.value_or(defaultValue);
     }
-    virtual ui64 GetGuaranteeIndexationStartBytesLimit(const ui64 defaultValue) const override {
-        return GuaranteeIndexationStartBytesLimit.value_or(defaultValue);
+    virtual TDuration DoGetOptimizerFreshnessCheckDuration(const TDuration defaultValue) const override {
+        return OverrideOptimizerFreshnessCheckDuration.value_or(defaultValue);
     }
-    virtual TDuration GetOptimizerFreshnessCheckDuration(const TDuration defaultValue) const override {
-        return OptimizerFreshnessCheckDuration.value_or(defaultValue);
+    virtual TDuration DoGetReadTimeoutClean(const TDuration def) const override {
+        return OverrideReadTimeoutClean.value_or(def);
     }
-    virtual TDuration GetReadTimeoutClean(const TDuration def) override {
-        return ReadTimeoutClean.value_or(def);
+    virtual ui64 DoGetReduceMemoryIntervalLimit(const ui64 def) const override {
+        return OverrideReduceMemoryIntervalLimit.value_or(def);
+    }
+    virtual ui64 DoGetRejectMemoryIntervalLimit(const ui64 def) const override {
+        return OverrideRejectMemoryIntervalLimit.value_or(def);
     }
     virtual EOptimizerCompactionWeightControl GetCompactionControl() const override {
         return CompactionControl;
@@ -185,18 +196,9 @@ class TController: public TReadOnlyController {
     }
 
 public:
-    virtual TDuration GetRemovedPortionLivetime(const TDuration /*def*/) const override {
-        return TDuration::Zero();
-    }
     const TAtomicCounter& GetIndexWriteControllerBrokeCount() const {
         return IndexWriteControllerBrokeCount;
     }
-    virtual ui64 GetReduceMemoryIntervalLimit(const ui64 def) const override {
-        return OverrideReduceMemoryIntervalLimit.value_or(def);
-    }
-    virtual ui64 GetRejectMemoryIntervalLimit(const ui64 def) const override {
-        return OverrideRejectMemoryIntervalLimit.value_or(def);
-    }
     bool IsTrivialLinks() const;
     TCheckContext CheckInvariants() const;
 
@@ -232,9 +234,6 @@ class TController: public TReadOnlyController {
     void SetCompactionControl(const EOptimizerCompactionWeightControl value) {
         CompactionControl = value;
     }
-    void SetReadTimeoutClean(const TDuration d) {
-        ReadTimeoutClean = d;
-    }
 
     bool HasPKSortingOnly() const;
 
diff --git a/ydb/core/tx/columnshard/hooks/testing/ro_controller.h b/ydb/core/tx/columnshard/hooks/testing/ro_controller.h
index c271878ea838..c55be9455204 100644
--- a/ydb/core/tx/columnshard/hooks/testing/ro_controller.h
+++ b/ydb/core/tx/columnshard/hooks/testing/ro_controller.h
@@ -31,9 +31,18 @@ class TReadOnlyController: public ICSController {
     YDB_READONLY(TAtomicCounter, ActualizationRefreshTieringCount, 0);
     YDB_READONLY(TAtomicCounter, ShardingFiltersCount, 0);
 
+    YDB_READONLY(TAtomicCounter, RequestTracingSnapshotsSave, 0);
+    YDB_READONLY(TAtomicCounter, RequestTracingSnapshotsRemove, 0);
+
     YDB_ACCESSOR(TAtomicCounter, CompactionsLimit, 10000000);
 
 protected:
+    virtual void OnRequestTracingChanges(
+        const std::set<NOlap::TSnapshot>& snapshotsToSave, const std::set<NOlap::TSnapshot>& snapshotsToRemove) override {
+        RequestTracingSnapshotsSave.Add(snapshotsToSave.size());
+        RequestTracingSnapshotsRemove.Add(snapshotsToRemove.size());
+    }
+
     virtual void OnSelectShardingFilter() override {
         ShardingFiltersCount.Inc();
     }
@@ -62,11 +71,11 @@ class TReadOnlyController: public ICSController {
         return EOptimizerCompactionWeightControl::Force;
     }
 
-public:
-    virtual TDuration GetOverridenGCPeriod(const TDuration /*def*/) const override {
+    virtual TDuration DoGetOverridenGCPeriod(const TDuration /*def*/) const override {
         return TDuration::Zero();
     }
 
+public:
     void WaitCompactions(const TDuration d) const {
         TInstant start = TInstant::Now();
         ui32 compactionsStart = GetCompactionStartedCounter().Val();
@@ -82,10 +91,10 @@ class TReadOnlyController: public ICSController {
 
     void WaitIndexation(const TDuration d) const {
         TInstant start = TInstant::Now();
-        ui32 compactionsStart = GetInsertStartedCounter().Val();
+        ui32 insertsStart = GetInsertStartedCounter().Val();
         while (Now() - start < d) {
-            if (compactionsStart != GetInsertStartedCounter().Val()) {
-                compactionsStart = GetInsertStartedCounter().Val();
+            if (insertsStart != GetInsertStartedCounter().Val()) {
+                insertsStart = GetInsertStartedCounter().Val();
                 start = TInstant::Now();
             }
             Cerr << "WAIT_INDEXATION: " << GetInsertStartedCounter().Val() << Endl;
diff --git a/ydb/core/tx/columnshard/test_helper/columnshard_ut_common.cpp b/ydb/core/tx/columnshard/test_helper/columnshard_ut_common.cpp
index 4f8cfe4ce4b9..31de6ffef8a5 100644
--- a/ydb/core/tx/columnshard/test_helper/columnshard_ut_common.cpp
+++ b/ydb/core/tx/columnshard/test_helper/columnshard_ut_common.cpp
@@ -1,6 +1,6 @@
 #include "columnshard_ut_common.h"
+#include "shard_reader.h"
 
-#include <ydb/core/tx/columnshard/common/tests/shard_reader.h>
 #include <ydb/core/tx/columnshard/hooks/testing/controller.h>
 #include <ydb/core/tx/columnshard/engines/reader/sys_view/portions/portions.h>
 #include <ydb/core/tx/columnshard/engines/storage/indexes/max/meta.h>
@@ -125,22 +125,25 @@ bool WriteDataImpl(TTestBasicRuntime& runtime, TActorId& sender, const ui64 shar
 }
 
 bool WriteData(TTestBasicRuntime& runtime, TActorId& sender, const ui64 shardId, const ui64 writeId, const ui64 tableId, const TString& data,
-                              const std::vector<NArrow::NTest::TTestColumn>& ydbSchema, std::vector<ui64>* writeIds, const NEvWrite::EModificationType mType) {
+    const std::vector<NArrow::NTest::TTestColumn>& ydbSchema, std::vector<ui64>* writeIds, const NEvWrite::EModificationType mType) {
     NLongTxService::TLongTxId longTxId;
     UNIT_ASSERT(longTxId.ParseString("ydb://long-tx/01ezvvxjdk2hd4vdgjs68knvp8?node_id=1"));
-    return WriteDataImpl(runtime, sender, shardId, tableId, longTxId, writeId, data, NArrow::MakeArrowSchema(ydbSchema), writeIds, mType);
-
+    return WriteDataImpl(
+        runtime, sender, shardId, tableId, longTxId, writeId, data, NArrow::MakeArrowSchema(ydbSchema), writeIds, mType);
 }
 
 bool WriteData(TTestBasicRuntime& runtime, TActorId& sender, const ui64 writeId, const ui64 tableId, const TString& data,
-                              const std::vector<NArrow::NTest::TTestColumn>& ydbSchema, bool waitResult, std::vector<ui64>* writeIds, const NEvWrite::EModificationType mType) {
+    const std::vector<NArrow::NTest::TTestColumn>& ydbSchema, bool waitResult, std::vector<ui64>* writeIds,
+    const NEvWrite::EModificationType mType) {
     NLongTxService::TLongTxId longTxId;
     UNIT_ASSERT(longTxId.ParseString("ydb://long-tx/01ezvvxjdk2hd4vdgjs68knvp8?node_id=1"));
     if (writeIds) {
-        return WriteDataImpl(runtime, sender, TTestTxConfig::TxTablet0, tableId, longTxId, writeId, data, NArrow::MakeArrowSchema(ydbSchema), writeIds, mType);
+        return WriteDataImpl(runtime, sender, TTestTxConfig::TxTablet0, tableId, longTxId, writeId, data,
+            NArrow::MakeArrowSchema(ydbSchema), writeIds, mType);
     }
     std::vector<ui64> ids;
-    return WriteDataImpl(runtime, sender, TTestTxConfig::TxTablet0, tableId, longTxId, writeId, data, NArrow::MakeArrowSchema(ydbSchema), waitResult ? &ids : nullptr, mType);
+    return WriteDataImpl(runtime, sender, TTestTxConfig::TxTablet0, tableId, longTxId, writeId, data,
+        NArrow::MakeArrowSchema(ydbSchema), waitResult ? &ids : nullptr, mType);
 }
 
 std::optional<ui64> WriteData(TTestBasicRuntime& runtime, TActorId& sender, const NLongTxService::TLongTxId& longTxId,
@@ -431,25 +434,20 @@ void TTestSchema::InitSchema(const std::vector<NArrow::NTest::TTestColumn>& colu
 namespace NKikimr::NColumnShard {
     NOlap::TIndexInfo BuildTableInfo(const std::vector<NArrow::NTest::TTestColumn>& ydbSchema,
                          const std::vector<NArrow::NTest::TTestColumn>& key) {
-        NOlap::TIndexInfo indexInfo = NOlap::TIndexInfo::BuildDefault();
-
+        THashMap<ui32, NTable::TColumn> columns;
         for (ui32 i = 0; i < ydbSchema.size(); ++i) {
             ui32 id = i + 1;
             auto& name = ydbSchema[i].GetName();
             auto& type = ydbSchema[i].GetType();
 
-            indexInfo.Columns[id] = NTable::TColumn(name, id, type, "");
-            indexInfo.ColumnNames[name] = id;
+            columns[id] = NTable::TColumn(name, id, type, "");
         }
 
+        std::vector<TString> pkNames;
         for (const auto& c : key) {
-            indexInfo.KeyColumns.push_back(indexInfo.ColumnNames[c.GetName()]);
+            pkNames.push_back(c.GetName());
         }
-
-        auto storage = std::make_shared<NOlap::TTestStoragesManager>();
-        storage->Initialize(TInstant::Now().Seconds());
-        indexInfo.SetAllKeys(NOlap::TTestStoragesManager::GetInstance());
-        return indexInfo;
+        return NOlap::TIndexInfo::BuildDefault(NOlap::TTestStoragesManager::GetInstance(), columns, pkNames);
     }
 
     void SetupSchema(TTestBasicRuntime& runtime, TActorId& sender, const TString& txBody, const NOlap::TSnapshot& snapshot, bool succeed) {
@@ -519,7 +517,7 @@ namespace NKikimr::NColumnShard {
             fields.emplace_back(f.GetName());
         }
 
-        NOlap::NTests::TShardReader reader(runtime, TTestTxConfig::TxTablet0, tableId, snapshot);
+        NTxUT::TShardReader reader(runtime, TTestTxConfig::TxTablet0, tableId, snapshot);
         reader.SetReplyColumns(fields);
         auto rb = reader.ReadAll();
         UNIT_ASSERT(reader.IsCorrectlyFinished());
diff --git a/ydb/core/tx/columnshard/test_helper/columnshard_ut_common.h b/ydb/core/tx/columnshard/test_helper/columnshard_ut_common.h
index 4306babbb1ed..7594be5da952 100644
--- a/ydb/core/tx/columnshard/test_helper/columnshard_ut_common.h
+++ b/ydb/core/tx/columnshard/test_helper/columnshard_ut_common.h
@@ -1,20 +1,21 @@
 #pragma once
 
-#include <ydb/core/tx/columnshard/blob_cache.h>
-#include <ydb/core/tx/columnshard/common/snapshot.h>
-
 #include <ydb/core/formats/arrow/arrow_batch_builder.h>
-#include <ydb/core/tx/columnshard/test_helper/helper.h>
+#include <ydb/core/protos/tx_columnshard.pb.h>
 #include <ydb/core/scheme/scheme_tabledefs.h>
 #include <ydb/core/scheme/scheme_types_proto.h>
 #include <ydb/core/testlib/tablet_helpers.h>
 #include <ydb/core/testlib/test_client.h>
-#include <ydb/core/protos/tx_columnshard.pb.h>
+#include <ydb/core/tx/columnshard/blob_cache.h>
+#include <ydb/core/tx/columnshard/common/snapshot.h>
+#include <ydb/core/tx/columnshard/test_helper/helper.h>
+#include <ydb/core/tx/data_events/common/modification_type.h>
+#include <ydb/core/tx/long_tx_service/public/types.h>
+
+#include <ydb/public/sdk/cpp/client/ydb_value/value.h>
 #include <ydb/services/metadata/abstract/fetcher.h>
 
 #include <library/cpp/testing/unittest/registar.h>
-#include <ydb/core/tx/long_tx_service/public/types.h>
-#include <ydb/core/tx/data_events/common/modification_type.h>
 
 namespace NKikimr::NOlap {
 struct TIndexInfo;
@@ -167,7 +168,7 @@ struct TTestSchema {
             // PK
             firstKeyItem,
             TTestColumn("resource_type", TTypeInfo(NTypeIds::Utf8) ),
-            TTestColumn("resource_id", TTypeInfo(NTypeIds::Utf8) ),
+            TTestColumn("resource_id", TTypeInfo(NTypeIds::Utf8)).SetAccessorClassName("SPARSED"),
             TTestColumn("uid", TTypeInfo(NTypeIds::Utf8) ).SetStorageId("__MEMORY"),
             TTestColumn("level", TTypeInfo(NTypeIds::Int32) ),
             TTestColumn("message", TTypeInfo(NTypeIds::Utf8) ).SetStorageId("__MEMORY"),
@@ -183,7 +184,7 @@ struct TTestSchema {
         std::vector<TTestColumn> schema = {
             // PK
             TTestColumn("timestamp", TTypeInfo(NTypeIds::Timestamp) ),
-            TTestColumn("resource_type", TTypeInfo(NTypeIds::Utf8) ),
+            TTestColumn("resource_type", TTypeInfo(NTypeIds::Utf8)).SetAccessorClassName("SPARSED"),
             TTestColumn("resource_id", TTypeInfo(NTypeIds::Utf8) ),
             TTestColumn("uid", TTypeInfo(NTypeIds::Utf8) ).SetStorageId("__MEMORY"),
             //
@@ -192,7 +193,7 @@ struct TTestSchema {
             TTestColumn("json_payload", TTypeInfo(NTypeIds::JsonDocument) ),
             TTestColumn("ingested_at", TTypeInfo(NTypeIds::Timestamp) ),
             TTestColumn("saved_at", TTypeInfo(NTypeIds::Timestamp) ),
-            TTestColumn("request_id", TTypeInfo(NTypeIds::Yson) )
+            TTestColumn("request_id", TTypeInfo(NTypeIds::Yson)).SetAccessorClassName("SPARSED")
         };
         return schema;
     };
@@ -201,7 +202,7 @@ struct TTestSchema {
         std::vector<TTestColumn> schema = {
             TTestColumn("timestamp", TTypeInfo(NTypeIds::Timestamp) ),
             TTestColumn("resource_type", TTypeInfo(NTypeIds::Utf8) ).SetStorageId("__MEMORY"),
-            TTestColumn("resource_id", TTypeInfo(NTypeIds::Utf8) ),
+            TTestColumn("resource_id", TTypeInfo(NTypeIds::Utf8)).SetAccessorClassName("SPARSED"),
             TTestColumn("uid", TTypeInfo(NTypeIds::Utf8) ).SetStorageId("__MEMORY")
         };
         return schema;
@@ -406,10 +407,12 @@ void PlanSchemaTx(TTestBasicRuntime& runtime, TActorId& sender, NOlap::TSnapshot
 void PlanWriteTx(TTestBasicRuntime& runtime, TActorId& sender, NOlap::TSnapshot snap, bool waitResult = true);
 
 bool WriteData(TTestBasicRuntime& runtime, TActorId& sender, const ui64 shardId, const ui64 writeId, const ui64 tableId, const TString& data,
-                              const std::vector<NArrow::NTest::TTestColumn>& ydbSchema, std::vector<ui64>* writeIds, const NEvWrite::EModificationType mType = NEvWrite::EModificationType::Upsert);
+    const std::vector<NArrow::NTest::TTestColumn>& ydbSchema, std::vector<ui64>* writeIds,
+    const NEvWrite::EModificationType mType = NEvWrite::EModificationType::Upsert);
 
 bool WriteData(TTestBasicRuntime& runtime, TActorId& sender, const ui64 writeId, const ui64 tableId, const TString& data,
-                              const std::vector<NArrow::NTest::TTestColumn>& ydbSchema, bool waitResult = true, std::vector<ui64>* writeIds = nullptr, const NEvWrite::EModificationType mType = NEvWrite::EModificationType::Upsert);
+    const std::vector<NArrow::NTest::TTestColumn>& ydbSchema, bool waitResult = true, std::vector<ui64>* writeIds = nullptr,
+    const NEvWrite::EModificationType mType = NEvWrite::EModificationType::Upsert);
 
 std::optional<ui64> WriteData(TTestBasicRuntime& runtime, TActorId& sender, const NLongTxService::TLongTxId& longTxId,
                               ui64 tableId, const ui64 writePartId, const TString& data,
@@ -474,11 +477,13 @@ namespace NKikimr::NColumnShard {
                 auto& builder = Owner.Builders[Index];
                 auto type = builder->type();
 
-                NArrow::SwitchType(type->id(), [&](const auto& t) {
+                Y_ABORT_UNLESS(NArrow::SwitchType(type->id(), [&](const auto& t) {
                     using TWrap = std::decay_t<decltype(t)>;
                     using T = typename TWrap::T;
                     using TBuilder = typename arrow::TypeTraits<typename TWrap::T>::BuilderType;
 
+                    AFL_NOTICE(NKikimrServices::TX_COLUMNSHARD)("T", typeid(T).name());
+
                     auto& typedBuilder = static_cast<TBuilder&>(*builder);
                     if constexpr (std::is_arithmetic<TData>::value) {
                         if constexpr (arrow::has_c_type<T>::value) {
@@ -493,9 +498,16 @@ namespace NKikimr::NColumnShard {
                             return true;
                         }
                     }
+
+                    if constexpr (std::is_same<TData, NYdb::TDecimalValue>::value) {
+                        if constexpr (arrow::is_decimal128_type<T>::value) {
+                            Y_ABORT_UNLESS(typedBuilder.Append(arrow::Decimal128(data.Hi_, data.Low_)).ok());
+                            return true;
+                        }
+                    }
                     Y_ABORT("Unknown type combination");
                     return false;
-                });
+                }));
                 return TRowBuilder(Index + 1, Owner);
             }
 
diff --git a/ydb/core/tx/columnshard/test_helper/controllers.h b/ydb/core/tx/columnshard/test_helper/controllers.h
index 5b48f204e2bc..68cd6a1dc4ed 100644
--- a/ydb/core/tx/columnshard/test_helper/controllers.h
+++ b/ydb/core/tx/columnshard/test_helper/controllers.h
@@ -21,24 +21,21 @@ class TWaitCompactionController: public NYDBTest::NColumnShard::TController {
     virtual bool NeedForceCompactionBacketsConstruction() const override {
         return true;
     }
-    virtual ui64 GetSmallPortionSizeDetector(const ui64 /*def*/) const override {
+    virtual ui64 DoGetSmallPortionSizeDetector(const ui64 /*def*/) const override {
         return SmallSizeDetector.value_or(0);
     }
-    virtual TDuration GetOptimizerFreshnessCheckDuration(const TDuration /*defaultValue*/) const override {
+    virtual TDuration DoGetOptimizerFreshnessCheckDuration(const TDuration /*defaultValue*/) const override {
         return TDuration::Zero();
     }
-    virtual TDuration GetLagForCompactionBeforeTierings(const TDuration /*def*/) const override {
+    virtual TDuration DoGetLagForCompactionBeforeTierings(const TDuration /*def*/) const override {
         return TDuration::Zero();
     }
-    virtual TDuration GetCompactionActualizationLag(const TDuration /*def*/) const override {
+    virtual TDuration DoGetCompactionActualizationLag(const TDuration /*def*/) const override {
         return TDuration::Zero();
     }
-    virtual TDuration GetTTLDefaultWaitingDuration(const TDuration /*defaultValue*/) const override {
-        return TDuration::Seconds(1);
-    }
 public:
     TWaitCompactionController() {
-        SetPeriodicWakeupActivationPeriod(TDuration::Seconds(1));
+        SetOverridePeriodicWakeupActivationPeriod(TDuration::Seconds(1));
     }
 
     ui32 GetFinishedExportsCount() const {
diff --git a/ydb/core/tx/columnshard/test_helper/helper.cpp b/ydb/core/tx/columnshard/test_helper/helper.cpp
index a7aca5f114ca..d64003c5d525 100644
--- a/ydb/core/tx/columnshard/test_helper/helper.cpp
+++ b/ydb/core/tx/columnshard/test_helper/helper.cpp
@@ -1,6 +1,7 @@
 #include "helper.h"
 
 #include <ydb/core/formats/arrow/arrow_helpers.h>
+#include <ydb/library/formats/arrow/protos/accessor.pb.h>
 #include <ydb/core/protos/flat_scheme_op.pb.h>
 #include <ydb/core/scheme/scheme_types_proto.h>
 #include <ydb/core/tx/columnshard/blobs_action/bs/storage.h>
@@ -25,6 +26,9 @@ NKikimrSchemeOp::TOlapColumnDescription TTestColumn::CreateColumn(const ui32 id)
         col.SetStorageId(StorageId);
     }
     auto columnType = NScheme::ProtoColumnTypeFromTypeInfoMod(Type, "");
+    if (AccessorClassName) {
+        col.MutableDataAccessorConstructor()->SetClassName(AccessorClassName);
+    }
     col.SetTypeId(columnType.TypeId);
     if (columnType.TypeInfo) {
         *col.MutableTypeInfo() = *columnType.TypeInfo;
@@ -32,6 +36,16 @@ NKikimrSchemeOp::TOlapColumnDescription TTestColumn::CreateColumn(const ui32 id)
     return col;
 }
 
+std::set<std::string> TTestColumn::GetNullableSet(const std::vector<TTestColumn>& columns) {
+    std::set<std::string> result;
+    for (auto&& i : columns) {
+        if (!i.GetNullable()) {
+            result.emplace(i.GetName());
+        }
+    }
+    return result;
+}
+
 std::vector<std::pair<TString, NKikimr::NScheme::TTypeInfo>> TTestColumn::ConvertToPairs(const std::vector<TTestColumn>& columns) {
     std::vector<std::pair<TString, NScheme::TTypeInfo>> result;
     for (auto&& i : columns) {
@@ -66,15 +80,15 @@ std::vector<NKikimr::NArrow::NTest::TTestColumn> TTestColumn::CropSchema(const s
 
 namespace NKikimr::NArrow {
 
-std::vector<std::shared_ptr<arrow::Field>> MakeArrowFields(
-    const std::vector<NTest::TTestColumn>& columns, const std::set<std::string>& notNullColumns /*= {}*/) {
+std::vector<std::shared_ptr<arrow::Field>> MakeArrowFields(const std::vector<NTest::TTestColumn>& columns) {
+    std::set<std::string> notNullColumns = NTest::TTestColumn::GetNullableSet(columns);
     auto result = MakeArrowFields(NTest::TTestColumn::ConvertToPairs(columns), notNullColumns);
     UNIT_ASSERT_C(result.ok(), result.status().ToString());
     return result.ValueUnsafe();
 }
 
-std::shared_ptr<arrow::Schema> MakeArrowSchema(
-    const std::vector<NTest::TTestColumn>& columns, const std::set<std::string>& notNullColumns /*= {}*/) {
+std::shared_ptr<arrow::Schema> MakeArrowSchema(const std::vector<NTest::TTestColumn>& columns) {
+    std::set<std::string> notNullColumns = NTest::TTestColumn::GetNullableSet(columns);
     auto result = MakeArrowSchema(NTest::TTestColumn::ConvertToPairs(columns), notNullColumns);
     UNIT_ASSERT_C(result.ok(), result.status().ToString());
     return result.ValueUnsafe();
diff --git a/ydb/core/tx/columnshard/test_helper/helper.h b/ydb/core/tx/columnshard/test_helper/helper.h
index cf71657cf97c..98f9a09b526c 100644
--- a/ydb/core/tx/columnshard/test_helper/helper.h
+++ b/ydb/core/tx/columnshard/test_helper/helper.h
@@ -51,6 +51,9 @@ class TTestColumn {
     YDB_ACCESSOR_DEF(TString, Name);
     YDB_ACCESSOR_DEF(NScheme::TTypeInfo, Type);
     YDB_ACCESSOR_DEF(TString, StorageId);
+    YDB_ACCESSOR_DEF(TString, AccessorClassName);
+    YDB_ACCESSOR(bool, Nullable, true);
+
 public:
     explicit TTestColumn(const TString& name, const NScheme::TTypeInfo& type)
         : Name(name)
@@ -63,13 +66,14 @@ class TTestColumn {
     static THashMap<TString, NScheme::TTypeInfo> ConvertToHash(const std::vector<TTestColumn>& columns);
     static std::vector<TTestColumn> BuildFromPairs(const std::vector<std::pair<TString, NScheme::TTypeInfo>>& columns);
     static std::vector<TTestColumn> CropSchema(const std::vector<TTestColumn>& input, const ui32 size);
+    static std::set<std::string> GetNullableSet(const std::vector<TTestColumn>& columns);
 };
 
 }
 
 namespace NKikimr::NArrow {
 
-std::vector<std::shared_ptr<arrow::Field>> MakeArrowFields(const std::vector<NTest::TTestColumn>& columns, const std::set<std::string>& notNullColumns = {});
-std::shared_ptr<arrow::Schema> MakeArrowSchema(const std::vector<NTest::TTestColumn>& columns, const std::set<std::string>& notNullColumns = {});
+std::vector<std::shared_ptr<arrow::Field>> MakeArrowFields(const std::vector<NTest::TTestColumn>& columns);
+std::shared_ptr<arrow::Schema> MakeArrowSchema(const std::vector<NTest::TTestColumn>& columns);
 
 }
diff --git a/ydb/core/tx/columnshard/common/tests/shard_reader.h b/ydb/core/tx/columnshard/test_helper/shard_reader.h
similarity index 99%
rename from ydb/core/tx/columnshard/common/tests/shard_reader.h
rename to ydb/core/tx/columnshard/test_helper/shard_reader.h
index 1bb3ad353835..2beaa5a782d9 100644
--- a/ydb/core/tx/columnshard/common/tests/shard_reader.h
+++ b/ydb/core/tx/columnshard/test_helper/shard_reader.h
@@ -10,7 +10,7 @@
 #include <contrib/libs/apache/arrow/cpp/src/arrow/record_batch.h>
 #include <optional>
 
-namespace NKikimr::NOlap::NTests {
+namespace NKikimr::NTxUT {
 
 class TShardReader {
 private:
@@ -267,4 +267,4 @@ class TShardReader {
     }
 };
 
-}
+} //namespace NKikimr::NTxUT
diff --git a/ydb/core/tx/columnshard/test_helper/ya.make b/ydb/core/tx/columnshard/test_helper/ya.make
index a900deb266db..cab4937293dd 100644
--- a/ydb/core/tx/columnshard/test_helper/ya.make
+++ b/ydb/core/tx/columnshard/test_helper/ya.make
@@ -2,6 +2,7 @@ LIBRARY()
 
 PEERDIR(
     ydb/core/protos
+    ydb/core/formats/arrow
     contrib/libs/apache/arrow
     ydb/library/actors/core
     ydb/core/tx/columnshard/blobs_action/bs
diff --git a/ydb/core/tx/schemeshard/ut_helpers/test_env.cpp b/ydb/core/tx/schemeshard/ut_helpers/test_env.cpp
index a4f0b3a544d7..9e5b7c8543f6 100644
--- a/ydb/core/tx/schemeshard/ut_helpers/test_env.cpp
+++ b/ydb/core/tx/schemeshard/ut_helpers/test_env.cpp
@@ -542,6 +542,7 @@ NSchemeShardUT_Private::TTestEnv::TTestEnv(TTestActorRuntime& runtime, const TTe
     app.SetEnableAddColumsWithDefaults(opts.EnableAddColumsWithDefaults_);
     app.SetEnableReplaceIfExistsForExternalEntities(opts.EnableReplaceIfExistsForExternalEntities_);
     app.SetEnableChangefeedsOnIndexTables(opts.EnableChangefeedsOnIndexTables_);
+    app.SetEnableTieringInColumnShard(opts.EnableTieringInColumnShard_);
 
     app.ColumnShardConfig.SetDisabledOnSchemeShard(false);
 
diff --git a/ydb/core/tx/schemeshard/ut_helpers/test_env.h b/ydb/core/tx/schemeshard/ut_helpers/test_env.h
index 388b50caa579..c433855c9c76 100644
--- a/ydb/core/tx/schemeshard/ut_helpers/test_env.h
+++ b/ydb/core/tx/schemeshard/ut_helpers/test_env.h
@@ -66,6 +66,7 @@ namespace NSchemeShardUT_Private {
         OPTION(std::optional<bool>, EnableReplaceIfExistsForExternalEntities, std::nullopt);
         OPTION(std::optional<TString>, GraphBackendType, std::nullopt);
         OPTION(std::optional<bool>, EnableChangefeedsOnIndexTables, std::nullopt);
+        OPTION(std::optional<bool>, EnableTieringInColumnShard, std::nullopt);
 
         #undef OPTION
     };
diff --git a/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-12 b/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-12
index 16b69fb8840b..1c7f8a39bfee 100644
--- a/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-12
+++ b/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-12
@@ -59,18 +59,8 @@
                                                         "PlanNodeType": "Connection",
                                                         "Plans": [
                                                             {
-                                                                "Node Type": "Aggregate-TableFullScan",
+                                                                "Node Type": "TableFullScan",
                                                                 "Operators": [
-                                                                    {
-                                                                        "Aggregation": "{_yql_agg_0: SUM(state._yql_agg_0,1)}",
-                                                                        "GroupBy": "item.SearchPhrase",
-                                                                        "Inputs": [
-                                                                            {
-                                                                                "InternalOperatorId": 1
-                                                                            }
-                                                                        ],
-                                                                        "Name": "Aggregate"
-                                                                    },
                                                                     {
                                                                         "Inputs": [],
                                                                         "Name": "TableFullScan",
@@ -124,11 +114,33 @@
                                                                                         }
                                                                                     }
                                                                                 },
+                                                                                {
+                                                                                    "GroupBy": {
+                                                                                        "Aggregates": [
+                                                                                            {
+                                                                                                "Column": {
+                                                                                                    "Id": 108
+                                                                                                },
+                                                                                                "Function": {
+                                                                                                    "Id": 2
+                                                                                                }
+                                                                                            }
+                                                                                        ],
+                                                                                        "KeyColumns": [
+                                                                                            {
+                                                                                                "Id": 40
+                                                                                            }
+                                                                                        ]
+                                                                                    }
+                                                                                },
                                                                                 {
                                                                                     "Projection": {
                                                                                         "Columns": [
                                                                                             {
                                                                                                 "Id": 40
+                                                                                            },
+                                                                                            {
+                                                                                                "Id": 108
                                                                                             }
                                                                                         ]
                                                                                     }
@@ -191,89 +203,98 @@
                                         "PlanNodeId": 4,
                                         "Plans": [
                                             {
-                                                "Node Type": "Aggregate",
+                                                "Node Type": "TableFullScan",
                                                 "Operators": [
                                                     {
-                                                        "Aggregation": "{_yql_agg_0: SUM(state._yql_agg_0,1)}",
-                                                        "GroupBy": "item.SearchPhrase",
-                                                        "Name": "Aggregate"
-                                                    }
-                                                ],
-                                                "PlanNodeId": 6,
-                                                "Plans": [
-                                                    {
-                                                        "Node Type": "TableFullScan",
-                                                        "Operators": [
-                                                            {
-                                                                "Name": "TableFullScan",
-                                                                "ReadColumns": [
-                                                                    "SearchPhrase"
-                                                                ],
-                                                                "ReadRanges": [
-                                                                    "CounterID (-\u221e, +\u221e)",
-                                                                    "EventDate (-\u221e, +\u221e)",
-                                                                    "UserID (-\u221e, +\u221e)",
-                                                                    "EventTime (-\u221e, +\u221e)",
-                                                                    "WatchID (-\u221e, +\u221e)"
-                                                                ],
-                                                                "Scan": "Parallel",
-                                                                "SsaProgram": {
-                                                                    "Command": [
-                                                                        {
-                                                                            "Assign": {
-                                                                                "Column": {
-                                                                                    "Id": 106
+                                                        "Name": "TableFullScan",
+                                                        "ReadColumns": [
+                                                            "SearchPhrase"
+                                                        ],
+                                                        "ReadRanges": [
+                                                            "CounterID (-\u221e, +\u221e)",
+                                                            "EventDate (-\u221e, +\u221e)",
+                                                            "UserID (-\u221e, +\u221e)",
+                                                            "EventTime (-\u221e, +\u221e)",
+                                                            "WatchID (-\u221e, +\u221e)"
+                                                        ],
+                                                        "Scan": "Parallel",
+                                                        "SsaProgram": {
+                                                            "Command": [
+                                                                {
+                                                                    "Assign": {
+                                                                        "Column": {
+                                                                            "Id": 106
+                                                                        },
+                                                                        "Constant": {
+                                                                            "Bytes": ""
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "Assign": {
+                                                                        "Column": {
+                                                                            "Id": 107
+                                                                        },
+                                                                        "Function": {
+                                                                            "Arguments": [
+                                                                                {
+                                                                                    "Id": 40
                                                                                 },
-                                                                                "Constant": {
-                                                                                    "Bytes": ""
+                                                                                {
+                                                                                    "Id": 106
                                                                                 }
-                                                                            }
-                                                                        },
-                                                                        {
-                                                                            "Assign": {
+                                                                            ],
+                                                                            "FunctionType": 2,
+                                                                            "KernelIdx": 0,
+                                                                            "YqlOperationId": 12
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "Filter": {
+                                                                        "Predicate": {
+                                                                            "Id": 107
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "GroupBy": {
+                                                                        "Aggregates": [
+                                                                            {
                                                                                 "Column": {
-                                                                                    "Id": 107
+                                                                                    "Id": 108
                                                                                 },
                                                                                 "Function": {
-                                                                                    "Arguments": [
-                                                                                        {
-                                                                                            "Id": 40
-                                                                                        },
-                                                                                        {
-                                                                                            "Id": 106
-                                                                                        }
-                                                                                    ],
-                                                                                    "FunctionType": 2,
-                                                                                    "KernelIdx": 0,
-                                                                                    "YqlOperationId": 12
+                                                                                    "Id": 2
                                                                                 }
                                                                             }
-                                                                        },
-                                                                        {
-                                                                            "Filter": {
-                                                                                "Predicate": {
-                                                                                    "Id": 107
-                                                                                }
-                                                                            }
-                                                                        },
-                                                                        {
-                                                                            "Projection": {
-                                                                                "Columns": [
-                                                                                    {
-                                                                                        "Id": 40
-                                                                                    }
-                                                                                ]
+                                                                        ],
+                                                                        "KeyColumns": [
+                                                                            {
+                                                                                "Id": 40
                                                                             }
-                                                                        }
-                                                                    ],
-                                                                    "Version": 4
+                                                                        ]
+                                                                    }
                                                                 },
-                                                                "Table": "clickbench/plans/column/hits"
-                                                            }
-                                                        ],
-                                                        "PlanNodeId": 7
+                                                                {
+                                                                    "Projection": {
+                                                                        "Columns": [
+                                                                            {
+                                                                                "Id": 40
+                                                                            },
+                                                                            {
+                                                                                "Id": 108
+                                                                            }
+                                                                        ]
+                                                                    }
+                                                                }
+                                                            ],
+                                                            "Version": 4
+                                                        },
+                                                        "Table": "clickbench/plans/column/hits"
                                                     }
-                                                ]
+                                                ],
+                                                "PlanNodeId": 6
                                             }
                                         ]
                                     }
diff --git a/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-14 b/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-14
index 540a47da8afa..81c702c23b55 100644
--- a/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-14
+++ b/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-14
@@ -60,18 +60,8 @@
                                                         "PlanNodeType": "Connection",
                                                         "Plans": [
                                                             {
-                                                                "Node Type": "Aggregate-TableFullScan",
+                                                                "Node Type": "TableFullScan",
                                                                 "Operators": [
-                                                                    {
-                                                                        "Aggregation": "{_yql_agg_0: SUM(state._yql_agg_0,1)}",
-                                                                        "GroupBy": "",
-                                                                        "Inputs": [
-                                                                            {
-                                                                                "InternalOperatorId": 1
-                                                                            }
-                                                                        ],
-                                                                        "Name": "Aggregate"
-                                                                    },
                                                                     {
                                                                         "Inputs": [],
                                                                         "Name": "TableFullScan",
@@ -126,6 +116,28 @@
                                                                                         }
                                                                                     }
                                                                                 },
+                                                                                {
+                                                                                    "GroupBy": {
+                                                                                        "Aggregates": [
+                                                                                            {
+                                                                                                "Column": {
+                                                                                                    "Id": 108
+                                                                                                },
+                                                                                                "Function": {
+                                                                                                    "Id": 2
+                                                                                                }
+                                                                                            }
+                                                                                        ],
+                                                                                        "KeyColumns": [
+                                                                                            {
+                                                                                                "Id": 39
+                                                                                            },
+                                                                                            {
+                                                                                                "Id": 40
+                                                                                            }
+                                                                                        ]
+                                                                                    }
+                                                                                },
                                                                                 {
                                                                                     "Projection": {
                                                                                         "Columns": [
@@ -134,6 +146,9 @@
                                                                                             },
                                                                                             {
                                                                                                 "Id": 40
+                                                                                            },
+                                                                                            {
+                                                                                                "Id": 108
                                                                                             }
                                                                                         ]
                                                                                     }
@@ -196,93 +211,105 @@
                                         "PlanNodeId": 4,
                                         "Plans": [
                                             {
-                                                "Node Type": "Aggregate",
+                                                "Node Type": "TableFullScan",
                                                 "Operators": [
                                                     {
-                                                        "Aggregation": "{_yql_agg_0: SUM(state._yql_agg_0,1)}",
-                                                        "GroupBy": "",
-                                                        "Name": "Aggregate"
-                                                    }
-                                                ],
-                                                "PlanNodeId": 6,
-                                                "Plans": [
-                                                    {
-                                                        "Node Type": "TableFullScan",
-                                                        "Operators": [
-                                                            {
-                                                                "Name": "TableFullScan",
-                                                                "ReadColumns": [
-                                                                    "SearchEngineID",
-                                                                    "SearchPhrase"
-                                                                ],
-                                                                "ReadRanges": [
-                                                                    "CounterID (-\u221e, +\u221e)",
-                                                                    "EventDate (-\u221e, +\u221e)",
-                                                                    "UserID (-\u221e, +\u221e)",
-                                                                    "EventTime (-\u221e, +\u221e)",
-                                                                    "WatchID (-\u221e, +\u221e)"
-                                                                ],
-                                                                "Scan": "Parallel",
-                                                                "SsaProgram": {
-                                                                    "Command": [
-                                                                        {
-                                                                            "Assign": {
-                                                                                "Column": {
-                                                                                    "Id": 106
+                                                        "Name": "TableFullScan",
+                                                        "ReadColumns": [
+                                                            "SearchEngineID",
+                                                            "SearchPhrase"
+                                                        ],
+                                                        "ReadRanges": [
+                                                            "CounterID (-\u221e, +\u221e)",
+                                                            "EventDate (-\u221e, +\u221e)",
+                                                            "UserID (-\u221e, +\u221e)",
+                                                            "EventTime (-\u221e, +\u221e)",
+                                                            "WatchID (-\u221e, +\u221e)"
+                                                        ],
+                                                        "Scan": "Parallel",
+                                                        "SsaProgram": {
+                                                            "Command": [
+                                                                {
+                                                                    "Assign": {
+                                                                        "Column": {
+                                                                            "Id": 106
+                                                                        },
+                                                                        "Constant": {
+                                                                            "Bytes": ""
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "Assign": {
+                                                                        "Column": {
+                                                                            "Id": 107
+                                                                        },
+                                                                        "Function": {
+                                                                            "Arguments": [
+                                                                                {
+                                                                                    "Id": 40
                                                                                 },
-                                                                                "Constant": {
-                                                                                    "Bytes": ""
+                                                                                {
+                                                                                    "Id": 106
                                                                                 }
-                                                                            }
-                                                                        },
-                                                                        {
-                                                                            "Assign": {
+                                                                            ],
+                                                                            "FunctionType": 2,
+                                                                            "KernelIdx": 0,
+                                                                            "YqlOperationId": 12
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "Filter": {
+                                                                        "Predicate": {
+                                                                            "Id": 107
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "GroupBy": {
+                                                                        "Aggregates": [
+                                                                            {
                                                                                 "Column": {
-                                                                                    "Id": 107
+                                                                                    "Id": 108
                                                                                 },
                                                                                 "Function": {
-                                                                                    "Arguments": [
-                                                                                        {
-                                                                                            "Id": 40
-                                                                                        },
-                                                                                        {
-                                                                                            "Id": 106
-                                                                                        }
-                                                                                    ],
-                                                                                    "FunctionType": 2,
-                                                                                    "KernelIdx": 0,
-                                                                                    "YqlOperationId": 12
-                                                                                }
-                                                                            }
-                                                                        },
-                                                                        {
-                                                                            "Filter": {
-                                                                                "Predicate": {
-                                                                                    "Id": 107
+                                                                                    "Id": 2
                                                                                 }
                                                                             }
-                                                                        },
-                                                                        {
-                                                                            "Projection": {
-                                                                                "Columns": [
-                                                                                    {
-                                                                                        "Id": 39
-                                                                                    },
-                                                                                    {
-                                                                                        "Id": 40
-                                                                                    }
-                                                                                ]
+                                                                        ],
+                                                                        "KeyColumns": [
+                                                                            {
+                                                                                "Id": 39
+                                                                            },
+                                                                            {
+                                                                                "Id": 40
                                                                             }
-                                                                        }
-                                                                    ],
-                                                                    "Version": 4
+                                                                        ]
+                                                                    }
                                                                 },
-                                                                "Table": "clickbench/plans/column/hits"
-                                                            }
-                                                        ],
-                                                        "PlanNodeId": 7
+                                                                {
+                                                                    "Projection": {
+                                                                        "Columns": [
+                                                                            {
+                                                                                "Id": 39
+                                                                            },
+                                                                            {
+                                                                                "Id": 40
+                                                                            },
+                                                                            {
+                                                                                "Id": 108
+                                                                            }
+                                                                        ]
+                                                                    }
+                                                                }
+                                                            ],
+                                                            "Version": 4
+                                                        },
+                                                        "Table": "clickbench/plans/column/hits"
                                                     }
-                                                ]
+                                                ],
+                                                "PlanNodeId": 6
                                             }
                                         ]
                                     }
diff --git a/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-15 b/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-15
index c9fb982c086a..bfc057c98171 100644
--- a/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-15
+++ b/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-15
@@ -59,18 +59,8 @@
                                                         "PlanNodeType": "Connection",
                                                         "Plans": [
                                                             {
-                                                                "Node Type": "Aggregate-TableFullScan",
+                                                                "Node Type": "TableFullScan",
                                                                 "Operators": [
-                                                                    {
-                                                                        "Aggregation": "{_yql_agg_0: SUM(state._yql_agg_0,1)}",
-                                                                        "GroupBy": "item.UserID",
-                                                                        "Inputs": [
-                                                                            {
-                                                                                "InternalOperatorId": 1
-                                                                            }
-                                                                        ],
-                                                                        "Name": "Aggregate"
-                                                                    },
                                                                     {
                                                                         "Inputs": [],
                                                                         "Name": "TableFullScan",
@@ -87,11 +77,33 @@
                                                                         "Scan": "Parallel",
                                                                         "SsaProgram": {
                                                                             "Command": [
+                                                                                {
+                                                                                    "GroupBy": {
+                                                                                        "Aggregates": [
+                                                                                            {
+                                                                                                "Column": {
+                                                                                                    "Id": 106
+                                                                                                },
+                                                                                                "Function": {
+                                                                                                    "Id": 2
+                                                                                                }
+                                                                                            }
+                                                                                        ],
+                                                                                        "KeyColumns": [
+                                                                                            {
+                                                                                                "Id": 10
+                                                                                            }
+                                                                                        ]
+                                                                                    }
+                                                                                },
                                                                                 {
                                                                                     "Projection": {
                                                                                         "Columns": [
                                                                                             {
                                                                                                 "Id": 10
+                                                                                            },
+                                                                                            {
+                                                                                                "Id": 106
                                                                                             }
                                                                                         ]
                                                                                     }
@@ -154,52 +166,61 @@
                                         "PlanNodeId": 4,
                                         "Plans": [
                                             {
-                                                "Node Type": "Aggregate",
+                                                "Node Type": "TableFullScan",
                                                 "Operators": [
                                                     {
-                                                        "Aggregation": "{_yql_agg_0: SUM(state._yql_agg_0,1)}",
-                                                        "GroupBy": "item.UserID",
-                                                        "Name": "Aggregate"
-                                                    }
-                                                ],
-                                                "PlanNodeId": 6,
-                                                "Plans": [
-                                                    {
-                                                        "Node Type": "TableFullScan",
-                                                        "Operators": [
-                                                            {
-                                                                "Name": "TableFullScan",
-                                                                "ReadColumns": [
-                                                                    "UserID"
-                                                                ],
-                                                                "ReadRanges": [
-                                                                    "CounterID (-\u221e, +\u221e)",
-                                                                    "EventDate (-\u221e, +\u221e)",
-                                                                    "UserID (-\u221e, +\u221e)",
-                                                                    "EventTime (-\u221e, +\u221e)",
-                                                                    "WatchID (-\u221e, +\u221e)"
-                                                                ],
-                                                                "Scan": "Parallel",
-                                                                "SsaProgram": {
-                                                                    "Command": [
-                                                                        {
-                                                                            "Projection": {
-                                                                                "Columns": [
-                                                                                    {
-                                                                                        "Id": 10
-                                                                                    }
-                                                                                ]
+                                                        "Name": "TableFullScan",
+                                                        "ReadColumns": [
+                                                            "UserID"
+                                                        ],
+                                                        "ReadRanges": [
+                                                            "CounterID (-\u221e, +\u221e)",
+                                                            "EventDate (-\u221e, +\u221e)",
+                                                            "UserID (-\u221e, +\u221e)",
+                                                            "EventTime (-\u221e, +\u221e)",
+                                                            "WatchID (-\u221e, +\u221e)"
+                                                        ],
+                                                        "Scan": "Parallel",
+                                                        "SsaProgram": {
+                                                            "Command": [
+                                                                {
+                                                                    "GroupBy": {
+                                                                        "Aggregates": [
+                                                                            {
+                                                                                "Column": {
+                                                                                    "Id": 106
+                                                                                },
+                                                                                "Function": {
+                                                                                    "Id": 2
+                                                                                }
+                                                                            }
+                                                                        ],
+                                                                        "KeyColumns": [
+                                                                            {
+                                                                                "Id": 10
                                                                             }
-                                                                        }
-                                                                    ],
-                                                                    "Version": 4
+                                                                        ]
+                                                                    }
                                                                 },
-                                                                "Table": "clickbench/plans/column/hits"
-                                                            }
-                                                        ],
-                                                        "PlanNodeId": 7
+                                                                {
+                                                                    "Projection": {
+                                                                        "Columns": [
+                                                                            {
+                                                                                "Id": 10
+                                                                            },
+                                                                            {
+                                                                                "Id": 106
+                                                                            }
+                                                                        ]
+                                                                    }
+                                                                }
+                                                            ],
+                                                            "Version": 4
+                                                        },
+                                                        "Table": "clickbench/plans/column/hits"
                                                     }
-                                                ]
+                                                ],
+                                                "PlanNodeId": 6
                                             }
                                         ]
                                     }
diff --git a/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-16 b/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-16
index 3fb5e7befa7d..d08b757a0299 100644
--- a/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-16
+++ b/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-16
@@ -60,18 +60,8 @@
                                                         "PlanNodeType": "Connection",
                                                         "Plans": [
                                                             {
-                                                                "Node Type": "Aggregate-TableFullScan",
+                                                                "Node Type": "TableFullScan",
                                                                 "Operators": [
-                                                                    {
-                                                                        "Aggregation": "{_yql_agg_0: SUM(state._yql_agg_0,1)}",
-                                                                        "GroupBy": "",
-                                                                        "Inputs": [
-                                                                            {
-                                                                                "InternalOperatorId": 1
-                                                                            }
-                                                                        ],
-                                                                        "Name": "Aggregate"
-                                                                    },
                                                                     {
                                                                         "Inputs": [],
                                                                         "Name": "TableFullScan",
@@ -89,6 +79,28 @@
                                                                         "Scan": "Parallel",
                                                                         "SsaProgram": {
                                                                             "Command": [
+                                                                                {
+                                                                                    "GroupBy": {
+                                                                                        "Aggregates": [
+                                                                                            {
+                                                                                                "Column": {
+                                                                                                    "Id": 106
+                                                                                                },
+                                                                                                "Function": {
+                                                                                                    "Id": 2
+                                                                                                }
+                                                                                            }
+                                                                                        ],
+                                                                                        "KeyColumns": [
+                                                                                            {
+                                                                                                "Id": 40
+                                                                                            },
+                                                                                            {
+                                                                                                "Id": 10
+                                                                                            }
+                                                                                        ]
+                                                                                    }
+                                                                                },
                                                                                 {
                                                                                     "Projection": {
                                                                                         "Columns": [
@@ -97,6 +109,9 @@
                                                                                             },
                                                                                             {
                                                                                                 "Id": 10
+                                                                                            },
+                                                                                            {
+                                                                                                "Id": 106
                                                                                             }
                                                                                         ]
                                                                                     }
@@ -159,56 +174,68 @@
                                         "PlanNodeId": 4,
                                         "Plans": [
                                             {
-                                                "Node Type": "Aggregate",
+                                                "Node Type": "TableFullScan",
                                                 "Operators": [
                                                     {
-                                                        "Aggregation": "{_yql_agg_0: SUM(state._yql_agg_0,1)}",
-                                                        "GroupBy": "",
-                                                        "Name": "Aggregate"
-                                                    }
-                                                ],
-                                                "PlanNodeId": 6,
-                                                "Plans": [
-                                                    {
-                                                        "Node Type": "TableFullScan",
-                                                        "Operators": [
-                                                            {
-                                                                "Name": "TableFullScan",
-                                                                "ReadColumns": [
-                                                                    "SearchPhrase",
-                                                                    "UserID"
-                                                                ],
-                                                                "ReadRanges": [
-                                                                    "CounterID (-\u221e, +\u221e)",
-                                                                    "EventDate (-\u221e, +\u221e)",
-                                                                    "UserID (-\u221e, +\u221e)",
-                                                                    "EventTime (-\u221e, +\u221e)",
-                                                                    "WatchID (-\u221e, +\u221e)"
-                                                                ],
-                                                                "Scan": "Parallel",
-                                                                "SsaProgram": {
-                                                                    "Command": [
-                                                                        {
-                                                                            "Projection": {
-                                                                                "Columns": [
-                                                                                    {
-                                                                                        "Id": 40
-                                                                                    },
-                                                                                    {
-                                                                                        "Id": 10
-                                                                                    }
-                                                                                ]
+                                                        "Name": "TableFullScan",
+                                                        "ReadColumns": [
+                                                            "SearchPhrase",
+                                                            "UserID"
+                                                        ],
+                                                        "ReadRanges": [
+                                                            "CounterID (-\u221e, +\u221e)",
+                                                            "EventDate (-\u221e, +\u221e)",
+                                                            "UserID (-\u221e, +\u221e)",
+                                                            "EventTime (-\u221e, +\u221e)",
+                                                            "WatchID (-\u221e, +\u221e)"
+                                                        ],
+                                                        "Scan": "Parallel",
+                                                        "SsaProgram": {
+                                                            "Command": [
+                                                                {
+                                                                    "GroupBy": {
+                                                                        "Aggregates": [
+                                                                            {
+                                                                                "Column": {
+                                                                                    "Id": 106
+                                                                                },
+                                                                                "Function": {
+                                                                                    "Id": 2
+                                                                                }
+                                                                            }
+                                                                        ],
+                                                                        "KeyColumns": [
+                                                                            {
+                                                                                "Id": 40
+                                                                            },
+                                                                            {
+                                                                                "Id": 10
                                                                             }
-                                                                        }
-                                                                    ],
-                                                                    "Version": 4
+                                                                        ]
+                                                                    }
                                                                 },
-                                                                "Table": "clickbench/plans/column/hits"
-                                                            }
-                                                        ],
-                                                        "PlanNodeId": 7
+                                                                {
+                                                                    "Projection": {
+                                                                        "Columns": [
+                                                                            {
+                                                                                "Id": 40
+                                                                            },
+                                                                            {
+                                                                                "Id": 10
+                                                                            },
+                                                                            {
+                                                                                "Id": 106
+                                                                            }
+                                                                        ]
+                                                                    }
+                                                                }
+                                                            ],
+                                                            "Version": 4
+                                                        },
+                                                        "Table": "clickbench/plans/column/hits"
                                                     }
-                                                ]
+                                                ],
+                                                "PlanNodeId": 6
                                             }
                                         ]
                                     }
diff --git a/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-17 b/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-17
index 94ef751b2c62..a56994b072f4 100644
--- a/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-17
+++ b/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-17
@@ -59,18 +59,8 @@
                                                         "PlanNodeType": "Connection",
                                                         "Plans": [
                                                             {
-                                                                "Node Type": "Aggregate-TableFullScan",
+                                                                "Node Type": "TableFullScan",
                                                                 "Operators": [
-                                                                    {
-                                                                        "Aggregation": "{_yql_agg_0: SUM(state._yql_agg_0,1)}",
-                                                                        "GroupBy": "",
-                                                                        "Inputs": [
-                                                                            {
-                                                                                "InternalOperatorId": 1
-                                                                            }
-                                                                        ],
-                                                                        "Name": "Aggregate"
-                                                                    },
                                                                     {
                                                                         "Inputs": [],
                                                                         "Name": "TableFullScan",
@@ -88,6 +78,28 @@
                                                                         "Scan": "Parallel",
                                                                         "SsaProgram": {
                                                                             "Command": [
+                                                                                {
+                                                                                    "GroupBy": {
+                                                                                        "Aggregates": [
+                                                                                            {
+                                                                                                "Column": {
+                                                                                                    "Id": 106
+                                                                                                },
+                                                                                                "Function": {
+                                                                                                    "Id": 2
+                                                                                                }
+                                                                                            }
+                                                                                        ],
+                                                                                        "KeyColumns": [
+                                                                                            {
+                                                                                                "Id": 40
+                                                                                            },
+                                                                                            {
+                                                                                                "Id": 10
+                                                                                            }
+                                                                                        ]
+                                                                                    }
+                                                                                },
                                                                                 {
                                                                                     "Projection": {
                                                                                         "Columns": [
@@ -96,6 +108,9 @@
                                                                                             },
                                                                                             {
                                                                                                 "Id": 10
+                                                                                            },
+                                                                                            {
+                                                                                                "Id": 106
                                                                                             }
                                                                                         ]
                                                                                     }
@@ -154,56 +169,68 @@
                                         "PlanNodeId": 4,
                                         "Plans": [
                                             {
-                                                "Node Type": "Aggregate",
+                                                "Node Type": "TableFullScan",
                                                 "Operators": [
                                                     {
-                                                        "Aggregation": "{_yql_agg_0: SUM(state._yql_agg_0,1)}",
-                                                        "GroupBy": "",
-                                                        "Name": "Aggregate"
-                                                    }
-                                                ],
-                                                "PlanNodeId": 6,
-                                                "Plans": [
-                                                    {
-                                                        "Node Type": "TableFullScan",
-                                                        "Operators": [
-                                                            {
-                                                                "Name": "TableFullScan",
-                                                                "ReadColumns": [
-                                                                    "SearchPhrase",
-                                                                    "UserID"
-                                                                ],
-                                                                "ReadRanges": [
-                                                                    "CounterID (-\u221e, +\u221e)",
-                                                                    "EventDate (-\u221e, +\u221e)",
-                                                                    "UserID (-\u221e, +\u221e)",
-                                                                    "EventTime (-\u221e, +\u221e)",
-                                                                    "WatchID (-\u221e, +\u221e)"
-                                                                ],
-                                                                "Scan": "Parallel",
-                                                                "SsaProgram": {
-                                                                    "Command": [
-                                                                        {
-                                                                            "Projection": {
-                                                                                "Columns": [
-                                                                                    {
-                                                                                        "Id": 40
-                                                                                    },
-                                                                                    {
-                                                                                        "Id": 10
-                                                                                    }
-                                                                                ]
+                                                        "Name": "TableFullScan",
+                                                        "ReadColumns": [
+                                                            "SearchPhrase",
+                                                            "UserID"
+                                                        ],
+                                                        "ReadRanges": [
+                                                            "CounterID (-\u221e, +\u221e)",
+                                                            "EventDate (-\u221e, +\u221e)",
+                                                            "UserID (-\u221e, +\u221e)",
+                                                            "EventTime (-\u221e, +\u221e)",
+                                                            "WatchID (-\u221e, +\u221e)"
+                                                        ],
+                                                        "Scan": "Parallel",
+                                                        "SsaProgram": {
+                                                            "Command": [
+                                                                {
+                                                                    "GroupBy": {
+                                                                        "Aggregates": [
+                                                                            {
+                                                                                "Column": {
+                                                                                    "Id": 106
+                                                                                },
+                                                                                "Function": {
+                                                                                    "Id": 2
+                                                                                }
+                                                                            }
+                                                                        ],
+                                                                        "KeyColumns": [
+                                                                            {
+                                                                                "Id": 40
+                                                                            },
+                                                                            {
+                                                                                "Id": 10
                                                                             }
-                                                                        }
-                                                                    ],
-                                                                    "Version": 4
+                                                                        ]
+                                                                    }
                                                                 },
-                                                                "Table": "clickbench/plans/column/hits"
-                                                            }
-                                                        ],
-                                                        "PlanNodeId": 7
+                                                                {
+                                                                    "Projection": {
+                                                                        "Columns": [
+                                                                            {
+                                                                                "Id": 40
+                                                                            },
+                                                                            {
+                                                                                "Id": 10
+                                                                            },
+                                                                            {
+                                                                                "Id": 106
+                                                                            }
+                                                                        ]
+                                                                    }
+                                                                }
+                                                            ],
+                                                            "Version": 4
+                                                        },
+                                                        "Table": "clickbench/plans/column/hits"
                                                     }
-                                                ]
+                                                ],
+                                                "PlanNodeId": 6
                                             }
                                         ]
                                     }
diff --git a/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-21 b/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-21
index 7e17b759c25f..a3aad98b8615 100644
--- a/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-21
+++ b/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-21
@@ -59,18 +59,8 @@
                                                         "PlanNodeType": "Connection",
                                                         "Plans": [
                                                             {
-                                                                "Node Type": "Aggregate-TableFullScan",
+                                                                "Node Type": "TableFullScan",
                                                                 "Operators": [
-                                                                    {
-                                                                        "Aggregation": "{_yql_agg_0: SUM(state._yql_agg_0,1),_yql_agg_1: MIN(item.URL,state._yql_agg_1)}",
-                                                                        "GroupBy": "item.SearchPhrase",
-                                                                        "Inputs": [
-                                                                            {
-                                                                                "InternalOperatorId": 1
-                                                                            }
-                                                                        ],
-                                                                        "Name": "Aggregate"
-                                                                    },
                                                                     {
                                                                         "Inputs": [],
                                                                         "Name": "TableFullScan",
@@ -165,6 +155,38 @@
                                                                                         }
                                                                                     }
                                                                                 },
+                                                                                {
+                                                                                    "GroupBy": {
+                                                                                        "Aggregates": [
+                                                                                            {
+                                                                                                "Column": {
+                                                                                                    "Id": 110
+                                                                                                },
+                                                                                                "Function": {
+                                                                                                    "Id": 2
+                                                                                                }
+                                                                                            },
+                                                                                            {
+                                                                                                "Column": {
+                                                                                                    "Id": 111
+                                                                                                },
+                                                                                                "Function": {
+                                                                                                    "Arguments": [
+                                                                                                        {
+                                                                                                            "Id": 14
+                                                                                                        }
+                                                                                                    ],
+                                                                                                    "Id": 3
+                                                                                                }
+                                                                                            }
+                                                                                        ],
+                                                                                        "KeyColumns": [
+                                                                                            {
+                                                                                                "Id": 40
+                                                                                            }
+                                                                                        ]
+                                                                                    }
+                                                                                },
                                                                                 {
                                                                                     "Projection": {
                                                                                         "Columns": [
@@ -172,7 +194,10 @@
                                                                                                 "Id": 40
                                                                                             },
                                                                                             {
-                                                                                                "Id": 14
+                                                                                                "Id": 110
+                                                                                            },
+                                                                                            {
+                                                                                                "Id": 111
                                                                                             }
                                                                                         ]
                                                                                     }
@@ -235,133 +260,155 @@
                                         "PlanNodeId": 4,
                                         "Plans": [
                                             {
-                                                "Node Type": "Aggregate",
+                                                "Node Type": "TableFullScan",
                                                 "Operators": [
                                                     {
-                                                        "Aggregation": "{_yql_agg_0: SUM(state._yql_agg_0,1),_yql_agg_1: MIN(item.URL,state._yql_agg_1)}",
-                                                        "GroupBy": "item.SearchPhrase",
-                                                        "Name": "Aggregate"
-                                                    }
-                                                ],
-                                                "PlanNodeId": 6,
-                                                "Plans": [
-                                                    {
-                                                        "Node Type": "TableFullScan",
-                                                        "Operators": [
-                                                            {
-                                                                "Name": "TableFullScan",
-                                                                "ReadColumns": [
-                                                                    "SearchPhrase",
-                                                                    "URL"
-                                                                ],
-                                                                "ReadRanges": [
-                                                                    "CounterID (-\u221e, +\u221e)",
-                                                                    "EventDate (-\u221e, +\u221e)",
-                                                                    "UserID (-\u221e, +\u221e)",
-                                                                    "EventTime (-\u221e, +\u221e)",
-                                                                    "WatchID (-\u221e, +\u221e)"
-                                                                ],
-                                                                "Scan": "Parallel",
-                                                                "SsaProgram": {
-                                                                    "Command": [
-                                                                        {
-                                                                            "Assign": {
-                                                                                "Column": {
-                                                                                    "Id": 106
-                                                                                },
-                                                                                "Constant": {
-                                                                                    "Bytes": ""
-                                                                                }
-                                                                            }
+                                                        "Name": "TableFullScan",
+                                                        "ReadColumns": [
+                                                            "SearchPhrase",
+                                                            "URL"
+                                                        ],
+                                                        "ReadRanges": [
+                                                            "CounterID (-\u221e, +\u221e)",
+                                                            "EventDate (-\u221e, +\u221e)",
+                                                            "UserID (-\u221e, +\u221e)",
+                                                            "EventTime (-\u221e, +\u221e)",
+                                                            "WatchID (-\u221e, +\u221e)"
+                                                        ],
+                                                        "Scan": "Parallel",
+                                                        "SsaProgram": {
+                                                            "Command": [
+                                                                {
+                                                                    "Assign": {
+                                                                        "Column": {
+                                                                            "Id": 106
                                                                         },
-                                                                        {
-                                                                            "Assign": {
-                                                                                "Column": {
-                                                                                    "Id": 107
-                                                                                },
-                                                                                "Function": {
-                                                                                    "Arguments": [
-                                                                                        {
-                                                                                            "Id": 40
-                                                                                        },
-                                                                                        {
-                                                                                            "Id": 106
-                                                                                        }
-                                                                                    ],
-                                                                                    "FunctionType": 2,
-                                                                                    "KernelIdx": 0,
-                                                                                    "YqlOperationId": 12
-                                                                                }
-                                                                            }
+                                                                        "Constant": {
+                                                                            "Bytes": ""
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "Assign": {
+                                                                        "Column": {
+                                                                            "Id": 107
                                                                         },
-                                                                        {
-                                                                            "Filter": {
-                                                                                "Predicate": {
-                                                                                    "Id": 107
+                                                                        "Function": {
+                                                                            "Arguments": [
+                                                                                {
+                                                                                    "Id": 40
+                                                                                },
+                                                                                {
+                                                                                    "Id": 106
                                                                                 }
-                                                                            }
+                                                                            ],
+                                                                            "FunctionType": 2,
+                                                                            "KernelIdx": 0,
+                                                                            "YqlOperationId": 12
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "Filter": {
+                                                                        "Predicate": {
+                                                                            "Id": 107
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "Projection": {}
+                                                                },
+                                                                {
+                                                                    "Assign": {
+                                                                        "Column": {
+                                                                            "Id": 108
                                                                         },
-                                                                        {
-                                                                            "Projection": {}
+                                                                        "Constant": {
+                                                                            "Bytes": "google"
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "Assign": {
+                                                                        "Column": {
+                                                                            "Id": 109
                                                                         },
-                                                                        {
-                                                                            "Assign": {
-                                                                                "Column": {
+                                                                        "Function": {
+                                                                            "Arguments": [
+                                                                                {
+                                                                                    "Id": 14
+                                                                                },
+                                                                                {
                                                                                     "Id": 108
+                                                                                }
+                                                                            ],
+                                                                            "FunctionType": 2,
+                                                                            "KernelIdx": 1,
+                                                                            "YqlOperationId": 10
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "Filter": {
+                                                                        "Predicate": {
+                                                                            "Id": 109
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "GroupBy": {
+                                                                        "Aggregates": [
+                                                                            {
+                                                                                "Column": {
+                                                                                    "Id": 110
                                                                                 },
-                                                                                "Constant": {
-                                                                                    "Bytes": "google"
+                                                                                "Function": {
+                                                                                    "Id": 2
                                                                                 }
-                                                                            }
-                                                                        },
-                                                                        {
-                                                                            "Assign": {
+                                                                            },
+                                                                            {
                                                                                 "Column": {
-                                                                                    "Id": 109
+                                                                                    "Id": 111
                                                                                 },
                                                                                 "Function": {
                                                                                     "Arguments": [
                                                                                         {
                                                                                             "Id": 14
-                                                                                        },
-                                                                                        {
-                                                                                            "Id": 108
                                                                                         }
                                                                                     ],
-                                                                                    "FunctionType": 2,
-                                                                                    "KernelIdx": 1,
-                                                                                    "YqlOperationId": 10
-                                                                                }
-                                                                            }
-                                                                        },
-                                                                        {
-                                                                            "Filter": {
-                                                                                "Predicate": {
-                                                                                    "Id": 109
+                                                                                    "Id": 3
                                                                                 }
                                                                             }
-                                                                        },
-                                                                        {
-                                                                            "Projection": {
-                                                                                "Columns": [
-                                                                                    {
-                                                                                        "Id": 40
-                                                                                    },
-                                                                                    {
-                                                                                        "Id": 14
-                                                                                    }
-                                                                                ]
+                                                                        ],
+                                                                        "KeyColumns": [
+                                                                            {
+                                                                                "Id": 40
                                                                             }
-                                                                        }
-                                                                    ],
-                                                                    "Version": 4
+                                                                        ]
+                                                                    }
                                                                 },
-                                                                "Table": "clickbench/plans/column/hits"
-                                                            }
-                                                        ],
-                                                        "PlanNodeId": 7
+                                                                {
+                                                                    "Projection": {
+                                                                        "Columns": [
+                                                                            {
+                                                                                "Id": 40
+                                                                            },
+                                                                            {
+                                                                                "Id": 110
+                                                                            },
+                                                                            {
+                                                                                "Id": 111
+                                                                            }
+                                                                        ]
+                                                                    }
+                                                                }
+                                                            ],
+                                                            "Version": 4
+                                                        },
+                                                        "Table": "clickbench/plans/column/hits"
                                                     }
-                                                ]
+                                                ],
+                                                "PlanNodeId": 6
                                             }
                                         ]
                                     }
diff --git a/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-30 b/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-30
index 9bbc50a61991..cef01bba0a22 100644
--- a/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-30
+++ b/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-30
@@ -60,18 +60,8 @@
                                                         "PlanNodeType": "Connection",
                                                         "Plans": [
                                                             {
-                                                                "Node Type": "Aggregate-TableFullScan",
+                                                                "Node Type": "TableFullScan",
                                                                 "Operators": [
-                                                                    {
-                                                                        "Aggregation": "{_yql_agg_1: SUM(state._yql_agg_1,1),_yql_agg_2: SUM(item.IsRefresh,state._yql_agg_2)}",
-                                                                        "GroupBy": "",
-                                                                        "Inputs": [
-                                                                            {
-                                                                                "InternalOperatorId": 1
-                                                                            }
-                                                                        ],
-                                                                        "Name": "Aggregate"
-                                                                    },
                                                                     {
                                                                         "Inputs": [],
                                                                         "Name": "TableFullScan",
@@ -129,6 +119,67 @@
                                                                                         }
                                                                                     }
                                                                                 },
+                                                                                {
+                                                                                    "GroupBy": {
+                                                                                        "Aggregates": [
+                                                                                            {
+                                                                                                "Column": {
+                                                                                                    "Id": 108
+                                                                                                },
+                                                                                                "Function": {
+                                                                                                    "Arguments": [
+                                                                                                        {
+                                                                                                            "Id": 21
+                                                                                                        }
+                                                                                                    ],
+                                                                                                    "Id": 5
+                                                                                                }
+                                                                                            },
+                                                                                            {
+                                                                                                "Column": {
+                                                                                                    "Id": 109
+                                                                                                },
+                                                                                                "Function": {
+                                                                                                    "Arguments": [
+                                                                                                        {
+                                                                                                            "Id": 21
+                                                                                                        }
+                                                                                                    ],
+                                                                                                    "Id": 2
+                                                                                                }
+                                                                                            },
+                                                                                            {
+                                                                                                "Column": {
+                                                                                                    "Id": 110
+                                                                                                },
+                                                                                                "Function": {
+                                                                                                    "Id": 2
+                                                                                                }
+                                                                                            },
+                                                                                            {
+                                                                                                "Column": {
+                                                                                                    "Id": 111
+                                                                                                },
+                                                                                                "Function": {
+                                                                                                    "Arguments": [
+                                                                                                        {
+                                                                                                            "Id": 16
+                                                                                                        }
+                                                                                                    ],
+                                                                                                    "Id": 5
+                                                                                                }
+                                                                                            }
+                                                                                        ],
+                                                                                        "KeyColumns": [
+                                                                                            {
+                                                                                                "Id": 8
+                                                                                            },
+                                                                                            {
+                                                                                                "Id": 39
+                                                                                            }
+                                                                                        ]
+                                                                                    }
+                                                                                },
                                                                                 {
                                                                                     "Projection": {
                                                                                         "Columns": [
@@ -136,13 +187,19 @@
                                                                                                 "Id": 8
                                                                                             },
                                                                                             {
-                                                                                                "Id": 16
+                                                                                                "Id": 39
                                                                                             },
                                                                                             {
-                                                                                                "Id": 21
+                                                                                                "Id": 109
                                                                                             },
                                                                                             {
-                                                                                                "Id": 39
+                                                                                                "Id": 108
+                                                                                            },
+                                                                                            {
+                                                                                                "Id": 110
+                                                                                            },
+                                                                                            {
+                                                                                                "Id": 111
                                                                                             }
                                                                                         ]
                                                                                     }
@@ -205,102 +262,156 @@
                                         "PlanNodeId": 4,
                                         "Plans": [
                                             {
-                                                "Node Type": "Aggregate",
+                                                "Node Type": "TableFullScan",
                                                 "Operators": [
                                                     {
-                                                        "Aggregation": "{_yql_agg_1: SUM(state._yql_agg_1,1),_yql_agg_2: SUM(item.IsRefresh,state._yql_agg_2)}",
-                                                        "GroupBy": "",
-                                                        "Name": "Aggregate"
-                                                    }
-                                                ],
-                                                "PlanNodeId": 6,
-                                                "Plans": [
-                                                    {
-                                                        "Node Type": "TableFullScan",
-                                                        "Operators": [
-                                                            {
-                                                                "Name": "TableFullScan",
-                                                                "ReadColumns": [
-                                                                    "ClientIP",
-                                                                    "IsRefresh",
-                                                                    "ResolutionWidth",
-                                                                    "SearchEngineID",
-                                                                    "SearchPhrase"
-                                                                ],
-                                                                "ReadRanges": [
-                                                                    "CounterID (-\u221e, +\u221e)",
-                                                                    "EventDate (-\u221e, +\u221e)",
-                                                                    "UserID (-\u221e, +\u221e)",
-                                                                    "EventTime (-\u221e, +\u221e)",
-                                                                    "WatchID (-\u221e, +\u221e)"
-                                                                ],
-                                                                "Scan": "Parallel",
-                                                                "SsaProgram": {
-                                                                    "Command": [
-                                                                        {
-                                                                            "Assign": {
-                                                                                "Column": {
-                                                                                    "Id": 106
+                                                        "Name": "TableFullScan",
+                                                        "ReadColumns": [
+                                                            "ClientIP",
+                                                            "IsRefresh",
+                                                            "ResolutionWidth",
+                                                            "SearchEngineID",
+                                                            "SearchPhrase"
+                                                        ],
+                                                        "ReadRanges": [
+                                                            "CounterID (-\u221e, +\u221e)",
+                                                            "EventDate (-\u221e, +\u221e)",
+                                                            "UserID (-\u221e, +\u221e)",
+                                                            "EventTime (-\u221e, +\u221e)",
+                                                            "WatchID (-\u221e, +\u221e)"
+                                                        ],
+                                                        "Scan": "Parallel",
+                                                        "SsaProgram": {
+                                                            "Command": [
+                                                                {
+                                                                    "Assign": {
+                                                                        "Column": {
+                                                                            "Id": 106
+                                                                        },
+                                                                        "Constant": {
+                                                                            "Bytes": ""
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "Assign": {
+                                                                        "Column": {
+                                                                            "Id": 107
+                                                                        },
+                                                                        "Function": {
+                                                                            "Arguments": [
+                                                                                {
+                                                                                    "Id": 40
                                                                                 },
-                                                                                "Constant": {
-                                                                                    "Bytes": ""
+                                                                                {
+                                                                                    "Id": 106
                                                                                 }
-                                                                            }
-                                                                        },
-                                                                        {
-                                                                            "Assign": {
+                                                                            ],
+                                                                            "FunctionType": 2,
+                                                                            "KernelIdx": 0,
+                                                                            "YqlOperationId": 12
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "Filter": {
+                                                                        "Predicate": {
+                                                                            "Id": 107
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "GroupBy": {
+                                                                        "Aggregates": [
+                                                                            {
                                                                                 "Column": {
-                                                                                    "Id": 107
+                                                                                    "Id": 108
                                                                                 },
                                                                                 "Function": {
                                                                                     "Arguments": [
                                                                                         {
-                                                                                            "Id": 40
-                                                                                        },
+                                                                                            "Id": 21
+                                                                                        }
+                                                                                    ],
+                                                                                    "Id": 5
+                                                                                }
+                                                                            },
+                                                                            {
+                                                                                "Column": {
+                                                                                    "Id": 109
+                                                                                },
+                                                                                "Function": {
+                                                                                    "Arguments": [
                                                                                         {
-                                                                                            "Id": 106
+                                                                                            "Id": 21
                                                                                         }
                                                                                     ],
-                                                                                    "FunctionType": 2,
-                                                                                    "KernelIdx": 0,
-                                                                                    "YqlOperationId": 12
+                                                                                    "Id": 2
                                                                                 }
-                                                                            }
-                                                                        },
-                                                                        {
-                                                                            "Filter": {
-                                                                                "Predicate": {
-                                                                                    "Id": 107
+                                                                            },
+                                                                            {
+                                                                                "Column": {
+                                                                                    "Id": 110
+                                                                                },
+                                                                                "Function": {
+                                                                                    "Id": 2
+                                                                                }
+                                                                            },
+                                                                            {
+                                                                                "Column": {
+                                                                                    "Id": 111
+                                                                                },
+                                                                                "Function": {
+                                                                                    "Arguments": [
+                                                                                        {
+                                                                                            "Id": 16
+                                                                                        }
+                                                                                    ],
+                                                                                    "Id": 5
                                                                                 }
                                                                             }
-                                                                        },
-                                                                        {
-                                                                            "Projection": {
-                                                                                "Columns": [
-                                                                                    {
-                                                                                        "Id": 8
-                                                                                    },
-                                                                                    {
-                                                                                        "Id": 16
-                                                                                    },
-                                                                                    {
-                                                                                        "Id": 21
-                                                                                    },
-                                                                                    {
-                                                                                        "Id": 39
-                                                                                    }
-                                                                                ]
+                                                                        ],
+                                                                        "KeyColumns": [
+                                                                            {
+                                                                                "Id": 8
+                                                                            },
+                                                                            {
+                                                                                "Id": 39
                                                                             }
-                                                                        }
-                                                                    ],
-                                                                    "Version": 4
+                                                                        ]
+                                                                    }
                                                                 },
-                                                                "Table": "clickbench/plans/column/hits"
-                                                            }
-                                                        ],
-                                                        "PlanNodeId": 7
+                                                                {
+                                                                    "Projection": {
+                                                                        "Columns": [
+                                                                            {
+                                                                                "Id": 8
+                                                                            },
+                                                                            {
+                                                                                "Id": 39
+                                                                            },
+                                                                            {
+                                                                                "Id": 109
+                                                                            },
+                                                                            {
+                                                                                "Id": 108
+                                                                            },
+                                                                            {
+                                                                                "Id": 110
+                                                                            },
+                                                                            {
+                                                                                "Id": 111
+                                                                            }
+                                                                        ]
+                                                                    }
+                                                                }
+                                                            ],
+                                                            "Version": 4
+                                                        },
+                                                        "Table": "clickbench/plans/column/hits"
                                                     }
-                                                ]
+                                                ],
+                                                "PlanNodeId": 6
                                             }
                                         ]
                                     }
diff --git a/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-31 b/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-31
index 40b8bbae3b1d..2dc49b273bcf 100644
--- a/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-31
+++ b/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-31
@@ -60,18 +60,8 @@
                                                         "PlanNodeType": "Connection",
                                                         "Plans": [
                                                             {
-                                                                "Node Type": "Aggregate-TableFullScan",
+                                                                "Node Type": "TableFullScan",
                                                                 "Operators": [
-                                                                    {
-                                                                        "Aggregation": "{_yql_agg_1: SUM(state._yql_agg_1,1),_yql_agg_2: SUM(item.IsRefresh,state._yql_agg_2)}",
-                                                                        "GroupBy": "",
-                                                                        "Inputs": [
-                                                                            {
-                                                                                "InternalOperatorId": 1
-                                                                            }
-                                                                        ],
-                                                                        "Name": "Aggregate"
-                                                                    },
                                                                     {
                                                                         "Inputs": [],
                                                                         "Name": "TableFullScan",
@@ -129,6 +119,67 @@
                                                                                         }
                                                                                     }
                                                                                 },
+                                                                                {
+                                                                                    "GroupBy": {
+                                                                                        "Aggregates": [
+                                                                                            {
+                                                                                                "Column": {
+                                                                                                    "Id": 108
+                                                                                                },
+                                                                                                "Function": {
+                                                                                                    "Arguments": [
+                                                                                                        {
+                                                                                                            "Id": 21
+                                                                                                        }
+                                                                                                    ],
+                                                                                                    "Id": 5
+                                                                                                }
+                                                                                            },
+                                                                                            {
+                                                                                                "Column": {
+                                                                                                    "Id": 109
+                                                                                                },
+                                                                                                "Function": {
+                                                                                                    "Arguments": [
+                                                                                                        {
+                                                                                                            "Id": 21
+                                                                                                        }
+                                                                                                    ],
+                                                                                                    "Id": 2
+                                                                                                }
+                                                                                            },
+                                                                                            {
+                                                                                                "Column": {
+                                                                                                    "Id": 110
+                                                                                                },
+                                                                                                "Function": {
+                                                                                                    "Id": 2
+                                                                                                }
+                                                                                            },
+                                                                                            {
+                                                                                                "Column": {
+                                                                                                    "Id": 111
+                                                                                                },
+                                                                                                "Function": {
+                                                                                                    "Arguments": [
+                                                                                                        {
+                                                                                                            "Id": 16
+                                                                                                        }
+                                                                                                    ],
+                                                                                                    "Id": 5
+                                                                                                }
+                                                                                            }
+                                                                                        ],
+                                                                                        "KeyColumns": [
+                                                                                            {
+                                                                                                "Id": 8
+                                                                                            },
+                                                                                            {
+                                                                                                "Id": 1
+                                                                                            }
+                                                                                        ]
+                                                                                    }
+                                                                                },
                                                                                 {
                                                                                     "Projection": {
                                                                                         "Columns": [
@@ -136,13 +187,19 @@
                                                                                                 "Id": 8
                                                                                             },
                                                                                             {
-                                                                                                "Id": 16
+                                                                                                "Id": 1
                                                                                             },
                                                                                             {
-                                                                                                "Id": 21
+                                                                                                "Id": 109
                                                                                             },
                                                                                             {
-                                                                                                "Id": 1
+                                                                                                "Id": 108
+                                                                                            },
+                                                                                            {
+                                                                                                "Id": 110
+                                                                                            },
+                                                                                            {
+                                                                                                "Id": 111
                                                                                             }
                                                                                         ]
                                                                                     }
@@ -205,102 +262,156 @@
                                         "PlanNodeId": 4,
                                         "Plans": [
                                             {
-                                                "Node Type": "Aggregate",
+                                                "Node Type": "TableFullScan",
                                                 "Operators": [
                                                     {
-                                                        "Aggregation": "{_yql_agg_1: SUM(state._yql_agg_1,1),_yql_agg_2: SUM(item.IsRefresh,state._yql_agg_2)}",
-                                                        "GroupBy": "",
-                                                        "Name": "Aggregate"
-                                                    }
-                                                ],
-                                                "PlanNodeId": 6,
-                                                "Plans": [
-                                                    {
-                                                        "Node Type": "TableFullScan",
-                                                        "Operators": [
-                                                            {
-                                                                "Name": "TableFullScan",
-                                                                "ReadColumns": [
-                                                                    "ClientIP",
-                                                                    "IsRefresh",
-                                                                    "ResolutionWidth",
-                                                                    "SearchPhrase",
-                                                                    "WatchID"
-                                                                ],
-                                                                "ReadRanges": [
-                                                                    "CounterID (-\u221e, +\u221e)",
-                                                                    "EventDate (-\u221e, +\u221e)",
-                                                                    "UserID (-\u221e, +\u221e)",
-                                                                    "EventTime (-\u221e, +\u221e)",
-                                                                    "WatchID (-\u221e, +\u221e)"
-                                                                ],
-                                                                "Scan": "Parallel",
-                                                                "SsaProgram": {
-                                                                    "Command": [
-                                                                        {
-                                                                            "Assign": {
-                                                                                "Column": {
-                                                                                    "Id": 106
+                                                        "Name": "TableFullScan",
+                                                        "ReadColumns": [
+                                                            "ClientIP",
+                                                            "IsRefresh",
+                                                            "ResolutionWidth",
+                                                            "SearchPhrase",
+                                                            "WatchID"
+                                                        ],
+                                                        "ReadRanges": [
+                                                            "CounterID (-\u221e, +\u221e)",
+                                                            "EventDate (-\u221e, +\u221e)",
+                                                            "UserID (-\u221e, +\u221e)",
+                                                            "EventTime (-\u221e, +\u221e)",
+                                                            "WatchID (-\u221e, +\u221e)"
+                                                        ],
+                                                        "Scan": "Parallel",
+                                                        "SsaProgram": {
+                                                            "Command": [
+                                                                {
+                                                                    "Assign": {
+                                                                        "Column": {
+                                                                            "Id": 106
+                                                                        },
+                                                                        "Constant": {
+                                                                            "Bytes": ""
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "Assign": {
+                                                                        "Column": {
+                                                                            "Id": 107
+                                                                        },
+                                                                        "Function": {
+                                                                            "Arguments": [
+                                                                                {
+                                                                                    "Id": 40
                                                                                 },
-                                                                                "Constant": {
-                                                                                    "Bytes": ""
+                                                                                {
+                                                                                    "Id": 106
                                                                                 }
-                                                                            }
-                                                                        },
-                                                                        {
-                                                                            "Assign": {
+                                                                            ],
+                                                                            "FunctionType": 2,
+                                                                            "KernelIdx": 0,
+                                                                            "YqlOperationId": 12
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "Filter": {
+                                                                        "Predicate": {
+                                                                            "Id": 107
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "GroupBy": {
+                                                                        "Aggregates": [
+                                                                            {
                                                                                 "Column": {
-                                                                                    "Id": 107
+                                                                                    "Id": 108
                                                                                 },
                                                                                 "Function": {
                                                                                     "Arguments": [
                                                                                         {
-                                                                                            "Id": 40
-                                                                                        },
+                                                                                            "Id": 21
+                                                                                        }
+                                                                                    ],
+                                                                                    "Id": 5
+                                                                                }
+                                                                            },
+                                                                            {
+                                                                                "Column": {
+                                                                                    "Id": 109
+                                                                                },
+                                                                                "Function": {
+                                                                                    "Arguments": [
                                                                                         {
-                                                                                            "Id": 106
+                                                                                            "Id": 21
                                                                                         }
                                                                                     ],
-                                                                                    "FunctionType": 2,
-                                                                                    "KernelIdx": 0,
-                                                                                    "YqlOperationId": 12
+                                                                                    "Id": 2
                                                                                 }
-                                                                            }
-                                                                        },
-                                                                        {
-                                                                            "Filter": {
-                                                                                "Predicate": {
-                                                                                    "Id": 107
+                                                                            },
+                                                                            {
+                                                                                "Column": {
+                                                                                    "Id": 110
+                                                                                },
+                                                                                "Function": {
+                                                                                    "Id": 2
+                                                                                }
+                                                                            },
+                                                                            {
+                                                                                "Column": {
+                                                                                    "Id": 111
+                                                                                },
+                                                                                "Function": {
+                                                                                    "Arguments": [
+                                                                                        {
+                                                                                            "Id": 16
+                                                                                        }
+                                                                                    ],
+                                                                                    "Id": 5
                                                                                 }
                                                                             }
-                                                                        },
-                                                                        {
-                                                                            "Projection": {
-                                                                                "Columns": [
-                                                                                    {
-                                                                                        "Id": 8
-                                                                                    },
-                                                                                    {
-                                                                                        "Id": 16
-                                                                                    },
-                                                                                    {
-                                                                                        "Id": 21
-                                                                                    },
-                                                                                    {
-                                                                                        "Id": 1
-                                                                                    }
-                                                                                ]
+                                                                        ],
+                                                                        "KeyColumns": [
+                                                                            {
+                                                                                "Id": 8
+                                                                            },
+                                                                            {
+                                                                                "Id": 1
                                                                             }
-                                                                        }
-                                                                    ],
-                                                                    "Version": 4
+                                                                        ]
+                                                                    }
                                                                 },
-                                                                "Table": "clickbench/plans/column/hits"
-                                                            }
-                                                        ],
-                                                        "PlanNodeId": 7
+                                                                {
+                                                                    "Projection": {
+                                                                        "Columns": [
+                                                                            {
+                                                                                "Id": 8
+                                                                            },
+                                                                            {
+                                                                                "Id": 1
+                                                                            },
+                                                                            {
+                                                                                "Id": 109
+                                                                            },
+                                                                            {
+                                                                                "Id": 108
+                                                                            },
+                                                                            {
+                                                                                "Id": 110
+                                                                            },
+                                                                            {
+                                                                                "Id": 111
+                                                                            }
+                                                                        ]
+                                                                    }
+                                                                }
+                                                            ],
+                                                            "Version": 4
+                                                        },
+                                                        "Table": "clickbench/plans/column/hits"
                                                     }
-                                                ]
+                                                ],
+                                                "PlanNodeId": 6
                                             }
                                         ]
                                     }
diff --git a/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-32 b/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-32
index cdb74eef88cd..419e6c218a52 100644
--- a/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-32
+++ b/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-32
@@ -60,18 +60,8 @@
                                                         "PlanNodeType": "Connection",
                                                         "Plans": [
                                                             {
-                                                                "Node Type": "Aggregate-TableFullScan",
+                                                                "Node Type": "TableFullScan",
                                                                 "Operators": [
-                                                                    {
-                                                                        "Aggregation": "{_yql_agg_1: SUM(state._yql_agg_1,1),_yql_agg_2: SUM(item.IsRefresh,state._yql_agg_2)}",
-                                                                        "GroupBy": "",
-                                                                        "Inputs": [
-                                                                            {
-                                                                                "InternalOperatorId": 1
-                                                                            }
-                                                                        ],
-                                                                        "Name": "Aggregate"
-                                                                    },
                                                                     {
                                                                         "Inputs": [],
                                                                         "Name": "TableFullScan",
@@ -91,6 +81,67 @@
                                                                         "Scan": "Parallel",
                                                                         "SsaProgram": {
                                                                             "Command": [
+                                                                                {
+                                                                                    "GroupBy": {
+                                                                                        "Aggregates": [
+                                                                                            {
+                                                                                                "Column": {
+                                                                                                    "Id": 106
+                                                                                                },
+                                                                                                "Function": {
+                                                                                                    "Arguments": [
+                                                                                                        {
+                                                                                                            "Id": 21
+                                                                                                        }
+                                                                                                    ],
+                                                                                                    "Id": 5
+                                                                                                }
+                                                                                            },
+                                                                                            {
+                                                                                                "Column": {
+                                                                                                    "Id": 107
+                                                                                                },
+                                                                                                "Function": {
+                                                                                                    "Arguments": [
+                                                                                                        {
+                                                                                                            "Id": 21
+                                                                                                        }
+                                                                                                    ],
+                                                                                                    "Id": 2
+                                                                                                }
+                                                                                            },
+                                                                                            {
+                                                                                                "Column": {
+                                                                                                    "Id": 108
+                                                                                                },
+                                                                                                "Function": {
+                                                                                                    "Id": 2
+                                                                                                }
+                                                                                            },
+                                                                                            {
+                                                                                                "Column": {
+                                                                                                    "Id": 109
+                                                                                                },
+                                                                                                "Function": {
+                                                                                                    "Arguments": [
+                                                                                                        {
+                                                                                                            "Id": 16
+                                                                                                        }
+                                                                                                    ],
+                                                                                                    "Id": 5
+                                                                                                }
+                                                                                            }
+                                                                                        ],
+                                                                                        "KeyColumns": [
+                                                                                            {
+                                                                                                "Id": 8
+                                                                                            },
+                                                                                            {
+                                                                                                "Id": 1
+                                                                                            }
+                                                                                        ]
+                                                                                    }
+                                                                                },
                                                                                 {
                                                                                     "Projection": {
                                                                                         "Columns": [
@@ -98,13 +149,19 @@
                                                                                                 "Id": 8
                                                                                             },
                                                                                             {
-                                                                                                "Id": 16
+                                                                                                "Id": 1
                                                                                             },
                                                                                             {
-                                                                                                "Id": 21
+                                                                                                "Id": 107
                                                                                             },
                                                                                             {
-                                                                                                "Id": 1
+                                                                                                "Id": 106
+                                                                                            },
+                                                                                            {
+                                                                                                "Id": 108
+                                                                                            },
+                                                                                            {
+                                                                                                "Id": 109
                                                                                             }
                                                                                         ]
                                                                                     }
@@ -167,64 +224,118 @@
                                         "PlanNodeId": 4,
                                         "Plans": [
                                             {
-                                                "Node Type": "Aggregate",
+                                                "Node Type": "TableFullScan",
                                                 "Operators": [
                                                     {
-                                                        "Aggregation": "{_yql_agg_1: SUM(state._yql_agg_1,1),_yql_agg_2: SUM(item.IsRefresh,state._yql_agg_2)}",
-                                                        "GroupBy": "",
-                                                        "Name": "Aggregate"
-                                                    }
-                                                ],
-                                                "PlanNodeId": 6,
-                                                "Plans": [
-                                                    {
-                                                        "Node Type": "TableFullScan",
-                                                        "Operators": [
-                                                            {
-                                                                "Name": "TableFullScan",
-                                                                "ReadColumns": [
-                                                                    "ClientIP",
-                                                                    "IsRefresh",
-                                                                    "ResolutionWidth",
-                                                                    "WatchID"
-                                                                ],
-                                                                "ReadRanges": [
-                                                                    "CounterID (-\u221e, +\u221e)",
-                                                                    "EventDate (-\u221e, +\u221e)",
-                                                                    "UserID (-\u221e, +\u221e)",
-                                                                    "EventTime (-\u221e, +\u221e)",
-                                                                    "WatchID (-\u221e, +\u221e)"
-                                                                ],
-                                                                "Scan": "Parallel",
-                                                                "SsaProgram": {
-                                                                    "Command": [
-                                                                        {
-                                                                            "Projection": {
-                                                                                "Columns": [
-                                                                                    {
-                                                                                        "Id": 8
-                                                                                    },
-                                                                                    {
-                                                                                        "Id": 16
-                                                                                    },
-                                                                                    {
-                                                                                        "Id": 21
-                                                                                    },
-                                                                                    {
-                                                                                        "Id": 1
-                                                                                    }
-                                                                                ]
+                                                        "Name": "TableFullScan",
+                                                        "ReadColumns": [
+                                                            "ClientIP",
+                                                            "IsRefresh",
+                                                            "ResolutionWidth",
+                                                            "WatchID"
+                                                        ],
+                                                        "ReadRanges": [
+                                                            "CounterID (-\u221e, +\u221e)",
+                                                            "EventDate (-\u221e, +\u221e)",
+                                                            "UserID (-\u221e, +\u221e)",
+                                                            "EventTime (-\u221e, +\u221e)",
+                                                            "WatchID (-\u221e, +\u221e)"
+                                                        ],
+                                                        "Scan": "Parallel",
+                                                        "SsaProgram": {
+                                                            "Command": [
+                                                                {
+                                                                    "GroupBy": {
+                                                                        "Aggregates": [
+                                                                            {
+                                                                                "Column": {
+                                                                                    "Id": 106
+                                                                                },
+                                                                                "Function": {
+                                                                                    "Arguments": [
+                                                                                        {
+                                                                                            "Id": 21
+                                                                                        }
+                                                                                    ],
+                                                                                    "Id": 5
+                                                                                }
+                                                                            },
+                                                                            {
+                                                                                "Column": {
+                                                                                    "Id": 107
+                                                                                },
+                                                                                "Function": {
+                                                                                    "Arguments": [
+                                                                                        {
+                                                                                            "Id": 21
+                                                                                        }
+                                                                                    ],
+                                                                                    "Id": 2
+                                                                                }
+                                                                            },
+                                                                            {
+                                                                                "Column": {
+                                                                                    "Id": 108
+                                                                                },
+                                                                                "Function": {
+                                                                                    "Id": 2
+                                                                                }
+                                                                            },
+                                                                            {
+                                                                                "Column": {
+                                                                                    "Id": 109
+                                                                                },
+                                                                                "Function": {
+                                                                                    "Arguments": [
+                                                                                        {
+                                                                                            "Id": 16
+                                                                                        }
+                                                                                    ],
+                                                                                    "Id": 5
+                                                                                }
+                                                                            }
+                                                                        ],
+                                                                        "KeyColumns": [
+                                                                            {
+                                                                                "Id": 8
+                                                                            },
+                                                                            {
+                                                                                "Id": 1
                                                                             }
-                                                                        }
-                                                                    ],
-                                                                    "Version": 4
+                                                                        ]
+                                                                    }
                                                                 },
-                                                                "Table": "clickbench/plans/column/hits"
-                                                            }
-                                                        ],
-                                                        "PlanNodeId": 7
+                                                                {
+                                                                    "Projection": {
+                                                                        "Columns": [
+                                                                            {
+                                                                                "Id": 8
+                                                                            },
+                                                                            {
+                                                                                "Id": 1
+                                                                            },
+                                                                            {
+                                                                                "Id": 107
+                                                                            },
+                                                                            {
+                                                                                "Id": 106
+                                                                            },
+                                                                            {
+                                                                                "Id": 108
+                                                                            },
+                                                                            {
+                                                                                "Id": 109
+                                                                            }
+                                                                        ]
+                                                                    }
+                                                                }
+                                                            ],
+                                                            "Version": 4
+                                                        },
+                                                        "Table": "clickbench/plans/column/hits"
                                                     }
-                                                ]
+                                                ],
+                                                "PlanNodeId": 6
                                             }
                                         ]
                                     }
diff --git a/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-33 b/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-33
index b97bfa06e46c..3da7ae9fd6f2 100644
--- a/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-33
+++ b/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-33
@@ -59,18 +59,8 @@
                                                         "PlanNodeType": "Connection",
                                                         "Plans": [
                                                             {
-                                                                "Node Type": "Aggregate-TableFullScan",
+                                                                "Node Type": "TableFullScan",
                                                                 "Operators": [
-                                                                    {
-                                                                        "Aggregation": "{_yql_agg_0: SUM(state._yql_agg_0,1)}",
-                                                                        "GroupBy": "item.URL",
-                                                                        "Inputs": [
-                                                                            {
-                                                                                "InternalOperatorId": 1
-                                                                            }
-                                                                        ],
-                                                                        "Name": "Aggregate"
-                                                                    },
                                                                     {
                                                                         "Inputs": [],
                                                                         "Name": "TableFullScan",
@@ -87,11 +77,33 @@
                                                                         "Scan": "Parallel",
                                                                         "SsaProgram": {
                                                                             "Command": [
+                                                                                {
+                                                                                    "GroupBy": {
+                                                                                        "Aggregates": [
+                                                                                            {
+                                                                                                "Column": {
+                                                                                                    "Id": 106
+                                                                                                },
+                                                                                                "Function": {
+                                                                                                    "Id": 2
+                                                                                                }
+                                                                                            }
+                                                                                        ],
+                                                                                        "KeyColumns": [
+                                                                                            {
+                                                                                                "Id": 14
+                                                                                            }
+                                                                                        ]
+                                                                                    }
+                                                                                },
                                                                                 {
                                                                                     "Projection": {
                                                                                         "Columns": [
                                                                                             {
                                                                                                 "Id": 14
+                                                                                            },
+                                                                                            {
+                                                                                                "Id": 106
                                                                                             }
                                                                                         ]
                                                                                     }
@@ -154,52 +166,61 @@
                                         "PlanNodeId": 4,
                                         "Plans": [
                                             {
-                                                "Node Type": "Aggregate",
+                                                "Node Type": "TableFullScan",
                                                 "Operators": [
                                                     {
-                                                        "Aggregation": "{_yql_agg_0: SUM(state._yql_agg_0,1)}",
-                                                        "GroupBy": "item.URL",
-                                                        "Name": "Aggregate"
-                                                    }
-                                                ],
-                                                "PlanNodeId": 6,
-                                                "Plans": [
-                                                    {
-                                                        "Node Type": "TableFullScan",
-                                                        "Operators": [
-                                                            {
-                                                                "Name": "TableFullScan",
-                                                                "ReadColumns": [
-                                                                    "URL"
-                                                                ],
-                                                                "ReadRanges": [
-                                                                    "CounterID (-\u221e, +\u221e)",
-                                                                    "EventDate (-\u221e, +\u221e)",
-                                                                    "UserID (-\u221e, +\u221e)",
-                                                                    "EventTime (-\u221e, +\u221e)",
-                                                                    "WatchID (-\u221e, +\u221e)"
-                                                                ],
-                                                                "Scan": "Parallel",
-                                                                "SsaProgram": {
-                                                                    "Command": [
-                                                                        {
-                                                                            "Projection": {
-                                                                                "Columns": [
-                                                                                    {
-                                                                                        "Id": 14
-                                                                                    }
-                                                                                ]
+                                                        "Name": "TableFullScan",
+                                                        "ReadColumns": [
+                                                            "URL"
+                                                        ],
+                                                        "ReadRanges": [
+                                                            "CounterID (-\u221e, +\u221e)",
+                                                            "EventDate (-\u221e, +\u221e)",
+                                                            "UserID (-\u221e, +\u221e)",
+                                                            "EventTime (-\u221e, +\u221e)",
+                                                            "WatchID (-\u221e, +\u221e)"
+                                                        ],
+                                                        "Scan": "Parallel",
+                                                        "SsaProgram": {
+                                                            "Command": [
+                                                                {
+                                                                    "GroupBy": {
+                                                                        "Aggregates": [
+                                                                            {
+                                                                                "Column": {
+                                                                                    "Id": 106
+                                                                                },
+                                                                                "Function": {
+                                                                                    "Id": 2
+                                                                                }
+                                                                            }
+                                                                        ],
+                                                                        "KeyColumns": [
+                                                                            {
+                                                                                "Id": 14
                                                                             }
-                                                                        }
-                                                                    ],
-                                                                    "Version": 4
+                                                                        ]
+                                                                    }
                                                                 },
-                                                                "Table": "clickbench/plans/column/hits"
-                                                            }
-                                                        ],
-                                                        "PlanNodeId": 7
+                                                                {
+                                                                    "Projection": {
+                                                                        "Columns": [
+                                                                            {
+                                                                                "Id": 14
+                                                                            },
+                                                                            {
+                                                                                "Id": 106
+                                                                            }
+                                                                        ]
+                                                                    }
+                                                                }
+                                                            ],
+                                                            "Version": 4
+                                                        },
+                                                        "Table": "clickbench/plans/column/hits"
                                                     }
-                                                ]
+                                                ],
+                                                "PlanNodeId": 6
                                             }
                                         ]
                                     }
diff --git a/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-34 b/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-34
index 589267a2ea09..b6764303856f 100644
--- a/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-34
+++ b/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-34
@@ -60,18 +60,8 @@
                                                         "PlanNodeType": "Connection",
                                                         "Plans": [
                                                             {
-                                                                "Node Type": "Aggregate-TableFullScan",
+                                                                "Node Type": "TableFullScan",
                                                                 "Operators": [
-                                                                    {
-                                                                        "Aggregation": "{_yql_agg_0: SUM(state._yql_agg_0,1)}",
-                                                                        "GroupBy": "",
-                                                                        "Inputs": [
-                                                                            {
-                                                                                "InternalOperatorId": 1
-                                                                            }
-                                                                        ],
-                                                                        "Name": "Aggregate"
-                                                                    },
                                                                     {
                                                                         "Inputs": [],
                                                                         "Name": "TableFullScan",
@@ -89,6 +79,28 @@
                                                                         "Scan": "Parallel",
                                                                         "SsaProgram": {
                                                                             "Command": [
+                                                                                {
+                                                                                    "GroupBy": {
+                                                                                        "Aggregates": [
+                                                                                            {
+                                                                                                "Column": {
+                                                                                                    "Id": 106
+                                                                                                },
+                                                                                                "Function": {
+                                                                                                    "Id": 2
+                                                                                                }
+                                                                                            }
+                                                                                        ],
+                                                                                        "KeyColumns": [
+                                                                                            {
+                                                                                                "Id": 14
+                                                                                            },
+                                                                                            {
+                                                                                                "Id": 10
+                                                                                            }
+                                                                                        ]
+                                                                                    }
+                                                                                },
                                                                                 {
                                                                                     "Projection": {
                                                                                         "Columns": [
@@ -97,6 +109,9 @@
                                                                                             },
                                                                                             {
                                                                                                 "Id": 10
+                                                                                            },
+                                                                                            {
+                                                                                                "Id": 106
                                                                                             }
                                                                                         ]
                                                                                     }
@@ -159,56 +174,68 @@
                                         "PlanNodeId": 4,
                                         "Plans": [
                                             {
-                                                "Node Type": "Aggregate",
+                                                "Node Type": "TableFullScan",
                                                 "Operators": [
                                                     {
-                                                        "Aggregation": "{_yql_agg_0: SUM(state._yql_agg_0,1)}",
-                                                        "GroupBy": "",
-                                                        "Name": "Aggregate"
-                                                    }
-                                                ],
-                                                "PlanNodeId": 6,
-                                                "Plans": [
-                                                    {
-                                                        "Node Type": "TableFullScan",
-                                                        "Operators": [
-                                                            {
-                                                                "Name": "TableFullScan",
-                                                                "ReadColumns": [
-                                                                    "URL",
-                                                                    "UserID"
-                                                                ],
-                                                                "ReadRanges": [
-                                                                    "CounterID (-\u221e, +\u221e)",
-                                                                    "EventDate (-\u221e, +\u221e)",
-                                                                    "UserID (-\u221e, +\u221e)",
-                                                                    "EventTime (-\u221e, +\u221e)",
-                                                                    "WatchID (-\u221e, +\u221e)"
-                                                                ],
-                                                                "Scan": "Parallel",
-                                                                "SsaProgram": {
-                                                                    "Command": [
-                                                                        {
-                                                                            "Projection": {
-                                                                                "Columns": [
-                                                                                    {
-                                                                                        "Id": 14
-                                                                                    },
-                                                                                    {
-                                                                                        "Id": 10
-                                                                                    }
-                                                                                ]
+                                                        "Name": "TableFullScan",
+                                                        "ReadColumns": [
+                                                            "URL",
+                                                            "UserID"
+                                                        ],
+                                                        "ReadRanges": [
+                                                            "CounterID (-\u221e, +\u221e)",
+                                                            "EventDate (-\u221e, +\u221e)",
+                                                            "UserID (-\u221e, +\u221e)",
+                                                            "EventTime (-\u221e, +\u221e)",
+                                                            "WatchID (-\u221e, +\u221e)"
+                                                        ],
+                                                        "Scan": "Parallel",
+                                                        "SsaProgram": {
+                                                            "Command": [
+                                                                {
+                                                                    "GroupBy": {
+                                                                        "Aggregates": [
+                                                                            {
+                                                                                "Column": {
+                                                                                    "Id": 106
+                                                                                },
+                                                                                "Function": {
+                                                                                    "Id": 2
+                                                                                }
+                                                                            }
+                                                                        ],
+                                                                        "KeyColumns": [
+                                                                            {
+                                                                                "Id": 14
+                                                                            },
+                                                                            {
+                                                                                "Id": 10
                                                                             }
-                                                                        }
-                                                                    ],
-                                                                    "Version": 4
+                                                                        ]
+                                                                    }
                                                                 },
-                                                                "Table": "clickbench/plans/column/hits"
-                                                            }
-                                                        ],
-                                                        "PlanNodeId": 7
+                                                                {
+                                                                    "Projection": {
+                                                                        "Columns": [
+                                                                            {
+                                                                                "Id": 14
+                                                                            },
+                                                                            {
+                                                                                "Id": 10
+                                                                            },
+                                                                            {
+                                                                                "Id": 106
+                                                                            }
+                                                                        ]
+                                                                    }
+                                                                }
+                                                            ],
+                                                            "Version": 4
+                                                        },
+                                                        "Table": "clickbench/plans/column/hits"
                                                     }
-                                                ]
+                                                ],
+                                                "PlanNodeId": 6
                                             }
                                         ]
                                     }
diff --git a/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-36 b/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-36
index 796d4e89a5ac..8ff3b5426a03 100644
--- a/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-36
+++ b/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-36
@@ -59,18 +59,8 @@
                                                         "PlanNodeType": "Connection",
                                                         "Plans": [
                                                             {
-                                                                "Node Type": "Aggregate-TableRangeScan",
+                                                                "Node Type": "TableRangeScan",
                                                                 "Operators": [
-                                                                    {
-                                                                        "Aggregation": "{_yql_agg_0: SUM(state._yql_agg_0,1)}",
-                                                                        "GroupBy": "item.URL",
-                                                                        "Inputs": [
-                                                                            {
-                                                                                "InternalOperatorId": 1
-                                                                            }
-                                                                        ],
-                                                                        "Name": "Aggregate"
-                                                                    },
                                                                     {
                                                                         "Inputs": [],
                                                                         "Name": "TableRangeScan",
@@ -228,11 +218,33 @@
                                                                                         }
                                                                                     }
                                                                                 },
+                                                                                {
+                                                                                    "GroupBy": {
+                                                                                        "Aggregates": [
+                                                                                            {
+                                                                                                "Column": {
+                                                                                                    "Id": 114
+                                                                                                },
+                                                                                                "Function": {
+                                                                                                    "Id": 2
+                                                                                                }
+                                                                                            }
+                                                                                        ],
+                                                                                        "KeyColumns": [
+                                                                                            {
+                                                                                                "Id": 14
+                                                                                            }
+                                                                                        ]
+                                                                                    }
+                                                                                },
                                                                                 {
                                                                                     "Projection": {
                                                                                         "Columns": [
                                                                                             {
                                                                                                 "Id": 14
+                                                                                            },
+                                                                                            {
+                                                                                                "Id": 114
                                                                                             }
                                                                                         ]
                                                                                     }
@@ -295,193 +307,202 @@
                                         "PlanNodeId": 4,
                                         "Plans": [
                                             {
-                                                "Node Type": "Aggregate",
+                                                "Node Type": "TableRangeScan",
                                                 "Operators": [
                                                     {
-                                                        "Aggregation": "{_yql_agg_0: SUM(state._yql_agg_0,1)}",
-                                                        "GroupBy": "item.URL",
-                                                        "Name": "Aggregate"
-                                                    }
-                                                ],
-                                                "PlanNodeId": 6,
-                                                "Plans": [
-                                                    {
-                                                        "Node Type": "TableRangeScan",
-                                                        "Operators": [
-                                                            {
-                                                                "Name": "TableRangeScan",
-                                                                "ReadColumns": [
-                                                                    "DontCountHits",
-                                                                    "IsRefresh",
-                                                                    "URL"
-                                                                ],
-                                                                "ReadRanges": [
-                                                                    "CounterID [62, 62]",
-                                                                    "EventDate [15887, 15917]"
-                                                                ],
-                                                                "ReadRangesExpectedSize": 1,
-                                                                "ReadRangesKeys": [
-                                                                    "CounterID",
-                                                                    "EventDate"
-                                                                ],
-                                                                "Scan": "Parallel",
-                                                                "SsaProgram": {
-                                                                    "Command": [
-                                                                        {
-                                                                            "Assign": {
-                                                                                "Column": {
-                                                                                    "Id": 106
-                                                                                },
-                                                                                "Constant": {
-                                                                                    "Int32": 0
-                                                                                }
-                                                                            }
+                                                        "Name": "TableRangeScan",
+                                                        "ReadColumns": [
+                                                            "DontCountHits",
+                                                            "IsRefresh",
+                                                            "URL"
+                                                        ],
+                                                        "ReadRanges": [
+                                                            "CounterID [62, 62]",
+                                                            "EventDate [15887, 15917]"
+                                                        ],
+                                                        "ReadRangesExpectedSize": 1,
+                                                        "ReadRangesKeys": [
+                                                            "CounterID",
+                                                            "EventDate"
+                                                        ],
+                                                        "Scan": "Parallel",
+                                                        "SsaProgram": {
+                                                            "Command": [
+                                                                {
+                                                                    "Assign": {
+                                                                        "Column": {
+                                                                            "Id": 106
                                                                         },
-                                                                        {
-                                                                            "Assign": {
-                                                                                "Column": {
-                                                                                    "Id": 107
-                                                                                },
-                                                                                "Function": {
-                                                                                    "Arguments": [
-                                                                                        {
-                                                                                            "Id": 62
-                                                                                        },
-                                                                                        {
-                                                                                            "Id": 106
-                                                                                        }
-                                                                                    ],
-                                                                                    "FunctionType": 2,
-                                                                                    "KernelIdx": 0,
-                                                                                    "YqlOperationId": 11
-                                                                                }
-                                                                            }
+                                                                        "Constant": {
+                                                                            "Int32": 0
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "Assign": {
+                                                                        "Column": {
+                                                                            "Id": 107
                                                                         },
-                                                                        {
-                                                                            "Assign": {
-                                                                                "Column": {
-                                                                                    "Id": 108
+                                                                        "Function": {
+                                                                            "Arguments": [
+                                                                                {
+                                                                                    "Id": 62
                                                                                 },
-                                                                                "Constant": {
-                                                                                    "Int32": 0
+                                                                                {
+                                                                                    "Id": 106
                                                                                 }
-                                                                            }
+                                                                            ],
+                                                                            "FunctionType": 2,
+                                                                            "KernelIdx": 0,
+                                                                            "YqlOperationId": 11
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "Assign": {
+                                                                        "Column": {
+                                                                            "Id": 108
                                                                         },
-                                                                        {
-                                                                            "Assign": {
-                                                                                "Column": {
-                                                                                    "Id": 109
+                                                                        "Constant": {
+                                                                            "Int32": 0
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "Assign": {
+                                                                        "Column": {
+                                                                            "Id": 109
+                                                                        },
+                                                                        "Function": {
+                                                                            "Arguments": [
+                                                                                {
+                                                                                    "Id": 16
                                                                                 },
-                                                                                "Function": {
-                                                                                    "Arguments": [
-                                                                                        {
-                                                                                            "Id": 16
-                                                                                        },
-                                                                                        {
-                                                                                            "Id": 108
-                                                                                        }
-                                                                                    ],
-                                                                                    "FunctionType": 2,
-                                                                                    "KernelIdx": 1,
-                                                                                    "YqlOperationId": 11
+                                                                                {
+                                                                                    "Id": 108
                                                                                 }
-                                                                            }
+                                                                            ],
+                                                                            "FunctionType": 2,
+                                                                            "KernelIdx": 1,
+                                                                            "YqlOperationId": 11
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "Assign": {
+                                                                        "Column": {
+                                                                            "Id": 110
                                                                         },
-                                                                        {
-                                                                            "Assign": {
-                                                                                "Column": {
-                                                                                    "Id": 110
+                                                                        "Constant": {
+                                                                            "Bytes": ""
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "Assign": {
+                                                                        "Column": {
+                                                                            "Id": 111
+                                                                        },
+                                                                        "Function": {
+                                                                            "Arguments": [
+                                                                                {
+                                                                                    "Id": 14
                                                                                 },
-                                                                                "Constant": {
-                                                                                    "Bytes": ""
+                                                                                {
+                                                                                    "Id": 110
                                                                                 }
-                                                                            }
+                                                                            ],
+                                                                            "FunctionType": 2,
+                                                                            "KernelIdx": 2,
+                                                                            "YqlOperationId": 12
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "Assign": {
+                                                                        "Column": {
+                                                                            "Id": 112
                                                                         },
-                                                                        {
-                                                                            "Assign": {
-                                                                                "Column": {
-                                                                                    "Id": 111
+                                                                        "Function": {
+                                                                            "Arguments": [
+                                                                                {
+                                                                                    "Id": 109
                                                                                 },
-                                                                                "Function": {
-                                                                                    "Arguments": [
-                                                                                        {
-                                                                                            "Id": 14
-                                                                                        },
-                                                                                        {
-                                                                                            "Id": 110
-                                                                                        }
-                                                                                    ],
-                                                                                    "FunctionType": 2,
-                                                                                    "KernelIdx": 2,
-                                                                                    "YqlOperationId": 12
+                                                                                {
+                                                                                    "Id": 111
                                                                                 }
-                                                                            }
+                                                                            ],
+                                                                            "FunctionType": 2,
+                                                                            "KernelIdx": 3,
+                                                                            "YqlOperationId": 0
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "Assign": {
+                                                                        "Column": {
+                                                                            "Id": 113
                                                                         },
-                                                                        {
-                                                                            "Assign": {
-                                                                                "Column": {
-                                                                                    "Id": 112
+                                                                        "Function": {
+                                                                            "Arguments": [
+                                                                                {
+                                                                                    "Id": 107
                                                                                 },
-                                                                                "Function": {
-                                                                                    "Arguments": [
-                                                                                        {
-                                                                                            "Id": 109
-                                                                                        },
-                                                                                        {
-                                                                                            "Id": 111
-                                                                                        }
-                                                                                    ],
-                                                                                    "FunctionType": 2,
-                                                                                    "KernelIdx": 3,
-                                                                                    "YqlOperationId": 0
+                                                                                {
+                                                                                    "Id": 112
                                                                                 }
-                                                                            }
-                                                                        },
-                                                                        {
-                                                                            "Assign": {
+                                                                            ],
+                                                                            "FunctionType": 2,
+                                                                            "KernelIdx": 4,
+                                                                            "YqlOperationId": 0
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "Filter": {
+                                                                        "Predicate": {
+                                                                            "Id": 113
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "GroupBy": {
+                                                                        "Aggregates": [
+                                                                            {
                                                                                 "Column": {
-                                                                                    "Id": 113
+                                                                                    "Id": 114
                                                                                 },
                                                                                 "Function": {
-                                                                                    "Arguments": [
-                                                                                        {
-                                                                                            "Id": 107
-                                                                                        },
-                                                                                        {
-                                                                                            "Id": 112
-                                                                                        }
-                                                                                    ],
-                                                                                    "FunctionType": 2,
-                                                                                    "KernelIdx": 4,
-                                                                                    "YqlOperationId": 0
+                                                                                    "Id": 2
                                                                                 }
                                                                             }
-                                                                        },
-                                                                        {
-                                                                            "Filter": {
-                                                                                "Predicate": {
-                                                                                    "Id": 113
-                                                                                }
-                                                                            }
-                                                                        },
-                                                                        {
-                                                                            "Projection": {
-                                                                                "Columns": [
-                                                                                    {
-                                                                                        "Id": 14
-                                                                                    }
-                                                                                ]
+                                                                        ],
+                                                                        "KeyColumns": [
+                                                                            {
+                                                                                "Id": 14
                                                                             }
-                                                                        }
-                                                                    ],
-                                                                    "Version": 4
+                                                                        ]
+                                                                    }
                                                                 },
-                                                                "Table": "clickbench/plans/column/hits"
-                                                            }
-                                                        ],
-                                                        "PlanNodeId": 7
+                                                                {
+                                                                    "Projection": {
+                                                                        "Columns": [
+                                                                            {
+                                                                                "Id": 14
+                                                                            },
+                                                                            {
+                                                                                "Id": 114
+                                                                            }
+                                                                        ]
+                                                                    }
+                                                                }
+                                                            ],
+                                                            "Version": 4
+                                                        },
+                                                        "Table": "clickbench/plans/column/hits"
                                                     }
-                                                ]
+                                                ],
+                                                "PlanNodeId": 6
                                             }
                                         ]
                                     }
diff --git a/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-37 b/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-37
index 54add1a7092f..ed07bb8d72fb 100644
--- a/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-37
+++ b/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-37
@@ -59,18 +59,8 @@
                                                         "PlanNodeType": "Connection",
                                                         "Plans": [
                                                             {
-                                                                "Node Type": "Aggregate-TableRangeScan",
+                                                                "Node Type": "TableRangeScan",
                                                                 "Operators": [
-                                                                    {
-                                                                        "Aggregation": "{_yql_agg_0: SUM(state._yql_agg_0,1)}",
-                                                                        "GroupBy": "item.Title",
-                                                                        "Inputs": [
-                                                                            {
-                                                                                "InternalOperatorId": 1
-                                                                            }
-                                                                        ],
-                                                                        "Name": "Aggregate"
-                                                                    },
                                                                     {
                                                                         "Inputs": [],
                                                                         "Name": "TableRangeScan",
@@ -228,11 +218,33 @@
                                                                                         }
                                                                                     }
                                                                                 },
+                                                                                {
+                                                                                    "GroupBy": {
+                                                                                        "Aggregates": [
+                                                                                            {
+                                                                                                "Column": {
+                                                                                                    "Id": 114
+                                                                                                },
+                                                                                                "Function": {
+                                                                                                    "Id": 2
+                                                                                                }
+                                                                                            }
+                                                                                        ],
+                                                                                        "KeyColumns": [
+                                                                                            {
+                                                                                                "Id": 3
+                                                                                            }
+                                                                                        ]
+                                                                                    }
+                                                                                },
                                                                                 {
                                                                                     "Projection": {
                                                                                         "Columns": [
                                                                                             {
                                                                                                 "Id": 3
+                                                                                            },
+                                                                                            {
+                                                                                                "Id": 114
                                                                                             }
                                                                                         ]
                                                                                     }
@@ -295,193 +307,202 @@
                                         "PlanNodeId": 4,
                                         "Plans": [
                                             {
-                                                "Node Type": "Aggregate",
+                                                "Node Type": "TableRangeScan",
                                                 "Operators": [
                                                     {
-                                                        "Aggregation": "{_yql_agg_0: SUM(state._yql_agg_0,1)}",
-                                                        "GroupBy": "item.Title",
-                                                        "Name": "Aggregate"
-                                                    }
-                                                ],
-                                                "PlanNodeId": 6,
-                                                "Plans": [
-                                                    {
-                                                        "Node Type": "TableRangeScan",
-                                                        "Operators": [
-                                                            {
-                                                                "Name": "TableRangeScan",
-                                                                "ReadColumns": [
-                                                                    "DontCountHits",
-                                                                    "IsRefresh",
-                                                                    "Title"
-                                                                ],
-                                                                "ReadRanges": [
-                                                                    "CounterID [62, 62]",
-                                                                    "EventDate [15887, 15917]"
-                                                                ],
-                                                                "ReadRangesExpectedSize": 1,
-                                                                "ReadRangesKeys": [
-                                                                    "CounterID",
-                                                                    "EventDate"
-                                                                ],
-                                                                "Scan": "Parallel",
-                                                                "SsaProgram": {
-                                                                    "Command": [
-                                                                        {
-                                                                            "Assign": {
-                                                                                "Column": {
-                                                                                    "Id": 106
-                                                                                },
-                                                                                "Constant": {
-                                                                                    "Int32": 0
-                                                                                }
-                                                                            }
+                                                        "Name": "TableRangeScan",
+                                                        "ReadColumns": [
+                                                            "DontCountHits",
+                                                            "IsRefresh",
+                                                            "Title"
+                                                        ],
+                                                        "ReadRanges": [
+                                                            "CounterID [62, 62]",
+                                                            "EventDate [15887, 15917]"
+                                                        ],
+                                                        "ReadRangesExpectedSize": 1,
+                                                        "ReadRangesKeys": [
+                                                            "CounterID",
+                                                            "EventDate"
+                                                        ],
+                                                        "Scan": "Parallel",
+                                                        "SsaProgram": {
+                                                            "Command": [
+                                                                {
+                                                                    "Assign": {
+                                                                        "Column": {
+                                                                            "Id": 106
                                                                         },
-                                                                        {
-                                                                            "Assign": {
-                                                                                "Column": {
-                                                                                    "Id": 107
-                                                                                },
-                                                                                "Function": {
-                                                                                    "Arguments": [
-                                                                                        {
-                                                                                            "Id": 62
-                                                                                        },
-                                                                                        {
-                                                                                            "Id": 106
-                                                                                        }
-                                                                                    ],
-                                                                                    "FunctionType": 2,
-                                                                                    "KernelIdx": 0,
-                                                                                    "YqlOperationId": 11
-                                                                                }
-                                                                            }
+                                                                        "Constant": {
+                                                                            "Int32": 0
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "Assign": {
+                                                                        "Column": {
+                                                                            "Id": 107
                                                                         },
-                                                                        {
-                                                                            "Assign": {
-                                                                                "Column": {
-                                                                                    "Id": 108
+                                                                        "Function": {
+                                                                            "Arguments": [
+                                                                                {
+                                                                                    "Id": 62
                                                                                 },
-                                                                                "Constant": {
-                                                                                    "Int32": 0
+                                                                                {
+                                                                                    "Id": 106
                                                                                 }
-                                                                            }
+                                                                            ],
+                                                                            "FunctionType": 2,
+                                                                            "KernelIdx": 0,
+                                                                            "YqlOperationId": 11
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "Assign": {
+                                                                        "Column": {
+                                                                            "Id": 108
                                                                         },
-                                                                        {
-                                                                            "Assign": {
-                                                                                "Column": {
-                                                                                    "Id": 109
+                                                                        "Constant": {
+                                                                            "Int32": 0
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "Assign": {
+                                                                        "Column": {
+                                                                            "Id": 109
+                                                                        },
+                                                                        "Function": {
+                                                                            "Arguments": [
+                                                                                {
+                                                                                    "Id": 16
                                                                                 },
-                                                                                "Function": {
-                                                                                    "Arguments": [
-                                                                                        {
-                                                                                            "Id": 16
-                                                                                        },
-                                                                                        {
-                                                                                            "Id": 108
-                                                                                        }
-                                                                                    ],
-                                                                                    "FunctionType": 2,
-                                                                                    "KernelIdx": 1,
-                                                                                    "YqlOperationId": 11
+                                                                                {
+                                                                                    "Id": 108
                                                                                 }
-                                                                            }
+                                                                            ],
+                                                                            "FunctionType": 2,
+                                                                            "KernelIdx": 1,
+                                                                            "YqlOperationId": 11
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "Assign": {
+                                                                        "Column": {
+                                                                            "Id": 110
                                                                         },
-                                                                        {
-                                                                            "Assign": {
-                                                                                "Column": {
-                                                                                    "Id": 110
+                                                                        "Constant": {
+                                                                            "Bytes": ""
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "Assign": {
+                                                                        "Column": {
+                                                                            "Id": 111
+                                                                        },
+                                                                        "Function": {
+                                                                            "Arguments": [
+                                                                                {
+                                                                                    "Id": 3
                                                                                 },
-                                                                                "Constant": {
-                                                                                    "Bytes": ""
+                                                                                {
+                                                                                    "Id": 110
                                                                                 }
-                                                                            }
+                                                                            ],
+                                                                            "FunctionType": 2,
+                                                                            "KernelIdx": 2,
+                                                                            "YqlOperationId": 12
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "Assign": {
+                                                                        "Column": {
+                                                                            "Id": 112
                                                                         },
-                                                                        {
-                                                                            "Assign": {
-                                                                                "Column": {
-                                                                                    "Id": 111
+                                                                        "Function": {
+                                                                            "Arguments": [
+                                                                                {
+                                                                                    "Id": 109
                                                                                 },
-                                                                                "Function": {
-                                                                                    "Arguments": [
-                                                                                        {
-                                                                                            "Id": 3
-                                                                                        },
-                                                                                        {
-                                                                                            "Id": 110
-                                                                                        }
-                                                                                    ],
-                                                                                    "FunctionType": 2,
-                                                                                    "KernelIdx": 2,
-                                                                                    "YqlOperationId": 12
+                                                                                {
+                                                                                    "Id": 111
                                                                                 }
-                                                                            }
+                                                                            ],
+                                                                            "FunctionType": 2,
+                                                                            "KernelIdx": 3,
+                                                                            "YqlOperationId": 0
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "Assign": {
+                                                                        "Column": {
+                                                                            "Id": 113
                                                                         },
-                                                                        {
-                                                                            "Assign": {
-                                                                                "Column": {
-                                                                                    "Id": 112
+                                                                        "Function": {
+                                                                            "Arguments": [
+                                                                                {
+                                                                                    "Id": 107
                                                                                 },
-                                                                                "Function": {
-                                                                                    "Arguments": [
-                                                                                        {
-                                                                                            "Id": 109
-                                                                                        },
-                                                                                        {
-                                                                                            "Id": 111
-                                                                                        }
-                                                                                    ],
-                                                                                    "FunctionType": 2,
-                                                                                    "KernelIdx": 3,
-                                                                                    "YqlOperationId": 0
+                                                                                {
+                                                                                    "Id": 112
                                                                                 }
-                                                                            }
-                                                                        },
-                                                                        {
-                                                                            "Assign": {
+                                                                            ],
+                                                                            "FunctionType": 2,
+                                                                            "KernelIdx": 4,
+                                                                            "YqlOperationId": 0
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "Filter": {
+                                                                        "Predicate": {
+                                                                            "Id": 113
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "GroupBy": {
+                                                                        "Aggregates": [
+                                                                            {
                                                                                 "Column": {
-                                                                                    "Id": 113
+                                                                                    "Id": 114
                                                                                 },
                                                                                 "Function": {
-                                                                                    "Arguments": [
-                                                                                        {
-                                                                                            "Id": 107
-                                                                                        },
-                                                                                        {
-                                                                                            "Id": 112
-                                                                                        }
-                                                                                    ],
-                                                                                    "FunctionType": 2,
-                                                                                    "KernelIdx": 4,
-                                                                                    "YqlOperationId": 0
+                                                                                    "Id": 2
                                                                                 }
                                                                             }
-                                                                        },
-                                                                        {
-                                                                            "Filter": {
-                                                                                "Predicate": {
-                                                                                    "Id": 113
-                                                                                }
-                                                                            }
-                                                                        },
-                                                                        {
-                                                                            "Projection": {
-                                                                                "Columns": [
-                                                                                    {
-                                                                                        "Id": 3
-                                                                                    }
-                                                                                ]
+                                                                        ],
+                                                                        "KeyColumns": [
+                                                                            {
+                                                                                "Id": 3
                                                                             }
-                                                                        }
-                                                                    ],
-                                                                    "Version": 4
+                                                                        ]
+                                                                    }
                                                                 },
-                                                                "Table": "clickbench/plans/column/hits"
-                                                            }
-                                                        ],
-                                                        "PlanNodeId": 7
+                                                                {
+                                                                    "Projection": {
+                                                                        "Columns": [
+                                                                            {
+                                                                                "Id": 3
+                                                                            },
+                                                                            {
+                                                                                "Id": 114
+                                                                            }
+                                                                        ]
+                                                                    }
+                                                                }
+                                                            ],
+                                                            "Version": 4
+                                                        },
+                                                        "Table": "clickbench/plans/column/hits"
                                                     }
-                                                ]
+                                                ],
+                                                "PlanNodeId": 6
                                             }
                                         ]
                                     }
diff --git a/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-38 b/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-38
index 7bb266311b0d..e3d91c1cb23c 100644
--- a/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-38
+++ b/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-38
@@ -88,18 +88,8 @@
                                                                         "PlanNodeType": "Connection",
                                                                         "Plans": [
                                                                             {
-                                                                                "Node Type": "Aggregate-TableRangeScan",
+                                                                                "Node Type": "TableRangeScan",
                                                                                 "Operators": [
-                                                                                    {
-                                                                                        "Aggregation": "{_yql_agg_0: SUM(state._yql_agg_0,1)}",
-                                                                                        "GroupBy": "item.URL",
-                                                                                        "Inputs": [
-                                                                                            {
-                                                                                                "InternalOperatorId": 1
-                                                                                            }
-                                                                                        ],
-                                                                                        "Name": "Aggregate"
-                                                                                    },
                                                                                     {
                                                                                         "Inputs": [],
                                                                                         "Name": "TableRangeScan",
@@ -258,11 +248,33 @@
                                                                                                         }
                                                                                                     }
                                                                                                 },
+                                                                                                {
+                                                                                                    "GroupBy": {
+                                                                                                        "Aggregates": [
+                                                                                                            {
+                                                                                                                "Column": {
+                                                                                                                    "Id": 114
+                                                                                                                },
+                                                                                                                "Function": {
+                                                                                                                    "Id": 2
+                                                                                                                }
+                                                                                                            }
+                                                                                                        ],
+                                                                                                        "KeyColumns": [
+                                                                                                            {
+                                                                                                                "Id": 14
+                                                                                                            }
+                                                                                                        ]
+                                                                                                    }
+                                                                                                },
                                                                                                 {
                                                                                                     "Projection": {
                                                                                                         "Columns": [
                                                                                                             {
                                                                                                                 "Id": 14
+                                                                                                            },
+                                                                                                            {
+                                                                                                                "Id": 114
                                                                                                             }
                                                                                                         ]
                                                                                                     }
@@ -349,194 +361,203 @@
                                                         "PlanNodeId": 7,
                                                         "Plans": [
                                                             {
-                                                                "Node Type": "Aggregate",
+                                                                "Node Type": "TableRangeScan",
                                                                 "Operators": [
                                                                     {
-                                                                        "Aggregation": "{_yql_agg_0: SUM(state._yql_agg_0,1)}",
-                                                                        "GroupBy": "item.URL",
-                                                                        "Name": "Aggregate"
-                                                                    }
-                                                                ],
-                                                                "PlanNodeId": 9,
-                                                                "Plans": [
-                                                                    {
-                                                                        "Node Type": "TableRangeScan",
-                                                                        "Operators": [
-                                                                            {
-                                                                                "Name": "TableRangeScan",
-                                                                                "ReadColumns": [
-                                                                                    "IsDownload",
-                                                                                    "IsLink",
-                                                                                    "IsRefresh",
-                                                                                    "URL"
-                                                                                ],
-                                                                                "ReadRanges": [
-                                                                                    "CounterID [62, 62]",
-                                                                                    "EventDate [15887, 15917]"
-                                                                                ],
-                                                                                "ReadRangesExpectedSize": 1,
-                                                                                "ReadRangesKeys": [
-                                                                                    "CounterID",
-                                                                                    "EventDate"
-                                                                                ],
-                                                                                "Scan": "Parallel",
-                                                                                "SsaProgram": {
-                                                                                    "Command": [
-                                                                                        {
-                                                                                            "Assign": {
-                                                                                                "Column": {
-                                                                                                    "Id": 106
-                                                                                                },
-                                                                                                "Constant": {
-                                                                                                    "Int32": 0
-                                                                                                }
-                                                                                            }
+                                                                        "Name": "TableRangeScan",
+                                                                        "ReadColumns": [
+                                                                            "IsDownload",
+                                                                            "IsLink",
+                                                                            "IsRefresh",
+                                                                            "URL"
+                                                                        ],
+                                                                        "ReadRanges": [
+                                                                            "CounterID [62, 62]",
+                                                                            "EventDate [15887, 15917]"
+                                                                        ],
+                                                                        "ReadRangesExpectedSize": 1,
+                                                                        "ReadRangesKeys": [
+                                                                            "CounterID",
+                                                                            "EventDate"
+                                                                        ],
+                                                                        "Scan": "Parallel",
+                                                                        "SsaProgram": {
+                                                                            "Command": [
+                                                                                {
+                                                                                    "Assign": {
+                                                                                        "Column": {
+                                                                                            "Id": 106
                                                                                         },
-                                                                                        {
-                                                                                            "Assign": {
-                                                                                                "Column": {
-                                                                                                    "Id": 107
-                                                                                                },
-                                                                                                "Function": {
-                                                                                                    "Arguments": [
-                                                                                                        {
-                                                                                                            "Id": 16
-                                                                                                        },
-                                                                                                        {
-                                                                                                            "Id": 106
-                                                                                                        }
-                                                                                                    ],
-                                                                                                    "FunctionType": 2,
-                                                                                                    "KernelIdx": 0,
-                                                                                                    "YqlOperationId": 11
-                                                                                                }
-                                                                                            }
+                                                                                        "Constant": {
+                                                                                            "Int32": 0
+                                                                                        }
+                                                                                    }
+                                                                                },
+                                                                                {
+                                                                                    "Assign": {
+                                                                                        "Column": {
+                                                                                            "Id": 107
                                                                                         },
-                                                                                        {
-                                                                                            "Assign": {
-                                                                                                "Column": {
-                                                                                                    "Id": 108
+                                                                                        "Function": {
+                                                                                            "Arguments": [
+                                                                                                {
+                                                                                                    "Id": 16
                                                                                                 },
-                                                                                                "Constant": {
-                                                                                                    "Int32": 0
+                                                                                                {
+                                                                                                    "Id": 106
                                                                                                 }
-                                                                                            }
+                                                                                            ],
+                                                                                            "FunctionType": 2,
+                                                                                            "KernelIdx": 0,
+                                                                                            "YqlOperationId": 11
+                                                                                        }
+                                                                                    }
+                                                                                },
+                                                                                {
+                                                                                    "Assign": {
+                                                                                        "Column": {
+                                                                                            "Id": 108
                                                                                         },
-                                                                                        {
-                                                                                            "Assign": {
-                                                                                                "Column": {
-                                                                                                    "Id": 109
+                                                                                        "Constant": {
+                                                                                            "Int32": 0
+                                                                                        }
+                                                                                    }
+                                                                                },
+                                                                                {
+                                                                                    "Assign": {
+                                                                                        "Column": {
+                                                                                            "Id": 109
+                                                                                        },
+                                                                                        "Function": {
+                                                                                            "Arguments": [
+                                                                                                {
+                                                                                                    "Id": 53
                                                                                                 },
-                                                                                                "Function": {
-                                                                                                    "Arguments": [
-                                                                                                        {
-                                                                                                            "Id": 53
-                                                                                                        },
-                                                                                                        {
-                                                                                                            "Id": 108
-                                                                                                        }
-                                                                                                    ],
-                                                                                                    "FunctionType": 2,
-                                                                                                    "KernelIdx": 1,
-                                                                                                    "YqlOperationId": 12
+                                                                                                {
+                                                                                                    "Id": 108
                                                                                                 }
-                                                                                            }
+                                                                                            ],
+                                                                                            "FunctionType": 2,
+                                                                                            "KernelIdx": 1,
+                                                                                            "YqlOperationId": 12
+                                                                                        }
+                                                                                    }
+                                                                                },
+                                                                                {
+                                                                                    "Assign": {
+                                                                                        "Column": {
+                                                                                            "Id": 110
                                                                                         },
-                                                                                        {
-                                                                                            "Assign": {
-                                                                                                "Column": {
-                                                                                                    "Id": 110
+                                                                                        "Constant": {
+                                                                                            "Int32": 0
+                                                                                        }
+                                                                                    }
+                                                                                },
+                                                                                {
+                                                                                    "Assign": {
+                                                                                        "Column": {
+                                                                                            "Id": 111
+                                                                                        },
+                                                                                        "Function": {
+                                                                                            "Arguments": [
+                                                                                                {
+                                                                                                    "Id": 54
                                                                                                 },
-                                                                                                "Constant": {
-                                                                                                    "Int32": 0
+                                                                                                {
+                                                                                                    "Id": 110
                                                                                                 }
-                                                                                            }
+                                                                                            ],
+                                                                                            "FunctionType": 2,
+                                                                                            "KernelIdx": 2,
+                                                                                            "YqlOperationId": 11
+                                                                                        }
+                                                                                    }
+                                                                                },
+                                                                                {
+                                                                                    "Assign": {
+                                                                                        "Column": {
+                                                                                            "Id": 112
                                                                                         },
-                                                                                        {
-                                                                                            "Assign": {
-                                                                                                "Column": {
-                                                                                                    "Id": 111
+                                                                                        "Function": {
+                                                                                            "Arguments": [
+                                                                                                {
+                                                                                                    "Id": 109
                                                                                                 },
-                                                                                                "Function": {
-                                                                                                    "Arguments": [
-                                                                                                        {
-                                                                                                            "Id": 54
-                                                                                                        },
-                                                                                                        {
-                                                                                                            "Id": 110
-                                                                                                        }
-                                                                                                    ],
-                                                                                                    "FunctionType": 2,
-                                                                                                    "KernelIdx": 2,
-                                                                                                    "YqlOperationId": 11
+                                                                                                {
+                                                                                                    "Id": 111
                                                                                                 }
-                                                                                            }
+                                                                                            ],
+                                                                                            "FunctionType": 2,
+                                                                                            "KernelIdx": 3,
+                                                                                            "YqlOperationId": 0
+                                                                                        }
+                                                                                    }
+                                                                                },
+                                                                                {
+                                                                                    "Assign": {
+                                                                                        "Column": {
+                                                                                            "Id": 113
                                                                                         },
-                                                                                        {
-                                                                                            "Assign": {
-                                                                                                "Column": {
-                                                                                                    "Id": 112
+                                                                                        "Function": {
+                                                                                            "Arguments": [
+                                                                                                {
+                                                                                                    "Id": 107
                                                                                                 },
-                                                                                                "Function": {
-                                                                                                    "Arguments": [
-                                                                                                        {
-                                                                                                            "Id": 109
-                                                                                                        },
-                                                                                                        {
-                                                                                                            "Id": 111
-                                                                                                        }
-                                                                                                    ],
-                                                                                                    "FunctionType": 2,
-                                                                                                    "KernelIdx": 3,
-                                                                                                    "YqlOperationId": 0
+                                                                                                {
+                                                                                                    "Id": 112
                                                                                                 }
-                                                                                            }
-                                                                                        },
-                                                                                        {
-                                                                                            "Assign": {
+                                                                                            ],
+                                                                                            "FunctionType": 2,
+                                                                                            "KernelIdx": 4,
+                                                                                            "YqlOperationId": 0
+                                                                                        }
+                                                                                    }
+                                                                                },
+                                                                                {
+                                                                                    "Filter": {
+                                                                                        "Predicate": {
+                                                                                            "Id": 113
+                                                                                        }
+                                                                                    }
+                                                                                },
+                                                                                {
+                                                                                    "GroupBy": {
+                                                                                        "Aggregates": [
+                                                                                            {
                                                                                                 "Column": {
-                                                                                                    "Id": 113
+                                                                                                    "Id": 114
                                                                                                 },
                                                                                                 "Function": {
-                                                                                                    "Arguments": [
-                                                                                                        {
-                                                                                                            "Id": 107
-                                                                                                        },
-                                                                                                        {
-                                                                                                            "Id": 112
-                                                                                                        }
-                                                                                                    ],
-                                                                                                    "FunctionType": 2,
-                                                                                                    "KernelIdx": 4,
-                                                                                                    "YqlOperationId": 0
+                                                                                                    "Id": 2
                                                                                                 }
                                                                                             }
-                                                                                        },
-                                                                                        {
-                                                                                            "Filter": {
-                                                                                                "Predicate": {
-                                                                                                    "Id": 113
-                                                                                                }
-                                                                                            }
-                                                                                        },
-                                                                                        {
-                                                                                            "Projection": {
-                                                                                                "Columns": [
-                                                                                                    {
-                                                                                                        "Id": 14
-                                                                                                    }
-                                                                                                ]
+                                                                                        ],
+                                                                                        "KeyColumns": [
+                                                                                            {
+                                                                                                "Id": 14
                                                                                             }
-                                                                                        }
-                                                                                    ],
-                                                                                    "Version": 4
+                                                                                        ]
+                                                                                    }
                                                                                 },
-                                                                                "Table": "clickbench/plans/column/hits"
-                                                                            }
-                                                                        ],
-                                                                        "PlanNodeId": 10
+                                                                                {
+                                                                                    "Projection": {
+                                                                                        "Columns": [
+                                                                                            {
+                                                                                                "Id": 14
+                                                                                            },
+                                                                                            {
+                                                                                                "Id": 114
+                                                                                            }
+                                                                                        ]
+                                                                                    }
+                                                                                }
+                                                                            ],
+                                                                            "Version": 4
+                                                                        },
+                                                                        "Table": "clickbench/plans/column/hits"
                                                                     }
-                                                                ]
+                                                                ],
+                                                                "PlanNodeId": 9
                                                             }
                                                         ]
                                                     }
diff --git a/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-41 b/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-41
index 4dce9155dc8a..dd89190d205b 100644
--- a/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-41
+++ b/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-41
@@ -89,18 +89,8 @@
                                                                         "PlanNodeType": "Connection",
                                                                         "Plans": [
                                                                             {
-                                                                                "Node Type": "Aggregate-TableRangeScan",
+                                                                                "Node Type": "TableRangeScan",
                                                                                 "Operators": [
-                                                                                    {
-                                                                                        "Aggregation": "{_yql_agg_0: SUM(state._yql_agg_0,1)}",
-                                                                                        "GroupBy": "",
-                                                                                        "Inputs": [
-                                                                                            {
-                                                                                                "InternalOperatorId": 1
-                                                                                            }
-                                                                                        ],
-                                                                                        "Name": "Aggregate"
-                                                                                    },
                                                                                     {
                                                                                         "Inputs": [],
                                                                                         "Name": "TableRangeScan",
@@ -260,6 +250,28 @@
                                                                                                         }
                                                                                                     }
                                                                                                 },
+                                                                                                {
+                                                                                                    "GroupBy": {
+                                                                                                        "Aggregates": [
+                                                                                                            {
+                                                                                                                "Column": {
+                                                                                                                    "Id": 114
+                                                                                                                },
+                                                                                                                "Function": {
+                                                                                                                    "Id": 2
+                                                                                                                }
+                                                                                                            }
+                                                                                                        ],
+                                                                                                        "KeyColumns": [
+                                                                                                            {
+                                                                                                                "Id": 44
+                                                                                                            },
+                                                                                                            {
+                                                                                                                "Id": 43
+                                                                                                            }
+                                                                                                        ]
+                                                                                                    }
+                                                                                                },
                                                                                                 {
                                                                                                     "Projection": {
                                                                                                         "Columns": [
@@ -268,6 +280,9 @@
                                                                                                             },
                                                                                                             {
                                                                                                                 "Id": 43
+                                                                                                            },
+                                                                                                            {
+                                                                                                                "Id": 114
                                                                                                             }
                                                                                                         ]
                                                                                                     }
@@ -354,198 +369,210 @@
                                                         "PlanNodeId": 7,
                                                         "Plans": [
                                                             {
-                                                                "Node Type": "Aggregate",
+                                                                "Node Type": "TableRangeScan",
                                                                 "Operators": [
                                                                     {
-                                                                        "Aggregation": "{_yql_agg_0: SUM(state._yql_agg_0,1)}",
-                                                                        "GroupBy": "",
-                                                                        "Name": "Aggregate"
-                                                                    }
-                                                                ],
-                                                                "PlanNodeId": 9,
-                                                                "Plans": [
-                                                                    {
-                                                                        "Node Type": "TableRangeScan",
-                                                                        "Operators": [
-                                                                            {
-                                                                                "Name": "TableRangeScan",
-                                                                                "ReadColumns": [
-                                                                                    "DontCountHits",
-                                                                                    "IsRefresh",
-                                                                                    "URLHash",
-                                                                                    "WindowClientHeight",
-                                                                                    "WindowClientWidth"
-                                                                                ],
-                                                                                "ReadRanges": [
-                                                                                    "CounterID [62, 62]",
-                                                                                    "EventDate [15887, 15917]"
-                                                                                ],
-                                                                                "ReadRangesExpectedSize": 1,
-                                                                                "ReadRangesKeys": [
-                                                                                    "CounterID",
-                                                                                    "EventDate"
-                                                                                ],
-                                                                                "Scan": "Parallel",
-                                                                                "SsaProgram": {
-                                                                                    "Command": [
-                                                                                        {
-                                                                                            "Assign": {
-                                                                                                "Column": {
-                                                                                                    "Id": 106
-                                                                                                },
-                                                                                                "Constant": {
-                                                                                                    "Int32": 0
-                                                                                                }
-                                                                                            }
+                                                                        "Name": "TableRangeScan",
+                                                                        "ReadColumns": [
+                                                                            "DontCountHits",
+                                                                            "IsRefresh",
+                                                                            "URLHash",
+                                                                            "WindowClientHeight",
+                                                                            "WindowClientWidth"
+                                                                        ],
+                                                                        "ReadRanges": [
+                                                                            "CounterID [62, 62]",
+                                                                            "EventDate [15887, 15917]"
+                                                                        ],
+                                                                        "ReadRangesExpectedSize": 1,
+                                                                        "ReadRangesKeys": [
+                                                                            "CounterID",
+                                                                            "EventDate"
+                                                                        ],
+                                                                        "Scan": "Parallel",
+                                                                        "SsaProgram": {
+                                                                            "Command": [
+                                                                                {
+                                                                                    "Assign": {
+                                                                                        "Column": {
+                                                                                            "Id": 106
                                                                                         },
-                                                                                        {
-                                                                                            "Assign": {
-                                                                                                "Column": {
-                                                                                                    "Id": 107
-                                                                                                },
-                                                                                                "Function": {
-                                                                                                    "Arguments": [
-                                                                                                        {
-                                                                                                            "Id": 16
-                                                                                                        },
-                                                                                                        {
-                                                                                                            "Id": 106
-                                                                                                        }
-                                                                                                    ],
-                                                                                                    "FunctionType": 2,
-                                                                                                    "KernelIdx": 0,
-                                                                                                    "YqlOperationId": 11
-                                                                                                }
-                                                                                            }
+                                                                                        "Constant": {
+                                                                                            "Int32": 0
+                                                                                        }
+                                                                                    }
+                                                                                },
+                                                                                {
+                                                                                    "Assign": {
+                                                                                        "Column": {
+                                                                                            "Id": 107
                                                                                         },
-                                                                                        {
-                                                                                            "Assign": {
-                                                                                                "Column": {
-                                                                                                    "Id": 108
+                                                                                        "Function": {
+                                                                                            "Arguments": [
+                                                                                                {
+                                                                                                    "Id": 16
                                                                                                 },
-                                                                                                "Constant": {
-                                                                                                    "Int32": 0
+                                                                                                {
+                                                                                                    "Id": 106
                                                                                                 }
-                                                                                            }
+                                                                                            ],
+                                                                                            "FunctionType": 2,
+                                                                                            "KernelIdx": 0,
+                                                                                            "YqlOperationId": 11
+                                                                                        }
+                                                                                    }
+                                                                                },
+                                                                                {
+                                                                                    "Assign": {
+                                                                                        "Column": {
+                                                                                            "Id": 108
                                                                                         },
-                                                                                        {
-                                                                                            "Assign": {
-                                                                                                "Column": {
-                                                                                                    "Id": 109
+                                                                                        "Constant": {
+                                                                                            "Int32": 0
+                                                                                        }
+                                                                                    }
+                                                                                },
+                                                                                {
+                                                                                    "Assign": {
+                                                                                        "Column": {
+                                                                                            "Id": 109
+                                                                                        },
+                                                                                        "Function": {
+                                                                                            "Arguments": [
+                                                                                                {
+                                                                                                    "Id": 62
                                                                                                 },
-                                                                                                "Function": {
-                                                                                                    "Arguments": [
-                                                                                                        {
-                                                                                                            "Id": 62
-                                                                                                        },
-                                                                                                        {
-                                                                                                            "Id": 108
-                                                                                                        }
-                                                                                                    ],
-                                                                                                    "FunctionType": 2,
-                                                                                                    "KernelIdx": 1,
-                                                                                                    "YqlOperationId": 11
+                                                                                                {
+                                                                                                    "Id": 108
                                                                                                 }
-                                                                                            }
+                                                                                            ],
+                                                                                            "FunctionType": 2,
+                                                                                            "KernelIdx": 1,
+                                                                                            "YqlOperationId": 11
+                                                                                        }
+                                                                                    }
+                                                                                },
+                                                                                {
+                                                                                    "Assign": {
+                                                                                        "Column": {
+                                                                                            "Id": 110
                                                                                         },
-                                                                                        {
-                                                                                            "Assign": {
-                                                                                                "Column": {
-                                                                                                    "Id": 110
+                                                                                        "Constant": {
+                                                                                            "Int64": 2868770270353813622
+                                                                                        }
+                                                                                    }
+                                                                                },
+                                                                                {
+                                                                                    "Assign": {
+                                                                                        "Column": {
+                                                                                            "Id": 111
+                                                                                        },
+                                                                                        "Function": {
+                                                                                            "Arguments": [
+                                                                                                {
+                                                                                                    "Id": 104
                                                                                                 },
-                                                                                                "Constant": {
-                                                                                                    "Int64": 2868770270353813622
+                                                                                                {
+                                                                                                    "Id": 110
                                                                                                 }
-                                                                                            }
+                                                                                            ],
+                                                                                            "FunctionType": 2,
+                                                                                            "KernelIdx": 2,
+                                                                                            "YqlOperationId": 11
+                                                                                        }
+                                                                                    }
+                                                                                },
+                                                                                {
+                                                                                    "Assign": {
+                                                                                        "Column": {
+                                                                                            "Id": 112
                                                                                         },
-                                                                                        {
-                                                                                            "Assign": {
-                                                                                                "Column": {
-                                                                                                    "Id": 111
+                                                                                        "Function": {
+                                                                                            "Arguments": [
+                                                                                                {
+                                                                                                    "Id": 109
                                                                                                 },
-                                                                                                "Function": {
-                                                                                                    "Arguments": [
-                                                                                                        {
-                                                                                                            "Id": 104
-                                                                                                        },
-                                                                                                        {
-                                                                                                            "Id": 110
-                                                                                                        }
-                                                                                                    ],
-                                                                                                    "FunctionType": 2,
-                                                                                                    "KernelIdx": 2,
-                                                                                                    "YqlOperationId": 11
+                                                                                                {
+                                                                                                    "Id": 111
                                                                                                 }
-                                                                                            }
+                                                                                            ],
+                                                                                            "FunctionType": 2,
+                                                                                            "KernelIdx": 3,
+                                                                                            "YqlOperationId": 0
+                                                                                        }
+                                                                                    }
+                                                                                },
+                                                                                {
+                                                                                    "Assign": {
+                                                                                        "Column": {
+                                                                                            "Id": 113
                                                                                         },
-                                                                                        {
-                                                                                            "Assign": {
-                                                                                                "Column": {
-                                                                                                    "Id": 112
+                                                                                        "Function": {
+                                                                                            "Arguments": [
+                                                                                                {
+                                                                                                    "Id": 107
                                                                                                 },
-                                                                                                "Function": {
-                                                                                                    "Arguments": [
-                                                                                                        {
-                                                                                                            "Id": 109
-                                                                                                        },
-                                                                                                        {
-                                                                                                            "Id": 111
-                                                                                                        }
-                                                                                                    ],
-                                                                                                    "FunctionType": 2,
-                                                                                                    "KernelIdx": 3,
-                                                                                                    "YqlOperationId": 0
+                                                                                                {
+                                                                                                    "Id": 112
                                                                                                 }
-                                                                                            }
-                                                                                        },
-                                                                                        {
-                                                                                            "Assign": {
+                                                                                            ],
+                                                                                            "FunctionType": 2,
+                                                                                            "KernelIdx": 4,
+                                                                                            "YqlOperationId": 0
+                                                                                        }
+                                                                                    }
+                                                                                },
+                                                                                {
+                                                                                    "Filter": {
+                                                                                        "Predicate": {
+                                                                                            "Id": 113
+                                                                                        }
+                                                                                    }
+                                                                                },
+                                                                                {
+                                                                                    "GroupBy": {
+                                                                                        "Aggregates": [
+                                                                                            {
                                                                                                 "Column": {
-                                                                                                    "Id": 113
+                                                                                                    "Id": 114
                                                                                                 },
                                                                                                 "Function": {
-                                                                                                    "Arguments": [
-                                                                                                        {
-                                                                                                            "Id": 107
-                                                                                                        },
-                                                                                                        {
-                                                                                                            "Id": 112
-                                                                                                        }
-                                                                                                    ],
-                                                                                                    "FunctionType": 2,
-                                                                                                    "KernelIdx": 4,
-                                                                                                    "YqlOperationId": 0
+                                                                                                    "Id": 2
                                                                                                 }
                                                                                             }
-                                                                                        },
-                                                                                        {
-                                                                                            "Filter": {
-                                                                                                "Predicate": {
-                                                                                                    "Id": 113
-                                                                                                }
-                                                                                            }
-                                                                                        },
-                                                                                        {
-                                                                                            "Projection": {
-                                                                                                "Columns": [
-                                                                                                    {
-                                                                                                        "Id": 44
-                                                                                                    },
-                                                                                                    {
-                                                                                                        "Id": 43
-                                                                                                    }
-                                                                                                ]
+                                                                                        ],
+                                                                                        "KeyColumns": [
+                                                                                            {
+                                                                                                "Id": 44
+                                                                                            },
+                                                                                            {
+                                                                                                "Id": 43
                                                                                             }
-                                                                                        }
-                                                                                    ],
-                                                                                    "Version": 4
+                                                                                        ]
+                                                                                    }
                                                                                 },
-                                                                                "Table": "clickbench/plans/column/hits"
-                                                                            }
-                                                                        ],
-                                                                        "PlanNodeId": 10
+                                                                                {
+                                                                                    "Projection": {
+                                                                                        "Columns": [
+                                                                                            {
+                                                                                                "Id": 44
+                                                                                            },
+                                                                                            {
+                                                                                                "Id": 43
+                                                                                            },
+                                                                                            {
+                                                                                                "Id": 114
+                                                                                            }
+                                                                                        ]
+                                                                                    }
+                                                                                }
+                                                                            ],
+                                                                            "Version": 4
+                                                                        },
+                                                                        "Table": "clickbench/plans/column/hits"
                                                                     }
-                                                                ]
+                                                                ],
+                                                                "PlanNodeId": 9
                                                             }
                                                         ]
                                                     }
diff --git a/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-7 b/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-7
index c875bd726155..49b95b51d14e 100644
--- a/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-7
+++ b/ydb/tests/functional/clickbench/canondata/test.test_plans_column_/queries-original-plan-column-7
@@ -59,18 +59,8 @@
                                                         "PlanNodeType": "Connection",
                                                         "Plans": [
                                                             {
-                                                                "Node Type": "Aggregate-TableFullScan",
+                                                                "Node Type": "TableFullScan",
                                                                 "Operators": [
-                                                                    {
-                                                                        "Aggregation": "{_yql_agg_0: SUM(state._yql_agg_0,1)}",
-                                                                        "GroupBy": "item.AdvEngineID",
-                                                                        "Inputs": [
-                                                                            {
-                                                                                "InternalOperatorId": 1
-                                                                            }
-                                                                        ],
-                                                                        "Name": "Aggregate"
-                                                                    },
                                                                     {
                                                                         "Inputs": [],
                                                                         "Name": "TableFullScan",
@@ -124,11 +114,33 @@
                                                                                         }
                                                                                     }
                                                                                 },
+                                                                                {
+                                                                                    "GroupBy": {
+                                                                                        "Aggregates": [
+                                                                                            {
+                                                                                                "Column": {
+                                                                                                    "Id": 108
+                                                                                                },
+                                                                                                "Function": {
+                                                                                                    "Id": 2
+                                                                                                }
+                                                                                            }
+                                                                                        ],
+                                                                                        "KeyColumns": [
+                                                                                            {
+                                                                                                "Id": 41
+                                                                                            }
+                                                                                        ]
+                                                                                    }
+                                                                                },
                                                                                 {
                                                                                     "Projection": {
                                                                                         "Columns": [
                                                                                             {
                                                                                                 "Id": 41
+                                                                                            },
+                                                                                            {
+                                                                                                "Id": 108
                                                                                             }
                                                                                         ]
                                                                                     }
@@ -191,89 +203,98 @@
                                         "PlanNodeId": 4,
                                         "Plans": [
                                             {
-                                                "Node Type": "Aggregate",
+                                                "Node Type": "TableFullScan",
                                                 "Operators": [
                                                     {
-                                                        "Aggregation": "{_yql_agg_0: SUM(state._yql_agg_0,1)}",
-                                                        "GroupBy": "item.AdvEngineID",
-                                                        "Name": "Aggregate"
-                                                    }
-                                                ],
-                                                "PlanNodeId": 6,
-                                                "Plans": [
-                                                    {
-                                                        "Node Type": "TableFullScan",
-                                                        "Operators": [
-                                                            {
-                                                                "Name": "TableFullScan",
-                                                                "ReadColumns": [
-                                                                    "AdvEngineID"
-                                                                ],
-                                                                "ReadRanges": [
-                                                                    "CounterID (-\u221e, +\u221e)",
-                                                                    "EventDate (-\u221e, +\u221e)",
-                                                                    "UserID (-\u221e, +\u221e)",
-                                                                    "EventTime (-\u221e, +\u221e)",
-                                                                    "WatchID (-\u221e, +\u221e)"
-                                                                ],
-                                                                "Scan": "Parallel",
-                                                                "SsaProgram": {
-                                                                    "Command": [
-                                                                        {
-                                                                            "Assign": {
-                                                                                "Column": {
-                                                                                    "Id": 106
+                                                        "Name": "TableFullScan",
+                                                        "ReadColumns": [
+                                                            "AdvEngineID"
+                                                        ],
+                                                        "ReadRanges": [
+                                                            "CounterID (-\u221e, +\u221e)",
+                                                            "EventDate (-\u221e, +\u221e)",
+                                                            "UserID (-\u221e, +\u221e)",
+                                                            "EventTime (-\u221e, +\u221e)",
+                                                            "WatchID (-\u221e, +\u221e)"
+                                                        ],
+                                                        "Scan": "Parallel",
+                                                        "SsaProgram": {
+                                                            "Command": [
+                                                                {
+                                                                    "Assign": {
+                                                                        "Column": {
+                                                                            "Id": 106
+                                                                        },
+                                                                        "Constant": {
+                                                                            "Int32": 0
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "Assign": {
+                                                                        "Column": {
+                                                                            "Id": 107
+                                                                        },
+                                                                        "Function": {
+                                                                            "Arguments": [
+                                                                                {
+                                                                                    "Id": 41
                                                                                 },
-                                                                                "Constant": {
-                                                                                    "Int32": 0
+                                                                                {
+                                                                                    "Id": 106
                                                                                 }
-                                                                            }
-                                                                        },
-                                                                        {
-                                                                            "Assign": {
+                                                                            ],
+                                                                            "FunctionType": 2,
+                                                                            "KernelIdx": 0,
+                                                                            "YqlOperationId": 12
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "Filter": {
+                                                                        "Predicate": {
+                                                                            "Id": 107
+                                                                        }
+                                                                    }
+                                                                },
+                                                                {
+                                                                    "GroupBy": {
+                                                                        "Aggregates": [
+                                                                            {
                                                                                 "Column": {
-                                                                                    "Id": 107
+                                                                                    "Id": 108
                                                                                 },
                                                                                 "Function": {
-                                                                                    "Arguments": [
-                                                                                        {
-                                                                                            "Id": 41
-                                                                                        },
-                                                                                        {
-                                                                                            "Id": 106
-                                                                                        }
-                                                                                    ],
-                                                                                    "FunctionType": 2,
-                                                                                    "KernelIdx": 0,
-                                                                                    "YqlOperationId": 12
+                                                                                    "Id": 2
                                                                                 }
                                                                             }
-                                                                        },
-                                                                        {
-                                                                            "Filter": {
-                                                                                "Predicate": {
-                                                                                    "Id": 107
-                                                                                }
-                                                                            }
-                                                                        },
-                                                                        {
-                                                                            "Projection": {
-                                                                                "Columns": [
-                                                                                    {
-                                                                                        "Id": 41
-                                                                                    }
-                                                                                ]
+                                                                        ],
+                                                                        "KeyColumns": [
+                                                                            {
+                                                                                "Id": 41
                                                                             }
-                                                                        }
-                                                                    ],
-                                                                    "Version": 4
+                                                                        ]
+                                                                    }
                                                                 },
-                                                                "Table": "clickbench/plans/column/hits"
-                                                            }
-                                                        ],
-                                                        "PlanNodeId": 7
+                                                                {
+                                                                    "Projection": {
+                                                                        "Columns": [
+                                                                            {
+                                                                                "Id": 41
+                                                                            },
+                                                                            {
+                                                                                "Id": 108
+                                                                            }
+                                                                        ]
+                                                                    }
+                                                                }
+                                                            ],
+                                                            "Version": 4
+                                                        },
+                                                        "Table": "clickbench/plans/column/hits"
                                                     }
-                                                ]
+                                                ],
+                                                "PlanNodeId": 6
                                             }
                                         ]
                                     }
diff --git a/ydb/tests/functional/clickbench/ya.make b/ydb/tests/functional/clickbench/ya.make
index b5a9a9fdc516..1ce9642b70df 100644
--- a/ydb/tests/functional/clickbench/ya.make
+++ b/ydb/tests/functional/clickbench/ya.make
@@ -9,6 +9,7 @@ SIZE(MEDIUM)
 
 ENV(YDB_USE_IN_MEMORY_PDISKS=true)
 ENV(YDB_CLI_BINARY="ydb/apps/ydb/ydb")
+ENV(YDB_ENABLE_COLUMN_TABLES="true")
 REQUIREMENTS(
     ram:32
     cpu:4
diff --git a/ydb/tests/functional/scheme_tests/canondata/tablet_scheme_tests.TestTabletSchemes.test_tablet_schemes_flat_schemeshard_/flat_schemeshard.schema b/ydb/tests/functional/scheme_tests/canondata/tablet_scheme_tests.TestTabletSchemes.test_tablet_schemes_flat_schemeshard_/flat_schemeshard.schema
index 804ca76f1716..02b8cd6f6188 100644
--- a/ydb/tests/functional/scheme_tests/canondata/tablet_scheme_tests.TestTabletSchemes.test_tablet_schemes_flat_schemeshard_/flat_schemeshard.schema
+++ b/ydb/tests/functional/scheme_tests/canondata/tablet_scheme_tests.TestTabletSchemes.test_tablet_schemes_flat_schemeshard_/flat_schemeshard.schema
@@ -1448,6 +1448,11 @@
                 "ColumnId": 31,
                 "ColumnName": "ServerlessComputeResourcesMode",
                 "ColumnType": "Uint32"
+            },
+            {
+                "ColumnId": 32,
+                "ColumnName": "ColumnTableColumnsLimit",
+                "ColumnType": "Uint64"
             }
         ],
         "ColumnsDropped": [],
@@ -1484,7 +1489,8 @@
                     28,
                     29,
                     30,
-                    31
+                    31,
+                    32
                 ],
                 "RoomID": 0,
                 "Codec": 0,
diff --git a/ydb/tests/functional/ydb_cli/ya.make b/ydb/tests/functional/ydb_cli/ya.make
index 678b5cd39f6e..1e4310e5e7fc 100644
--- a/ydb/tests/functional/ydb_cli/ya.make
+++ b/ydb/tests/functional/ydb_cli/ya.make
@@ -10,6 +10,7 @@ TEST_SRCS(
 
 ENV(YDB_DRIVER_BINARY="ydb/apps/ydbd/ydbd")
 ENV(YDB_CLI_BINARY="ydb/apps/ydb/ydb")
+ENV(YDB_ENABLE_COLUMN_TABLES="true")
 TIMEOUT(600)
 SIZE(MEDIUM)
 
diff --git a/ydb/tests/library/harness/kikimr_config.py b/ydb/tests/library/harness/kikimr_config.py
index ff214228d453..3baa281fdd75 100644
--- a/ydb/tests/library/harness/kikimr_config.py
+++ b/ydb/tests/library/harness/kikimr_config.py
@@ -83,6 +83,8 @@ def load_default_yaml(default_tablet_node_ids, ydb_domain_name, static_erasure,
     yaml_dict["log_config"]["entry"] = []
     for log, level in six.iteritems(log_configs):
         yaml_dict["log_config"]["entry"].append({"component": log, "level": int(level)})
+    if os.getenv("YDB_ENABLE_COLUMN_TABLES", "") == "true":
+        yaml_dict |= {"column_shard_config": {"disabled_on_scheme_shard": False}}
     return yaml_dict
 
 
diff --git a/ydb/tests/library/harness/kikimr_runner.py b/ydb/tests/library/harness/kikimr_runner.py
index b6f6c5066037..df67478a78af 100644
--- a/ydb/tests/library/harness/kikimr_runner.py
+++ b/ydb/tests/library/harness/kikimr_runner.py
@@ -613,33 +613,36 @@ def can_update(self):
 
     def start(self):
         if self.__slot_id is None:
-            return self.ssh_command("sudo start kikimr")
-        return self.ssh_command(
-            [
-                "sudo", "start",
-                "kikimr-multi",
-                "slot={}".format(self.__slot_id),
-                "tenant=/Root/db1",
-                "mbus={}".format(self.__mbus_port),
-                "grpc={}".format(self.__grpc_port),
-                "mon={}".format(self.__mon_port),
-                "ic={}".format(self.__ic_port),
-            ]
+            return self.ssh_command("sudo service kikimr start")
+
+        slot_dir = "/Berkanavt/kikimr_{slot}".format(slot=self.__slot_id)
+        slot_cfg = slot_dir + "/slot_cfg"
+        env_txt = slot_dir + "/env.txt"
+
+        cfg = """\
+tenant=/Root/db1
+grpc={grpc}
+mbus={mbus}
+ic={ic}
+mon={mon}""".format(
+            mbus=self.__mbus_port,
+            grpc=self.__grpc_port,
+            mon=self.__mon_port,
+            ic=self.__ic_port,
         )
 
+        self.ssh_command(["sudo", "mkdir", slot_dir])
+        self.ssh_command(["sudo", "touch", env_txt])
+        self.ssh_command(["/bin/echo", "-e", "\"{}\"".format(cfg),  "|", "sudo", "tee", slot_cfg])
+
+        return self.ssh_command(["sudo", "systemctl", "start", "kikimr-multi@{}".format(self.__slot_id)])
+
     def stop(self):
         if self.__slot_id is None:
-            return self.ssh_command("sudo stop kikimr")
+            return self.ssh_command("sudo service kikimr stop")
         return self.ssh_command(
             [
-                "sudo", "stop",
-                "kikimr-multi",
-                "slot={}".format(self.__slot_id),
-                "tenant=/Root/db1",
-                "mbus={}".format(self.__mbus_port),
-                "grpc={}".format(self.__grpc_port),
-                "mon={}".format(self.__mon_port),
-                "ic={}".format(self.__ic_port),
+                "sudo", "systemctl", "start", "kikimr-multi@{}".format(self.__slot_id),
             ]
         )
 
diff --git a/ydb/tests/library/harness/resources/default_yaml.yml b/ydb/tests/library/harness/resources/default_yaml.yml
index dc8eea16bf2e..7090fad7dedc 100644
--- a/ydb/tests/library/harness/resources/default_yaml.yml
+++ b/ydb/tests/library/harness/resources/default_yaml.yml
@@ -256,5 +256,3 @@ federated_query_config:
       uri: ""
   pinger:
     ping_period: "30s"
-column_shard_config:
-  disabled_on_scheme_shard: false
diff --git a/ydb/tests/olap/scenario/conftest.py b/ydb/tests/olap/scenario/conftest.py
index 51de3c62ada0..533375e989d4 100644
--- a/ydb/tests/olap/scenario/conftest.py
+++ b/ydb/tests/olap/scenario/conftest.py
@@ -19,7 +19,8 @@ def get_suite_name(cls):
 
     @classmethod
     def setup_class(cls):
-        ScenarioTestHelper(None).remove_path(cls.get_suite_name())
+        if not external_param_is_true('reuse-tables'):
+            ScenarioTestHelper(None).remove_path(cls.get_suite_name())
 
     @classmethod
     def teardown_class(cls):
diff --git a/ydb/tests/olap/scenario/helpers/data_generators.py b/ydb/tests/olap/scenario/helpers/data_generators.py
index 4945415a1085..286f4d8347a0 100644
--- a/ydb/tests/olap/scenario/helpers/data_generators.py
+++ b/ydb/tests/olap/scenario/helpers/data_generators.py
@@ -42,14 +42,30 @@ def next_row(self) -> None:
         pass
 
 
-class ColumnValueGeneratorNull(IColumnValueGenerator):
-    """NULL column value generator.
+class ColumnValueGeneratorConst(IColumnValueGenerator):
+    """Const column value generator.
 
-    Allways generate NULL value."""
+    Allways generate specified value."""
+
+    def __init__(self, value: Any) -> None:
+        """Constructor.
+
+         Args:
+            value: Value to generate.
+        Example:
+            DataGeneratorPerColumn(
+                self.schema2, 10,
+                ColumnValueGeneratorDefault(init_value=10))
+                    .with_column('not_level', ColumnValueGeneratorConst(42)
+            )
+        """
+
+        super().__init__()
+        self._value = value
 
     @override
-    def generate_value(column: ScenarioTestHelper.Column) -> Any:
-        return None
+    def generate_value(self, column: ScenarioTestHelper.Column) -> Any:
+        return self._value
 
 
 class ColumnValueGeneratorRandom(IColumnValueGenerator):
diff --git a/ydb/tests/olap/scenario/helpers/table_helper.py b/ydb/tests/olap/scenario/helpers/table_helper.py
index ef2088ecd692..8b1963fd13e0 100644
--- a/ydb/tests/olap/scenario/helpers/table_helper.py
+++ b/ydb/tests/olap/scenario/helpers/table_helper.py
@@ -218,6 +218,69 @@ def title(self) -> str:
         return f'drop column `{self._column}`'
 
 
+class SetSetting(AlterTableAction):
+    """Set a setting value for a table-like object.
+
+     Table-like objects are Tables and TableStore.
+     See {AlterTableLikeObject}.
+
+    Example:
+        sth = ScenarioTestHelper(ctx)
+        sth.execute_scheme_query(
+            AlterTable('testTable').action(SetSetting('TIERING', 'tiering1))
+        )
+    """
+
+    def __init__(self, setting: str, value_literal: str) -> None:
+        """Constructor.
+
+        Args:
+            column: Name of the column to be deleted."""
+
+        super().__init__()
+        self._setting = setting
+        self._value = value_literal
+
+    @override
+    def to_yql(self) -> str:
+        return f'SET {self._setting} {self._value}'
+
+    @override
+    def title(self) -> str:
+        return f'set {self._setting} = {self._value}'
+
+
+class ResetSetting(AlterTableAction):
+    """Reset value of a setting for a table-like object.
+
+     Table-like objects are Tables and TableStore.
+     See {AlterTableLikeObject}.
+
+    Example:
+        sth = ScenarioTestHelper(ctx)
+        sth.execute_scheme_query(
+            AlterTable('testTable').action(ResetSetting('TIERING'))
+        )
+    """
+
+    def __init__(self, setting: str) -> None:
+        """Constructor.
+
+        Args:
+            setting: Name of altered setting."""
+
+        super().__init__()
+        self._setting = setting
+
+    @override
+    def to_yql(self) -> str:
+        return f'RESET ({self._setting})'
+
+    @override
+    def title(self) -> str:
+        return f'reset {self._setting}'
+
+
 class AlterTableLikeObject(ScenarioTestHelper.IYqlble):
     """The base class for all requests to change table-like objects.
 
@@ -277,6 +340,42 @@ def drop_column(self, column: str) -> AlterTableLikeObject:
 
         return self(DropColumn(column))
 
+    def set_tiering(self, tiering_rule: str) -> AlterTableLikeObject:
+        """Set a tiering policy.
+
+        The method is similar to calling {AlterTableLikeObject.action} with a {SetSetting} instance.
+
+        Args:
+            tiering_rule: Name of a TIERING_RULE object.
+
+        Returns:
+            self."""
+
+        return self(SetSetting('TIERING', f'"{tiering_rule}"'))
+
+    def reset_tiering(self) -> AlterTableLikeObject:
+        """Remove a tiering policy.
+
+        The method is similar to calling {AlterTableLikeObject.action} with a {SetSetting} instance.
+
+        Returns:
+            self."""
+
+        return self(ResetSetting('TIERING'))
+
+    def set_ttl(self, interval: str, column: str) -> AlterTableLikeObject:
+        """Set TTL for rows.
+
+        The method is similar to calling {AlterTableLikeObject.action} with a {SetSetting} instance.
+
+        Args:
+            tiering_rule: Name of a TIERING_RULE object.
+
+        Returns:
+            self."""
+
+        return self(SetSetting('TTL', f'Interval("{interval}") ON `{column}`'))
+
     @override
     def params(self) -> Dict[str, str]:
         return {self._type(): self._name, 'actions': ', '.join([a.title() for a in self._actions])}
diff --git a/ydb/tests/olap/scenario/helpers/tiering_helper.py b/ydb/tests/olap/scenario/helpers/tiering_helper.py
new file mode 100644
index 000000000000..712aed66cac9
--- /dev/null
+++ b/ydb/tests/olap/scenario/helpers/tiering_helper.py
@@ -0,0 +1,246 @@
+from __future__ import annotations
+from ydb.tests.olap.scenario.helpers.scenario_tests_helper import (
+    ScenarioTestHelper,
+    TestContext,
+)
+from abc import abstractmethod
+
+from typing import override, Dict
+from dataclasses import dataclass
+import json
+
+
+@dataclass
+class ObjectStorageParams:
+    endpoint: str
+    bucket: str
+    access_key: str
+    secret_key: str
+    scheme: str = 'HTTP'
+    verify_ssl: bool = False
+
+    def to_proto_str(self) -> str:
+        return (
+            f'Scheme: {self.scheme}
'
+            f'VerifySSL: {str(self.verify_ssl).lower()}
'
+            f'Endpoint: "{self.endpoint}"
'
+            f'Bucket: "{self.bucket}"
'
+            f'AccessKey: "{self.access_key}"
'
+            f'SecretKey: "{self.secret_key}"
'
+        )
+
+
+@dataclass
+class TieringRule:
+    tier_name: str
+    duration_for_evict: str
+
+    def to_dict(self):
+        return {
+            'tierName': self.tier_name,
+            'durationForEvict': self.duration_for_evict,
+        }
+
+
+@dataclass
+class TieringPolicy:
+    rules: list[TieringRule]
+
+    def __init__(self):
+        self.rules = []
+
+    def with_rule(self, rule: TieringRule):
+        self.rules.append(rule)
+        return self
+
+    def to_json(self) -> str:
+        return json.dumps({'rules': list(map(lambda x: x.to_dict(), self.rules))})
+
+
+@dataclass
+class TierConfig:
+    name: str
+    s3_params: ObjectStorageParams
+
+    def to_proto_str(self) -> str:
+        return (
+            f'Name: "{self.name}"
'
+            f'ObjectStorage: {{
{self.s3_params.to_proto_str()}
}}'
+        )
+
+
+class AlterTieringRule(ScenarioTestHelper.IYqlble):
+    """Alter a tiering rule.
+
+     See {ScenarioTestHelper.IYqlble}.
+    """
+
+    def __init__(self, name: str, default_column: str, config: TieringPolicy) -> None:
+        """Constructor.
+
+        Args:
+            name: Name (relative path) of the altered object.
+            default_column: Default column used for tiering.
+            config: Tiering rules to apply."""
+
+        super().__init__(name)
+        self._default_column: str = default_column
+        self._config: TieringPolicy = config
+
+    @override
+    def params(self) -> Dict[str, str]:
+        return {'tiering_rule': self._name, 'config': self._config.to_json()}
+
+    @override
+    def title(self):
+        return 'Alter tiering rule'
+
+    @override
+    def to_yql(self, ctx: TestContext) -> str:
+        return f'ALTER OBJECT `{self._name}` (TYPE TIERING_RULE)' \
+               f' SET (defaultColumn = {self._default_column}, description = `{self._config.to_json()}`)'
+
+
+class CreateTieringRule(AlterTieringRule):
+    """Create a tiering rule.
+
+     See {ScenarioTestHelper.IYqlble}.
+    """
+
+    @override
+    def title(self):
+        return 'Create tiering rule'
+
+    @override
+    def to_yql(self, ctx: TestContext) -> str:
+        return f'CREATE OBJECT `{self._name}` (TYPE TIERING_RULE)' \
+               f' WITH (defaultColumn = {self._default_column}, description = `{self._config.to_json()}`)'
+
+
+class CreateTieringRuleIfNotExists(AlterTieringRule):
+    """Create a tiering rule. If it exists, do nothing.
+
+     See {ScenarioTestHelper.IYqlble}.
+    """
+
+    @override
+    def title(self):
+        return 'Create tiering rule'
+
+    @override
+    def to_yql(self, ctx: TestContext) -> str:
+        return f'CREATE OBJECT IF NOT EXISTS `{self._name}` (TYPE TIERING_RULE)' \
+               f' WITH (defaultColumn = {self._default_column}, description = `{self._config.to_json()}`)'
+
+
+class AlterTier(ScenarioTestHelper.IYqlble):
+    """Alter a tier.
+
+     See {ScenarioTestHelper.IYqlble}.
+    """
+
+    def __init__(self, name: str, config: TierConfig) -> None:
+        """Constructor.
+
+        Args:
+            name: Name (relative path) of the altered object.
+            config: Tier configuration."""
+
+        super().__init__(name)
+        self._config: TierConfig = config
+
+    @override
+    def params(self) -> Dict[str, str]:
+        return {'tier': self._name, 'config': self._config.to_proto_str()}
+
+    @override
+    def title(self):
+        return 'Alter tier'
+
+    @override
+    def to_yql(self, ctx: TestContext) -> str:
+        return f'ALTER OBJECT `{self._name}` (TYPE TIER) SET (tierConfig = `{self._config.to_proto_str()}`)'
+
+
+class CreateTier(AlterTier):
+    """Create a tier.
+
+     See {ScenarioTestHelper.IYqlble}.
+    """
+
+    @override
+    def title(self):
+        return 'Create tier'
+
+    @override
+    def to_yql(self, ctx: TestContext) -> str:
+        return f'CREATE OBJECT `{self._name}` (TYPE TIER) WITH (tierConfig = `{self._config.to_proto_str()}`)'
+
+
+class CreateTierIfNotExists(AlterTier):
+    """Create a tier. If it exists, do nothing.
+
+     See {ScenarioTestHelper.IYqlble}.
+    """
+
+    @override
+    def title(self):
+        return 'Create tier'
+
+    @override
+    def to_yql(self, ctx: TestContext) -> str:
+        return f'CREATE OBJECT IF NOT EXISTS `{self._name}` (TYPE TIER)' \
+               f' WITH (tierConfig = `{self._config.to_proto_str()}`)'
+
+
+class DropObjectBase(ScenarioTestHelper.IYqlble):
+    """Drop a tier.
+
+     See {ScenarioTestHelper.IYqlble}.
+    """
+
+    def __init__(self, name: str) -> None:
+        """Constructor.
+
+        Args:
+            name: Name (relative path) of the altered object."""
+
+        super().__init__(name)
+
+    @override
+    def params(self) -> Dict[str, str]:
+        return {'object_type': self._object_type()}
+
+    @override
+    def title(self):
+        return f'Drop {self._object_type().lower()}'
+
+    @override
+    def to_yql(self, ctx: TestContext) -> str:
+        return f'DROP OBJECT `{self._name}` (TYPE {self._object_type()})'
+
+    @abstractmethod
+    def _object_type(self) -> str:
+        pass
+
+
+class DropTier(DropObjectBase):
+    """Drop a tier.
+
+     See {ScenarioTestHelper.IYqlble}.
+    """
+
+    @override
+    def _object_type(self):
+        return 'TIER'
+
+
+class DropTieringRule(DropObjectBase):
+    """Drop a tier.
+
+     See {ScenarioTestHelper.IYqlble}.
+    """
+
+    @override
+    def _object_type(self):
+        return 'TIERING_RULE'
diff --git a/ydb/tests/olap/scenario/test_alter_tiering.py b/ydb/tests/olap/scenario/test_alter_tiering.py
new file mode 100644
index 000000000000..d82087e7a217
--- /dev/null
+++ b/ydb/tests/olap/scenario/test_alter_tiering.py
@@ -0,0 +1,152 @@
+from conftest import BaseTestSet
+from ydb.tests.olap.scenario.helpers import (
+    ScenarioTestHelper,
+    TestContext,
+    CreateTable,
+    CreateTableStore,
+    DropTable,
+)
+from helpers.tiering_helper import (
+    ObjectStorageParams,
+    AlterTier,
+    CreateTierIfNotExists,
+    AlterTieringRule,
+    CreateTieringRuleIfNotExists,
+    TierConfig,
+    TieringPolicy,
+    TieringRule,
+    DropTier,
+    DropTieringRule,
+)
+import helpers.data_generators as dg
+from helpers.table_helper import AlterTable
+
+from ydb.tests.olap.lib.utils import get_external_param
+from ydb import PrimitiveType
+import datetime
+import random
+import threading
+from typing import Iterable
+import time
+
+
+class TestAlterTiering(BaseTestSet):
+    schema1 = (
+        ScenarioTestHelper.Schema()
+        .with_column(name='timestamp', type=PrimitiveType.Timestamp, not_null=True)
+        .with_column(name='writer', type=PrimitiveType.Uint32, not_null=True)
+        .with_column(name='value', type=PrimitiveType.Uint64, not_null=True)
+        .with_column(name='data', type=PrimitiveType.String, not_null=True)
+        .with_key_columns('timestamp', 'writer', 'value')
+    )
+
+    class TestThread(threading.Thread):
+        def run(self) -> None:
+            self.exc = None
+            try:
+                self.ret = self._target(*self._args, **self._kwargs)
+            except BaseException as e:
+                self.exc = e
+
+        def join(self, timeout=None):
+            super().join(timeout)
+            if self.exc:
+                raise self.exc
+            return self.ret
+
+    def _drop_tables(self, prefix: str, count: int, ctx: TestContext):
+        sth = ScenarioTestHelper(ctx)
+        for i in range(count):
+            sth.execute_scheme_query(DropTable(f'store/{prefix}_{i}'))
+
+    def _upsert(self, ctx: TestContext, table: str, writer_id: int, duration: datetime.timedelta):
+        deadline = datetime.datetime.now() + duration
+        sth = ScenarioTestHelper(ctx)
+        rows_written = 0
+        i = 0
+        while datetime.datetime.now() < deadline:
+            sth.bulk_upsert(
+                table,
+                dg.DataGeneratorPerColumn(self.schema1, 1000)
+                .with_column('timestamp', dg.ColumnValueGeneratorRandom(null_probability=0))
+                .with_column('writer', dg.ColumnValueGeneratorConst(writer_id))
+                .with_column('value', dg.ColumnValueGeneratorSequential(rows_written))
+                .with_column('data', dg.ColumnValueGeneratorConst(random.randbytes(1024)))
+            )
+            rows_written += 1000
+            i += 1
+            if rows_written > 100000 and i % 10 == 0:
+                scan_result = sth.execute_scan_query(f'SELECT COUNT(*) FROM `{sth.get_full_path("store/table")}` WHERE writer == {writer_id}')
+                assert scan_result.result_set.rows[0][0] == rows_written
+
+    def _change_tiering_rule(self, ctx: TestContext, table: str, tiering_rules: Iterable[str], duration: datetime.timedelta):
+        deadline = datetime.datetime.now() + duration
+        sth = ScenarioTestHelper(ctx)
+        while datetime.datetime.now() < deadline:
+            for tiering_rule in tiering_rules:
+                sth.execute_scheme_query(AlterTable(table).set_tiering(tiering_rule))
+            sth.execute_scheme_query(AlterTable(table).reset_tiering())
+
+    def scenario_alter_tiering_rule_while_writing(self, ctx: TestContext):
+        test_duration = datetime.timedelta(seconds=400)
+
+        s3_endpoint = get_external_param('s3-endpoint', 'storage.yandexcloud.net')
+        s3_access_key = get_external_param('s3-access-key', 'YCAJEM3Pg9fMyuX9ZUOJ_fake')
+        s3_secret_key = get_external_param('s3-secret-key', 'YCM7Ovup55wDkymyEtO8pw5F10_L5jtVY8w_fake')
+        s3_buckets = get_external_param('s3-buckets', 'ydb-tiering-test-1,ydb-tiering-test-2').split(',')
+
+        s3_configs = [
+            ObjectStorageParams(
+                scheme='HTTP',
+                verify_ssl=False,
+                endpoint=s3_endpoint,
+                bucket=bucket,
+                access_key=s3_access_key,
+                secret_key=s3_secret_key
+            ) for bucket in s3_buckets
+        ]
+
+        sth = ScenarioTestHelper(ctx)
+
+        tiers: list[str] = []
+        tiering_rules: list[str] = []
+        for i, s3_config in enumerate(s3_configs):
+            tiers.append(f'TestAlterTiering:tier{i}')
+            tiering_rules.append(f'TestAlterTiering:tiering_rule{i}')
+
+            tier_config = TierConfig(tiers[-1], s3_config)
+            tiering_config = TieringPolicy().with_rule(TieringRule(tiers[-1], '1s'))
+
+            sth.execute_scheme_query(CreateTierIfNotExists(tiers[-1], tier_config))
+            sth.execute_scheme_query(CreateTieringRuleIfNotExists(tiering_rules[-1], 'timestamp', tiering_config))
+
+            sth.execute_scheme_query(AlterTier(tiers[-1], tier_config))
+            sth.execute_scheme_query(AlterTieringRule(tiering_rules[-1], 'timestamp', tiering_config))
+
+        sth.execute_scheme_query(CreateTableStore('store').with_schema(self.schema1))
+        sth.execute_scheme_query(CreateTable('store/table').with_schema(self.schema1))
+
+        threads = []
+
+        threads.append(self.TestThread(
+            target=self._change_tiering_rule,
+            args=[ctx, 'store/table', tiering_rules, test_duration]
+        ))
+        writer_id_offset = random.randint(0, 1 << 30)
+        for i in range(4):
+            threads.append(self.TestThread(target=self._upsert, args=[ctx, 'store/table', writer_id_offset + i, test_duration]))
+
+        for thread in threads:
+            thread.start()
+        for thread in threads:
+            thread.join()
+
+        for tiering in tiering_rules:
+            sth.execute_scheme_query(DropTieringRule(tiering))
+        for tier in tiers:
+            sth.execute_scheme_query(DropTier(tier))
+
+        sth.execute_scheme_query(AlterTable('store/table').set_ttl('P1D', 'timestamp'))
+
+        while sth.execute_scan_query(f'SELECT COUNT(*) FROM `{sth.get_full_path("store/table")}`').result_set.rows[0][0]:
+            time.sleep(10)
diff --git a/ydb/tests/olap/scenario/ya.make b/ydb/tests/olap/scenario/ya.make
index 49eee4306f26..58a33a89fdba 100644
--- a/ydb/tests/olap/scenario/ya.make
+++ b/ydb/tests/olap/scenario/ya.make
@@ -11,6 +11,7 @@ PY3TEST()
     TEST_SRCS(
         test_simple.py
         test_scheme_load.py
+        test_alter_tiering.py
     )
 
     PEERDIR(
