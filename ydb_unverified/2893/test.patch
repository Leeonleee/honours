diff --git a/ydb/core/blobstorage/ut_testshard/CMakeLists.darwin-arm64.txt b/ydb/core/blobstorage/ut_testshard/CMakeLists.darwin-arm64.txt
index 46b220972149..19b8a576735e 100644
--- a/ydb/core/blobstorage/ut_testshard/CMakeLists.darwin-arm64.txt
+++ b/ydb/core/blobstorage/ut_testshard/CMakeLists.darwin-arm64.txt
@@ -12,6 +12,7 @@ target_link_libraries(ydb-core-blobstorage-ut_testshard PUBLIC
   contrib-libs-cxxsupp
   yutil
   cpp-testing-unittest_main
+  version_definition
   ydb-core-base
   ydb-core-blob_depot
   core-blobstorage-backpressure
diff --git a/ydb/core/blobstorage/ut_testshard/CMakeLists.darwin-x86_64.txt b/ydb/core/blobstorage/ut_testshard/CMakeLists.darwin-x86_64.txt
index 5c635e0b11b3..972e7c84ccaa 100644
--- a/ydb/core/blobstorage/ut_testshard/CMakeLists.darwin-x86_64.txt
+++ b/ydb/core/blobstorage/ut_testshard/CMakeLists.darwin-x86_64.txt
@@ -13,6 +13,7 @@ target_link_libraries(ydb-core-blobstorage-ut_testshard PUBLIC
   yutil
   library-cpp-cpuid_check
   cpp-testing-unittest_main
+  version_definition
   ydb-core-base
   ydb-core-blob_depot
   core-blobstorage-backpressure
diff --git a/ydb/core/blobstorage/ut_testshard/CMakeLists.linux-aarch64.txt b/ydb/core/blobstorage/ut_testshard/CMakeLists.linux-aarch64.txt
index 13632cba37ce..59ed90704881 100644
--- a/ydb/core/blobstorage/ut_testshard/CMakeLists.linux-aarch64.txt
+++ b/ydb/core/blobstorage/ut_testshard/CMakeLists.linux-aarch64.txt
@@ -13,6 +13,7 @@ target_link_libraries(ydb-core-blobstorage-ut_testshard PUBLIC
   contrib-libs-cxxsupp
   yutil
   cpp-testing-unittest_main
+  version_definition
   ydb-core-base
   ydb-core-blob_depot
   core-blobstorage-backpressure
diff --git a/ydb/core/blobstorage/ut_testshard/CMakeLists.linux-x86_64.txt b/ydb/core/blobstorage/ut_testshard/CMakeLists.linux-x86_64.txt
index 9e02e5a34a5b..1d86546dcea5 100644
--- a/ydb/core/blobstorage/ut_testshard/CMakeLists.linux-x86_64.txt
+++ b/ydb/core/blobstorage/ut_testshard/CMakeLists.linux-x86_64.txt
@@ -14,6 +14,7 @@ target_link_libraries(ydb-core-blobstorage-ut_testshard PUBLIC
   yutil
   library-cpp-cpuid_check
   cpp-testing-unittest_main
+  version_definition
   ydb-core-base
   ydb-core-blob_depot
   core-blobstorage-backpressure
diff --git a/ydb/core/blobstorage/ut_testshard/CMakeLists.windows-x86_64.txt b/ydb/core/blobstorage/ut_testshard/CMakeLists.windows-x86_64.txt
index 0fd1655f0b30..e1748212ae74 100644
--- a/ydb/core/blobstorage/ut_testshard/CMakeLists.windows-x86_64.txt
+++ b/ydb/core/blobstorage/ut_testshard/CMakeLists.windows-x86_64.txt
@@ -13,6 +13,7 @@ target_link_libraries(ydb-core-blobstorage-ut_testshard PUBLIC
   yutil
   library-cpp-cpuid_check
   cpp-testing-unittest_main
+  version_definition
   ydb-core-base
   ydb-core-blob_depot
   core-blobstorage-backpressure
diff --git a/ydb/core/blobstorage/ut_testshard/ya.make b/ydb/core/blobstorage/ut_testshard/ya.make
index e1c6adef761d..47409b20d301 100644
--- a/ydb/core/blobstorage/ut_testshard/ya.make
+++ b/ydb/core/blobstorage/ut_testshard/ya.make
@@ -12,6 +12,7 @@ UNITTEST()
     )
 
     PEERDIR(
+        ydb/apps/version
         ydb/core/base
         ydb/core/blob_depot
         ydb/core/blobstorage/backpressure
diff --git a/ydb/core/testlib/CMakeLists.darwin-arm64.txt b/ydb/core/testlib/CMakeLists.darwin-arm64.txt
index d234d9d9e6a0..887f4f370184 100644
--- a/ydb/core/testlib/CMakeLists.darwin-arm64.txt
+++ b/ydb/core/testlib/CMakeLists.darwin-arm64.txt
@@ -18,6 +18,7 @@ target_compile_options(ydb-core-testlib PRIVATE
 target_link_libraries(ydb-core-testlib PUBLIC
   contrib-libs-cxxsupp
   yutil
+  version_definition
   library-actors-core
   library-actors-interconnect
   library-grpc-client
diff --git a/ydb/core/testlib/CMakeLists.darwin-x86_64.txt b/ydb/core/testlib/CMakeLists.darwin-x86_64.txt
index d234d9d9e6a0..887f4f370184 100644
--- a/ydb/core/testlib/CMakeLists.darwin-x86_64.txt
+++ b/ydb/core/testlib/CMakeLists.darwin-x86_64.txt
@@ -18,6 +18,7 @@ target_compile_options(ydb-core-testlib PRIVATE
 target_link_libraries(ydb-core-testlib PUBLIC
   contrib-libs-cxxsupp
   yutil
+  version_definition
   library-actors-core
   library-actors-interconnect
   library-grpc-client
diff --git a/ydb/core/testlib/CMakeLists.linux-aarch64.txt b/ydb/core/testlib/CMakeLists.linux-aarch64.txt
index f5e108c012be..0a6dcd6d400c 100644
--- a/ydb/core/testlib/CMakeLists.linux-aarch64.txt
+++ b/ydb/core/testlib/CMakeLists.linux-aarch64.txt
@@ -19,6 +19,7 @@ target_link_libraries(ydb-core-testlib PUBLIC
   contrib-libs-linux-headers
   contrib-libs-cxxsupp
   yutil
+  version_definition
   library-actors-core
   library-actors-interconnect
   library-grpc-client
diff --git a/ydb/core/testlib/CMakeLists.linux-x86_64.txt b/ydb/core/testlib/CMakeLists.linux-x86_64.txt
index f5e108c012be..0a6dcd6d400c 100644
--- a/ydb/core/testlib/CMakeLists.linux-x86_64.txt
+++ b/ydb/core/testlib/CMakeLists.linux-x86_64.txt
@@ -19,6 +19,7 @@ target_link_libraries(ydb-core-testlib PUBLIC
   contrib-libs-linux-headers
   contrib-libs-cxxsupp
   yutil
+  version_definition
   library-actors-core
   library-actors-interconnect
   library-grpc-client
diff --git a/ydb/core/testlib/CMakeLists.windows-x86_64.txt b/ydb/core/testlib/CMakeLists.windows-x86_64.txt
index d234d9d9e6a0..887f4f370184 100644
--- a/ydb/core/testlib/CMakeLists.windows-x86_64.txt
+++ b/ydb/core/testlib/CMakeLists.windows-x86_64.txt
@@ -18,6 +18,7 @@ target_compile_options(ydb-core-testlib PRIVATE
 target_link_libraries(ydb-core-testlib PUBLIC
   contrib-libs-cxxsupp
   yutil
+  version_definition
   library-actors-core
   library-actors-interconnect
   library-grpc-client
diff --git a/ydb/core/testlib/actors/CMakeLists.darwin-arm64.txt b/ydb/core/testlib/actors/CMakeLists.darwin-arm64.txt
index 652256b272aa..559ad8cb1896 100644
--- a/ydb/core/testlib/actors/CMakeLists.darwin-arm64.txt
+++ b/ydb/core/testlib/actors/CMakeLists.darwin-arm64.txt
@@ -12,6 +12,7 @@ add_library(core-testlib-actors)
 target_link_libraries(core-testlib-actors PUBLIC
   contrib-libs-cxxsupp
   yutil
+  version_definition
   library-actors-testlib
   cpp-testing-unittest
   ydb-core-base
diff --git a/ydb/core/testlib/actors/CMakeLists.darwin-x86_64.txt b/ydb/core/testlib/actors/CMakeLists.darwin-x86_64.txt
index 652256b272aa..559ad8cb1896 100644
--- a/ydb/core/testlib/actors/CMakeLists.darwin-x86_64.txt
+++ b/ydb/core/testlib/actors/CMakeLists.darwin-x86_64.txt
@@ -12,6 +12,7 @@ add_library(core-testlib-actors)
 target_link_libraries(core-testlib-actors PUBLIC
   contrib-libs-cxxsupp
   yutil
+  version_definition
   library-actors-testlib
   cpp-testing-unittest
   ydb-core-base
diff --git a/ydb/core/testlib/actors/CMakeLists.linux-aarch64.txt b/ydb/core/testlib/actors/CMakeLists.linux-aarch64.txt
index 3aa61780092e..296b9c055c85 100644
--- a/ydb/core/testlib/actors/CMakeLists.linux-aarch64.txt
+++ b/ydb/core/testlib/actors/CMakeLists.linux-aarch64.txt
@@ -13,6 +13,7 @@ target_link_libraries(core-testlib-actors PUBLIC
   contrib-libs-linux-headers
   contrib-libs-cxxsupp
   yutil
+  version_definition
   library-actors-testlib
   cpp-testing-unittest
   ydb-core-base
diff --git a/ydb/core/testlib/actors/CMakeLists.linux-x86_64.txt b/ydb/core/testlib/actors/CMakeLists.linux-x86_64.txt
index 3aa61780092e..296b9c055c85 100644
--- a/ydb/core/testlib/actors/CMakeLists.linux-x86_64.txt
+++ b/ydb/core/testlib/actors/CMakeLists.linux-x86_64.txt
@@ -13,6 +13,7 @@ target_link_libraries(core-testlib-actors PUBLIC
   contrib-libs-linux-headers
   contrib-libs-cxxsupp
   yutil
+  version_definition
   library-actors-testlib
   cpp-testing-unittest
   ydb-core-base
diff --git a/ydb/core/testlib/actors/CMakeLists.windows-x86_64.txt b/ydb/core/testlib/actors/CMakeLists.windows-x86_64.txt
index 652256b272aa..559ad8cb1896 100644
--- a/ydb/core/testlib/actors/CMakeLists.windows-x86_64.txt
+++ b/ydb/core/testlib/actors/CMakeLists.windows-x86_64.txt
@@ -12,6 +12,7 @@ add_library(core-testlib-actors)
 target_link_libraries(core-testlib-actors PUBLIC
   contrib-libs-cxxsupp
   yutil
+  version_definition
   library-actors-testlib
   cpp-testing-unittest
   ydb-core-base
diff --git a/ydb/core/testlib/actors/ya.make b/ydb/core/testlib/actors/ya.make
index fc27aa01c236..25f814605794 100644
--- a/ydb/core/testlib/actors/ya.make
+++ b/ydb/core/testlib/actors/ya.make
@@ -5,6 +5,7 @@ SRCS(
 )
 
 PEERDIR(
+    ydb/apps/version
     ydb/library/actors/testlib
     library/cpp/testing/unittest
     ydb/core/base
diff --git a/ydb/core/testlib/tenant_runtime.cpp b/ydb/core/testlib/tenant_runtime.cpp
index 88ba8b75905c..3f1d14f4a977 100644
--- a/ydb/core/testlib/tenant_runtime.cpp
+++ b/ydb/core/testlib/tenant_runtime.cpp
@@ -1034,7 +1034,12 @@ void TTenantTestRuntime::Setup(bool createTenantPools)
                 labels[label.GetName()] = label.GetValue();
             }
             labels.emplace("node_id", ToString(i));
-            auto aid = Register(CreateConfigsDispatcher(Extension, labels));
+            auto aid = Register(CreateConfigsDispatcher(
+                    NKikimr::NConsole::TConfigsDispatcherInitInfo {
+                        .InitialConfig = Extension,
+                        .Labels = labels,
+                    }
+                ));
             EnableScheduleForActor(aid, true);
             RegisterService(MakeConfigsDispatcherID(GetNodeId(0)), aid, 0);
         }
diff --git a/ydb/core/testlib/test_client.cpp b/ydb/core/testlib/test_client.cpp
index b4c35f7375ac..978d3e3b1f97 100644
--- a/ydb/core/testlib/test_client.cpp
+++ b/ydb/core/testlib/test_client.cpp
@@ -739,7 +739,10 @@ namespace Tests {
             if (!initial.HasImmediateControlsConfig()) {
                 initial.MutableImmediateControlsConfig()->CopyFrom(Settings->Controls);
             }
-            auto *dispatcher = NConsole::CreateConfigsDispatcher(initial, {});
+            auto *dispatcher = NConsole::CreateConfigsDispatcher(
+                    NKikimr::NConsole::TConfigsDispatcherInitInfo {
+                        .InitialConfig = initial,
+                    });
             auto aid = Runtime->Register(dispatcher, nodeIdx, appData.SystemPoolId, TMailboxType::Revolving, 0);
             Runtime->RegisterService(NConsole::MakeConfigsDispatcherID(Runtime->GetNodeId(nodeIdx)), aid, nodeIdx);
         }
diff --git a/ydb/core/testlib/ya.make b/ydb/core/testlib/ya.make
index e7a93b69ae78..009636936e28 100644
--- a/ydb/core/testlib/ya.make
+++ b/ydb/core/testlib/ya.make
@@ -22,6 +22,7 @@ SRCS(
 )
 
 PEERDIR(
+    ydb/apps/version
     ydb/library/actors/core
     ydb/library/actors/interconnect
     ydb/library/grpc/client
