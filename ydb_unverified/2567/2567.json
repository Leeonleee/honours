{
  "repo": "ydb-platform/ydb",
  "pull_number": 2567,
  "instance_id": "ydb-platform__ydb-2567",
  "issue_numbers": [
    "2366"
  ],
  "base_commit": "61cd3ddb72d784160cd7dc9c4652395e5402c910",
  "patch": "diff --git a/ydb/library/yql/core/type_ann/type_ann_pg.cpp b/ydb/library/yql/core/type_ann/type_ann_pg.cpp\nindex ddd8c2ca6efe..f65e7af3d004 100644\n--- a/ydb/library/yql/core/type_ann/type_ann_pg.cpp\n+++ b/ydb/library/yql/core/type_ann/type_ann_pg.cpp\n@@ -4909,7 +4909,7 @@ IGraphTransformer::TStatus PgLikeWrapper(const TExprNode::TPtr& input, TExprNode\n         }\n \n         if (argTypes[i] != textTypeId) {\n-            if (argTypes[i] == NPg::UnknownOid) {\n+            if (NPg::IsCoercible(argTypes[i], textTypeId, NPg::ECoercionCode::Implicit)) {\n                 auto& argNode = input->ChildRef(i);\n                 argNode = WrapWithPgCast(std::move(argNode), textTypeId, ctx.Expr);\n                 return IGraphTransformer::TStatus::Repeat;\n",
  "test_patch": "diff --git a/ydb/library/yql/tests/postgresql/cases/alter_table.err b/ydb/library/yql/tests/postgresql/cases/alter_table.err\nindex a7ba5b774a51..6535c0088462 100644\n--- a/ydb/library/yql/tests/postgresql/cases/alter_table.err\n+++ b/ydb/library/yql/tests/postgresql/cases/alter_table.err\n@@ -5774,20 +5774,15 @@ select conname, obj_description(oid, 'pg_constraint') as desc\n </sql-statement>\n -stdin-:<main>: Error: Type annotation\n \n-    -stdin-:<main>:1:1: Error: At function: RemovePrefixMembers, At function: PgSelect\n+    -stdin-:<main>:1:1: Error: At function: RemovePrefixMembers, At function: PgSelect, At function: PgSetItem, At function: PgResultItem\n     \tselect conname, obj_description(oid, 'pg_constraint') as desc\n \t^\n-        -stdin-:<main>: Error: At function: PgSetItem\n-        \n-            -stdin-:<main>:1:1: Error: At function: PgWhere\n+        -stdin-:<main>:1:17: Error: At function: PgCall\n+        \tselect conname, obj_description(oid, 'pg_constraint') as desc\n+\t                ^\n+            -stdin-:<main>:1:17: Error: No such proc: obj_description\n             \tselect conname, obj_description(oid, 'pg_constraint') as desc\n-\t^\n-                -stdin-:<main>:2:36: Error: At function: PgLike\n-                \t  from pg_constraint where conname like 'at_partitioned%'\n-\t                                   ^\n-                    -stdin-:<main>:2:36: Error: Expected pg text, but got name\n-                    \t  from pg_constraint where conname like 'at_partitioned%'\n-\t                                   ^\n+\t                ^\n <sql-statement>\n alter table at_partitioned alter column name type varchar(127);\n </sql-statement>\n@@ -5823,20 +5818,15 @@ select conname, obj_description(oid, 'pg_constraint') as desc\n </sql-statement>\n -stdin-:<main>: Error: Type annotation\n \n-    -stdin-:<main>:1:1: Error: At function: RemovePrefixMembers, At function: PgSelect\n+    -stdin-:<main>:1:1: Error: At function: RemovePrefixMembers, At function: PgSelect, At function: PgSetItem, At function: PgResultItem\n     \tselect conname, obj_description(oid, 'pg_constraint') as desc\n \t^\n-        -stdin-:<main>: Error: At function: PgSetItem\n-        \n-            -stdin-:<main>:1:1: Error: At function: PgWhere\n+        -stdin-:<main>:1:17: Error: At function: PgCall\n+        \tselect conname, obj_description(oid, 'pg_constraint') as desc\n+\t                ^\n+            -stdin-:<main>:1:17: Error: No such proc: obj_description\n             \tselect conname, obj_description(oid, 'pg_constraint') as desc\n-\t^\n-                -stdin-:<main>:2:36: Error: At function: PgLike\n-                \t  from pg_constraint where conname like 'at_partitioned%'\n-\t                                   ^\n-                    -stdin-:<main>:2:36: Error: Expected pg text, but got name\n-                    \t  from pg_constraint where conname like 'at_partitioned%'\n-\t                                   ^\n+\t                ^\n <sql-statement>\n -- Don't remove this DROP, it exposes bug #15672\n drop table at_partitioned;\n@@ -5997,25 +5987,6 @@ select relname, conname, coninhcount, conislocal, connoinherit\n   where relname like 'test_inh_check%' and c.conrelid = r.oid\n   order by 1, 2;\n </sql-statement>\n--stdin-:<main>: Error: Type annotation\n-\n-    -stdin-:<main>:1:1: Error: At function: RemovePrefixMembers, At function: PgSelect\n-    \tselect relname, conname, coninhcount, conislocal, connoinherit\n-\t^\n-        -stdin-:<main>: Error: At function: PgSetItem\n-        \n-            -stdin-:<main>:1:1: Error: At function: PgWhere\n-            \tselect relname, conname, coninhcount, conislocal, connoinherit\n-\t^\n-                -stdin-:<main>:3:40: Error: At function: PgAnd\n-                \t  where relname like 'test_inh_check%' and c.conrelid = r.oid\n-\t                                       ^\n-                    -stdin-:<main>:3:17: Error: At function: PgLike\n-                    \t  where relname like 'test_inh_check%' and c.conrelid = r.oid\n-\t                ^\n-                        -stdin-:<main>:3:17: Error: Expected pg text, but got name\n-                        \t  where relname like 'test_inh_check%' and c.conrelid = r.oid\n-\t                ^\n <sql-statement>\n ALTER TABLE test_inh_check ALTER COLUMN a TYPE numeric;\n </sql-statement>\n@@ -6038,25 +6009,6 @@ select relname, conname, coninhcount, conislocal, connoinherit\n   where relname like 'test_inh_check%' and c.conrelid = r.oid\n   order by 1, 2;\n </sql-statement>\n--stdin-:<main>: Error: Type annotation\n-\n-    -stdin-:<main>:1:1: Error: At function: RemovePrefixMembers, At function: PgSelect\n-    \tselect relname, conname, coninhcount, conislocal, connoinherit\n-\t^\n-        -stdin-:<main>: Error: At function: PgSetItem\n-        \n-            -stdin-:<main>:1:1: Error: At function: PgWhere\n-            \tselect relname, conname, coninhcount, conislocal, connoinherit\n-\t^\n-                -stdin-:<main>:3:40: Error: At function: PgAnd\n-                \t  where relname like 'test_inh_check%' and c.conrelid = r.oid\n-\t                                       ^\n-                    -stdin-:<main>:3:17: Error: At function: PgLike\n-                    \t  where relname like 'test_inh_check%' and c.conrelid = r.oid\n-\t                ^\n-                        -stdin-:<main>:3:17: Error: Expected pg text, but got name\n-                        \t  where relname like 'test_inh_check%' and c.conrelid = r.oid\n-\t                ^\n <sql-statement>\n -- also try noinherit, local, and local+inherited cases\n ALTER TABLE test_inh_check ADD CONSTRAINT bnoinherit CHECK (b > 100) NO INHERIT;\n@@ -6104,25 +6056,6 @@ select relname, conname, coninhcount, conislocal, connoinherit\n   where relname like 'test_inh_check%' and c.conrelid = r.oid\n   order by 1, 2;\n </sql-statement>\n--stdin-:<main>: Error: Type annotation\n-\n-    -stdin-:<main>:1:1: Error: At function: RemovePrefixMembers, At function: PgSelect\n-    \tselect relname, conname, coninhcount, conislocal, connoinherit\n-\t^\n-        -stdin-:<main>: Error: At function: PgSetItem\n-        \n-            -stdin-:<main>:1:1: Error: At function: PgWhere\n-            \tselect relname, conname, coninhcount, conislocal, connoinherit\n-\t^\n-                -stdin-:<main>:3:40: Error: At function: PgAnd\n-                \t  where relname like 'test_inh_check%' and c.conrelid = r.oid\n-\t                                       ^\n-                    -stdin-:<main>:3:17: Error: At function: PgLike\n-                    \t  where relname like 'test_inh_check%' and c.conrelid = r.oid\n-\t                ^\n-                        -stdin-:<main>:3:17: Error: Expected pg text, but got name\n-                        \t  where relname like 'test_inh_check%' and c.conrelid = r.oid\n-\t                ^\n <sql-statement>\n ALTER TABLE test_inh_check ALTER COLUMN b TYPE numeric;\n </sql-statement>\n@@ -6145,25 +6078,6 @@ select relname, conname, coninhcount, conislocal, connoinherit\n   where relname like 'test_inh_check%' and c.conrelid = r.oid\n   order by 1, 2;\n </sql-statement>\n--stdin-:<main>: Error: Type annotation\n-\n-    -stdin-:<main>:1:1: Error: At function: RemovePrefixMembers, At function: PgSelect\n-    \tselect relname, conname, coninhcount, conislocal, connoinherit\n-\t^\n-        -stdin-:<main>: Error: At function: PgSetItem\n-        \n-            -stdin-:<main>:1:1: Error: At function: PgWhere\n-            \tselect relname, conname, coninhcount, conislocal, connoinherit\n-\t^\n-                -stdin-:<main>:3:40: Error: At function: PgAnd\n-                \t  where relname like 'test_inh_check%' and c.conrelid = r.oid\n-\t                                       ^\n-                    -stdin-:<main>:3:17: Error: At function: PgLike\n-                    \t  where relname like 'test_inh_check%' and c.conrelid = r.oid\n-\t                ^\n-                        -stdin-:<main>:3:17: Error: Expected pg text, but got name\n-                        \t  where relname like 'test_inh_check%' and c.conrelid = r.oid\n-\t                ^\n <sql-statement>\n -- ALTER COLUMN TYPE with different schema in children\n -- Bug at https://postgr.es/m/20170102225618.GA10071@telsasoft.com\n@@ -8752,56 +8666,56 @@ UNION ALL\n SELECT 'toast index', ri.relkind, ri.relpersistence FROM pg_class r join pg_class t ON t.oid = r.reltoastrelid JOIN pg_index i ON i.indrelid = t.oid JOIN pg_class ri ON ri.oid = i.indexrelid WHERE r.relname ~ '^unlogged1'\n ORDER BY relname;\n </sql-statement>\n-VERIFY failed (2024-02-23T18:47:23.640420+0300): \n+VERIFY failed (2024-03-07T20:04:42.142404+0300): \n   ydb/library/yql/minikql/comp_nodes/llvm14/mkql_join_dict.cpp:149\n   JoinDicts(): requirement !HasNullInKey(key1) failed\n-NPrivate::InternalPanicImpl(int, char const*, char const*, int, int, int, TBasicStringBuf<char, std::__y1::char_traits<char> >, char const*, unsigned long)+600 (0x98FCAA8)\n-NPrivate::Panic(NPrivate::TStaticBuf const&, int, char const*, char const*, char const*, ...)+285 (0x98F29BD)\n-??+0 (0x1183B081)\n-??+0 (0x7FF84FF892B5)\n-??+0 (0x7FF84FF88C92)\n-??+0 (0x7FF84FF8887D)\n-??+0 (0x110FB018)\n-std::__y1::back_insert_iterator<std::__y1::vector<NYql::NUdf::TUnboxedValue, NKikimr::NMiniKQL::TMKQLAllocator<NYql::NUdf::TUnboxedValue, (NKikimr::NMiniKQL::EMemorySubPool)0> > > std::__y1::transform[abi:v160005]<NKikimr::NMiniKQL::IComputationNode* const*, std::__y1::back_insert_iterator<std::__y1::vector<NYql::NUdf::TUnboxedValue, NKikimr::NMiniKQL::TMKQLAllocator<NYql::NUdf::TUnboxedValue, (NKikimr::NMiniKQL::EMemorySubPool)0> > >, std::__y1::__bind<NYql::NUdf::TUnboxedValue (NKikimr::NMiniKQL::IComputationNode::*)(NKikimr::NMiniKQL::TComputationContext&) const, std::__y1::placeholders::__ph<1> const&, std::__y1::reference_wrapper<NKikimr::NMiniKQL::TComputationContext> > >(NKikimr::NMiniKQL::IComputationNode* const*, NKikimr::NMiniKQL::IComputationNode* const*, std::__y1::back_insert_iterator<std::__y1::vector<NYql::NUdf::TUnboxedValue, NKikimr::NMiniKQL::TMKQLAllocator<NYql::NUdf::TUnboxedValue, (NKikimr::NMiniKQL::EMemorySubPool)0> > >, std::__y1::__bind<NYql::NUdf::TUnboxedValue (NKikimr::NMiniKQL::I+131 (0x110B0FE3)\n-??+0 (0x110B29E6)\n-??+0 (0x110B1E44)\n-??+0 (0x1180C4CF)\n-??+0 (0x1180B66F)\n-??+0 (0xF33B607)\n-NYql::TComputationGraphProxy::GetValue()+23 (0xF31AC77)\n-NYql::NFile::TYtFileGateway::ExecuteResult(NYql::NFile::TSession&, NYson::TYsonWriter&, NYql::NNodes::TExprBase, NYql::TExprContext&, NYql::IYtGateway::TResOrPullOptions&&, TVector<TBasicString<char, std::__y1::char_traits<char> >, std::__y1::allocator<TBasicString<char, std::__y1::char_traits<char> > > > const&) const+1930 (0xF2EE13A)\n-NYql::NFile::TYtFileGateway::ResOrPull(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, NYql::TExprContext&, NYql::IYtGateway::TResOrPullOptions&&)+881 (0xF2D85C1)\n-??+0 (0xE4C0F15)\n-??+0 (0xE4C44CA)\n-NYql::TExecTransformerBase::CallbackTransform(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&)+1098 (0xE4C871A)\n-NYql::TAsyncCallbackTransformer<NYql::TExecTransformerBase>::DoTransform(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&)+37 (0xE4C3CB5)\n-NYql::TGraphTransformerBase::Transform(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&)+152 (0xB009018)\n-??+0 (0xC64DF24)\n-??+0 (0xC642B8F)\n-NYql::TGraphTransformerBase::Transform(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&)+152 (0xB009018)\n-??+0 (0xC73C85F)\n-??+0 (0xC7410D0)\n-??+0 (0xC73C382)\n-??+0 (0xC740F6C)\n-??+0 (0xC73C382)\n-??+0 (0xC740F6C)\n-??+0 (0xC73C382)\n-??+0 (0xC738E84)\n-NYql::TGraphTransformerBase::Transform(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&)+152 (0xB009018)\n-??+0 (0xB009725)\n-NYql::TGraphTransformerBase::Transform(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&)+152 (0xB009018)\n-NYql::AsyncTransformStepImpl(NYql::IGraphTransformer&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&, bool, bool, TBasicStringBuf<char, std::__y1::char_traits<char> > const&)+290 (0xB007AF2)\n-NYql::AsyncTransform(NYql::IGraphTransformer&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&, bool)+66 (0xB008452)\n-NYql::TProgram::AsyncTransformWithFallback(bool)+81 (0xBF3E701)\n-??+0 (0xBF4FCD0)\n-NYql::TProgram::RunAsync(TBasicString<char, std::__y1::char_traits<char> > const&, IOutputStream*, IOutputStream*, IOutputStream*, bool)+3035 (0xBF3C6EB)\n-??+0 (0xBF3983A)\n-NYql::TProgram::Run(TBasicString<char, std::__y1::char_traits<char> > const&, IOutputStream*, IOutputStream*, IOutputStream*, bool)+129 (0xBF3BAD1)\n-Main(int, char**)+6488 (0x97DA248)\n-main+334 (0x97DCBCE)\n-??+0 (0x7FF84FC29D90)\n-__libc_start_main+128 (0x7FF84FC29E40)\n-??+0 (0x976E029)\n+NPrivate::InternalPanicImpl(int, char const*, char const*, int, int, int, TBasicStringBuf<char, std::__y1::char_traits<char> >, char const*, unsigned long)+600 (0x9929598)\n+NPrivate::Panic(NPrivate::TStaticBuf const&, int, char const*, char const*, char const*, ...)+285 (0x991F4FD)\n+??+0 (0x1185F421)\n+??+0 (0x7F665BEF82B5)\n+??+0 (0x7F665BEF7C92)\n+??+0 (0x7F665BEF787D)\n+??+0 (0x11120148)\n+std::__y1::back_insert_iterator<std::__y1::vector<NYql::NUdf::TUnboxedValue, NKikimr::NMiniKQL::TMKQLAllocator<NYql::NUdf::TUnboxedValue, (NKikimr::NMiniKQL::EMemorySubPool)0> > > std::__y1::transform[abi:ue170006]<NKikimr::NMiniKQL::IComputationNode* const*, std::__y1::back_insert_iterator<std::__y1::vector<NYql::NUdf::TUnboxedValue, NKikimr::NMiniKQL::TMKQLAllocator<NYql::NUdf::TUnboxedValue, (NKikimr::NMiniKQL::EMemorySubPool)0> > >, std::__y1::__bind<NYql::NUdf::TUnboxedValue (NKikimr::NMiniKQL::IComputationNode::*)(NKikimr::NMiniKQL::TComputationContext&) const, std::__y1::placeholders::__ph<1> const&, std::__y1::reference_wrapper<NKikimr::NMiniKQL::TComputationContext> > >(NKikimr::NMiniKQL::IComputationNode* const*, NKikimr::NMiniKQL::IComputationNode* const*, std::__y1::back_insert_iterator<std::__y1::vector<NYql::NUdf::TUnboxedValue, NKikimr::NMiniKQL::TMKQLAllocator<NYql::NUdf::TUnboxedValue, (NKikimr::NMiniKQL::EMemorySubPool)0> > >, std::__y1::__bind<NYql::NUdf::TUnboxedValue (NKikimr::NMiniKQL::+131 (0x110D6113)\n+??+0 (0x110D7B16)\n+??+0 (0x110D6F74)\n+??+0 (0x1183070F)\n+??+0 (0x1182F8BF)\n+??+0 (0xF362217)\n+NYql::TComputationGraphProxy::GetValue()+23 (0xF341777)\n+NYql::NFile::TYtFileGateway::ExecuteResult(NYql::NFile::TSession&, NYson::TYsonWriter&, NYql::NNodes::TExprBase, NYql::TExprContext&, NYql::IYtGateway::TResOrPullOptions&&, TVector<TBasicString<char, std::__y1::char_traits<char> >, std::__y1::allocator<TBasicString<char, std::__y1::char_traits<char> > > > const&) const+1930 (0xF314F4A)\n+NYql::NFile::TYtFileGateway::ResOrPull(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, NYql::TExprContext&, NYql::IYtGateway::TResOrPullOptions&&)+881 (0xF2FF821)\n+??+0 (0xE4DE525)\n+??+0 (0xE4E1B5A)\n+NYql::TExecTransformerBase::CallbackTransform(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&)+1098 (0xE4E5DDA)\n+NYql::TAsyncCallbackTransformer<NYql::TExecTransformerBase>::DoTransform(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&)+37 (0xE4E1215)\n+NYql::TGraphTransformerBase::Transform(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&)+152 (0xB038A78)\n+??+0 (0xC67B620)\n+??+0 (0xC67033F)\n+NYql::TGraphTransformerBase::Transform(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&)+152 (0xB038A78)\n+??+0 (0xC766BCF)\n+??+0 (0xC76B440)\n+??+0 (0xC7666F2)\n+??+0 (0xC76B2DC)\n+??+0 (0xC7666F2)\n+??+0 (0xC76B2DC)\n+??+0 (0xC7666F2)\n+??+0 (0xC7631F4)\n+NYql::TGraphTransformerBase::Transform(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&)+152 (0xB038A78)\n+??+0 (0xB039245)\n+NYql::TGraphTransformerBase::Transform(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&)+152 (0xB038A78)\n+NYql::AsyncTransformStepImpl(NYql::IGraphTransformer&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&, bool, bool, TBasicStringBuf<char, std::__y1::char_traits<char> > const&)+290 (0xB0374E2)\n+NYql::AsyncTransform(NYql::IGraphTransformer&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&, bool)+66 (0xB037E42)\n+NYql::TProgram::AsyncTransformWithFallback(bool)+81 (0xBF7CC71)\n+??+0 (0xBF8E3E0)\n+NYql::TProgram::RunAsync(TBasicString<char, std::__y1::char_traits<char> > const&, IOutputStream*, IOutputStream*, IOutputStream*, bool)+3119 (0xBF7AC3F)\n+??+0 (0xBF77D1A)\n+NYql::TProgram::Run(TBasicString<char, std::__y1::char_traits<char> > const&, IOutputStream*, IOutputStream*, IOutputStream*, bool)+129 (0xBF79FD1)\n+Main(int, char**)+6488 (0x98071A8)\n+main+343 (0x9809B77)\n+??+0 (0x7F665BC29D90)\n+__libc_start_main+128 (0x7F665BC29E40)\n+??+0 (0x979B029)\n __GI___pthread_kill at ./nptl/pthread_kill.c:89:0\n __GI_raise at ../sysdeps/posix/raise.c:26:0\n __GI_abort at ./stdlib/abort.c:79:0\n@@ -8812,22 +8726,22 @@ NKikimr::NMiniKQL::(anonymous namespace)::TJoinDictWrapper<false>::JoinDicts(NKi\n ??? at ???:0:0\n ??? at ???:0:0\n NKikimr::NMiniKQL::TCodegeneratorRootNode<NKikimr::NMiniKQL::TMutableCodegeneratorNode<NKikimr::NMiniKQL::(anonymous namespace)::TListMapWrapper>, true>::GetValue(NKikimr::NMiniKQL::TComputationContext&) const at /-B/ydb/library/yql/minikql/comp_nodes/llvm14/ydb/library/yql/minikql/computation/mkql_computation_node_codegen.h:845:0\n-std::__y1::back_insert_iterator<std::__y1::vector<NYql::NUdf::TUnboxedValue, NKikimr::NMiniKQL::TMKQLAllocator<NYql::NUdf::TUnboxedValue, (NKikimr::NMiniKQL::EMemorySubPool)0> > > std::__y1::transform[abi:v160005]<NKikimr::NMiniKQL::IComputationNode* const*, std::__y1::back_insert_iterator<std::__y1::vector<NYql::NUdf::TUnboxedValue, NKikimr::NMiniKQL::TMKQLAllocator<NYql::NUdf::TUnboxedValue, (NKikimr::NMiniKQL::EMemorySubPool)0> > >, std::__y1::__bind<NYql::NUdf::TUnboxedValue (NKikimr::NMiniKQL::IComputationNode::*)(NKikimr::NMiniKQL::TComputationContext&) const, std::__y1::placeholders::__ph<1> const&, std::__y1::reference_wrapper<NKikimr::NMiniKQL::TComputationContext> > >(NKikimr::NMiniKQL::IComputationNode* const*, NKikimr::NMiniKQL::IComputationNode* const*, std::__y1::back_insert_iterator<std::__y1::vector<NYql::NUdf::TUnboxedValue, NKikimr::NMiniKQL::TMKQLAllocator<NYql::NUdf::TUnboxedValue, (NKikimr::NMiniKQL::EMemorySubPool)0> > >, std::__y1::__bind<NYql::NUdf::TUnboxedValue (NKikimr::NMiniKQL::IComputationNode::*)(NKikimr::NMiniKQL::TComputationContext&) const, std::__y1::placeholders::__ph<1> const&, std::__y1::reference_wrapper<NKikimr::NMiniKQL::TComputationContext> >) at /-S/contrib/libs/cxxsupp/libcxx/include/__algorithm/transform.h:26:0\n+std::__y1::back_insert_iterator<std::__y1::vector<NYql::NUdf::TUnboxedValue, NKikimr::NMiniKQL::TMKQLAllocator<NYql::NUdf::TUnboxedValue, (NKikimr::NMiniKQL::EMemorySubPool)0> > > std::__y1::transform[abi:ue170006]<NKikimr::NMiniKQL::IComputationNode* const*, std::__y1::back_insert_iterator<std::__y1::vector<NYql::NUdf::TUnboxedValue, NKikimr::NMiniKQL::TMKQLAllocator<NYql::NUdf::TUnboxedValue, (NKikimr::NMiniKQL::EMemorySubPool)0> > >, std::__y1::__bind<NYql::NUdf::TUnboxedValue (NKikimr::NMiniKQL::IComputationNode::*)(NKikimr::NMiniKQL::TComputationContext&) const, std::__y1::placeholders::__ph<1> const&, std::__y1::reference_wrapper<NKikimr::NMiniKQL::TComputationContext> > >(NKikimr::NMiniKQL::IComputationNode* const*, NKikimr::NMiniKQL::IComputationNode* const*, std::__y1::back_insert_iterator<std::__y1::vector<NYql::NUdf::TUnboxedValue, NKikimr::NMiniKQL::TMKQLAllocator<NYql::NUdf::TUnboxedValue, (NKikimr::NMiniKQL::EMemorySubPool)0> > >, std::__y1::__bind<NYql::NUdf::TUnboxedValue (NKikimr::NMiniKQL::IComputationNode::*)(NKikimr::NMiniKQL::TComputationContext&) const, std::__y1::placeholders::__ph<1> const&, std::__y1::reference_wrapper<NKikimr::NMiniKQL::TComputationContext> >) at /-S/contrib/libs/cxxsupp/libcxx/include/__algorithm/transform.h:26:0\n NKikimr::NMiniKQL::(anonymous namespace)::TOrderedExtendWrapper<false>::DoCalculate(NKikimr::NMiniKQL::TComputationContext&) const at /-B/ydb/library/yql/minikql/comp_nodes/llvm14/mkql_extend.cpp:540:0\n NKikimr::NMiniKQL::TMutableComputationNode<NKikimr::NMiniKQL::(anonymous namespace)::TOrderedExtendWrapper<false> >::GetValue(NKikimr::NMiniKQL::TComputationContext&) const at /-S/ydb/library/yql/minikql/computation/mkql_computation_node_impl.h:217:0\n NKikimr::NMiniKQL::(anonymous namespace)::TAlgoBaseWrapper<NKikimr::NMiniKQL::(anonymous namespace)::TAlgoWrapper, true>::DoCalculate(NKikimr::NMiniKQL::TComputationContext&) const at /-B/ydb/library/yql/minikql/comp_nodes/llvm14/mkql_sort.cpp:340:0\n NKikimr::NMiniKQL::TMutableComputationNode<NKikimr::NMiniKQL::(anonymous namespace)::TAlgoBaseWrapper<NKikimr::NMiniKQL::(anonymous namespace)::TAlgoWrapper, true> >::GetValue(NKikimr::NMiniKQL::TComputationContext&) const at /-S/ydb/library/yql/minikql/computation/mkql_computation_node_impl.h:214:0\n NKikimr::NMiniKQL::(anonymous namespace)::TComputationGraph::GetValue() at /-B/ydb/library/yql/minikql/computation/llvm14/mkql_computation_node_graph.cpp:623:0\n NYql::TComputationGraphProxy::GetValue() at /-S/ydb/library/yql/providers/yt/lib/lambda_builder/lambda_builder.cpp:116:0\n-NYql::NFile::TYtFileGateway::ExecuteResult(NYql::NFile::TSession&, NYson::TYsonWriter&, NYql::NNodes::TExprBase, NYql::TExprContext&, NYql::IYtGateway::TResOrPullOptions&&, TVector<TBasicString<char, std::__y1::char_traits<char> >, std::__y1::allocator<TBasicString<char, std::__y1::char_traits<char> > > > const&) const at /-S/ydb/library/yql/providers/yt/gateway/file/yql_yt_file.cpp:1198:0\n-NYql::NFile::TYtFileGateway::ResOrPull(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, NYql::TExprContext&, NYql::IYtGateway::TResOrPullOptions&&) at /-S/ydb/library/yql/providers/yt/gateway/file/yql_yt_file.cpp:644:0\n-NYql::(anonymous namespace)::TYtDataSourceExecTransformer::HandleResOrPull(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, NYql::TExprContext&) at /-S/ydb/library/yql/providers/yt/provider/yql_yt_datasource_exec.cpp:181:0\n-std::__y1::__function::__func<std::__y1::function<std::__y1::pair<NYql::IGraphTransformer::TStatus, NThreading::TFuture<std::__y1::function<NYql::IGraphTransformer::TStatus (TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&)> > > (TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&)> NYql::TExecTransformerBase::Hndl<NYql::(anonymous namespace)::TYtDataSourceExecTransformer>(std::__y1::pair<NYql::IGraphTransformer::TStatus, NThreading::TFuture<std::__y1::function<NYql::IGraphTransformer::TStatus (TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&)> > > (NYql::(anonymous namespace)::TYtDataSourceExecTransformer::*)(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, NYql::TExprContext&))::'lambda'(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&), std::__y1::allocator<std::__y1::function<std::__y1::pair<NYql::IGraphTransformer::TStatus, NThreading::TFuture<std::__y1::function<NYql::IGraphTransformer::TStatus (TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&)> > > (TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&)> NYql::TExecTransformerBase::Hndl<NYql::(anonymous namespace)::TYtDataSourceExecTransformer>(std::__y1::pair<NYql::IGraphTransformer::TStatus, NThreading::TFuture<std::__y1::function<NYql::IGraphTransformer::TStatus (TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&)> > > (NYql::(anonymous namespace)::TYtDataSourceExecTransformer::*)(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, NYql::TExprContext&))::'lambda'(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&)>, std::__y1::pair<NYql::IGraphTransformer::TStatus, NThreading::TFuture<std::__y1::function<NYql::IGraphTransformer::TStatus (TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&)> > > (TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&)>::operator()(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&) at /-S/contrib/libs/cxxsupp/libcxx/include/__functional/function.h:356:0\n-NYql::TExecTransformerBase::CallbackTransform(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&) at /-S/ydb/library/yql/providers/common/transform/yql_exec.cpp:27:0\n-NYql::TAsyncCallbackTransformer<NYql::TExecTransformerBase>::DoTransform(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&) at /-S/ydb/library/yql/core/yql_graph_transformer.h:332:0\n+NYql::NFile::TYtFileGateway::ExecuteResult(NYql::NFile::TSession&, NYson::TYsonWriter&, NYql::NNodes::TExprBase, NYql::TExprContext&, NYql::IYtGateway::TResOrPullOptions&&, TVector<TBasicString<char, std::__y1::char_traits<char> >, std::__y1::allocator<TBasicString<char, std::__y1::char_traits<char> > > > const&) const at /home/marsaly/ydbwork/ydb/ydb/library/yql/providers/yt/gateway/file/yql_yt_file.cpp:1201:0\n+NYql::NFile::TYtFileGateway::ResOrPull(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, NYql::TExprContext&, NYql::IYtGateway::TResOrPullOptions&&) at /home/marsaly/ydbwork/ydb/ydb/library/yql/providers/yt/gateway/file/yql_yt_file.cpp:644:0\n+NYql::(anonymous namespace)::TYtDataSourceExecTransformer::HandleResOrPull(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, NYql::TExprContext&) at /home/marsaly/ydbwork/ydb/ydb/library/yql/providers/yt/provider/yql_yt_datasource_exec.cpp:181:0\n+std::__y1::__function::__func<std::__y1::function<std::__y1::pair<NYql::IGraphTransformer::TStatus, NThreading::TFuture<std::__y1::function<NYql::IGraphTransformer::TStatus (TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&)> > > (TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&)> NYql::TExecTransformerBase::Hndl<NYql::(anonymous namespace)::TYtDataSourceExecTransformer>(std::__y1::pair<NYql::IGraphTransformer::TStatus, NThreading::TFuture<std::__y1::function<NYql::IGraphTransformer::TStatus (TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&)> > > (NYql::(anonymous namespace)::TYtDataSourceExecTransformer::*)(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, NYql::TExprContext&))::'lambda'(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&), std::__y1::allocator<std::__y1::function<std::__y1::pair<NYql::IGraphTransformer::TStatus, NThreading::TFuture<std::__y1::function<NYql::IGraphTransformer::TStatus (TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&)> > > (TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&)> NYql::TExecTransformerBase::Hndl<NYql::(anonymous namespace)::TYtDataSourceExecTransformer>(std::__y1::pair<NYql::IGraphTransformer::TStatus, NThreading::TFuture<std::__y1::function<NYql::IGraphTransformer::TStatus (TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&)> > > (NYql::(anonymous namespace)::TYtDataSourceExecTransformer::*)(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, NYql::TExprContext&))::'lambda'(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&)>, std::__y1::pair<NYql::IGraphTransformer::TStatus, NThreading::TFuture<std::__y1::function<NYql::IGraphTransformer::TStatus (TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&)> > > (TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&)>::operator()(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&) at /home/marsaly/ydbwork/ydb/contrib/libs/cxxsupp/libcxx/include/__functional/function.h:363:0\n+NYql::TExecTransformerBase::CallbackTransform(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&) at /home/marsaly/ydbwork/ydb/ydb/library/yql/providers/common/transform/yql_exec.cpp:27:0\n+NYql::TAsyncCallbackTransformer<NYql::TExecTransformerBase>::DoTransform(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&) at /home/marsaly/ydbwork/ydb/ydb/library/yql/core/yql_graph_transformer.h:332:0\n NYql::TGraphTransformerBase::Transform(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&) at /-S/ydb/library/yql/core/yql_graph_transformer.h:160:0\n-NYql::IGraphTransformer::TStatus NYql::(anonymous namespace)::TResultCallableExecutionTransformer::HandleFillOrPull<NYql::NNodes::NGenerated::TResultStub<NYql::NNodes::TExprBase, NYql::NNodes::NGenerated::TResOrPullBaseStub<NYql::NNodes::TExprBase, NYql::NNodes::TCallable, NYql::NNodes::TCoAtom, NYql::NNodes::NGenerated::TCoNameValueTupleListStub<NYql::NNodes::TExprBase, NYql::NNodes::TListBase, NYql::NNodes::NGenerated::TCoNameValueTupleStub<NYql::NNodes::TExprBase, NYql::NNodes::TCoAtom> > > > >(NYql::NNodes::TExprBase, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&, NYql::IDataProvider&) at /-S/ydb/library/yql/providers/result/provider/yql_result_provider.cpp:609:0\n-NYql::(anonymous namespace)::TResultCallableExecutionTransformer::DoTransform(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&) at /-S/ydb/library/yql/providers/result/provider/yql_result_provider.cpp:248:0\n+NYql::IGraphTransformer::TStatus NYql::(anonymous namespace)::TResultCallableExecutionTransformer::HandleFillOrPull<NYql::NNodes::NGenerated::TResultStub<NYql::NNodes::TExprBase, NYql::NNodes::NGenerated::TResOrPullBaseStub<NYql::NNodes::TExprBase, NYql::NNodes::TCallable, NYql::NNodes::TCoAtom, NYql::NNodes::NGenerated::TCoNameValueTupleListStub<NYql::NNodes::TExprBase, NYql::NNodes::TListBase, NYql::NNodes::NGenerated::TCoNameValueTupleStub<NYql::NNodes::TExprBase, NYql::NNodes::TCoAtom> > > > >(NYql::NNodes::TExprBase, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&, NYql::IDataProvider&) at /home/marsaly/ydbwork/ydb/ydb/library/yql/providers/result/provider/yql_result_provider.cpp:609:0\n+NYql::(anonymous namespace)::TResultCallableExecutionTransformer::DoTransform(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&) at /home/marsaly/ydbwork/ydb/ydb/library/yql/providers/result/provider/yql_result_provider.cpp:248:0\n NYql::TGraphTransformerBase::Transform(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&) at /-S/ydb/library/yql/core/yql_graph_transformer.h:160:0\n NYql::(anonymous namespace)::TExecutionTransformer::ExecuteNode(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&, unsigned int) at /-S/ydb/library/yql/core/yql_execution.cpp:274:0\n NYql::(anonymous namespace)::TExecutionTransformer::ExecuteChildren(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> > const&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&, unsigned int) at /-S/ydb/library/yql/core/yql_execution.cpp:340:0\n@@ -8842,11 +8756,11 @@ NYql::(anonymous namespace)::TCompositeGraphTransformer::DoTransform(TIntrusiveP\n NYql::TGraphTransformerBase::Transform(TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&) at /-S/ydb/library/yql/core/yql_graph_transformer.h:160:0\n NYql::AsyncTransformStepImpl(NYql::IGraphTransformer&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&, bool, bool, TBasicStringBuf<char, std::__y1::char_traits<char> > const&) at /-S/ydb/library/yql/core/yql_graph_transformer.cpp:312:0\n NYql::AsyncTransform(NYql::IGraphTransformer&, TIntrusivePtr<NYql::TExprNode, TDefaultIntrusivePtrOps<NYql::TExprNode> >&, NYql::TExprContext&, bool) at /-S/ydb/library/yql/core/yql_graph_transformer.cpp:364:0\n-NYql::TProgram::AsyncTransformWithFallback(bool) at /-S/ydb/library/yql/core/facade/yql_facade.cpp:1149:0\n-NThreading::TFuture<NThreading::NImpl::TFutureType<NThreading::NImpl::TFutureCallResult<NYql::TProgram::RunAsync(TBasicString<char, std::__y1::char_traits<char> > const&, IOutputStream*, IOutputStream*, IOutputStream*, bool)::$_0, void>::TType>::TType> NThreading::TFuture<void>::Apply<NYql::TProgram::RunAsync(TBasicString<char, std::__y1::char_traits<char> > const&, IOutputStream*, IOutputStream*, IOutputStream*, bool)::$_0>(NYql::TProgram::RunAsync(TBasicString<char, std::__y1::char_traits<char> > const&, IOutputStream*, IOutputStream*, IOutputStream*, bool)::$_0&&) const::'lambda'(NThreading::TFuture<void> const&)::operator()(NThreading::TFuture<void> const&) at /-S/library/cpp/threading/future/core/future-inl.h:726:0\n-NYql::TProgram::RunAsync(TBasicString<char, std::__y1::char_traits<char> > const&, IOutputStream*, IOutputStream*, IOutputStream*, bool) at /-S/ydb/library/yql/core/facade/yql_facade.cpp:1014:0\n-NYql::IGraphTransformer::TStatus NYql::(anonymous namespace)::SyncExecution<TBasicString<char, std::__y1::char_traits<char> > const&, IOutputStream*, IOutputStream*, IOutputStream*, bool, TBasicString<char, std::__y1::char_traits<char> > const&, IOutputStream*&, IOutputStream*&, IOutputStream*&, bool&>(NYql::TProgram*, NThreading::TFuture<NYql::IGraphTransformer::TStatus> (NYql::TProgram::*)(TBasicString<char, std::__y1::char_traits<char> > const&, IOutputStream*, IOutputStream*, IOutputStream*, bool), TBasicString<char, std::__y1::char_traits<char> > const&, IOutputStream*&, IOutputStream*&, IOutputStream*&, bool&) at /-S/ydb/library/yql/core/facade/yql_facade.cpp:69:0\n-NYql::TProgram::Run(TBasicString<char, std::__y1::char_traits<char> > const&, IOutputStream*, IOutputStream*, IOutputStream*, bool) at /-S/ydb/library/yql/core/facade/yql_facade.cpp:949:0\n+NYql::TProgram::AsyncTransformWithFallback(bool) at /home/marsaly/ydbwork/ydb/ydb/library/yql/core/facade/yql_facade.cpp:1153:0\n+NThreading::TFuture<NThreading::NImpl::TFutureType<NThreading::NImpl::TFutureCallResult<NYql::TProgram::RunAsync(TBasicString<char, std::__y1::char_traits<char> > const&, IOutputStream*, IOutputStream*, IOutputStream*, bool)::$_0, void>::TType>::TType> NThreading::TFuture<void>::Apply<NYql::TProgram::RunAsync(TBasicString<char, std::__y1::char_traits<char> > const&, IOutputStream*, IOutputStream*, IOutputStream*, bool)::$_0>(NYql::TProgram::RunAsync(TBasicString<char, std::__y1::char_traits<char> > const&, IOutputStream*, IOutputStream*, IOutputStream*, bool)::$_0&&) const::'lambda'(NThreading::TFuture<void> const&)::operator()(NThreading::TFuture<void> const&) at /home/marsaly/ydbwork/ydb/library/cpp/threading/future/core/future-inl.h:726:0\n+NYql::TProgram::RunAsync(TBasicString<char, std::__y1::char_traits<char> > const&, IOutputStream*, IOutputStream*, IOutputStream*, bool) at /home/marsaly/ydbwork/ydb/ydb/library/yql/core/facade/yql_facade.cpp:1018:0\n+NYql::IGraphTransformer::TStatus NYql::(anonymous namespace)::SyncExecution<TBasicString<char, std::__y1::char_traits<char> > const&, IOutputStream*, IOutputStream*, IOutputStream*, bool, TBasicString<char, std::__y1::char_traits<char> > const&, IOutputStream*&, IOutputStream*&, IOutputStream*&, bool&>(NYql::TProgram*, NThreading::TFuture<NYql::IGraphTransformer::TStatus> (NYql::TProgram::*)(TBasicString<char, std::__y1::char_traits<char> > const&, IOutputStream*, IOutputStream*, IOutputStream*, bool), TBasicString<char, std::__y1::char_traits<char> > const&, IOutputStream*&, IOutputStream*&, IOutputStream*&, bool&) at /home/marsaly/ydbwork/ydb/ydb/library/yql/core/facade/yql_facade.cpp:69:0\n+NYql::TProgram::Run(TBasicString<char, std::__y1::char_traits<char> > const&, IOutputStream*, IOutputStream*, IOutputStream*, bool) at /home/marsaly/ydbwork/ydb/ydb/library/yql/core/facade/yql_facade.cpp:953:0\n Main(int, char**) at /home/marsaly/ydbwork/ydb/ydb/library/yql/tools/pgrun/pgrun.cpp:1301:0\n main at /home/marsaly/ydbwork/ydb/ydb/library/yql/tools/pgrun/pgrun.cpp:1341:0\n __libc_start_call_main at ../sysdeps/nptl/libc_start_call_main.h:58:0\ndiff --git a/ydb/library/yql/tests/postgresql/cases/strings.err b/ydb/library/yql/tests/postgresql/cases/strings.err\nindex 1bf6598f59b1..fbce7eb2daa3 100644\n--- a/ydb/library/yql/tests/postgresql/cases/strings.err\n+++ b/ydb/library/yql/tests/postgresql/cases/strings.err\n@@ -994,31 +994,9 @@ SELECT 'indio' NOT LIKE 'in_o' AS \"true\";\n <sql-statement>\n SELECT 'abc'::name LIKE '_b_' AS \"true\";\n </sql-statement>\n--stdin-:<main>: Error: Type annotation\n-\n-    -stdin-:<main>:1:1: Error: At function: RemovePrefixMembers, At function: PgSelect, At function: PgSetItem, At function: PgResultItem\n-    \tSELECT 'abc'::name LIKE '_b_' AS \"true\";\n-\t^\n-        -stdin-:<main>:1:20: Error: At function: PgLike\n-        \tSELECT 'abc'::name LIKE '_b_' AS \"true\";\n-\t                   ^\n-            -stdin-:<main>:1:20: Error: Expected pg text, but got name\n-            \tSELECT 'abc'::name LIKE '_b_' AS \"true\";\n-\t                   ^\n <sql-statement>\n SELECT 'abc'::name NOT LIKE '_b_' AS \"false\";\n </sql-statement>\n--stdin-:<main>: Error: Type annotation\n-\n-    -stdin-:<main>:1:1: Error: At function: RemovePrefixMembers, At function: PgSelect, At function: PgSetItem, At function: PgResultItem\n-    \tSELECT 'abc'::name NOT LIKE '_b_' AS \"false\";\n-\t^\n-        -stdin-:<main>:1:20: Error: At function: PgNot, At function: PgLike\n-        \tSELECT 'abc'::name NOT LIKE '_b_' AS \"false\";\n-\t                   ^\n-            -stdin-:<main>:1:20: Error: Expected pg text, but got name\n-            \tSELECT 'abc'::name NOT LIKE '_b_' AS \"false\";\n-\t                   ^\n <sql-statement>\n SELECT 'abc'::bytea LIKE '_b_'::bytea AS \"true\";\n </sql-statement>\n@@ -1200,31 +1178,9 @@ SELECT 'Hawkeye' NOT ILIKE 'h%' AS \"false\";\n <sql-statement>\n SELECT 'ABC'::name ILIKE '_b_' AS \"true\";\n </sql-statement>\n--stdin-:<main>: Error: Type annotation\n-\n-    -stdin-:<main>:1:1: Error: At function: RemovePrefixMembers, At function: PgSelect, At function: PgSetItem, At function: PgResultItem\n-    \tSELECT 'ABC'::name ILIKE '_b_' AS \"true\";\n-\t^\n-        -stdin-:<main>:1:20: Error: At function: PgILike\n-        \tSELECT 'ABC'::name ILIKE '_b_' AS \"true\";\n-\t                   ^\n-            -stdin-:<main>:1:20: Error: Expected pg text, but got name\n-            \tSELECT 'ABC'::name ILIKE '_b_' AS \"true\";\n-\t                   ^\n <sql-statement>\n SELECT 'ABC'::name NOT ILIKE '_b_' AS \"false\";\n </sql-statement>\n--stdin-:<main>: Error: Type annotation\n-\n-    -stdin-:<main>:1:1: Error: At function: RemovePrefixMembers, At function: PgSelect, At function: PgSetItem, At function: PgResultItem\n-    \tSELECT 'ABC'::name NOT ILIKE '_b_' AS \"false\";\n-\t^\n-        -stdin-:<main>:1:20: Error: At function: PgNot, At function: PgILike\n-        \tSELECT 'ABC'::name NOT ILIKE '_b_' AS \"false\";\n-\t                   ^\n-            -stdin-:<main>:1:20: Error: Expected pg text, but got name\n-            \tSELECT 'ABC'::name NOT ILIKE '_b_' AS \"false\";\n-\t                   ^\n <sql-statement>\n --\n -- test %/_ combination cases, cf bugs #4821 and #5478\ndiff --git a/ydb/library/yql/tests/postgresql/cases/strings.out b/ydb/library/yql/tests/postgresql/cases/strings.out\nindex 8af8f5476c78..35d85bc0147d 100644\n--- a/ydb/library/yql/tests/postgresql/cases/strings.out\n+++ b/ydb/library/yql/tests/postgresql/cases/strings.out\n@@ -765,6 +765,18 @@ SELECT 'indio' NOT LIKE 'in_o' AS \"true\";\n  t\n (1 row)\n \n+SELECT 'abc'::name LIKE '_b_' AS \"true\";\n+ true \n+------\n+ t\n+(1 row)\n+\n+SELECT 'abc'::name NOT LIKE '_b_' AS \"false\";\n+ false \n+-------\n+ f\n+(1 row)\n+\n -- unused escape character\n SELECT 'hawkeye' LIKE 'h%' ESCAPE '#' AS \"true\";\n  true \n@@ -890,6 +902,18 @@ SELECT 'Hawkeye' NOT ILIKE 'h%' AS \"false\";\n  f\n (1 row)\n \n+SELECT 'ABC'::name ILIKE '_b_' AS \"true\";\n+ true \n+------\n+ t\n+(1 row)\n+\n+SELECT 'ABC'::name NOT ILIKE '_b_' AS \"false\";\n+ false \n+-------\n+ f\n+(1 row)\n+\n SELECT 'jack' LIKE '%____%' AS t;\n  t \n ---\ndiff --git a/ydb/library/yql/tests/postgresql/cases/strings.sql b/ydb/library/yql/tests/postgresql/cases/strings.sql\nindex 1363058ea15f..232343f65299 100644\n--- a/ydb/library/yql/tests/postgresql/cases/strings.sql\n+++ b/ydb/library/yql/tests/postgresql/cases/strings.sql\n@@ -167,6 +167,8 @@ SELECT 'indio' LIKE 'in__o' AS \"true\";\n SELECT 'indio' NOT LIKE 'in__o' AS \"false\";\n SELECT 'indio' LIKE 'in_o' AS \"false\";\n SELECT 'indio' NOT LIKE 'in_o' AS \"true\";\n+SELECT 'abc'::name LIKE '_b_' AS \"true\";\n+SELECT 'abc'::name NOT LIKE '_b_' AS \"false\";\n -- unused escape character\n SELECT 'hawkeye' LIKE 'h%' ESCAPE '#' AS \"true\";\n SELECT 'hawkeye' NOT LIKE 'h%' ESCAPE '#' AS \"false\";\n@@ -192,6 +194,8 @@ SELECT 'hawkeye' ILIKE 'H%Eye' AS \"true\";\n SELECT 'hawkeye' NOT ILIKE 'H%Eye' AS \"false\";\n SELECT 'Hawkeye' ILIKE 'h%' AS \"true\";\n SELECT 'Hawkeye' NOT ILIKE 'h%' AS \"false\";\n+SELECT 'ABC'::name ILIKE '_b_' AS \"true\";\n+SELECT 'ABC'::name NOT ILIKE '_b_' AS \"false\";\n SELECT 'jack' LIKE '%____%' AS t;\n --\n -- basic tests of LIKE with indexes\ndiff --git a/ydb/library/yql/tests/postgresql/cases/uuid.err b/ydb/library/yql/tests/postgresql/cases/uuid.err\nindex 6aa92ec8b8e3..1e3d24f91aa6 100644\n--- a/ydb/library/yql/tests/postgresql/cases/uuid.err\n+++ b/ydb/library/yql/tests/postgresql/cases/uuid.err\n@@ -160,25 +160,6 @@ INSERT INTO guid1(guid_field) VALUES('11111111-1111-1111-1111-111111111111');\n -- check to see whether the new indexes are actually there\n SELECT count(*) FROM pg_class WHERE relkind='i' AND relname LIKE 'guid%';\n </sql-statement>\n--stdin-:<main>: Error: Type annotation\n-\n-    -stdin-:<main>:1:1: Error: At function: RemovePrefixMembers, At function: PgSelect\n-    \t-- check to see whether the new indexes are actually there\n-\t^\n-        -stdin-:<main>: Error: At function: PgSetItem\n-        \n-            -stdin-:<main>:1:1: Error: At function: PgWhere\n-            \t-- check to see whether the new indexes are actually there\n-\t^\n-                -stdin-:<main>:2:49: Error: At function: PgAnd\n-                \tSELECT count(*) FROM pg_class WHERE relkind='i' AND relname LIKE 'guid%';\n-\t                                                ^\n-                    -stdin-:<main>:2:61: Error: At function: PgLike\n-                    \tSELECT count(*) FROM pg_class WHERE relkind='i' AND relname LIKE 'guid%';\n-\t                                                            ^\n-                        -stdin-:<main>:2:61: Error: Expected pg text, but got name\n-                        \tSELECT count(*) FROM pg_class WHERE relkind='i' AND relname LIKE 'guid%';\n-\t                                                            ^\n <sql-statement>\n -- populating the test tables with additional records\n INSERT INTO guid1(guid_field) VALUES('44444444-4444-4444-4444-444444444444');\ndiff --git a/ydb/library/yql/tests/postgresql/cases/xml.err b/ydb/library/yql/tests/postgresql/cases/xml.err\nindex feccb0fe7475..b311f609959a 100644\n--- a/ydb/library/yql/tests/postgresql/cases/xml.err\n+++ b/ydb/library/yql/tests/postgresql/cases/xml.err\n@@ -899,22 +899,6 @@ CREATE VIEW xmlview9 AS SELECT xmlserialize(content 'good' as text);\n SELECT table_name, view_definition FROM information_schema.views\n   WHERE table_name LIKE 'xmlview%' ORDER BY 1;\n </sql-statement>\n--stdin-:<main>: Error: Type annotation\n-\n-    -stdin-:<main>:1:1: Error: At function: RemovePrefixMembers, At function: PgSelect\n-    \tSELECT table_name, view_definition FROM information_schema.views\n-\t^\n-        -stdin-:<main>: Error: At function: PgSetItem\n-        \n-            -stdin-:<main>:1:1: Error: At function: PgWhere\n-            \tSELECT table_name, view_definition FROM information_schema.views\n-\t^\n-                -stdin-:<main>:2:20: Error: At function: PgLike\n-                \t  WHERE table_name LIKE 'xmlview%' ORDER BY 1;\n-\t                   ^\n-                    -stdin-:<main>:2:20: Error: Expected pg text, but got name\n-                    \t  WHERE table_name LIKE 'xmlview%' ORDER BY 1;\n-\t                   ^\n <sql-statement>\n -- Text XPath expressions evaluation\n SELECT xpath('/value', data) FROM xmltest;\ndiff --git a/ydb/library/yql/tests/postgresql/cases/xml.err.1 b/ydb/library/yql/tests/postgresql/cases/xml.err.1\nindex feccb0fe7475..b311f609959a 100644\n--- a/ydb/library/yql/tests/postgresql/cases/xml.err.1\n+++ b/ydb/library/yql/tests/postgresql/cases/xml.err.1\n@@ -899,22 +899,6 @@ CREATE VIEW xmlview9 AS SELECT xmlserialize(content 'good' as text);\n SELECT table_name, view_definition FROM information_schema.views\n   WHERE table_name LIKE 'xmlview%' ORDER BY 1;\n </sql-statement>\n--stdin-:<main>: Error: Type annotation\n-\n-    -stdin-:<main>:1:1: Error: At function: RemovePrefixMembers, At function: PgSelect\n-    \tSELECT table_name, view_definition FROM information_schema.views\n-\t^\n-        -stdin-:<main>: Error: At function: PgSetItem\n-        \n-            -stdin-:<main>:1:1: Error: At function: PgWhere\n-            \tSELECT table_name, view_definition FROM information_schema.views\n-\t^\n-                -stdin-:<main>:2:20: Error: At function: PgLike\n-                \t  WHERE table_name LIKE 'xmlview%' ORDER BY 1;\n-\t                   ^\n-                    -stdin-:<main>:2:20: Error: Expected pg text, but got name\n-                    \t  WHERE table_name LIKE 'xmlview%' ORDER BY 1;\n-\t                   ^\n <sql-statement>\n -- Text XPath expressions evaluation\n SELECT xpath('/value', data) FROM xmltest;\ndiff --git a/ydb/library/yql/tests/postgresql/cases/xml.err.2 b/ydb/library/yql/tests/postgresql/cases/xml.err.2\nindex feccb0fe7475..b311f609959a 100644\n--- a/ydb/library/yql/tests/postgresql/cases/xml.err.2\n+++ b/ydb/library/yql/tests/postgresql/cases/xml.err.2\n@@ -899,22 +899,6 @@ CREATE VIEW xmlview9 AS SELECT xmlserialize(content 'good' as text);\n SELECT table_name, view_definition FROM information_schema.views\n   WHERE table_name LIKE 'xmlview%' ORDER BY 1;\n </sql-statement>\n--stdin-:<main>: Error: Type annotation\n-\n-    -stdin-:<main>:1:1: Error: At function: RemovePrefixMembers, At function: PgSelect\n-    \tSELECT table_name, view_definition FROM information_schema.views\n-\t^\n-        -stdin-:<main>: Error: At function: PgSetItem\n-        \n-            -stdin-:<main>:1:1: Error: At function: PgWhere\n-            \tSELECT table_name, view_definition FROM information_schema.views\n-\t^\n-                -stdin-:<main>:2:20: Error: At function: PgLike\n-                \t  WHERE table_name LIKE 'xmlview%' ORDER BY 1;\n-\t                   ^\n-                    -stdin-:<main>:2:20: Error: Expected pg text, but got name\n-                    \t  WHERE table_name LIKE 'xmlview%' ORDER BY 1;\n-\t                   ^\n <sql-statement>\n -- Text XPath expressions evaluation\n SELECT xpath('/value', data) FROM xmltest;\ndiff --git a/ydb/library/yql/tests/postgresql/pg_tests.csv b/ydb/library/yql/tests/postgresql/pg_tests.csv\nindex 02d1a2bfb5c7..9325385be5ec 100644\n--- a/ydb/library/yql/tests/postgresql/pg_tests.csv\n+++ b/ydb/library/yql/tests/postgresql/pg_tests.csv\n@@ -40,7 +40,7 @@ select_distinct_on,4,1,25.0\n select_having,23,19,82.61\r\n select_implicit,44,28,63.64\r\n select_into,67,3,4.48\r\n-strings,390,296,75.9\r\n+strings,390,300,76.92\r\n subselect,234,107,45.73\r\n text,76,16,21.05\r\n time,39,29,74.36\r\ndiff --git a/ydb/library/yql/tests/postgresql/status.md b/ydb/library/yql/tests/postgresql/status.md\nindex 8a4b832ea9c2..865f05d3cf38 100644\n--- a/ydb/library/yql/tests/postgresql/status.md\n+++ b/ydb/library/yql/tests/postgresql/status.md\n@@ -16,7 +16,7 @@\n || 12 | bit | 115 | 90 | 78.26 | 18.02.2024 | YQL-17634 ||\n || 13 | numeric | 915 | 813 (+343) | 88.85 | 18.02.2024 | YQL-17629 ||\n || 14 | uuid | 36 | 29 (+29) | 80.56 | 07.03.2024 | YQL-17636 ||\n-|| 15 | strings | 390 | 296 (+192) | 75.9 | 22.02.2024 | YQL-17587 ||\n+|| 15 | strings | 390 | 300 (+4) | 76.92 | 07.03.2024 | YQL-17587 ||\n || 16 | numerology | 24 | 16 (+8) | 66.67 | 22.02.2024 | YQL-17926 ||\n || 17 | date | 264 | 207 (+5) | 78.41 | 07.03.2024 | YQL-17733 ||\n || 18 | time | 39 | 29 | 74.36 | 30.01.2024 | YQL-17738 ||\ndiff --git a/ydb/library/yql/tests/postgresql/status.old b/ydb/library/yql/tests/postgresql/status.old\nindex cda2a7314b3f..8a4b832ea9c2 100644\n--- a/ydb/library/yql/tests/postgresql/status.old\n+++ b/ydb/library/yql/tests/postgresql/status.old\n@@ -12,49 +12,49 @@\n || 8 | int8 | 142 | 127 (+1) | 89.44 | 22.02.2024 | YQL-17614 ||\n || 9 | oid | 27 | 27 (+6) | 100.0 | 22.01.2024 | YQL-17623 ||\n || 10 | float4 | 96 | 82 (+2) | 85.42 | 26.01.2024 | YQL-17586 ||\n-|| 11 | float8 | 168 | 139 | 82.74 | 18.02.2024 | YQL-17628 ||\n+|| 11 | float8 | 168 | 140 (+1) | 83.33 | 07.03.2024 | YQL-17628 ||\n || 12 | bit | 115 | 90 | 78.26 | 18.02.2024 | YQL-17634 ||\n || 13 | numeric | 915 | 813 (+343) | 88.85 | 18.02.2024 | YQL-17629 ||\n-|| 14 | uuid | 36 | 0 | 0.0 | 02.05.2023 | YQL-17636 ||\n+|| 14 | uuid | 36 | 29 (+29) | 80.56 | 07.03.2024 | YQL-17636 ||\n || 15 | strings | 390 | 296 (+192) | 75.9 | 22.02.2024 | YQL-17587 ||\n || 16 | numerology | 24 | 16 (+8) | 66.67 | 22.02.2024 | YQL-17926 ||\n-|| 17 | date | 264 | 202 | 76.52 | 18.02.2024 | YQL-17733 ||\n+|| 17 | date | 264 | 207 (+5) | 78.41 | 07.03.2024 | YQL-17733 ||\n || 18 | time | 39 | 29 | 74.36 | 30.01.2024 | YQL-17738 ||\n || 19 | timetz | 45 | 19 | 42.22 | 30.01.2024 | YQL-17739 ||\n-|| 20 | timestamp | 145 | 86 | 59.31 | 18.02.2024 | YQL-17692 ||\n-|| 21 | timestamptz | 315 | 97 | 30.79 | 30.01.2024 | YQL-17693 ||\n-|| 22 | interval | 168 | 115 | 68.45 | 25.10.2023 | YQL-17786 ||\n-|| 23 | horology | 306 | 79 | 25.82 | 10.08.2023 | YQL-17856 ||\n+|| 20 | timestamp | 145 | 88 (+2) | 60.69 | 07.03.2024 | YQL-17692 ||\n+|| 21 | timestamptz | 315 | 99 (+2) | 31.43 | 07.03.2024 | YQL-17693 ||\n+|| 22 | interval | 168 | 118 (+3) | 70.24 | 07.03.2024 | YQL-17786 ||\n+|| 23 | horology | 306 | 94 (+15) | 30.72 | 07.03.2024 | YQL-17856 ||\n || 24 | comments | 7 | 7 | 100.0 | 25.05.2023 |  ||\n-|| 25 | expressions | 63 | 14 | 22.22 | 25.10.2023 | YQL-17784 ||\n+|| 25 | expressions | 63 | 18 (+4) | 28.57 | 07.03.2024 | YQL-17784 ||\n || 26 | unicode | 13 | 4 | 30.77 | 10.08.2023 | ||\n || 27 | create_table | 368 | 48 (+5) | 13.04 | 22.02.2024 | YQL-17664 ||\n || 28 | insert | 357 | 15 | 4.2 | 12.12.2023 | YQL-17785 ||\n-|| 29 | create_misc | 76 | 3 | 3.95 | 29.09.2023 | YQL-17855 ||\n-|| 30 | select | 88 | 9 | 10.23 | 12.12.2023 | YQL-17858 ||\n+|| 29 | create_misc | 76 | 9 (+6) | 11.84 | 07.03.2024 | YQL-17855 ||\n+|| 30 | select | 88 | 27 (+18) | 30.68 | 07.03.2024 | YQL-17858 ||\n || 31 | select_into | 67 | 3 | 4.48 | 27.07.2023 | YQL-17787 ||\n || 32 | select_distinct | 46 | 1 | 2.17 | 27.07.2023 | YQL-17857 ||\n-|| 33 | select_distinct_on | 4 | 0 | 0.0 | 25.05.2023 | YQL-17925 ||\n+|| 33 | select_distinct_on | 4 | 1 (+1) | 25.0 | 07.03.2024 | YQL-17925 ||\n || 34 | select_implicit | 44 | 28 (+15) | 63.64 | 30.01.2024 | YQL-17737 ||\n || 35 | select_having | 23 | 19 (+3) | 82.61 | 30.01.2024 | YQL-17736 ||\n-|| 36 | subselect | 234 | 97 (+92) | 41.45 | 22.02.2024 | YQL-17589 ||\n-|| 37 | union | 186 | 40 (+40) | 21.51 | 22.02.2024 | YQL-17590 ||\n+|| 36 | subselect | 234 | 107 (+10) | 45.73 | 07.03.2024 | YQL-17589 ||\n+|| 37 | union | 186 | 62 (+22) | 33.33 | 07.03.2024 | YQL-17590 ||\n || 38 | case | 63 | 35 (+5) | 55.56 | 18.02.2024 | YQL-17732 ||\n-|| 39 | join | 591 | 134 (+20) | 22.67 | 18.02.2024 | YQL-17687 ||\n-|| 40 | aggregates | 416 | 85 (+1) | 20.43 | 22.02.2024 | YQL-17627 ||\n-|| 41 | arrays | 410 | 117 (+9) | 28.54 | 22.02.2024 | YQL-17707 ||\n+|| 39 | join | 591 | 200 (+66) | 33.84 | 07.03.2024 | YQL-17687 ||\n+|| 40 | aggregates | 416 | 104 (+19) | 25.0 | 07.03.2024 | YQL-17627 ||\n+|| 41 | arrays | 410 | 120 (+3) | 29.27 | 07.03.2024 | YQL-17707 ||\n || 42 | update | 288 | 23 (+1) | 7.99 | 30.01.2024 | YQL-17685 ||\n || 43 | delete | 10 | 5 (+5) | 50.0 | 27.01.2024 | YQL-17585 ||\n || 44 | dbsize | 24 | 20 | 83.33 | 18.02.2024 | ||\n-|| 45 | window | 298 | 5 | 1.68 | 12.12.2023 | YQL-17592 ||\n+|| 45 | window | 298 | 61 (+56) | 20.47 | 07.03.2024 | YQL-17592 ||\n || 46 | functional_deps | 40 | 7 (+1) | 17.5 | 19.01.2024 | ||\n-|| 47 | json | 450 | 135 (+2) | 30.0 | 22.02.2024 | YQL-17734 ||\n+|| 47 | json | 450 | 139 (+4) | 30.89 | 07.03.2024 | YQL-17734 ||\n || 48 | jsonb | 1013 | 404 (+3) | 39.88 | 18.02.2024 | YQL-17735 ||\n || 49 | json_encoding | 42 | 42 | 100.0 | 29.05.2023 | ||\n || 50 | jsonpath | 169 | 152 | 89.94 | 29.05.2023 | \u0447\u0438\u0441\u043b\u0430 \u0441 \u0442\u043e\u0447\u043a\u043e\u0439 \u0431\u0435\u0437 \u0446\u0435\u043b\u043e\u0439 \u0447\u0430\u0441\u0442\u0438 (\u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 .1), \u043b\u0438\u0442\u0435\u0440\u0430\u043b '00' ||\n || 51 | jsonpath_encoding | 31 | 31 | 100.0 | 29.05.2023 | ||\n || 52 | jsonb_jsonpath | 427 | 88 | 20.61 | 12.12.2023 | ||\n-|| 53 | limit | 84 | 5 | 5.95 | 10.08.2023 | YQL-17783 ||\n+|| 53 | limit | 84 | 18 (+13) | 21.43 | 07.03.2024 | YQL-17783 ||\n || 54 | truncate | 193 | 41 (+5) | 21.24 | 18.02.2024 | YQL-17740 ||\n || 55 | alter_table | 1679 | 233 (+222) | 13.88 | 18.02.2024 | YQL-17688 ||\n || 56 | xml | 234 | 18 (+4) | 7.69 | 18.02.2024 | YQL-17681 ||\ndiff --git a/ydb/library/yql/tests/sql/dq_file/part13/canondata/result.json b/ydb/library/yql/tests/sql/dq_file/part13/canondata/result.json\nindex 6dc5424a2726..3918e18690ee 100644\n--- a/ydb/library/yql/tests/sql/dq_file/part13/canondata/result.json\n+++ b/ydb/library/yql/tests/sql/dq_file/part13/canondata/result.json\n@@ -1778,6 +1778,28 @@\n         }\n     ],\n     \"test.test[pg-pg_in_dict_key_with_stable_pickle-default.txt-Results]\": [],\n+    \"test.test[pg-pg_like_cast-default.txt-Analyze]\": [\n+        {\n+            \"checksum\": \"c1f2d837c3623c81dd596a9877913fb8\",\n+            \"size\": 948,\n+            \"uri\": \"https://{canondata_backend}/1599023/af4de9c2015a8dbd6c450ba09edc50e553a0c403/resource.tar.gz#test.test_pg-pg_like_cast-default.txt-Analyze_/plan.txt\"\n+        }\n+    ],\n+    \"test.test[pg-pg_like_cast-default.txt-Debug]\": [\n+        {\n+            \"checksum\": \"24943aa60203974bc089ecac64ecfc82\",\n+            \"size\": 1583,\n+            \"uri\": \"https://{canondata_backend}/1599023/af4de9c2015a8dbd6c450ba09edc50e553a0c403/resource.tar.gz#test.test_pg-pg_like_cast-default.txt-Debug_/opt.yql_patched\"\n+        }\n+    ],\n+    \"test.test[pg-pg_like_cast-default.txt-Plan]\": [\n+        {\n+            \"checksum\": \"c1f2d837c3623c81dd596a9877913fb8\",\n+            \"size\": 948,\n+            \"uri\": \"https://{canondata_backend}/1599023/af4de9c2015a8dbd6c450ba09edc50e553a0c403/resource.tar.gz#test.test_pg-pg_like_cast-default.txt-Plan_/plan.txt\"\n+        }\n+    ],\n+    \"test.test[pg-pg_like_cast-default.txt-Results]\": [],\n     \"test.test[pg-select_columnref2-default.txt-Analyze]\": [\n         {\n             \"checksum\": \"7c26ae70a78338dce1e8028da3cdc562\",\ndiff --git a/ydb/library/yql/tests/sql/hybrid_file/part7/canondata/result.json b/ydb/library/yql/tests/sql/hybrid_file/part7/canondata/result.json\nindex 568a5912c5a4..4306a6342085 100644\n--- a/ydb/library/yql/tests/sql/hybrid_file/part7/canondata/result.json\n+++ b/ydb/library/yql/tests/sql/hybrid_file/part7/canondata/result.json\n@@ -1609,6 +1609,20 @@\n             \"uri\": \"https://{canondata_backend}/1781765/028f42f897160b53900546b39900217bb2eb9fb1/resource.tar.gz#test.test_pg-pg_in_dict_key_with_stable_pickle-default.txt-Plan_/plan.txt\"\n         }\n     ],\n+    \"test.test[pg-pg_like_cast-default.txt-Debug]\": [\n+        {\n+            \"checksum\": \"65aa382cc96b28d78de7c020b9a14325\",\n+            \"size\": 1582,\n+            \"uri\": \"https://{canondata_backend}/1942671/d37704c7d0acd85d95c86ed2cbc5abdedc6da1fe/resource.tar.gz#test.test_pg-pg_like_cast-default.txt-Debug_/opt.yql_patched\"\n+        }\n+    ],\n+    \"test.test[pg-pg_like_cast-default.txt-Plan]\": [\n+        {\n+            \"checksum\": \"c1f2d837c3623c81dd596a9877913fb8\",\n+            \"size\": 948,\n+            \"uri\": \"https://{canondata_backend}/1942671/d37704c7d0acd85d95c86ed2cbc5abdedc6da1fe/resource.tar.gz#test.test_pg-pg_like_cast-default.txt-Plan_/plan.txt\"\n+        }\n+    ],\n     \"test.test[pg-record_from_table_row-default.txt-Debug]\": [\n         {\n             \"checksum\": \"72570482eac43dc72fb808334c10d01b\",\ndiff --git a/ydb/library/yql/tests/sql/sql2yql/canondata/result.json b/ydb/library/yql/tests/sql/sql2yql/canondata/result.json\nindex 0e0a6ceb6b5b..65464141583a 100644\n--- a/ydb/library/yql/tests/sql/sql2yql/canondata/result.json\n+++ b/ydb/library/yql/tests/sql/sql2yql/canondata/result.json\n@@ -11276,6 +11276,13 @@\n             \"uri\": \"https://{canondata_backend}/1599023/af9c2f81df0601cf266a0926b5ce73b6101b9115/resource.tar.gz#test_sql2yql.test_pg-pg_like_/sql.yql\"\n         }\n     ],\n+    \"test_sql2yql.test[pg-pg_like_cast]\": [\n+        {\n+            \"checksum\": \"73237972233c0aed54ee29842eef3433\",\n+            \"size\": 818,\n+            \"uri\": \"https://{canondata_backend}/1924537/0a56b94135daeec4385a52132da20f92bfbe1f4d/resource.tar.gz#test_sql2yql.test_pg-pg_like_cast_/sql.yql\"\n+        }\n+    ],\n     \"test_sql2yql.test[pg-pg_like_opt]\": [\n         {\n             \"checksum\": \"cf3aa66b65f253f4aa264eee61a8864a\",\ndiff --git a/ydb/library/yql/tests/sql/suites/pg/pg_like_cast.sql b/ydb/library/yql/tests/sql/suites/pg/pg_like_cast.sql\nnew file mode 100644\nindex 000000000000..998a6c651452\n--- /dev/null\n+++ b/ydb/library/yql/tests/sql/suites/pg/pg_like_cast.sql\n@@ -0,0 +1,3 @@\n+--!syntax_pg\n+SELECT count(*) FROM pg_class WHERE relkind='i' AND relname LIKE 'guid%';\n+\ndiff --git a/ydb/library/yql/tests/sql/yt_native_file/part13/canondata/result.json b/ydb/library/yql/tests/sql/yt_native_file/part13/canondata/result.json\nindex 645bf82fc827..4776678a62d6 100644\n--- a/ydb/library/yql/tests/sql/yt_native_file/part13/canondata/result.json\n+++ b/ydb/library/yql/tests/sql/yt_native_file/part13/canondata/result.json\n@@ -1758,6 +1758,27 @@\n             \"uri\": \"https://{canondata_backend}/212715/e1bc1d6e31fa656365a738e65224a7c3f774bae6/resource.tar.gz#test.test_pg-pg_in_dict_key_with_stable_pickle-default.txt-Results_/results.txt\"\n         }\n     ],\n+    \"test.test[pg-pg_like_cast-default.txt-Debug]\": [\n+        {\n+            \"checksum\": \"b618d9b6d039fdc02115a7de5b566c34\",\n+            \"size\": 1523,\n+            \"uri\": \"https://{canondata_backend}/1946324/7e45ed1a689a805f3b1fc3a99f2ee1fafd329189/resource.tar.gz#test.test_pg-pg_like_cast-default.txt-Debug_/opt.yql\"\n+        }\n+    ],\n+    \"test.test[pg-pg_like_cast-default.txt-Plan]\": [\n+        {\n+            \"checksum\": \"c1f2d837c3623c81dd596a9877913fb8\",\n+            \"size\": 948,\n+            \"uri\": \"https://{canondata_backend}/1946324/7e45ed1a689a805f3b1fc3a99f2ee1fafd329189/resource.tar.gz#test.test_pg-pg_like_cast-default.txt-Plan_/plan.txt\"\n+        }\n+    ],\n+    \"test.test[pg-pg_like_cast-default.txt-Results]\": [\n+        {\n+            \"checksum\": \"6e366853b97b2a461c3625148215d73d\",\n+            \"size\": 660,\n+            \"uri\": \"https://{canondata_backend}/1946324/7e45ed1a689a805f3b1fc3a99f2ee1fafd329189/resource.tar.gz#test.test_pg-pg_like_cast-default.txt-Results_/results.txt\"\n+        }\n+    ],\n     \"test.test[pg-select_columnref2-default.txt-Debug]\": [\n         {\n             \"checksum\": \"150fedc013ab1b6ab49629652df5c6ef\",\n",
  "problem_statement": "No implicit casts from name to pgtext\n```\r\nSELECT t.oid, t.typname AS name\r\nFROM pg_catalog.pg_type t\r\nLEFT OUTER JOIN pg_catalog.pg_type e ON e.oid=t.typelem\r\nLEFT OUTER JOIN pg_catalog.pg_class ct ON ct.oid=t.typrelid AND ct.relkind <> 'c'\r\nLEFT OUTER JOIN pg_catalog.pg_namespace nsp ON nsp.oid = t.typnamespace\r\nWHERE t.typtype != 'd' AND t.typname NOT LIKE E'\\_%' AND t.typnamespace = 1::oid\r\nAND ct.oid is NULL\r\nORDER BY t.typname\r\n```\r\n\r\ngives\r\n```\r\nExpected pg text, but got name\r\n```\n",
  "hints_text": "",
  "created_at": "2024-03-07T17:12:57Z",
  "modified_files": [
    "ydb/library/yql/core/type_ann/type_ann_pg.cpp"
  ],
  "modified_test_files": [
    "ydb/library/yql/tests/postgresql/cases/alter_table.err",
    "ydb/library/yql/tests/postgresql/cases/strings.err",
    "ydb/library/yql/tests/postgresql/cases/strings.out",
    "ydb/library/yql/tests/postgresql/cases/strings.sql",
    "ydb/library/yql/tests/postgresql/cases/uuid.err",
    "ydb/library/yql/tests/postgresql/cases/xml.err",
    "ydb/library/yql/tests/postgresql/cases/xml.err.1",
    "ydb/library/yql/tests/postgresql/cases/xml.err.2",
    "ydb/library/yql/tests/postgresql/pg_tests.csv",
    "ydb/library/yql/tests/postgresql/status.md",
    "ydb/library/yql/tests/postgresql/status.old",
    "ydb/library/yql/tests/sql/dq_file/part13/canondata/result.json",
    "ydb/library/yql/tests/sql/hybrid_file/part7/canondata/result.json",
    "ydb/library/yql/tests/sql/sql2yql/canondata/result.json",
    "b/ydb/library/yql/tests/sql/suites/pg/pg_like_cast.sql",
    "ydb/library/yql/tests/sql/yt_native_file/part13/canondata/result.json"
  ]
}