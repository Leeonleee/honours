{
  "repo": "dragonflydb/dragonfly",
  "pull_number": 3703,
  "instance_id": "dragonflydb__dragonfly-3703",
  "issue_numbers": [
    "3698"
  ],
  "base_commit": "4988831b6feaa83c31031f5fdebf0ac9b455ca5f",
  "patch": "diff --git a/src/server/acl/acl_family.cc b/src/server/acl/acl_family.cc\nindex d510bbded698..d7ee4c3bdfe9 100644\n--- a/src/server/acl/acl_family.cc\n+++ b/src/server/acl/acl_family.cc\n@@ -788,7 +788,7 @@ MaterializedContents MaterializeFileContents(std::vector<std::string>* usernames\n   for (auto& command : commands) {\n     if (command.empty())\n       continue;\n-    std::vector<std::string_view> cmds = absl::StrSplit(command, ' ');\n+    std::vector<std::string_view> cmds = absl::StrSplit(command, ' ', absl::SkipEmpty());\n     if (!absl::EqualsIgnoreCase(cmds[0], \"USER\") || cmds.size() < 4) {\n       return {};\n     }\n",
  "test_patch": "diff --git a/tests/dragonfly/acl_family_test.py b/tests/dragonfly/acl_family_test.py\nindex 7e7bdad6f933..82dbe410488a 100644\n--- a/tests/dragonfly/acl_family_test.py\n+++ b/tests/dragonfly/acl_family_test.py\n@@ -485,7 +485,8 @@ async def test_require_pass_with_acl_file_order(df_factory, tmp_dir):\n \n @pytest.mark.asyncio\n async def test_set_acl_file(async_client: aioredis.Redis, tmp_dir):\n-    acl_file_content = \"USER roy ON #ea71c25a7a602246b4c39824b855678894a96f43bb9b71319c39700a1e045222 +@string +@fast +hset\\nUSER john on nopass +@string\"\n+    # Note the extra space below, it's intented to also check that we properly parse extra spaces\n+    acl_file_content = \"USER    roy ON #ea71c25a7a602246b4c39824b855678894a96f43bb9b71319c39700a1e045222 +@string +@fast +hset\\nUSER john on nopass +@string\"\n \n     acl = create_temp_file(acl_file_content, tmp_dir)\n \n",
  "problem_statement": "Allow extra spaces when parsing ACL's from a file\nCurrently if an ACL rule within an acl file has its words separated by more than one space we reject it. Fix this.\n",
  "hints_text": "",
  "created_at": "2024-09-12T13:10:09Z",
  "modified_files": [
    "src/server/acl/acl_family.cc"
  ],
  "modified_test_files": [
    "tests/dragonfly/acl_family_test.py"
  ]
}