diff --git a/src/server/dflycmd.cc b/src/server/dflycmd.cc
index 9e154024e86e..4e0a34941bce 100644
--- a/src/server/dflycmd.cc
+++ b/src/server/dflycmd.cc
@@ -300,6 +300,14 @@ void DflyCmd::Flow(CmdArgList args, RedisReplyBuilder* rb, ConnectionContext* cn
     flow.eof_token = eof_token;
     flow.version = replica_ptr->version;
 
+    if (!cntx->conn()->Migrate(shard_set->pool()->at(flow_id))) {
+      // Listener::PreShutdown() triggered
+      if (cntx->conn()->socket()->IsOpen()) {
+        return rb->SendError(kInvalidState);
+      }
+      return;
+    }
+
 #if 0  // Partial synchronization is disabled
   if (seqid.has_value()) {
     if (sf_->journal()->IsLSNInBuffer(*seqid) || sf_->journal()->GetLsn() == *seqid) {
@@ -346,13 +354,6 @@ void DflyCmd::Flow(CmdArgList args, RedisReplyBuilder* rb, ConnectionContext* cn
     }
   }
 
-  if (!cntx->conn()->Migrate(shard_set->pool()->at(flow_id))) {
-    // Listener::PreShutdown() triggered
-    if (cntx->conn()->socket()->IsOpen()) {
-      return rb->SendError(kInvalidState);
-    }
-    return;
-  }
   sf_->journal()->StartInThread();
 
   rb->StartArray(2);
diff --git a/src/server/snapshot.cc b/src/server/snapshot.cc
index abfe5a9814ee..b809f8364ea7 100644
--- a/src/server/snapshot.cc
+++ b/src/server/snapshot.cc
@@ -236,7 +236,6 @@ void SliceSnapshot::SwitchIncrementalFb(LSN lsn) {
         std::make_error_code(errc::state_not_recoverable),
         absl::StrCat("Partial sync was unsuccessful because entry #", lsn,
                      " was dropped from the buffer. Current lsn=", journal->GetLsn()));
-    FinalizeJournalStream(true);
   }
 }
 
