{
  "repo": "ClickHouse/ClickHouse",
  "pull_number": 24177,
  "instance_id": "ClickHouse__ClickHouse-24177",
  "issue_numbers": [
    "24029"
  ],
  "base_commit": "8e13182bc48afd8952979a39f5c18dfa7396565a",
  "patch": "diff --git a/src/DataTypes/DataTypeUUID.h b/src/DataTypes/DataTypeUUID.h\nindex 70104a034786..5ed7a9126071 100644\n--- a/src/DataTypes/DataTypeUUID.h\n+++ b/src/DataTypes/DataTypeUUID.h\n@@ -35,6 +35,7 @@ class DataTypeUUID : public IDataType\n     bool textCanContainOnlyValidUTF8() const override { return true; }\n     bool isComparable() const override { return true; }\n     bool isValueUnambiguouslyRepresentedInContiguousMemoryRegion() const override { return true; }\n+    bool isValueUnambiguouslyRepresentedInFixedSizeContiguousMemoryRegion() const override { return true; }\n     bool haveMaximumSizeOfValue() const override { return true; }\n     size_t getSizeOfValueInMemory() const override { return sizeof(UUID); }\n     bool isCategorial() const override { return true; }\n",
  "test_patch": "diff --git a/tests/queries/0_stateless/01869_reinterpret_as_fixed_string_uuid.reference b/tests/queries/0_stateless/01869_reinterpret_as_fixed_string_uuid.reference\nnew file mode 100644\nindex 000000000000..d9ca990623e6\n--- /dev/null\n+++ b/tests/queries/0_stateless/01869_reinterpret_as_fixed_string_uuid.reference\n@@ -0,0 +1,1 @@\n+E711B35C04C4F061A0DBD36A00A67B90\ndiff --git a/tests/queries/0_stateless/01869_reinterpret_as_fixed_string_uuid.sql b/tests/queries/0_stateless/01869_reinterpret_as_fixed_string_uuid.sql\nnew file mode 100644\nindex 000000000000..f6cf90c372cb\n--- /dev/null\n+++ b/tests/queries/0_stateless/01869_reinterpret_as_fixed_string_uuid.sql\n@@ -0,0 +1,1 @@\n+SELECT hex(reinterpretAsFixedString(toUUID('61f0c404-5cb3-11e7-907b-a6006ad3dba0')));\n",
  "problem_statement": "reinterpretAsFixedString for UUID stopped working\n**Describe the bug**\r\nThe following statement started to return an error.\r\n```\r\nSELECT reinterpretAsFixedString(toUUID('61f0c404-5cb3-11e7-907b-a6006ad3dba0'))\r\n```\r\n\r\n**Does it reproduce on recent release?**\r\nCurrent master \r\n\r\n**How to reproduce**\r\n```\r\n    Description\r\n      Received exception from server (version 21.6.1):\r\n    Code: 43. DB::Exception: Received from localhost:9000. DB::Exception: Cannot reinterpret UUID as FixedString because it is not fixed size and contiguous in memory: While processing hex(encrypt('aes-128-ecb', reinterpretAsFixedString(toUUID('61f0c404-5cb3-11e7-907b-a6006ad3dba0')), '1111111111111111')).\r\n```\r\n\r\n**Expected behavior**\r\n```\r\nClickHouse client version 21.6.1.6689 (official build).\r\nConnecting to localhost:9000 as user default.\r\nConnected to ClickHouse server version 21.6.1 revision 54448.\r\n\r\nuser-host :) SELECT reinterpretAsFixedString(toUUID('61f0c404-5cb3-11e7-907b-a6006ad3dba0'))\r\n\r\nSELECT reinterpretAsFixedString(toUUID('61f0c404-5cb3-11e7-907b-a6006ad3dba0'))\r\n\r\nQuery id: fe58828e-6290-4f97-bd80-9589de123de3\r\n\r\n\u250c\u2500reinterpretAsFixedString(toUUID('61f0c404-5cb3-11e7-907b-a6006ad3dba0'))\u2500\u2510\r\n\u2502 \ufffd\ufffd\\\ufffd\ufffda\ufffd\ufffd\ufffdj\ufffd{\ufffd                                                                     \u2502\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n\r\n1 rows in set. Elapsed: 0.005 sec. \r\n\r\nuser-host :)\r\n```\r\n\n",
  "hints_text": "Only relevant to 21.6 (master).",
  "created_at": "2021-05-17T07:15:04Z",
  "modified_files": [
    "src/DataTypes/DataTypeUUID.h"
  ],
  "modified_test_files": [
    "b/tests/queries/0_stateless/01869_reinterpret_as_fixed_string_uuid.reference",
    "b/tests/queries/0_stateless/01869_reinterpret_as_fixed_string_uuid.sql"
  ]
}