diff --git a/tests/queries/0_stateless/02345_partial_sort_transform_optimization.reference b/tests/queries/0_stateless/02345_partial_sort_transform_optimization.reference
new file mode 100644
index 000000000000..7b50765be554
--- /dev/null
+++ b/tests/queries/0_stateless/02345_partial_sort_transform_optimization.reference
@@ -0,0 +1,15 @@
+0	999999	999999
+0	999998	999998
+0	999997	999997
+0	999996	999996
+0	999995	999995
+0	999994	999994
+0	999993	999993
+0	999992	999992
+0	999991	999991
+0	999990	999990
+98974
+98973
+98972
+98971
+98970
diff --git a/tests/queries/0_stateless/02345_partial_sort_transform_optimization.sql b/tests/queries/0_stateless/02345_partial_sort_transform_optimization.sql
new file mode 100644
index 000000000000..eb395e5ec41b
--- /dev/null
+++ b/tests/queries/0_stateless/02345_partial_sort_transform_optimization.sql
@@ -0,0 +1,5 @@
+-- Tags: no-backward-compatibility-check
+
+-- Regression for PartialSortingTransform optimization that requires at least 1500 rows.
+SELECT * FROM (SELECT * FROM (SELECT 0 a, toNullable(number) b, toString(number) c FROM numbers(1e6)) ORDER BY a DESC, b DESC, c LIMIT 1500) limit 10;
+SELECT number FROM (SELECT number, 1 AS k FROM numbers(100000) ORDER BY k ASC, number DESC LIMIT 1025, 1023) LIMIT 5;
