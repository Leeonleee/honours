diff --git a/dbms/tests/queries/0_stateless/00301_csv.reference b/dbms/tests/queries/0_stateless/00301_csv.reference
index 92cb50c0727b..a9351f91f703 100644
--- a/dbms/tests/queries/0_stateless/00301_csv.reference
+++ b/dbms/tests/queries/0_stateless/00301_csv.reference
@@ -4,10 +4,6 @@ Hello "world"	789	2016-01-03
 Hello
 world	100	2016-01-04
 default	1	2019-06-19
 default-eof	1	2019-06-19
-0	1	42	2019-07-22
-1	world	3	2019-07-23
-2	Hello	123	2019-06-19
-3	Hello	42	2019-06-19
 2016-01-01 01:02:03	1
 2016-01-02 01:02:03	2
 2017-08-15 13:15:01	3
diff --git a/dbms/tests/queries/0_stateless/00301_csv.sh b/dbms/tests/queries/0_stateless/00301_csv.sh
index c1bb6710c1f7..cb0167b4e99c 100755
--- a/dbms/tests/queries/0_stateless/00301_csv.sh
+++ b/dbms/tests/queries/0_stateless/00301_csv.sh
@@ -17,17 +17,6 @@ Hello "world", 789 ,2016-01-03
 $CLICKHOUSE_CLIENT --query="SELECT * FROM csv ORDER BY d";
 $CLICKHOUSE_CLIENT --query="DROP TABLE csv";
 
-
-$CLICKHOUSE_CLIENT --query="CREATE TABLE csv (i Int8, s String DEFAULT 'Hello', n UInt64 DEFAULT 42, d Date DEFAULT '2019-06-19') ENGINE = Memory";
-echo '\N, 1, \N, "2019-07-22"
-1, world, 3, "2019-07-23"
-2, \N, 123, \N
-3, \N, \N, \N' | $CLICKHOUSE_CLIENT --input_format_null_as_default=1 --query="INSERT INTO csv FORMAT CSV";
-
-$CLICKHOUSE_CLIENT --query="SELECT * FROM csv ORDER BY i";
-$CLICKHOUSE_CLIENT --query="DROP TABLE csv";
-
-
 $CLICKHOUSE_CLIENT --query="CREATE TABLE csv (t DateTime('Europe/Moscow'), s String) ENGINE = Memory";
 
 echo '"2016-01-01 01:02:03","1"
diff --git a/dbms/tests/queries/0_stateless/00937_template_output_format.sh b/dbms/tests/queries/0_stateless/00937_template_output_format.sh
index 239f7d672d01..0b0cba4e2bd8 100755
--- a/dbms/tests/queries/0_stateless/00937_template_output_format.sh
+++ b/dbms/tests/queries/0_stateless/00937_template_output_format.sh
@@ -20,3 +20,4 @@ format_template_row = '$CURDIR/00937_template_output_format_row.tmp', \
 format_template_rows_between_delimiter = ';
'";
 
 $CLICKHOUSE_CLIENT --query="DROP TABLE template";
+rm $CURDIR/00937_template_output_format_resultset.tmp $CURDIR/00937_template_output_format_row.tmp
diff --git a/dbms/tests/queries/0_stateless/00938_template_input_format.sh b/dbms/tests/queries/0_stateless/00938_template_input_format.sh
index 998fe195203e..ca314db13de6 100755
--- a/dbms/tests/queries/0_stateless/00938_template_input_format.sh
+++ b/dbms/tests/queries/0_stateless/00938_template_input_format.sh
@@ -50,3 +50,4 @@ $CLICKHOUSE_CLIENT --query="SELECT * FROM template2 ORDER BY n FORMAT CSV";
 
 $CLICKHOUSE_CLIENT --query="DROP TABLE template1";
 $CLICKHOUSE_CLIENT --query="DROP TABLE template2";
+rm $CURDIR/00938_template_input_format_resultset.tmp $CURDIR/00938_template_input_format_row.tmp
diff --git a/dbms/tests/queries/0_stateless/01015_insert_values_parametrized.reference b/dbms/tests/queries/0_stateless/01015_insert_values_parametrized.reference
index e98738050e57..c887e5feb5f0 100644
--- a/dbms/tests/queries/0_stateless/01015_insert_values_parametrized.reference
+++ b/dbms/tests/queries/0_stateless/01015_insert_values_parametrized.reference
@@ -2,3 +2,4 @@
 1	worldparam	[0.2,0.3]
 2	testparam	[0.3]
 3	paramparam	[]
+4	evaluateparam	[0.2]
diff --git a/dbms/tests/queries/0_stateless/01015_insert_values_parametrized.sh b/dbms/tests/queries/0_stateless/01015_insert_values_parametrized.sh
index 2fd06535ebe8..8edda6629b05 100755
--- a/dbms/tests/queries/0_stateless/01015_insert_values_parametrized.sh
+++ b/dbms/tests/queries/0_stateless/01015_insert_values_parametrized.sh
@@ -6,12 +6,15 @@ CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
 $CLICKHOUSE_CLIENT --query="DROP TABLE IF EXISTS insert_values_parametrized";
 $CLICKHOUSE_CLIENT --query="CREATE TABLE insert_values_parametrized (n UInt8, s String, a Array(Float32)) ENGINE = Memory";
 
-$CLICKHOUSE_CLIENT --input_format_values_deduce_templates_of_expressions=1 --param_p_n="-1" --param_p_s="param" --param_p_a="[0.2,0.3]" --query="INSERT INTO insert_values_parametrized  VALUES
+$CLICKHOUSE_CLIENT --input_format_values_deduce_templates_of_expressions=1 --input_format_values_interpret_expressions=0 --param_p_n="-1" --param_p_s="param" --param_p_a="[0.2,0.3]" --query="INSERT INTO insert_values_parametrized  VALUES
 (1 + {p_n:Int8}, lower(concat('Hello', {p_s:String})), arraySort(arrayIntersect([],            {p_a:Array(Nullable(Float32))}))),\
 (2 + {p_n:Int8}, lower(concat('world', {p_s:String})), arraySort(arrayIntersect([0.1,0.2,0.3], {p_a:Array(Nullable(Float32))}))),\
 (3 + {p_n:Int8}, lower(concat('TEST',  {p_s:String})), arraySort(arrayIntersect([0.1,0.3,0.4], {p_a:Array(Nullable(Float32))}))),\
 (4 + {p_n:Int8}, lower(concat('PaRaM', {p_s:String})), arraySort(arrayIntersect([0.5],         {p_a:Array(Nullable(Float32))})))";
 
+$CLICKHOUSE_CLIENT --input_format_values_deduce_templates_of_expressions=0 --input_format_values_interpret_expressions=1 --param_p_n="-1" --param_p_s="param" --param_p_a="[0.2,0.3]" --query="INSERT INTO insert_values_parametrized  VALUES \
+(5 + {p_n:Int8}, lower(concat('Evaluate', {p_s:String})), arrayIntersect([0, 0.2, 0.6], {p_a:Array(Nullable(Float32))}))"
+
 $CLICKHOUSE_CLIENT --query="SELECT * FROM insert_values_parametrized ORDER BY n";
 
 $CLICKHOUSE_CLIENT --query="DROP TABLE insert_values_parametrized";
diff --git a/dbms/tests/queries/0_stateless/01016_input_null_as_default.reference b/dbms/tests/queries/0_stateless/01016_input_null_as_default.reference
new file mode 100644
index 000000000000..ba9657bf16e0
--- /dev/null
+++ b/dbms/tests/queries/0_stateless/01016_input_null_as_default.reference
@@ -0,0 +1,30 @@
+CSV
+0	1	42	2019-07-22	[10,20,30]	('default',0)
+1	world	3	2019-07-23	[1,2,3]	('tuple',3.14)
+2	Hello	123	2019-06-19	[]	('test',2.71828)
+3	Hello	42	2019-06-19	[1,2,3]	('default',0.75)
+TSV
+0	1	42	2019-07-22	[10,20,30]	('default',0)
+1	world	3	2019-07-23	[1,2,3]	('tuple',3.14)
+2	Hello	123	2019-06-19	[]	('test',2.71828)
+3	Hello	42	2019-06-19	[1,2,3]	('default',0.75)
+TSKV
+0	1	42	2019-07-22	[10,20,30]	('default',0)
+1	world	3	2019-07-23	[1,2,3]	('tuple',3.14)
+2	Hello	123	2019-06-19	[]	('test',2.71828)
+3	Hello	42	2019-06-19	[1,2,3]	('default',0.75)
+JSONEachRow
+0	1	42	2019-07-22	[10,20,30]	('default',0)
+1	world	3	2019-07-23	[1,2,3]	('tuple',3.14)
+2	Hello	123	2019-06-19	[]	('test',2.71828)
+3	Hello	42	2019-06-19	[1,2,3]	('default',0.75)
+Template (Quoted)
+0	1	42	2019-07-22	[10,20,30]	('default',0)
+1	world	3	2019-07-23	[1,2,3]	('tuple',3.14)
+2	Hello	123	2019-06-19	[]	('test',2.71828)
+3	Hello	42	2019-06-19	[1,2,3]	('default',0.75)
+Values
+0	1	42	2019-07-22	[10,20,30]	('default',0)
+1	world	3	2019-07-23	[1,2,3]	('tuple',3.14)
+2	Hello	123	2019-06-19	[]	('test',2.71828)
+3	Hello	42	2019-06-19	[1,2,3]	('default',0.75)
diff --git a/dbms/tests/queries/0_stateless/01016_input_null_as_default.sh b/dbms/tests/queries/0_stateless/01016_input_null_as_default.sh
new file mode 100755
index 000000000000..f7fdefc26df8
--- /dev/null
+++ b/dbms/tests/queries/0_stateless/01016_input_null_as_default.sh
@@ -0,0 +1,55 @@
+#!/usr/bin/env bash
+
+CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
+. $CURDIR/../shell_config.sh
+
+$CLICKHOUSE_CLIENT --query="DROP TABLE IF EXISTS null_as_default";
+$CLICKHOUSE_CLIENT --query="CREATE TABLE null_as_default (i Int8, s String DEFAULT 'Hello', n UInt64 DEFAULT 42, d Date DEFAULT '2019-06-19', a Array(UInt8) DEFAULT [1, 2, 3], t Tuple(String, Float64) DEFAULT ('default', i / 4)) ENGINE = Memory";
+
+echo 'CSV'
+echo '\N, 1, \N, "2019-07-22", "[10, 20, 30]", \N
+1, world, 3, "2019-07-23", \N, tuple, 3.14
+2, \N, 123, \N, "[]", test, 2.71828
+3, \N, \N, \N, \N, \N' | $CLICKHOUSE_CLIENT --input_format_null_as_default=1 --query="INSERT INTO null_as_default FORMAT CSV";
+$CLICKHOUSE_CLIENT --query="SELECT * FROM null_as_default ORDER BY i";
+$CLICKHOUSE_CLIENT --query="TRUNCATE TABLE null_as_default";
+
+echo 'TSV'
+echo -e '\N\t1\t\N\t2019-07-22\t[10, 20, 30]\t\N
+1\tworld\t3\t2019-07-23\t\N\t('\''tuple'\'', 3.14)
+2\t\N\t123\t\N\t[]\t('\''test'\'', 2.71828)
+3\t\N\t\N\t\N\t\N\t\N' | $CLICKHOUSE_CLIENT --input_format_null_as_default=1 --query="INSERT INTO null_as_default FORMAT TSV";
+$CLICKHOUSE_CLIENT --query="SELECT * FROM null_as_default ORDER BY i";
+$CLICKHOUSE_CLIENT --query="TRUNCATE TABLE null_as_default";
+
+echo 'TSKV'
+echo -e 'i=\N\ts=1\tn=\N\td=2019-07-22\ta=[10, 20, 30]\tt=\N
+i=1\ts=world\tn=3\td=2019-07-23\ta=\N\tt=('\''tuple'\'', 3.14)
+i=2\ts=\N\tn=123\td=\N\ta=[]\tt=('\''test'\'', 2.71828)
+i=3\ts=\N\tn=\N\td=\N\ta=\N\tt=\N' | $CLICKHOUSE_CLIENT --input_format_null_as_default=1 --query="INSERT INTO null_as_default FORMAT TSKV";
+$CLICKHOUSE_CLIENT --query="SELECT * FROM null_as_default ORDER BY i";
+$CLICKHOUSE_CLIENT --query="TRUNCATE TABLE null_as_default";
+
+echo 'JSONEachRow'
+echo '{"i": null, "s": "1", "n": null, "d": "2019-07-22", "a": [10, 20, 30], "t": null}
+{"i": 1, "s": "world", "n": 3, "d": "2019-07-23", "a": null, "t": ["tuple", 3.14]}
+{"i": 2, "s": null, "n": 123, "d": null, "a": [], "t": ["test", 2.71828]}
+{"i": 3, "s": null, "n": null, "d": null, "a": null, "t": null}' | $CLICKHOUSE_CLIENT --input_format_null_as_default=1 --query="INSERT INTO null_as_default FORMAT JSONEachRow";
+$CLICKHOUSE_CLIENT --query="SELECT * FROM null_as_default ORDER BY i";
+$CLICKHOUSE_CLIENT --query="TRUNCATE TABLE null_as_default";
+
+echo 'Template (Quoted)'
+echo 'NULL, '\''1'\'', null, '\''2019-07-22'\'', [10, 20, 30], NuLl
+1, '\''world'\'', 3, '\''2019-07-23'\'', NULL, ('\''tuple'\'', 3.14)
+2, null, 123, null, [], ('\''test'\'', 2.71828)
+3, null, null, null, null, null' | $CLICKHOUSE_CLIENT --input_format_null_as_default=1 --format_custom_escaping_rule=Quoted --format_custom_field_delimiter=', ' --query="INSERT INTO null_as_default FORMAT CustomSeparated";
+$CLICKHOUSE_CLIENT --query="SELECT * FROM null_as_default ORDER BY i";
+$CLICKHOUSE_CLIENT --query="TRUNCATE TABLE null_as_default";
+
+echo 'Values'
+echo '(NULL, '\''1'\'', (null), '\''2019-07-22'\'', ([10, 20, 30]), (NuLl)),
+(1, '\''world'\'', (3), '\''2019-07-23'\'', (NULL), (('\''tuple'\'', 3.14))),
+(2, null, (123), null, ([]), (('\''test'\'', 2.71828))),
+(3, null, (null), null, (null), (null))' | $CLICKHOUSE_CLIENT --input_format_null_as_default=1 --input_format_values_deduce_templates_of_expressions=1 --query="INSERT INTO null_as_default VALUES";
+$CLICKHOUSE_CLIENT --query="SELECT * FROM null_as_default ORDER BY i";
+$CLICKHOUSE_CLIENT --query="DROP TABLE null_as_default";
diff --git a/dbms/tests/queries/0_stateless/01017_tsv_empty_as_default.reference b/dbms/tests/queries/0_stateless/01017_tsv_empty_as_default.reference
new file mode 100644
index 000000000000..feca2ec64849
--- /dev/null
+++ b/dbms/tests/queries/0_stateless/01017_tsv_empty_as_default.reference
@@ -0,0 +1,4 @@
+	1	2019-06-19
+abcd	100	2016-01-01
+default	1	2019-06-19
+default-eof	1	2019-06-19
diff --git a/dbms/tests/queries/0_stateless/01017_tsv_empty_as_default.sh b/dbms/tests/queries/0_stateless/01017_tsv_empty_as_default.sh
new file mode 100755
index 000000000000..cdaa5016d3e6
--- /dev/null
+++ b/dbms/tests/queries/0_stateless/01017_tsv_empty_as_default.sh
@@ -0,0 +1,14 @@
+#!/usr/bin/env bash
+
+CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
+. $CURDIR/../shell_config.sh
+
+$CLICKHOUSE_CLIENT --query="DROP TABLE IF EXISTS empty_as_default";
+$CLICKHOUSE_CLIENT --query="CREATE TABLE empty_as_default (s String, n UInt64 DEFAULT 1, d Date DEFAULT '2019-06-19') ENGINE = Memory";
+
+echo -ne 'abcd\t100\t2016-01-01
+default\t\t
+\t\t
+default-eof\t\t' | $CLICKHOUSE_CLIENT --input_format_defaults_for_omitted_fields=1 --input_format_tsv_empty_as_default=1 --query="INSERT INTO empty_as_default FORMAT TSV";
+$CLICKHOUSE_CLIENT --query="SELECT * FROM empty_as_default ORDER BY s";
+$CLICKHOUSE_CLIENT --query="DROP TABLE empty_as_default";
diff --git a/dbms/tests/queries/0_stateless/01018_insert_multiple_blocks_with_defaults.reference b/dbms/tests/queries/0_stateless/01018_insert_multiple_blocks_with_defaults.reference
new file mode 100644
index 000000000000..d598f5d498a8
--- /dev/null
+++ b/dbms/tests/queries/0_stateless/01018_insert_multiple_blocks_with_defaults.reference
@@ -0,0 +1,2 @@
+1	hello
+2	world
diff --git a/dbms/tests/queries/0_stateless/01018_insert_multiple_blocks_with_defaults.sh b/dbms/tests/queries/0_stateless/01018_insert_multiple_blocks_with_defaults.sh
new file mode 100755
index 000000000000..c6931fd68ee1
--- /dev/null
+++ b/dbms/tests/queries/0_stateless/01018_insert_multiple_blocks_with_defaults.sh
@@ -0,0 +1,10 @@
+#!/usr/bin/env bash
+
+CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
+. $CURDIR/../shell_config.sh
+
+$CLICKHOUSE_CLIENT --query="DROP TABLE IF EXISTS defaults"
+$CLICKHOUSE_CLIENT --query="CREATE TABLE defaults (n UInt8, s String DEFAULT 'hello') ENGINE = Memory"
+echo '{"n": 1} {"n": 2, "s":"world"}' | $CLICKHOUSE_CLIENT --max_insert_block_size=1 --query="INSERT INTO defaults FORMAT JSONEachRow"
+$CLICKHOUSE_CLIENT --query="SELECT * FROM defaults ORDER BY n"
+$CLICKHOUSE_CLIENT --query="DROP TABLE defaults"
