diff --git a/dbms/tests/queries/0_stateless/01087_index_set_ubsan.reference b/dbms/tests/queries/0_stateless/01087_index_set_ubsan.reference
new file mode 100644
index 000000000000..a9127bd8170c
--- /dev/null
+++ b/dbms/tests/queries/0_stateless/01087_index_set_ubsan.reference
@@ -0,0 +1,4 @@
+1	1
+1	2
+1	3
+1	4
diff --git a/dbms/tests/queries/0_stateless/01087_index_set_ubsan.sql b/dbms/tests/queries/0_stateless/01087_index_set_ubsan.sql
new file mode 100644
index 000000000000..e22e58396b56
--- /dev/null
+++ b/dbms/tests/queries/0_stateless/01087_index_set_ubsan.sql
@@ -0,0 +1,5 @@
+DROP TABLE IF EXISTS t;
+create table t (i Int, a Int, s String, index ind_s (s) type set(1) granularity 1) engine = MergeTree order by i;
+insert into t values (1, 1, 'a') (2, 1, 'a') (3, 1, 'a') (4, 1, 'a');
+SELECT a, i from t ORDER BY a, i;
+DROP TABLE t;
