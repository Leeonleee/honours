You will be provided with a partial code base and an issue statement explaining a problem to resolve.

<issue>
BC check: Cannot quickly remove directory ... by removing files
https://s3.amazonaws.com/clickhouse-test-reports/0/bd4a208428c8f17c4c3148886e6bf008bb064f58/stress_test__memory__actions_.html

```
2022.06.30 05:04:05.434426 [ 461303 ] {} <Error> test_35.tp_1 (1ff2034b-af50-401f-90fd-ac714bb9d202): Cannot quickly remove directory /var/lib/clickhouse/store/1ff/1ff2034b-af50-401f-90fd-ac714bb9d202/delete_tmp_all_0_0_0_2 by removing files; fallback to recursive removal. Reason: Code: 458. DB::ErrnoException: Cannot unlink file /var/lib/clickhouse/store/1ff/1ff2034b-af50-401f-90fd-ac714bb9d202/delete_tmp_all_0_0_0_2/pp.proj, errno: 21, strerror: Is a directory. (CANNOT_UNLINK) (version 22.7.1.1 (official build))
2022.06.30 05:04:05.434439 [ 461316 ] {} <Error> test_35.tp_2 (2c15d3ff-aa27-4370-b90d-fa14236c603b): Cannot quickly remove directory /var/lib/clickhouse/store/2c1/2c15d3ff-aa27-4370-b90d-fa14236c603b/delete_tmp_all_0_0_0_2 by removing files; fallback to recursive removal. Reason: Code: 458. DB::ErrnoException: Cannot unlink file /var/lib/clickhouse/store/2c1/2c15d3ff-aa27-4370-b90d-fa14236c603b/delete_tmp_all_0_0_0_2/pp.proj, errno: 21, strerror: Is a directory. (CANNOT_UNLINK) (version 22.7.1.1 (official build))
2022.06.30 05:04:05.436398 [ 461303 ] {} <Error> test_35.tp_1 (1ff2034b-af50-401f-90fd-ac714bb9d202): Cannot quickly remove directory /var/lib/clickhouse/store/1ff/1ff2034b-af50-401f-90fd-ac714bb9d202/delete_tmp_all_1_1_0_2 by removing files; fallback to recursive removal. Reason: Code: 458. DB::ErrnoException: Cannot unlink file /var/lib/clickhouse/store/1ff/1ff2034b-af50-401f-90fd-ac714bb9d202/delete_tmp_all_1_1_0_2/pp.proj, errno: 21, strerror: Is a directory. (CANNOT_UNLINK) (version 22.7.1.1 (official build))
2022.06.30 05:04:05.436486 [ 461316 ] {} <Error> test_35.tp_2 (2c15d3ff-aa27-4370-b90d-fa14236c603b): Cannot quickly remove directory /var/lib/clickhouse/store/2c1/2c15d3ff-aa27-4370-b90d-fa14236c603b/delete_tmp_all_1_1_0_2 by removing files; fallback to recursive removal. Reason: Code: 458. DB::ErrnoException: Cannot unlink file /var/lib/clickhouse/store/2c1/2c15d3ff-aa27-4370-b90d-fa14236c603b/delete_tmp_all_1_1_0_2/pp.proj, errno: 21, strerror: Is a directory. (CANNOT_UNLINK) (version 22.7.1.1 (official build))
```

Seems like the issue was introduced in #36555
</issue>

I need you to solve the provided issue by generating a code fix that can be applied directly to the repository

Respond below:
