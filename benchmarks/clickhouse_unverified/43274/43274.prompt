You will be provided with a partial code base and an issue statement explaining a problem to resolve.

<issue>
Inconsistent behaviour of arrayFirst* and arrayLast* with Nullable columns
Tested with latest version on play.clickhouse.com (22.10.1.1875)

```sql
SELECT arrayFirst((x,f) -> f, [1,2,3,NULL], [0,1,0,0]) as test
```
returns 2 as expected.

But:
```sql
SELECT arrayFirstOrNull((x,f) -> f, [1,2,3,NULL], [0,1,0,0]) as test

Code: 44. DB::Exception: Nullable(UInt8) cannot be inside Nullable column. (ILLEGAL_COLUMN) (version 22.10.1.1875 (official build))
```
tries to wrap another Nullable layer. It seems to be inconsistent in some way if we should use this function on various columns programatically.

And, BTW, it would be great if we could use Nullable columns in filter column of higher-order functions. Why is this forbidden now?
```sql
SELECT arrayFirst((x,f) -> f, [1,2,3,4], [0,1,0,NULL]) as test

Code: 44. DB::Exception: Unexpected type of filter column. (ILLEGAL_COLUMN) (version 22.10.1.1875 (official build))
```
</issue>

I need you to solve the provided issue by generating a code fix that can be applied directly to the repository

Respond below:
