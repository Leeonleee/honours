diff --git a/tests/queries/0_stateless/02002_sampling_and_unknown_column_bug.reference b/tests/queries/0_stateless/02002_sampling_and_unknown_column_bug.reference
new file mode 100644
index 000000000000..9315e86b328a
--- /dev/null
+++ b/tests/queries/0_stateless/02002_sampling_and_unknown_column_bug.reference
@@ -0,0 +1,2 @@
+1
+1	1	1
diff --git a/tests/queries/0_stateless/02002_sampling_and_unknown_column_bug.sql b/tests/queries/0_stateless/02002_sampling_and_unknown_column_bug.sql
new file mode 100644
index 000000000000..838d7a5526bf
--- /dev/null
+++ b/tests/queries/0_stateless/02002_sampling_and_unknown_column_bug.sql
@@ -0,0 +1,20 @@
+drop table if exists sessions;
+CREATE TABLE sessions
+(
+  `user_id` UInt64
+)
+ENGINE = MergeTree
+ORDER BY user_id 
+SAMPLE BY user_id;
+
+insert into sessions values(1);
+
+SELECT
+    sum(user_id * _sample_factor) 
+FROM sessions
+SAMPLE 10000000;
+
+SELECT
+    uniq(user_id) a,  min(_sample_factor) x,  a*x
+FROM sessions
+SAMPLE 10000000;
