diff --git a/tests/queries/0_stateless/00405_PrettyCompactMonoBlock.reference b/tests/queries/0_stateless/00405_PrettyCompactMonoBlock.reference
new file mode 100644
index 000000000000..94d3efa6e0a9
--- /dev/null
+++ b/tests/queries/0_stateless/00405_PrettyCompactMonoBlock.reference
@@ -0,0 +1,32 @@
+one block
+â”Œâ”€[1mnumber[0mâ”€â”
+â”‚      0 â”‚
+â”‚      1 â”‚
+â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+two blocks
+â”Œâ”€[1mnumber[0mâ”€â”
+â”‚      0 â”‚
+â”‚      0 â”‚
+â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+extremes
+â”Œâ”€[1mnumber[0mâ”€â”
+â”‚      0 â”‚
+â”‚      1 â”‚
+â”‚      2 â”‚
+â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+
+Extremes:
+â”Œâ”€[1mnumber[0mâ”€â”
+â”‚      0 â”‚
+â”‚      2 â”‚
+â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+totals
+â”Œâ”€[1msum(number)[0mâ”€â”
+â”‚           2 â”‚
+â”‚           1 â”‚
+â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+
+Totals:
+â”Œâ”€[1msum(number)[0mâ”€â”
+â”‚           3 â”‚
+â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
diff --git a/tests/queries/0_stateless/00405_PrettyCompactMonoBlock.sh b/tests/queries/0_stateless/00405_PrettyCompactMonoBlock.sh
new file mode 100755
index 000000000000..a353ce5ea5cf
--- /dev/null
+++ b/tests/queries/0_stateless/00405_PrettyCompactMonoBlock.sh
@@ -0,0 +1,13 @@
+#!/usr/bin/env bash
+
+CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
+. "$CURDIR"/../shell_config.sh
+
+echo 'one block'
+${CLICKHOUSE_LOCAL} --query="SELECT * FROM numbers(2)" --format PrettyCompactMonoBlock
+echo 'two blocks'
+${CLICKHOUSE_LOCAL} --query="SELECT * FROM numbers(1) UNION ALL SELECT * FROM numbers(1)" --format PrettyCompactMonoBlock
+echo 'extremes'
+${CLICKHOUSE_LOCAL} --query="SELECT * FROM numbers(3)" --format PrettyCompactMonoBlock --extremes=1
+echo 'totals'
+${CLICKHOUSE_LOCAL} --query="SELECT sum(number) FROM numbers(3) GROUP BY number%2 WITH TOTALS" --format PrettyCompactMonoBlock
