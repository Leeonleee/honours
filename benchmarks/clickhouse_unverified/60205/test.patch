diff --git a/tests/queries/0_stateless/01848_partition_value_column.sql b/tests/queries/0_stateless/01848_partition_value_column.sql
index 28d842af3e9c..de5e766c92cd 100644
--- a/tests/queries/0_stateless/01848_partition_value_column.sql
+++ b/tests/queries/0_stateless/01848_partition_value_column.sql
@@ -14,8 +14,8 @@ select count() from tbl where _partition_value.3 = 4 settings max_rows_to_read =
 
 create table tbl2(i int) engine MergeTree order by i;
 insert into tbl2 values (1);
-select _partition_value from tbl2; -- { serverError 16 }
-select _partition_value from tbl2 group by 1; -- { serverError 16 }
+select _partition_value from tbl2; -- { serverError UNKNOWN_IDENTIFIER }
+select _partition_value from tbl2 group by 1; -- { serverError UNKNOWN_IDENTIFIER }
 
 drop table tbl;
 drop table tbl2;
diff --git a/tests/queries/0_stateless/02235_add_part_offset_virtual_column.reference b/tests/queries/0_stateless/02235_add_part_offset_virtual_column.reference
index 2455f50b7f2a..e88abb35ab4d 100644
--- a/tests/queries/0_stateless/02235_add_part_offset_virtual_column.reference
+++ b/tests/queries/0_stateless/02235_add_part_offset_virtual_column.reference
@@ -50,6 +50,8 @@ SOME GRANULES FILTERED OUT
 100002	foo
 PREWHERE
 301408	164953047376	164953047376
+335872	166463369216	166463369216
+301407	164952947376	164952947376
 42
 10042
 20042
diff --git a/tests/queries/0_stateless/02235_add_part_offset_virtual_column.sql b/tests/queries/0_stateless/02235_add_part_offset_virtual_column.sql
index 73ae6eb499f8..5af6565c03d7 100644
--- a/tests/queries/0_stateless/02235_add_part_offset_virtual_column.sql
+++ b/tests/queries/0_stateless/02235_add_part_offset_virtual_column.sql
@@ -52,7 +52,7 @@ SELECT _part_offset, foo FROM t_1 where granule == 0 AND _part_offset >= 100000
 
 SELECT 'PREWHERE';
 SELECT count(*), sum(_part_offset), sum(order_0) from t_1 prewhere granule == 0 where _part_offset >= 100000;
-SELECT count(*), sum(_part_offset), sum(order_0) from t_1 prewhere _part != '' where granule == 0; -- { serverError 10, 16 }
-SELECT count(*), sum(_part_offset), sum(order_0) from t_1 prewhere _part_offset > 100000 where granule == 0; -- { serverError 10, 16 }
+SELECT count(*), sum(_part_offset), sum(order_0) from t_1 prewhere _part != '' where granule == 0;
+SELECT count(*), sum(_part_offset), sum(order_0) from t_1 prewhere _part_offset > 100000 where granule == 0;
 SELECT _part_offset FROM t_1 PREWHERE order_0 % 10000 == 42 ORDER BY order_0 LIMIT 3;
 SELECT _part_offset, foo FROM t_1 PREWHERE order_0 % 10000 == 42 ORDER BY order_0 LIMIT 3;
diff --git a/tests/queries/0_stateless/02890_describe_table_options.reference b/tests/queries/0_stateless/02890_describe_table_options.reference
index 5d99df36bb43..ecbfe5a9f4d6 100644
--- a/tests/queries/0_stateless/02890_describe_table_options.reference
+++ b/tests/queries/0_stateless/02890_describe_table_options.reference
@@ -2,237 +2,201 @@
 
 SET describe_compact_output = 0, describe_include_virtual_columns = 0, describe_include_subcolumns = 0;
 DESCRIBE TABLE t_describe_options FORMAT PrettyCompactNoEscapes;
-┌─name─┬─type─────────────────────────────┬─default_type─┬─default_expression─┬─comment──────┬─codec_expression─┬─ttl_expression─┐
-│ id   │ UInt64                           │              │                    │ index column │                  │                │
-│ arr  │ Array(UInt64)                    │ DEFAULT      │ [10, 20]           │              │ ZSTD(1)          │                │
-│ t    │ Tuple(
-    a String,
-    b UInt64) │ DEFAULT      │ ('foo', 0)         │              │ ZSTD(1)          │                │
-└──────┴──────────────────────────────────┴──────────────┴────────────────────┴──────────────┴──────────────────┴────────────────┘
+┌─name─┬─type──────────────────────┬─default_type─┬─default_expression─┬─comment──────┬─codec_expression─┬─ttl_expression─┐
+│ id   │ UInt64                    │              │                    │ index column │                  │                │
+│ arr  │ Array(UInt64)             │ DEFAULT      │ [10, 20]           │              │ ZSTD(1)          │                │
+│ t    │ Tuple(a String, b UInt64) │ DEFAULT      │ ('foo', 0)         │              │ ZSTD(1)          │                │
+└──────┴───────────────────────────┴──────────────┴────────────────────┴──────────────┴──────────────────┴────────────────┘
 DESCRIBE remote(default, currentDatabase(), t_describe_options) FORMAT PrettyCompactNoEscapes;
-┌─name─┬─type─────────────────────────────┬─default_type─┬─default_expression─┬─comment──────┬─codec_expression─┬─ttl_expression─┐
-│ id   │ UInt64                           │              │                    │ index column │                  │                │
-│ arr  │ Array(UInt64)                    │ DEFAULT      │ [10, 20]           │              │ ZSTD(1)          │                │
-│ t    │ Tuple(
-    a String,
-    b UInt64) │ DEFAULT      │ ('foo', 0)         │              │ ZSTD(1)          │                │
-└──────┴──────────────────────────────────┴──────────────┴────────────────────┴──────────────┴──────────────────┴────────────────┘
+┌─name─┬─type──────────────────────┬─default_type─┬─default_expression─┬─comment──────┬─codec_expression─┬─ttl_expression─┐
+│ id   │ UInt64                    │              │                    │ index column │                  │                │
+│ arr  │ Array(UInt64)             │ DEFAULT      │ [10, 20]           │              │ ZSTD(1)          │                │
+│ t    │ Tuple(a String, b UInt64) │ DEFAULT      │ ('foo', 0)         │              │ ZSTD(1)          │                │
+└──────┴───────────────────────────┴──────────────┴────────────────────┴──────────────┴──────────────────┴────────────────┘
 SET describe_compact_output = 0, describe_include_virtual_columns = 0, describe_include_subcolumns = 1;
 DESCRIBE TABLE t_describe_options FORMAT PrettyCompactNoEscapes;
-┌─name──────┬─type─────────────────────────────┬─default_type─┬─default_expression─┬─comment──────┬─codec_expression─┬─ttl_expression─┬─is_subcolumn─┐
-│ id        │ UInt64                           │              │                    │ index column │                  │                │            0 │
-│ arr       │ Array(UInt64)                    │ DEFAULT      │ [10, 20]           │              │ ZSTD(1)          │                │            0 │
-│ t         │ Tuple(
-    a String,
-    b UInt64) │ DEFAULT      │ ('foo', 0)         │              │ ZSTD(1)          │                │            0 │
-│ arr.size0 │ UInt64                           │              │                    │              │                  │                │            1 │
-│ t.a       │ String                           │              │                    │              │ ZSTD(1)          │                │            1 │
-│ t.b       │ UInt64                           │              │                    │              │ ZSTD(1)          │                │            1 │
-└───────────┴──────────────────────────────────┴──────────────┴────────────────────┴──────────────┴──────────────────┴────────────────┴──────────────┘
+┌─name──────┬─type──────────────────────┬─default_type─┬─default_expression─┬─comment──────┬─codec_expression─┬─ttl_expression─┬─is_subcolumn─┐
+│ id        │ UInt64                    │              │                    │ index column │                  │                │            0 │
+│ arr       │ Array(UInt64)             │ DEFAULT      │ [10, 20]           │              │ ZSTD(1)          │                │            0 │
+│ t         │ Tuple(a String, b UInt64) │ DEFAULT      │ ('foo', 0)         │              │ ZSTD(1)          │                │            0 │
+│ arr.size0 │ UInt64                    │              │                    │              │                  │                │            1 │
+│ t.a       │ String                    │              │                    │              │ ZSTD(1)          │                │            1 │
+│ t.b       │ UInt64                    │              │                    │              │ ZSTD(1)          │                │            1 │
+└───────────┴───────────────────────────┴──────────────┴────────────────────┴──────────────┴──────────────────┴────────────────┴──────────────┘
 DESCRIBE remote(default, currentDatabase(), t_describe_options) FORMAT PrettyCompactNoEscapes;
-┌─name──────┬─type─────────────────────────────┬─default_type─┬─default_expression─┬─comment──────┬─codec_expression─┬─ttl_expression─┬─is_subcolumn─┐
-│ id        │ UInt64                           │              │                    │ index column │                  │                │            0 │
-│ arr       │ Array(UInt64)                    │ DEFAULT      │ [10, 20]           │              │ ZSTD(1)          │                │            0 │
-│ t         │ Tuple(
-    a String,
-    b UInt64) │ DEFAULT      │ ('foo', 0)         │              │ ZSTD(1)          │                │            0 │
-│ arr.size0 │ UInt64                           │              │                    │              │                  │                │            1 │
-│ t.a       │ String                           │              │                    │              │ ZSTD(1)          │                │            1 │
-│ t.b       │ UInt64                           │              │                    │              │ ZSTD(1)          │                │            1 │
-└───────────┴──────────────────────────────────┴──────────────┴────────────────────┴──────────────┴──────────────────┴────────────────┴──────────────┘
+┌─name──────┬─type──────────────────────┬─default_type─┬─default_expression─┬─comment──────┬─codec_expression─┬─ttl_expression─┬─is_subcolumn─┐
+│ id        │ UInt64                    │              │                    │ index column │                  │                │            0 │
+│ arr       │ Array(UInt64)             │ DEFAULT      │ [10, 20]           │              │ ZSTD(1)          │                │            0 │
+│ t         │ Tuple(a String, b UInt64) │ DEFAULT      │ ('foo', 0)         │              │ ZSTD(1)          │                │            0 │
+│ arr.size0 │ UInt64                    │              │                    │              │                  │                │            1 │
+│ t.a       │ String                    │              │                    │              │ ZSTD(1)          │                │            1 │
+│ t.b       │ UInt64                    │              │                    │              │ ZSTD(1)          │                │            1 │
+└───────────┴───────────────────────────┴──────────────┴────────────────────┴──────────────┴──────────────────┴────────────────┴──────────────┘
 SET describe_compact_output = 0, describe_include_virtual_columns = 1, describe_include_subcolumns = 0;
 DESCRIBE TABLE t_describe_options FORMAT PrettyCompactNoEscapes;
-┌─name─────────────┬─type─────────────────────────────┬─default_type─┬─default_expression─┬─comment──────┬─codec_expression─┬─ttl_expression─┬─is_virtual─┐
-│ id               │ UInt64                           │              │                    │ index column │                  │                │          0 │
-│ arr              │ Array(UInt64)                    │ DEFAULT      │ [10, 20]           │              │ ZSTD(1)          │                │          0 │
-│ t                │ Tuple(
-    a String,
-    b UInt64) │ DEFAULT      │ ('foo', 0)         │              │ ZSTD(1)          │                │          0 │
-│ _part            │ LowCardinality(String)           │              │                    │              │                  │                │          1 │
-│ _part_index      │ UInt64                           │              │                    │              │                  │                │          1 │
-│ _part_uuid       │ UUID                             │              │                    │              │                  │                │          1 │
-│ _partition_id    │ LowCardinality(String)           │              │                    │              │                  │                │          1 │
-│ _partition_value │ UInt8                            │              │                    │              │                  │                │          1 │
-│ _sample_factor   │ Float64                          │              │                    │              │                  │                │          1 │
-│ _part_offset     │ UInt64                           │              │                    │              │                  │                │          1 │
-│ _row_exists      │ UInt8                            │              │                    │              │                  │                │          1 │
-│ _block_number    │ UInt64                           │              │                    │              │                  │                │          1 │
-└──────────────────┴──────────────────────────────────┴──────────────┴────────────────────┴──────────────┴──────────────────┴────────────────┴────────────┘
+┌─name───────────┬─type──────────────────────┬─default_type─┬─default_expression─┬─comment─────────────────────────────────────────────────────────────────────────────────┬─codec_expression─┬─ttl_expression─┬─is_virtual─┐
+│ id             │ UInt64                    │              │                    │ index column                                                                            │                  │                │          0 │
+│ arr            │ Array(UInt64)             │ DEFAULT      │ [10, 20]           │                                                                                         │ ZSTD(1)          │                │          0 │
+│ t              │ Tuple(a String, b UInt64) │ DEFAULT      │ ('foo', 0)         │                                                                                         │ ZSTD(1)          │                │          0 │
+│ _part          │ LowCardinality(String)    │              │                    │ Name of part                                                                            │                  │                │          1 │
+│ _part_index    │ UInt64                    │              │                    │ Sequential index of the part in the query result                                        │                  │                │          1 │
+│ _part_uuid     │ UUID                      │              │                    │ Unique part identifier (if enabled MergeTree setting assign_part_uuids)                 │                  │                │          1 │
+│ _partition_id  │ LowCardinality(String)    │              │                    │ Name of partition                                                                       │                  │                │          1 │
+│ _sample_factor │ Float64                   │              │                    │ Sample factor (from the query)                                                          │                  │                │          1 │
+│ _part_offset   │ UInt64                    │              │                    │ Number of row in the part                                                               │                  │                │          1 │
+│ _row_exists    │ UInt8                     │              │                    │ Persisted mask created by lightweight delete that show whether row exists or is deleted │                  │                │          1 │
+│ _block_number  │ UInt64                    │              │                    │ Persisted original number of block that was assigned at insert                          │ Delta, LZ4       │                │          1 │
+└────────────────┴───────────────────────────┴──────────────┴────────────────────┴─────────────────────────────────────────────────────────────────────────────────────────┴──────────────────┴────────────────┴────────────┘
 DESCRIBE remote(default, currentDatabase(), t_describe_options) FORMAT PrettyCompactNoEscapes;
-┌─name───────────┬─type─────────────────────────────┬─default_type─┬─default_expression─┬─comment──────┬─codec_expression─┬─ttl_expression─┬─is_virtual─┐
-│ id             │ UInt64                           │              │                    │ index column │                  │                │          0 │
-│ arr            │ Array(UInt64)                    │ DEFAULT      │ [10, 20]           │              │ ZSTD(1)          │                │          0 │
-│ t              │ Tuple(
-    a String,
-    b UInt64) │ DEFAULT      │ ('foo', 0)         │              │ ZSTD(1)          │                │          0 │
-│ _table         │ LowCardinality(String)           │              │                    │              │                  │                │          1 │
-│ _part          │ LowCardinality(String)           │              │                    │              │                  │                │          1 │
-│ _part_index    │ UInt64                           │              │                    │              │                  │                │          1 │
-│ _part_uuid     │ UUID                             │              │                    │              │                  │                │          1 │
-│ _partition_id  │ LowCardinality(String)           │              │                    │              │                  │                │          1 │
-│ _sample_factor │ Float64                          │              │                    │              │                  │                │          1 │
-│ _part_offset   │ UInt64                           │              │                    │              │                  │                │          1 │
-│ _row_exists    │ UInt8                            │              │                    │              │                  │                │          1 │
-│ _block_number  │ UInt64                           │              │                    │              │                  │                │          1 │
-│ _shard_num     │ UInt32                           │              │                    │              │                  │                │          1 │
-└────────────────┴──────────────────────────────────┴──────────────┴────────────────────┴──────────────┴──────────────────┴────────────────┴────────────┘
+┌─name───────────┬─type──────────────────────┬─default_type─┬─default_expression─┬─comment─────────────────────────────────────────────────────────────────────────────────┬─codec_expression─┬─ttl_expression─┬─is_virtual─┐
+│ id             │ UInt64                    │              │                    │ index column                                                                            │                  │                │          0 │
+│ arr            │ Array(UInt64)             │ DEFAULT      │ [10, 20]           │                                                                                         │ ZSTD(1)          │                │          0 │
+│ t              │ Tuple(a String, b UInt64) │ DEFAULT      │ ('foo', 0)         │                                                                                         │ ZSTD(1)          │                │          0 │
+│ _part          │ LowCardinality(String)    │              │                    │ Name of part                                                                            │                  │                │          1 │
+│ _part_index    │ UInt64                    │              │                    │ Sequential index of the part in the query result                                        │                  │                │          1 │
+│ _part_uuid     │ UUID                      │              │                    │ Unique part identifier (if enabled MergeTree setting assign_part_uuids)                 │                  │                │          1 │
+│ _partition_id  │ LowCardinality(String)    │              │                    │ Name of partition                                                                       │                  │                │          1 │
+│ _sample_factor │ Float64                   │              │                    │ Sample factor (from the query)                                                          │                  │                │          1 │
+│ _part_offset   │ UInt64                    │              │                    │ Number of row in the part                                                               │                  │                │          1 │
+│ _row_exists    │ UInt8                     │              │                    │ Persisted mask created by lightweight delete that show whether row exists or is deleted │                  │                │          1 │
+│ _block_number  │ UInt64                    │              │                    │ Persisted original number of block that was assigned at insert                          │ Delta, LZ4       │                │          1 │
+│ _table         │ LowCardinality(String)    │              │                    │ Name of a table                                                                         │                  │                │          1 │
+│ _shard_num     │ UInt32                    │              │                    │ Deprecated. Use function shardNum instead                                               │                  │                │          1 │
+└────────────────┴───────────────────────────┴──────────────┴────────────────────┴─────────────────────────────────────────────────────────────────────────────────────────┴──────────────────┴────────────────┴────────────┘
 SET describe_compact_output = 0, describe_include_virtual_columns = 1, describe_include_subcolumns = 1;
 DESCRIBE TABLE t_describe_options FORMAT PrettyCompactNoEscapes;
-┌─name─────────────┬─type─────────────────────────────┬─default_type─┬─default_expression─┬─comment──────┬─codec_expression─┬─ttl_expression─┬─is_subcolumn─┬─is_virtual─┐
-│ id               │ UInt64                           │              │                    │ index column │                  │                │            0 │          0 │
-│ arr              │ Array(UInt64)                    │ DEFAULT      │ [10, 20]           │              │ ZSTD(1)          │                │            0 │          0 │
-│ t                │ Tuple(
-    a String,
-    b UInt64) │ DEFAULT      │ ('foo', 0)         │              │ ZSTD(1)          │                │            0 │          0 │
-│ _part            │ LowCardinality(String)           │              │                    │              │                  │                │            0 │          1 │
-│ _part_index      │ UInt64                           │              │                    │              │                  │                │            0 │          1 │
-│ _part_uuid       │ UUID                             │              │                    │              │                  │                │            0 │          1 │
-│ _partition_id    │ LowCardinality(String)           │              │                    │              │                  │                │            0 │          1 │
-│ _partition_value │ UInt8                            │              │                    │              │                  │                │            0 │          1 │
-│ _sample_factor   │ Float64                          │              │                    │              │                  │                │            0 │          1 │
-│ _part_offset     │ UInt64                           │              │                    │              │                  │                │            0 │          1 │
-│ _row_exists      │ UInt8                            │              │                    │              │                  │                │            0 │          1 │
-│ _block_number    │ UInt64                           │              │                    │              │                  │                │            0 │          1 │
-│ arr.size0        │ UInt64                           │              │                    │              │                  │                │            1 │          0 │
-│ t.a              │ String                           │              │                    │              │ ZSTD(1)          │                │            1 │          0 │
-│ t.b              │ UInt64                           │              │                    │              │ ZSTD(1)          │                │            1 │          0 │
-└──────────────────┴──────────────────────────────────┴──────────────┴────────────────────┴──────────────┴──────────────────┴────────────────┴──────────────┴────────────┘
+┌─name───────────┬─type──────────────────────┬─default_type─┬─default_expression─┬─comment─────────────────────────────────────────────────────────────────────────────────┬─codec_expression─┬─ttl_expression─┬─is_subcolumn─┬─is_virtual─┐
+│ id             │ UInt64                    │              │                    │ index column                                                                            │                  │                │            0 │          0 │
+│ arr            │ Array(UInt64)             │ DEFAULT      │ [10, 20]           │                                                                                         │ ZSTD(1)          │                │            0 │          0 │
+│ t              │ Tuple(a String, b UInt64) │ DEFAULT      │ ('foo', 0)         │                                                                                         │ ZSTD(1)          │                │            0 │          0 │
+│ _part          │ LowCardinality(String)    │              │                    │ Name of part                                                                            │                  │                │            0 │          1 │
+│ _part_index    │ UInt64                    │              │                    │ Sequential index of the part in the query result                                        │                  │                │            0 │          1 │
+│ _part_uuid     │ UUID                      │              │                    │ Unique part identifier (if enabled MergeTree setting assign_part_uuids)                 │                  │                │            0 │          1 │
+│ _partition_id  │ LowCardinality(String)    │              │                    │ Name of partition                                                                       │                  │                │            0 │          1 │
+│ _sample_factor │ Float64                   │              │                    │ Sample factor (from the query)                                                          │                  │                │            0 │          1 │
+│ _part_offset   │ UInt64                    │              │                    │ Number of row in the part                                                               │                  │                │            0 │          1 │
+│ _row_exists    │ UInt8                     │              │                    │ Persisted mask created by lightweight delete that show whether row exists or is deleted │                  │                │            0 │          1 │
+│ _block_number  │ UInt64                    │              │                    │ Persisted original number of block that was assigned at insert                          │ Delta, LZ4       │                │            0 │          1 │
+│ arr.size0      │ UInt64                    │              │                    │                                                                                         │                  │                │            1 │          0 │
+│ t.a            │ String                    │              │                    │                                                                                         │ ZSTD(1)          │                │            1 │          0 │
+│ t.b            │ UInt64                    │              │                    │                                                                                         │ ZSTD(1)          │                │            1 │          0 │
+└────────────────┴───────────────────────────┴──────────────┴────────────────────┴─────────────────────────────────────────────────────────────────────────────────────────┴──────────────────┴────────────────┴──────────────┴────────────┘
 DESCRIBE remote(default, currentDatabase(), t_describe_options) FORMAT PrettyCompactNoEscapes;
-┌─name───────────┬─type─────────────────────────────┬─default_type─┬─default_expression─┬─comment──────┬─codec_expression─┬─ttl_expression─┬─is_subcolumn─┬─is_virtual─┐
-│ id             │ UInt64                           │              │                    │ index column │                  │                │            0 │          0 │
-│ arr            │ Array(UInt64)                    │ DEFAULT      │ [10, 20]           │              │ ZSTD(1)          │                │            0 │          0 │
-│ t              │ Tuple(
-    a String,
-    b UInt64) │ DEFAULT      │ ('foo', 0)         │              │ ZSTD(1)          │                │            0 │          0 │
-│ _table         │ LowCardinality(String)           │              │                    │              │                  │                │            0 │          1 │
-│ _part          │ LowCardinality(String)           │              │                    │              │                  │                │            0 │          1 │
-│ _part_index    │ UInt64                           │              │                    │              │                  │                │            0 │          1 │
-│ _part_uuid     │ UUID                             │              │                    │              │                  │                │            0 │          1 │
-│ _partition_id  │ LowCardinality(String)           │              │                    │              │                  │                │            0 │          1 │
-│ _sample_factor │ Float64                          │              │                    │              │                  │                │            0 │          1 │
-│ _part_offset   │ UInt64                           │              │                    │              │                  │                │            0 │          1 │
-│ _row_exists    │ UInt8                            │              │                    │              │                  │                │            0 │          1 │
-│ _block_number  │ UInt64                           │              │                    │              │                  │                │            0 │          1 │
-│ _shard_num     │ UInt32                           │              │                    │              │                  │                │            0 │          1 │
-│ arr.size0      │ UInt64                           │              │                    │              │                  │                │            1 │          0 │
-│ t.a            │ String                           │              │                    │              │ ZSTD(1)          │                │            1 │          0 │
-│ t.b            │ UInt64                           │              │                    │              │ ZSTD(1)          │                │            1 │          0 │
-└────────────────┴──────────────────────────────────┴──────────────┴────────────────────┴──────────────┴──────────────────┴────────────────┴──────────────┴────────────┘
+┌─name───────────┬─type──────────────────────┬─default_type─┬─default_expression─┬─comment─────────────────────────────────────────────────────────────────────────────────┬─codec_expression─┬─ttl_expression─┬─is_subcolumn─┬─is_virtual─┐
+│ id             │ UInt64                    │              │                    │ index column                                                                            │                  │                │            0 │          0 │
+│ arr            │ Array(UInt64)             │ DEFAULT      │ [10, 20]           │                                                                                         │ ZSTD(1)          │                │            0 │          0 │
+│ t              │ Tuple(a String, b UInt64) │ DEFAULT      │ ('foo', 0)         │                                                                                         │ ZSTD(1)          │                │            0 │          0 │
+│ _part          │ LowCardinality(String)    │              │                    │ Name of part                                                                            │                  │                │            0 │          1 │
+│ _part_index    │ UInt64                    │              │                    │ Sequential index of the part in the query result                                        │                  │                │            0 │          1 │
+│ _part_uuid     │ UUID                      │              │                    │ Unique part identifier (if enabled MergeTree setting assign_part_uuids)                 │                  │                │            0 │          1 │
+│ _partition_id  │ LowCardinality(String)    │              │                    │ Name of partition                                                                       │                  │                │            0 │          1 │
+│ _sample_factor │ Float64                   │              │                    │ Sample factor (from the query)                                                          │                  │                │            0 │          1 │
+│ _part_offset   │ UInt64                    │              │                    │ Number of row in the part                                                               │                  │                │            0 │          1 │
+│ _row_exists    │ UInt8                     │              │                    │ Persisted mask created by lightweight delete that show whether row exists or is deleted │                  │                │            0 │          1 │
+│ _block_number  │ UInt64                    │              │                    │ Persisted original number of block that was assigned at insert                          │ Delta, LZ4       │                │            0 │          1 │
+│ _table         │ LowCardinality(String)    │              │                    │ Name of a table                                                                         │                  │                │            0 │          1 │
+│ _shard_num     │ UInt32                    │              │                    │ Deprecated. Use function shardNum instead                                               │                  │                │            0 │          1 │
+│ arr.size0      │ UInt64                    │              │                    │                                                                                         │                  │                │            1 │          0 │
+│ t.a            │ String                    │              │                    │                                                                                         │ ZSTD(1)          │                │            1 │          0 │
+│ t.b            │ UInt64                    │              │                    │                                                                                         │ ZSTD(1)          │                │            1 │          0 │
+└────────────────┴───────────────────────────┴──────────────┴────────────────────┴─────────────────────────────────────────────────────────────────────────────────────────┴──────────────────┴────────────────┴──────────────┴────────────┘
 SET describe_compact_output = 1, describe_include_virtual_columns = 0, describe_include_subcolumns = 0;
 DESCRIBE TABLE t_describe_options FORMAT PrettyCompactNoEscapes;
-┌─name─┬─type─────────────────────────────┐
-│ id   │ UInt64                           │
-│ arr  │ Array(UInt64)                    │
-│ t    │ Tuple(
-    a String,
-    b UInt64) │
-└──────┴──────────────────────────────────┘
+┌─name─┬─type──────────────────────┐
+│ id   │ UInt64                    │
+│ arr  │ Array(UInt64)             │
+│ t    │ Tuple(a String, b UInt64) │
+└──────┴───────────────────────────┘
 DESCRIBE remote(default, currentDatabase(), t_describe_options) FORMAT PrettyCompactNoEscapes;
-┌─name─┬─type─────────────────────────────┐
-│ id   │ UInt64                           │
-│ arr  │ Array(UInt64)                    │
-│ t    │ Tuple(
-    a String,
-    b UInt64) │
-└──────┴──────────────────────────────────┘
+┌─name─┬─type──────────────────────┐
+│ id   │ UInt64                    │
+│ arr  │ Array(UInt64)             │
+│ t    │ Tuple(a String, b UInt64) │
+└──────┴───────────────────────────┘
 SET describe_compact_output = 1, describe_include_virtual_columns = 0, describe_include_subcolumns = 1;
 DESCRIBE TABLE t_describe_options FORMAT PrettyCompactNoEscapes;
-┌─name──────┬─type─────────────────────────────┬─is_subcolumn─┐
-│ id        │ UInt64                           │            0 │
-│ arr       │ Array(UInt64)                    │            0 │
-│ t         │ Tuple(
-    a String,
-    b UInt64) │            0 │
-│ arr.size0 │ UInt64                           │            1 │
-│ t.a       │ String                           │            1 │
-│ t.b       │ UInt64                           │            1 │
-└───────────┴──────────────────────────────────┴──────────────┘
+┌─name──────┬─type──────────────────────┬─is_subcolumn─┐
+│ id        │ UInt64                    │            0 │
+│ arr       │ Array(UInt64)             │            0 │
+│ t         │ Tuple(a String, b UInt64) │            0 │
+│ arr.size0 │ UInt64                    │            1 │
+│ t.a       │ String                    │            1 │
+│ t.b       │ UInt64                    │            1 │
+└───────────┴───────────────────────────┴──────────────┘
 DESCRIBE remote(default, currentDatabase(), t_describe_options) FORMAT PrettyCompactNoEscapes;
-┌─name──────┬─type─────────────────────────────┬─is_subcolumn─┐
-│ id        │ UInt64                           │            0 │
-│ arr       │ Array(UInt64)                    │            0 │
-│ t         │ Tuple(
-    a String,
-    b UInt64) │            0 │
-│ arr.size0 │ UInt64                           │            1 │
-│ t.a       │ String                           │            1 │
-│ t.b       │ UInt64                           │            1 │
-└───────────┴──────────────────────────────────┴──────────────┘
+┌─name──────┬─type──────────────────────┬─is_subcolumn─┐
+│ id        │ UInt64                    │            0 │
+│ arr       │ Array(UInt64)             │            0 │
+│ t         │ Tuple(a String, b UInt64) │            0 │
+│ arr.size0 │ UInt64                    │            1 │
+│ t.a       │ String                    │            1 │
+│ t.b       │ UInt64                    │            1 │
+└───────────┴───────────────────────────┴──────────────┘
 SET describe_compact_output = 1, describe_include_virtual_columns = 1, describe_include_subcolumns = 0;
 DESCRIBE TABLE t_describe_options FORMAT PrettyCompactNoEscapes;
-┌─name─────────────┬─type─────────────────────────────┬─is_virtual─┐
-│ id               │ UInt64                           │          0 │
-│ arr              │ Array(UInt64)                    │          0 │
-│ t                │ Tuple(
-    a String,
-    b UInt64) │          0 │
-│ _part            │ LowCardinality(String)           │          1 │
-│ _part_index      │ UInt64                           │          1 │
-│ _part_uuid       │ UUID                             │          1 │
-│ _partition_id    │ LowCardinality(String)           │          1 │
-│ _partition_value │ UInt8                            │          1 │
-│ _sample_factor   │ Float64                          │          1 │
-│ _part_offset     │ UInt64                           │          1 │
-│ _row_exists      │ UInt8                            │          1 │
-│ _block_number    │ UInt64                           │          1 │
-└──────────────────┴──────────────────────────────────┴────────────┘
+┌─name───────────┬─type──────────────────────┬─is_virtual─┐
+│ id             │ UInt64                    │          0 │
+│ arr            │ Array(UInt64)             │          0 │
+│ t              │ Tuple(a String, b UInt64) │          0 │
+│ _part          │ LowCardinality(String)    │          1 │
+│ _part_index    │ UInt64                    │          1 │
+│ _part_uuid     │ UUID                      │          1 │
+│ _partition_id  │ LowCardinality(String)    │          1 │
+│ _sample_factor │ Float64                   │          1 │
+│ _part_offset   │ UInt64                    │          1 │
+│ _row_exists    │ UInt8                     │          1 │
+│ _block_number  │ UInt64                    │          1 │
+└────────────────┴───────────────────────────┴────────────┘
 DESCRIBE remote(default, currentDatabase(), t_describe_options) FORMAT PrettyCompactNoEscapes;
-┌─name───────────┬─type─────────────────────────────┬─is_virtual─┐
-│ id             │ UInt64                           │          0 │
-│ arr            │ Array(UInt64)                    │          0 │
-│ t              │ Tuple(
-    a String,
-    b UInt64) │          0 │
-│ _table         │ LowCardinality(String)           │          1 │
-│ _part          │ LowCardinality(String)           │          1 │
-│ _part_index    │ UInt64                           │          1 │
-│ _part_uuid     │ UUID                             │          1 │
-│ _partition_id  │ LowCardinality(String)           │          1 │
-│ _sample_factor │ Float64                          │          1 │
-│ _part_offset   │ UInt64                           │          1 │
-│ _row_exists    │ UInt8                            │          1 │
-│ _block_number  │ UInt64                           │          1 │
-│ _shard_num     │ UInt32                           │          1 │
-└────────────────┴──────────────────────────────────┴────────────┘
+┌─name───────────┬─type──────────────────────┬─is_virtual─┐
+│ id             │ UInt64                    │          0 │
+│ arr            │ Array(UInt64)             │          0 │
+│ t              │ Tuple(a String, b UInt64) │          0 │
+│ _part          │ LowCardinality(String)    │          1 │
+│ _part_index    │ UInt64                    │          1 │
+│ _part_uuid     │ UUID                      │          1 │
+│ _partition_id  │ LowCardinality(String)    │          1 │
+│ _sample_factor │ Float64                   │          1 │
+│ _part_offset   │ UInt64                    │          1 │
+│ _row_exists    │ UInt8                     │          1 │
+│ _block_number  │ UInt64                    │          1 │
+│ _table         │ LowCardinality(String)    │          1 │
+│ _shard_num     │ UInt32                    │          1 │
+└────────────────┴───────────────────────────┴────────────┘
 SET describe_compact_output = 1, describe_include_virtual_columns = 1, describe_include_subcolumns = 1;
 DESCRIBE TABLE t_describe_options FORMAT PrettyCompactNoEscapes;
-┌─name─────────────┬─type─────────────────────────────┬─is_subcolumn─┬─is_virtual─┐
-│ id               │ UInt64                           │            0 │          0 │
-│ arr              │ Array(UInt64)                    │            0 │          0 │
-│ t                │ Tuple(
-    a String,
-    b UInt64) │            0 │          0 │
-│ _part            │ LowCardinality(String)           │            0 │          1 │
-│ _part_index      │ UInt64                           │            0 │          1 │
-│ _part_uuid       │ UUID                             │            0 │          1 │
-│ _partition_id    │ LowCardinality(String)           │            0 │          1 │
-│ _partition_value │ UInt8                            │            0 │          1 │
-│ _sample_factor   │ Float64                          │            0 │          1 │
-│ _part_offset     │ UInt64                           │            0 │          1 │
-│ _row_exists      │ UInt8                            │            0 │          1 │
-│ _block_number    │ UInt64                           │            0 │          1 │
-│ arr.size0        │ UInt64                           │            1 │          0 │
-│ t.a              │ String                           │            1 │          0 │
-│ t.b              │ UInt64                           │            1 │          0 │
-└──────────────────┴──────────────────────────────────┴──────────────┴────────────┘
+┌─name───────────┬─type──────────────────────┬─is_subcolumn─┬─is_virtual─┐
+│ id             │ UInt64                    │            0 │          0 │
+│ arr            │ Array(UInt64)             │            0 │          0 │
+│ t              │ Tuple(a String, b UInt64) │            0 │          0 │
+│ _part          │ LowCardinality(String)    │            0 │          1 │
+│ _part_index    │ UInt64                    │            0 │          1 │
+│ _part_uuid     │ UUID                      │            0 │          1 │
+│ _partition_id  │ LowCardinality(String)    │            0 │          1 │
+│ _sample_factor │ Float64                   │            0 │          1 │
+│ _part_offset   │ UInt64                    │            0 │          1 │
+│ _row_exists    │ UInt8                     │            0 │          1 │
+│ _block_number  │ UInt64                    │            0 │          1 │
+│ arr.size0      │ UInt64                    │            1 │          0 │
+│ t.a            │ String                    │            1 │          0 │
+│ t.b            │ UInt64                    │            1 │          0 │
+└────────────────┴───────────────────────────┴──────────────┴────────────┘
 DESCRIBE remote(default, currentDatabase(), t_describe_options) FORMAT PrettyCompactNoEscapes;
-┌─name───────────┬─type─────────────────────────────┬─is_subcolumn─┬─is_virtual─┐
-│ id             │ UInt64                           │            0 │          0 │
-│ arr            │ Array(UInt64)                    │            0 │          0 │
-│ t              │ Tuple(
-    a String,
-    b UInt64) │            0 │          0 │
-│ _table         │ LowCardinality(String)           │            0 │          1 │
-│ _part          │ LowCardinality(String)           │            0 │          1 │
-│ _part_index    │ UInt64                           │            0 │          1 │
-│ _part_uuid     │ UUID                             │            0 │          1 │
-│ _partition_id  │ LowCardinality(String)           │            0 │          1 │
-│ _sample_factor │ Float64                          │            0 │          1 │
-│ _part_offset   │ UInt64                           │            0 │          1 │
-│ _row_exists    │ UInt8                            │            0 │          1 │
-│ _block_number  │ UInt64                           │            0 │          1 │
-│ _shard_num     │ UInt32                           │            0 │          1 │
-│ arr.size0      │ UInt64                           │            1 │          0 │
-│ t.a            │ String                           │            1 │          0 │
-│ t.b            │ UInt64                           │            1 │          0 │
-└────────────────┴──────────────────────────────────┴──────────────┴────────────┘
+┌─name───────────┬─type──────────────────────┬─is_subcolumn─┬─is_virtual─┐
+│ id             │ UInt64                    │            0 │          0 │
+│ arr            │ Array(UInt64)             │            0 │          0 │
+│ t              │ Tuple(a String, b UInt64) │            0 │          0 │
+│ _part          │ LowCardinality(String)    │            0 │          1 │
+│ _part_index    │ UInt64                    │            0 │          1 │
+│ _part_uuid     │ UUID                      │            0 │          1 │
+│ _partition_id  │ LowCardinality(String)    │            0 │          1 │
+│ _sample_factor │ Float64                   │            0 │          1 │
+│ _part_offset   │ UInt64                    │            0 │          1 │
+│ _row_exists    │ UInt8                     │            0 │          1 │
+│ _block_number  │ UInt64                    │            0 │          1 │
+│ _table         │ LowCardinality(String)    │            0 │          1 │
+│ _shard_num     │ UInt32                    │            0 │          1 │
+│ arr.size0      │ UInt64                    │            1 │          0 │
+│ t.a            │ String                    │            1 │          0 │
+│ t.b            │ UInt64                    │            1 │          0 │
+└────────────────┴───────────────────────────┴──────────────┴────────────┘
diff --git a/tests/queries/0_stateless/02890_describe_table_options.sql b/tests/queries/0_stateless/02890_describe_table_options.sql
index 236100148ffc..63806c7ee3d2 100644
--- a/tests/queries/0_stateless/02890_describe_table_options.sql
+++ b/tests/queries/0_stateless/02890_describe_table_options.sql
@@ -1,5 +1,7 @@
 DROP TABLE IF EXISTS t_describe_options;
 
+SET print_pretty_type_names = 0;
+
 CREATE TABLE t_describe_options (
     id UInt64 COMMENT 'index column',
     arr Array(UInt64) DEFAULT [10, 20] CODEC(ZSTD),
diff --git a/tests/queries/0_stateless/03000_virtual_columns_in_prewhere.reference b/tests/queries/0_stateless/03000_virtual_columns_in_prewhere.reference
new file mode 100644
index 000000000000..06b63ea6c2f0
--- /dev/null
+++ b/tests/queries/0_stateless/03000_virtual_columns_in_prewhere.reference
@@ -0,0 +1,1 @@
+0	0	0
diff --git a/tests/queries/0_stateless/03000_virtual_columns_in_prewhere.sql b/tests/queries/0_stateless/03000_virtual_columns_in_prewhere.sql
new file mode 100644
index 000000000000..d57db9151b96
--- /dev/null
+++ b/tests/queries/0_stateless/03000_virtual_columns_in_prewhere.sql
@@ -0,0 +1,10 @@
+drop table if exists x;
+
+create table x (i int, j int, k int) engine MergeTree order by tuple() settings index_granularity=8192, index_granularity_bytes = '10Mi',  min_bytes_for_wide_part=0, min_rows_for_wide_part=0, ratio_of_defaults_for_sparse_serialization=1;
+
+insert into x select number, number * 2, number * 3 from numbers(100000);
+
+-- One granule, (_part_offset (8 bytes) + <one minimal physical column> (4 bytes)) * 8192 + <other two physical columns>(8 bytes) * 1 = 98312
+select * from x prewhere _part_offset = 0 settings max_bytes_to_read = 98312;
+
+drop table x;
