diff --git a/tests/queries/0_stateless/01500_StorageFile_write_to_fd.sh b/tests/queries/0_stateless/01500_StorageFile_write_to_fd.sh
index 1d66f374a204..d4bb7d468bd4 100755
--- a/tests/queries/0_stateless/01500_StorageFile_write_to_fd.sh
+++ b/tests/queries/0_stateless/01500_StorageFile_write_to_fd.sh
@@ -5,7 +5,7 @@ CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
 . "$CURDIR"/../shell_config.sh
 
 # The following command will execute:
-#     CREATE TABLE table (key UInt32) ENGINE = File(TSV, stdin);
+#     CREATE TEMPORARY TABLE table (key UInt32) ENGINE = File(TSV, stdin);
 #     INSERT INTO `table` SELECT key FROM input('key UInt32') FORMAT TSV
-${CLICKHOUSE_LOCAL} -S 'key UInt32' -q "INSERT INTO \`table\` SELECT key FROM input('key UInt32') FORMAT TSV" < /dev/null 2>&1 \
+${CLICKHOUSE_LOCAL} -S 'key UInt32' -q "INSERT INTO \`table\` SELECT key FROM input('key UInt32') FORMAT TSV" --input-format TSV < /dev/null 2>&1 \
     | grep -q "No data to insert" || echo "Fail"
diff --git a/tests/queries/0_stateless/03408_implicit_table.reference b/tests/queries/0_stateless/03408_implicit_table.reference
new file mode 100644
index 000000000000..8ae9641531e2
--- /dev/null
+++ b/tests/queries/0_stateless/03408_implicit_table.reference
@@ -0,0 +1,27 @@
+-- { echo }
+SET implicit_select = 1, implicit_table_at_top_level = 'test', enable_analyzer = 1;
+DROP TABLE IF EXISTS test;
+CREATE TABLE test (s String) ENGINE = Memory;
+INSERT INTO test VALUES ('Hello'), ('World');
+s;
+Hello
+World
+count();
+2
+1;
+1
+1
+*;
+Hello
+World
+SELECT *, (SELECT 1);
+Hello	1
+World	1
+SELECT * FROM (SELECT *);
+0
+SELECT * UNION ALL SELECT *;
+Hello
+World
+Hello
+World
+DROP TABLE test;
diff --git a/tests/queries/0_stateless/03408_implicit_table.sql b/tests/queries/0_stateless/03408_implicit_table.sql
new file mode 100644
index 000000000000..58e292ed3415
--- /dev/null
+++ b/tests/queries/0_stateless/03408_implicit_table.sql
@@ -0,0 +1,15 @@
+-- { echo }
+SET implicit_select = 1, implicit_table_at_top_level = 'test', enable_analyzer = 1;
+DROP TABLE IF EXISTS test;
+CREATE TABLE test (s String) ENGINE = Memory;
+INSERT INTO test VALUES ('Hello'), ('World');
+
+s;
+count();
+1;
+*;
+SELECT *, (SELECT 1);
+SELECT * FROM (SELECT *);
+SELECT * UNION ALL SELECT *;
+
+DROP TABLE test;
diff --git a/tests/queries/0_stateless/03409_implicit_table_clickhouse_local.reference b/tests/queries/0_stateless/03409_implicit_table_clickhouse_local.reference
new file mode 100644
index 000000000000..d4a828faccee
--- /dev/null
+++ b/tests/queries/0_stateless/03409_implicit_table_clickhouse_local.reference
@@ -0,0 +1,1 @@
+123	test
diff --git a/tests/queries/0_stateless/03409_implicit_table_clickhouse_local.sh b/tests/queries/0_stateless/03409_implicit_table_clickhouse_local.sh
new file mode 100755
index 000000000000..3c98f3f13f4f
--- /dev/null
+++ b/tests/queries/0_stateless/03409_implicit_table_clickhouse_local.sh
@@ -0,0 +1,7 @@
+#!/usr/bin/env bash
+
+CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
+# shellcheck source=../shell_config.sh
+. "$CURDIR"/../shell_config.sh
+
+echo '{"Hello": {"world": 123}, "goodbye": "test"}' | ${CLICKHOUSE_LOCAL} -q "Hello.world, goodbye" --input-format JSONEachRow
