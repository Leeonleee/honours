{
  "repo": "ClickHouse/ClickHouse",
  "pull_number": 24313,
  "instance_id": "ClickHouse__ClickHouse-24313",
  "issue_numbers": [
    "24310"
  ],
  "base_commit": "6d586c918022256db752abe590fd906b7aa41fce",
  "patch": "diff --git a/src/Common/NamePrompter.h b/src/Common/NamePrompter.h\nindex 5f7832c44232..bb17f860f292 100644\n--- a/src/Common/NamePrompter.h\n+++ b/src/Common/NamePrompter.h\n@@ -90,17 +90,16 @@ class NamePrompter\n     }\n };\n \n-template <size_t MaxNumHints, class Self>\n+\n+template <size_t MaxNumHints, typename Self>\n class IHints\n {\n public:\n-\n     virtual std::vector<String> getAllRegisteredNames() const = 0;\n \n     std::vector<String> getHints(const String & name) const\n     {\n-        static const auto registered_names = getAllRegisteredNames();\n-        return prompter.getHints(name, registered_names);\n+        return prompter.getHints(name, getAllRegisteredNames());\n     }\n \n     virtual ~IHints() = default;\ndiff --git a/src/DataTypes/EnumValues.cpp b/src/DataTypes/EnumValues.cpp\nindex 39c24bf1122f..6df899ba9a27 100644\n--- a/src/DataTypes/EnumValues.cpp\n+++ b/src/DataTypes/EnumValues.cpp\n@@ -67,7 +67,7 @@ T EnumValues<T>::getValue(StringRef field_name, bool try_treat_as_id) const\n                 return x;\n         }\n         auto hints = this->getHints(field_name.toString());\n-        auto hints_string = !hints.empty() ? \", may be you meant: \" + toString(hints) : \"\";\n+        auto hints_string = !hints.empty() ? \", maybe you meant: \" + toString(hints) : \"\";\n         throw Exception{\"Unknown element '\" + field_name.toString() + \"' for enum\" + hints_string, ErrorCodes::BAD_ARGUMENTS};\n     }\n     return it->getMapped();\n",
  "test_patch": "diff --git a/tests/queries/0_stateless/01852_hints_enum_name.sh b/tests/queries/0_stateless/01852_hints_enum_name.sh\nindex bffde6e6c8c0..1e7d09602e98 100755\n--- a/tests/queries/0_stateless/01852_hints_enum_name.sh\n+++ b/tests/queries/0_stateless/01852_hints_enum_name.sh\n@@ -4,5 +4,5 @@ CURDIR=$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" && pwd)\n # shellcheck source=../shell_config.sh\n . \"$CURDIR\"/../shell_config.sh\n \n-$CLICKHOUSE_CLIENT --query=\"SELECT CAST('Helo', 'Enum(\\'Hello\\' = 1, \\'World\\' = 2)')\" 2>&1 | grep -q \"may be you meant: \\['Hello'\\]\" && echo 'OK' || echo 'FAIL'\n+$CLICKHOUSE_CLIENT --query=\"SELECT CAST('Helo' AS Enum('Hello' = 1, 'World' = 2))\" 2>&1 | grep -q -F \"maybe you meant: ['Hello']\" && echo 'OK' || echo 'FAIL'\n \n",
  "problem_statement": "Fix test\nI hereby agree to the terms of the CLA available at: https://yandex.ru/legal/cla/?lang=en\r\n\r\nChangelog category (leave one):\r\n- Not for changelog (changelog entry is not required)\r\n\r\n\n",
  "hints_text": "",
  "created_at": "2021-05-19T22:28:10Z",
  "modified_files": [
    "src/Common/NamePrompter.h",
    "src/DataTypes/EnumValues.cpp"
  ],
  "modified_test_files": [
    "tests/queries/0_stateless/01852_hints_enum_name.sh"
  ]
}