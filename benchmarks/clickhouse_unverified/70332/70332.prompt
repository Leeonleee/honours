You will be provided with a partial code base and an issue statement explaining a problem to resolve.

<issue>
LDAP: authentication with configured role mapping fails on a cluster with a secret
When ClickHouse server is configured as a part of a cluster with a secret, and there is an LDAP user directory with a role mapping, authentications for users from that directory fails.

If the `<secret>` is removed from the cluster config, or role mapping is disabled for LDAP user directory, users are authenticated successfully.
</issue>

I need you to solve the provided issue by generating a code fix that can be applied directly to the repository

Respond below:
