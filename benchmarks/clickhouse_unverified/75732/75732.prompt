You will be provided with a partial code base and an issue statement explaining a problem to resolve.

<issue>
array join not working in subquery with enable_analyzer=1
> 24.9.2
https://fiddle.clickhouse.com/04789f5f-4f83-4703-bc51-15af31eb8e58

```sql
create table merge (url String, mergedUrls Array(String)) engine = Memory;
insert into merge values ('a', ['b', 'c']);

with input as (
    select distinct on (d.url) d.url as cluster_name from merge d order by d.url desc limit 100
),
    cluster_url_q1 as (
        select distinct on (d.url) d.url as cluster_name, d.mergedUrls as url
        from merge d
        where d.url in input
        order by d.url
    ),
    cluster_url_t as (
        select distinct on (cluster_name, url) cluster_name, url
        from cluster_url_q1
        array join url
    ),
    (select groupArray((cluster_name, url)) from cluster_url_t) as cluster_url_a
select cluster_url_a, groupArray((cluster_name, url)) from cluster_url_t
settings enable_analyzer=1;
```

after another attempt to turn on the analyzer in one of the queries, the array join stopped working.
expected `[('a','b'),('a','c')]` got `[('a',['b','c'])]`
Multiple Array Joins not working as excepted when passed inside subquery
### Company or project name

_No response_

### Describe what's wrong

When multiple array joins are passed inside a subquery, results of 2nd array join is not working as expected. Row values are still returned as an array, whereas it should have been returned as single value.

https://fiddle.clickhouse.com/4f1f64b7-1105-4d89-bb99-800c056b8f97


### Does it reproduce on the most recent release?

Yes

### How to reproduce

ClickHouse version - latest

https://fiddle.clickhouse.com/4f1f64b7-1105-4d89-bb99-800c056b8f97


```
CREATE TABLE test_table(
    id integer,
    array_a Nested(
        a1 String,
        a2 String
    ),
    array_b Nested(
        b1 String,
        b2 String
    )
)
ENGINE=MergeTree()
ORDER BY id;

INSERT INTO test_table (id, array_a.a1, array_a.a2, array_b.b1, array_b.b2) VALUES ('1', ['r1a1'], ['r1a2'], ['r1b1'], ['r1b2']);

-- sample query with multiple array joins
SELECT array_b.b1
FROM
(
    SELECT *
    FROM test_table
    ARRAY JOIN array_a
)
ARRAY JOIN array_b;

-- query with multiple array joins passed inside subquery which returns wrong result
SELECT (
        SELECT array_b.b1
        FROM
        (
            SELECT *
            FROM test_table
            ARRAY JOIN array_a
        )
        ARRAY JOIN array_b
    ) AS rows;
```

### Expected behavior

Results of multiple array join inside subquery is returning singular value in CH version <= 24.9.3

https://fiddle.clickhouse.com/067572ae-1265-415a-ba41-1723f915af98

### Error message and/or stacktrace

_No response_

### Additional context

_No response_
</issue>

I need you to solve the provided issue by generating a code fix that can be applied directly to the repository

Respond below:
