diff --git a/src/Common/tests/gtest_named_collections.cpp b/src/Common/tests/gtest_named_collections.cpp
index bd46d2668e46..e2482f6ba8ba 100644
--- a/src/Common/tests/gtest_named_collections.cpp
+++ b/src/Common/tests/gtest_named_collections.cpp
@@ -77,7 +77,7 @@ key5:	5
 key6:	6.6
 )CONFIG");
 
-    collection2_copy->setOrUpdate<String>("key4", "value44");
+    collection2_copy->setOrUpdate<String>("key4", "value44", {});
     ASSERT_EQ(collection2_copy->get<String>("key4"), "value44");
     ASSERT_EQ(collection2->get<String>("key4"), "value4");
 
@@ -85,7 +85,7 @@ key6:	6.6
     ASSERT_EQ(collection2_copy->getOrDefault<String>("key4", "N"), "N");
     ASSERT_EQ(collection2->getOrDefault<String>("key4", "N"), "value4");
 
-    collection2_copy->setOrUpdate<String>("key4", "value45");
+    collection2_copy->setOrUpdate<String>("key4", "value45", {});
     ASSERT_EQ(collection2_copy->getOrDefault<String>("key4", "N"), "value45");
 
     NamedCollectionFactory::instance().remove("collection2_copy");
diff --git a/tests/config/config.d/named_collection.xml b/tests/config/config.d/named_collection.xml
index 5b716a7b8da5..01645ccecd50 100644
--- a/tests/config/config.d/named_collection.xml
+++ b/tests/config/config.d/named_collection.xml
@@ -37,5 +37,13 @@
             <access_key_id>test</access_key_id>
             <secret_access_key>testtest</secret_access_key>
         </s3_conn_db>
+        <url_override1>
+            <url overridable="0">http://127.0.0.1:8123?query=select+1</url>
+            <format overridable="1">RawBLOB</format>
+        </url_override1>
+        <url_override2>
+            <url>http://127.0.0.1:8123?query=select+1</url>
+            <format>RawBLOB</format>
+        </url_override2>
     </named_collections>
 </clickhouse>
diff --git a/tests/queries/0_stateless/02883_named_collections_override.reference b/tests/queries/0_stateless/02883_named_collections_override.reference
new file mode 100644
index 000000000000..78b3eeda9873
--- /dev/null
+++ b/tests/queries/0_stateless/02883_named_collections_override.reference
@@ -0,0 +1,32 @@
+allow_named_collection_override_by_default=1 u1
+1

+1

+1
+allow_named_collection_override_by_default=1 u2
+1

+1

+2

+1
+allow_named_collection_override_by_default=0 u1
+1

+1
+allow_named_collection_override_by_default=0 u2
+1

+Test ALTER
+2

+1

+Test XML collections
+allow_named_collection_override_by_default=1 url_override1
+1

+1

+1
+allow_named_collection_override_by_default=1 url_override2
+1

+1

+2

+1
+allow_named_collection_override_by_default=0 url_override1
+1

+1
+allow_named_collection_override_by_default=0 url_override2
+1

diff --git a/tests/queries/0_stateless/02883_named_collections_override.sh b/tests/queries/0_stateless/02883_named_collections_override.sh
new file mode 100755
index 000000000000..a08c795127da
--- /dev/null
+++ b/tests/queries/0_stateless/02883_named_collections_override.sh
@@ -0,0 +1,92 @@
+#!/usr/bin/env bash
+
+CUR_DIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
+# shellcheck source=../shell_config.sh
+. "$CUR_DIR"/../shell_config.sh
+
+u1="${CLICKHOUSE_TEST_UNIQUE_NAME}_collection1"
+u2="${CLICKHOUSE_TEST_UNIQUE_NAME}_collection2"
+u3="${CLICKHOUSE_TEST_UNIQUE_NAME}_collection3"
+
+${CLICKHOUSE_CLIENT}  -nm --query "
+
+DROP NAMED COLLECTION IF EXISTS $u1;
+DROP NAMED COLLECTION IF EXISTS $u2;
+DROP NAMED COLLECTION IF EXISTS $u3;
+
+CREATE NAMED COLLECTION IF NOT EXISTS $u1 AS
+    url = 'http://127.0.0.1:8123?query=select+1' NOT OVERRIDABLE,
+    format = 'RawBLOB' OVERRIDABLE;
+
+CREATE NAMED COLLECTION IF NOT EXISTS $u2 AS
+    url = 'http://127.0.0.1:8123?query=select+1',
+    format = 'RawBLOB';
+
+SET allow_named_collection_override_by_default=1;
+SELECT 'allow_named_collection_override_by_default=1 u1';
+SELECT * FROM url($u1);
+SELECT * FROM url($u1, headers('Accept'='text/csv; charset=utf-8'));
+SELECT * FROM url($u1, url='http://127.0.0.1:8123?query=select+2'); -- { serverError BAD_ARGUMENTS }
+SELECT * FROM url($u1, format='CSV');
+SELECT 'allow_named_collection_override_by_default=1 u2';
+SELECT * FROM url($u2);
+SELECT * FROM url($u2, headers('Accept'='text/csv; charset=utf-8'));
+SELECT * FROM url($u2, url='http://127.0.0.1:8123?query=select+2');
+SELECT * FROM url($u2, format='CSV');
+
+SET allow_named_collection_override_by_default=0;
+SELECT 'allow_named_collection_override_by_default=0 u1';
+SELECT * FROM url($u1);
+SELECT * FROM url($u1, headers('Accept'='text/csv; charset=utf-8')); -- { serverError BAD_ARGUMENTS }
+SELECT * FROM url($u1, url='http://127.0.0.1:8123?query=select+2'); -- { serverError BAD_ARGUMENTS }
+SELECT * FROM url($u1, format='CSV');
+SELECT 'allow_named_collection_override_by_default=0 u2';
+SELECT * FROM url($u2);
+SELECT * FROM url($u2, headers('Accept'='text/csv; charset=utf-8')); -- { serverError BAD_ARGUMENTS }
+SELECT * FROM url($u2, url='http://127.0.0.1:8123?query=select+2'); -- { serverError BAD_ARGUMENTS }
+SELECT * FROM url($u2, format='CSV'); -- { serverError BAD_ARGUMENTS }
+
+SELECT 'Test ALTER';
+
+CREATE NAMED COLLECTION IF NOT EXISTS $u3 AS
+    url = 'http://127.0.0.1:8123?query=select+1' NOT OVERRIDABLE,
+    format = 'RawBLOB' OVERRIDABLE;
+
+ALTER NAMED COLLECTION $u3 SET
+    url = 'http://127.0.0.1:8123?query=select+2' OVERRIDABLE,
+    format = 'RawBLOB' NOT OVERRIDABLE;
+
+SELECT * FROM url($u3);
+SELECT * FROM url($u3, url='http://127.0.0.1:8123?query=select+1');
+SELECT * FROM url($u3, format='CSV'); -- { serverError BAD_ARGUMENTS }
+
+DROP NAMED COLLECTION IF EXISTS $u1;
+DROP NAMED COLLECTION IF EXISTS $u2;
+DROP NAMED COLLECTION IF EXISTS $u2;
+
+SELECT 'Test XML collections';
+
+SET allow_named_collection_override_by_default=1;
+SELECT 'allow_named_collection_override_by_default=1 url_override1';
+SELECT * FROM url(url_override1);
+SELECT * FROM url(url_override1, headers('Accept'='text/csv; charset=utf-8'));
+SELECT * FROM url(url_override1, url='http://127.0.0.1:8123?query=select+2'); -- { serverError BAD_ARGUMENTS }
+SELECT * FROM url(url_override1, format='CSV');
+SELECT 'allow_named_collection_override_by_default=1 url_override2';
+SELECT * FROM url(url_override2);
+SELECT * FROM url(url_override2, headers('Accept'='text/csv; charset=utf-8'));
+SELECT * FROM url(url_override2, url='http://127.0.0.1:8123?query=select+2');
+SELECT * FROM url(url_override2, format='CSV');
+
+SET allow_named_collection_override_by_default=0;
+SELECT 'allow_named_collection_override_by_default=0 url_override1';
+SELECT * FROM url(url_override1);
+SELECT * FROM url(url_override1, headers('Accept'='text/csv; charset=utf-8')); -- { serverError BAD_ARGUMENTS }
+SELECT * FROM url(url_override1, url='http://127.0.0.1:8123?query=select+2'); -- { serverError BAD_ARGUMENTS }
+SELECT * FROM url(url_override1, format='CSV');
+SELECT 'allow_named_collection_override_by_default=0 url_override2';
+SELECT * FROM url(url_override2);
+SELECT * FROM url(url_override2, headers('Accept'='text/csv; charset=utf-8')); -- { serverError BAD_ARGUMENTS }
+SELECT * FROM url(url_override2, url='http://127.0.0.1:8123?query=select+2'); -- { serverError BAD_ARGUMENTS }
+SELECT * FROM url(url_override2, format='CSV'); -- { serverError BAD_ARGUMENTS }
+"
