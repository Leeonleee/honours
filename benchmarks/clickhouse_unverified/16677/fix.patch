diff --git a/src/Common/FieldVisitors.h b/src/Common/FieldVisitors.h
index 4fcb3091833f..79d5af889041 100644
--- a/src/Common/FieldVisitors.h
+++ b/src/Common/FieldVisitors.h
@@ -3,6 +3,7 @@
 #include <Core/DecimalFunctions.h>
 #include <Core/Field.h>
 #include <common/demangle.h>
+#include <Common/NaNUtils.h>
 
 
 class SipHash;
@@ -142,6 +143,19 @@ class FieldVisitorConvertToNumber : public StaticVisitor<T>
 
     T operator() (const Float64 & x) const
     {
+        if constexpr (!std::is_floating_point_v<T>)
+        {
+            if (!isFinite(x))
+            {
+                /// When converting to bool it's ok (non-zero converts to true, NaN including).
+                if (std::is_same_v<T, bool>)
+                    return true;
+
+                /// Conversion of infinite values to integer is undefined.
+                throw Exception("Cannot convert infinite value to integer type", ErrorCodes::CANNOT_CONVERT_TYPE);
+            }
+        }
+
         if constexpr (std::is_same_v<Decimal256, T>)
             return Int256(x);
         else
