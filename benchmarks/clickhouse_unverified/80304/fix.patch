diff --git a/src/Formats/NativeReader.cpp b/src/Formats/NativeReader.cpp
index 36ca2b6b26bb..f4506466aa04 100644
--- a/src/Formats/NativeReader.cpp
+++ b/src/Formats/NativeReader.cpp
@@ -233,9 +233,8 @@ Block NativeReader::read()
         {
             /// Index allows to do more checks.
             if (index_column_it->name != column.name)
-                throw Exception(ErrorCodes::INCORRECT_INDEX, "Index points to column with wrong name: corrupted index or data");
-            if (index_column_it->type != type_name)
-                throw Exception(ErrorCodes::INCORRECT_INDEX, "Index points to column with wrong type: corrupted index or data");
+                throw Exception(ErrorCodes::INCORRECT_INDEX, "Index points to a column with a wrong name ({} instead of {}): corrupted index or data", index_column_it->name, column.name);
+            /// Note: we can't compare data types as strings, compatible data types may differ in parameters.
         }
 
         /// If no rows, nothing to read.
diff --git a/src/Storages/StorageStripeLog.cpp b/src/Storages/StorageStripeLog.cpp
index 522833f1f848..a4b1a8e3424b 100644
--- a/src/Storages/StorageStripeLog.cpp
+++ b/src/Storages/StorageStripeLog.cpp
@@ -1,4 +1,3 @@
-#include <sys/stat.h>
 #include <sys/types.h>
 
 #include <optional>
@@ -24,10 +23,9 @@
 
 #include <Interpreters/Context.h>
 
-#include <Parsers/ASTLiteral.h>
 #include <Storages/StorageFactory.h>
 #include <Storages/StorageStripeLog.h>
-#include "StorageLogSettings.h"
+#include <Storages/StorageLogSettings.h>
 #include <Processors/ISource.h>
 #include <Processors/Sources/NullSource.h>
 #include <Processors/Sinks/SinkToStorage.h>
