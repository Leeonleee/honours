diff --git a/tests/queries/0_stateless/01277_alter_rename_column_constraint.reference b/tests/queries/0_stateless/01277_alter_rename_column_constraint.reference
new file mode 100644
index 000000000000..cb1842f95da3
--- /dev/null
+++ b/tests/queries/0_stateless/01277_alter_rename_column_constraint.reference
@@ -0,0 +1,90 @@
+2019-10-01	0	0	1	2
+2019-10-02	1	1	2	3
+2019-10-03	2	2	3	4
+2019-10-01	3	3	4	5
+2019-10-02	4	4	5	6
+2019-10-03	5	5	6	7
+2019-10-01	6	6	7	8
+2019-10-02	7	7	8	9
+2019-10-03	8	8	9	10
+CREATE TABLE default.table_for_rename
(
    `date` Date, 
    `key` UInt64, 
    `value4` String, 
    `value5` String, 
    `value3` String, 
    CONSTRAINT cs_value1 CHECK toInt64(value4) < toInt64(value5), 
    CONSTRAINT cs_value2 CHECK toInt64(value5) < toInt64(value3)
)
ENGINE = MergeTree()
PARTITION BY date
ORDER BY key
SETTINGS index_granularity = 8192
+2019-10-01	0	0	1	2
+2019-10-02	1	1	2	3
+2019-10-03	2	2	3	4
+2019-10-01	3	3	4	5
+2019-10-02	4	4	5	6
+2019-10-03	5	5	6	7
+2019-10-01	6	6	7	8
+2019-10-02	7	7	8	9
+2019-10-03	8	8	9	10
+-- insert after rename --
+2019-10-01	0	0	1	2
+2019-10-02	1	1	2	3
+2019-10-03	2	2	3	4
+2019-10-01	3	3	4	5
+2019-10-02	4	4	5	6
+2019-10-03	5	5	6	7
+2019-10-01	6	6	7	8
+2019-10-02	7	7	8	9
+2019-10-03	8	8	9	10
+2019-10-02	10	10	11	12
+2019-10-03	11	11	12	13
+2019-10-01	12	12	13	14
+2019-10-02	13	13	14	15
+2019-10-03	14	14	15	16
+2019-10-01	15	15	16	17
+2019-10-02	16	16	17	18
+2019-10-03	17	17	18	19
+2019-10-01	18	18	19	20
+2019-10-02	19	19	20	21
+-- rename columns back --
+CREATE TABLE default.table_for_rename
(
    `date` Date, 
    `key` UInt64, 
    `value1` String, 
    `value2` String, 
    `value3` String, 
    CONSTRAINT cs_value1 CHECK toInt64(value1) < toInt64(value2), 
    CONSTRAINT cs_value2 CHECK toInt64(value2) < toInt64(value3)
)
ENGINE = MergeTree()
PARTITION BY date
ORDER BY key
SETTINGS index_granularity = 8192
+2019-10-01	0	0	1	2
+2019-10-02	1	1	2	3
+2019-10-03	2	2	3	4
+2019-10-01	3	3	4	5
+2019-10-02	4	4	5	6
+2019-10-03	5	5	6	7
+2019-10-01	6	6	7	8
+2019-10-02	7	7	8	9
+2019-10-03	8	8	9	10
+2019-10-02	10	10	11	12
+2019-10-03	11	11	12	13
+2019-10-01	12	12	13	14
+2019-10-02	13	13	14	15
+2019-10-03	14	14	15	16
+2019-10-01	15	15	16	17
+2019-10-02	16	16	17	18
+2019-10-03	17	17	18	19
+2019-10-01	18	18	19	20
+2019-10-02	19	19	20	21
+-- insert after rename column --
+2019-10-01	0	0	1	2
+2019-10-02	1	1	2	3
+2019-10-03	2	2	3	4
+2019-10-01	3	3	4	5
+2019-10-02	4	4	5	6
+2019-10-03	5	5	6	7
+2019-10-01	6	6	7	8
+2019-10-02	7	7	8	9
+2019-10-03	8	8	9	10
+2019-10-02	10	10	11	12
+2019-10-03	11	11	12	13
+2019-10-01	12	12	13	14
+2019-10-02	13	13	14	15
+2019-10-03	14	14	15	16
+2019-10-01	15	15	16	17
+2019-10-02	16	16	17	18
+2019-10-03	17	17	18	19
+2019-10-01	18	18	19	20
+2019-10-02	19	19	20	21
+2019-10-03	20	20	21	22
+2019-10-01	21	21	22	23
+2019-10-02	22	22	23	24
+2019-10-03	23	23	24	25
+2019-10-01	24	24	25	26
+2019-10-02	25	25	26	27
+2019-10-03	26	26	27	28
+2019-10-01	27	27	28	29
+2019-10-02	28	28	29	30
+2019-10-03	29	29	30	31
diff --git a/tests/queries/0_stateless/01277_alter_rename_column_constraint.sql b/tests/queries/0_stateless/01277_alter_rename_column_constraint.sql
new file mode 100644
index 000000000000..72fbb0456012
--- /dev/null
+++ b/tests/queries/0_stateless/01277_alter_rename_column_constraint.sql
@@ -0,0 +1,43 @@
+DROP TABLE IF EXISTS table_for_rename;
+
+CREATE TABLE table_for_rename
+(
+  date Date,
+  key UInt64,
+  value1 String,
+  value2 String,
+  value3 String,
+  CONSTRAINT cs_value1 CHECK toInt64(value1) < toInt64(value2),
+  CONSTRAINT cs_value2 CHECK toInt64(value2) < toInt64(value3)
+)
+ENGINE = MergeTree()
+PARTITION BY date
+ORDER BY key;
+
+INSERT INTO table_for_rename SELECT toDate('2019-10-01') + number % 3, number, toString(number), toString(number + 1), toString(number + 2) from numbers(9);
+INSERT INTO table_for_rename SELECT toDate('2019-10-01') + number % 3, number, toString(number), toString(number + 1), toString(number) from numbers(9); ; --{serverError 469}
+
+SELECT * FROM table_for_rename ORDER BY key;
+
+ALTER TABLE table_for_rename RENAME COLUMN value1 TO value4;
+ALTER TABLE table_for_rename RENAME COLUMN value2 TO value5;
+SHOW CREATE TABLE table_for_rename;
+SELECT * FROM table_for_rename ORDER BY key;
+
+SELECT '-- insert after rename --';
+INSERT INTO table_for_rename SELECT toDate('2019-10-01') + number % 3, number, toString(number), toString(number + 1), toString(number + 2) from numbers(10, 10);
+INSERT INTO table_for_rename SELECT toDate('2019-10-01') + number % 3, number, toString(number), toString(number + 1), toString(number) from numbers(10, 10); ; --{serverError 469}
+SELECT * FROM table_for_rename ORDER BY key;
+
+SELECT '-- rename columns back --';
+ALTER TABLE table_for_rename RENAME COLUMN value4 TO value1;
+ALTER TABLE table_for_rename RENAME COLUMN value5 TO value2;
+SHOW CREATE TABLE table_for_rename;
+SELECT * FROM table_for_rename ORDER BY key;
+
+SELECT '-- insert after rename column --';
+INSERT INTO table_for_rename SELECT toDate('2019-10-01') + number % 3, number, toString(number), toString(number + 1), toString(number + 2) from numbers(20,10);
+INSERT INTO table_for_rename SELECT toDate('2019-10-01') + number % 3, number, toString(number), toString(number), toString(number + 2) from numbers(20, 10); ; --{serverError 469}
+SELECT * FROM table_for_rename ORDER BY key;
+
+DROP TABLE IF EXISTS table_for_rename;
diff --git a/tests/queries/0_stateless/01277_alter_rename_column_constraint_zookeeper.reference b/tests/queries/0_stateless/01277_alter_rename_column_constraint_zookeeper.reference
new file mode 100644
index 000000000000..9ca17dbbc0a8
--- /dev/null
+++ b/tests/queries/0_stateless/01277_alter_rename_column_constraint_zookeeper.reference
@@ -0,0 +1,90 @@
+2019-10-01	0	0	1	2
+2019-10-02	1	1	2	3
+2019-10-03	2	2	3	4
+2019-10-01	3	3	4	5
+2019-10-02	4	4	5	6
+2019-10-03	5	5	6	7
+2019-10-01	6	6	7	8
+2019-10-02	7	7	8	9
+2019-10-03	8	8	9	10
+CREATE TABLE default.table_for_rename1
(
    `date` Date, 
    `key` UInt64, 
    `value4` String, 
    `value5` String, 
    `value3` String, 
    CONSTRAINT cs_value1 CHECK toInt64(value4) < toInt64(value5), 
    CONSTRAINT cs_value2 CHECK toInt64(value5) < toInt64(value3)
)
ENGINE = ReplicatedMergeTree(\'/clickhouse/tables/test_for_rename\', \'1\')
PARTITION BY date
ORDER BY key
SETTINGS index_granularity = 8192
+2019-10-01	0	0	1	2
+2019-10-02	1	1	2	3
+2019-10-03	2	2	3	4
+2019-10-01	3	3	4	5
+2019-10-02	4	4	5	6
+2019-10-03	5	5	6	7
+2019-10-01	6	6	7	8
+2019-10-02	7	7	8	9
+2019-10-03	8	8	9	10
+-- insert after rename --
+2019-10-01	0	0	1	2
+2019-10-02	1	1	2	3
+2019-10-03	2	2	3	4
+2019-10-01	3	3	4	5
+2019-10-02	4	4	5	6
+2019-10-03	5	5	6	7
+2019-10-01	6	6	7	8
+2019-10-02	7	7	8	9
+2019-10-03	8	8	9	10
+2019-10-02	10	10	11	12
+2019-10-03	11	11	12	13
+2019-10-01	12	12	13	14
+2019-10-02	13	13	14	15
+2019-10-03	14	14	15	16
+2019-10-01	15	15	16	17
+2019-10-02	16	16	17	18
+2019-10-03	17	17	18	19
+2019-10-01	18	18	19	20
+2019-10-02	19	19	20	21
+-- rename columns back --
+CREATE TABLE default.table_for_rename1
(
    `date` Date, 
    `key` UInt64, 
    `value1` String, 
    `value2` String, 
    `value3` String, 
    CONSTRAINT cs_value1 CHECK toInt64(value1) < toInt64(value2), 
    CONSTRAINT cs_value2 CHECK toInt64(value2) < toInt64(value3)
)
ENGINE = ReplicatedMergeTree(\'/clickhouse/tables/test_for_rename\', \'1\')
PARTITION BY date
ORDER BY key
SETTINGS index_granularity = 8192
+2019-10-01	0	0	1	2
+2019-10-02	1	1	2	3
+2019-10-03	2	2	3	4
+2019-10-01	3	3	4	5
+2019-10-02	4	4	5	6
+2019-10-03	5	5	6	7
+2019-10-01	6	6	7	8
+2019-10-02	7	7	8	9
+2019-10-03	8	8	9	10
+2019-10-02	10	10	11	12
+2019-10-03	11	11	12	13
+2019-10-01	12	12	13	14
+2019-10-02	13	13	14	15
+2019-10-03	14	14	15	16
+2019-10-01	15	15	16	17
+2019-10-02	16	16	17	18
+2019-10-03	17	17	18	19
+2019-10-01	18	18	19	20
+2019-10-02	19	19	20	21
+-- insert after rename column --
+2019-10-01	0	0	1	2
+2019-10-02	1	1	2	3
+2019-10-03	2	2	3	4
+2019-10-01	3	3	4	5
+2019-10-02	4	4	5	6
+2019-10-03	5	5	6	7
+2019-10-01	6	6	7	8
+2019-10-02	7	7	8	9
+2019-10-03	8	8	9	10
+2019-10-02	10	10	11	12
+2019-10-03	11	11	12	13
+2019-10-01	12	12	13	14
+2019-10-02	13	13	14	15
+2019-10-03	14	14	15	16
+2019-10-01	15	15	16	17
+2019-10-02	16	16	17	18
+2019-10-03	17	17	18	19
+2019-10-01	18	18	19	20
+2019-10-02	19	19	20	21
+2019-10-03	20	20	21	22
+2019-10-01	21	21	22	23
+2019-10-02	22	22	23	24
+2019-10-03	23	23	24	25
+2019-10-01	24	24	25	26
+2019-10-02	25	25	26	27
+2019-10-03	26	26	27	28
+2019-10-01	27	27	28	29
+2019-10-02	28	28	29	30
+2019-10-03	29	29	30	31
diff --git a/tests/queries/0_stateless/01277_alter_rename_column_constraint_zookeeper.sql b/tests/queries/0_stateless/01277_alter_rename_column_constraint_zookeeper.sql
new file mode 100644
index 000000000000..2d3a7e0198a6
--- /dev/null
+++ b/tests/queries/0_stateless/01277_alter_rename_column_constraint_zookeeper.sql
@@ -0,0 +1,43 @@
+DROP TABLE IF EXISTS table_for_rename1;
+
+CREATE TABLE table_for_rename1
+(
+  date Date,
+  key UInt64,
+  value1 String,
+  value2 String,
+  value3 String,
+  CONSTRAINT cs_value1 CHECK toInt64(value1) < toInt64(value2),
+  CONSTRAINT cs_value2 CHECK toInt64(value2) < toInt64(value3)
+)
+ENGINE = ReplicatedMergeTree('/clickhouse/tables/test_for_rename', '1')
+PARTITION BY date
+ORDER BY key;
+
+INSERT INTO table_for_rename1 SELECT toDate('2019-10-01') + number % 3, number, toString(number), toString(number + 1), toString(number + 2) from numbers(9);
+INSERT INTO table_for_rename1 SELECT toDate('2019-10-01') + number % 3, number, toString(number), toString(number + 1), toString(number) from numbers(9); ; --{serverError 469}
+
+SELECT * FROM table_for_rename1 ORDER BY key;
+
+ALTER TABLE table_for_rename1 RENAME COLUMN value1 TO value4;
+ALTER TABLE table_for_rename1 RENAME COLUMN value2 TO value5;
+SHOW CREATE TABLE table_for_rename1;
+SELECT * FROM table_for_rename1 ORDER BY key;
+
+SELECT '-- insert after rename --';
+INSERT INTO table_for_rename1 SELECT toDate('2019-10-01') + number % 3, number, toString(number), toString(number + 1), toString(number + 2) from numbers(10, 10);
+INSERT INTO table_for_rename1 SELECT toDate('2019-10-01') + number % 3, number, toString(number), toString(number + 1), toString(number) from numbers(10, 10); ; --{serverError 469}
+SELECT * FROM table_for_rename1 ORDER BY key;
+
+SELECT '-- rename columns back --';
+ALTER TABLE table_for_rename1 RENAME COLUMN value4 TO value1;
+ALTER TABLE table_for_rename1 RENAME COLUMN value5 TO value2;
+SHOW CREATE TABLE table_for_rename1;
+SELECT * FROM table_for_rename1 ORDER BY key;
+
+SELECT '-- insert after rename column --';
+INSERT INTO table_for_rename1 SELECT toDate('2019-10-01') + number % 3, number, toString(number), toString(number + 1), toString(number + 2) from numbers(20,10);
+INSERT INTO table_for_rename1 SELECT toDate('2019-10-01') + number % 3, number, toString(number), toString(number), toString(number + 2) from numbers(20, 10); ; --{serverError 469}
+SELECT * FROM table_for_rename1 ORDER BY key;
+
+DROP TABLE IF EXISTS table_for_rename1;
