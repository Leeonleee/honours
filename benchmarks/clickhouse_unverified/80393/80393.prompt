You will be provided with a partial code base and an issue statement explaining a problem to resolve.

<issue>
Projection x plain_rewritable not working together
> Please make sure that the version you're using is still supported (you can find the list [here](https://github.com/ClickHouse/ClickHouse/blob/master/SECURITY.md#scope-and-supported-versions)).

> You have to provide the following information whenever possible.

**Company or project name**

Agnostic

**Describe what's wrong**

Error when querying a table with projections and plain_rewritable disk.
The issue happens with clickhouse local version 24.10.1.329.

**Enable crash reporting**

> Change "enabled" to true in "send_crash_reports" section in `config.xml`:
```
<send_crash_reports>
        <!-- Changing <enabled> to true allows sending crash reports to -->
        <!-- the ClickHouse core developers team via Sentry https://sentry.io -->
        <enabled>false</enabled>
```

**How to reproduce**

The following error happens with clickhouse local version 24.10.1.329.
Here is how to reproduce it:

```sql
create table test_proj_001 (
    timestamp DateTime64(3, 'UTC'),
    number UInt64,
    blob String,

    INDEX timestamp timestamp TYPE minmax GRANULARITY 1,

    PROJECTION min_max_number (
        SELECT
            min(number), 
            max(number)
    )
)
ENGINE = MergeTree
PARTITION BY toYYYYMM(timestamp)
ORDER BY (timestamp)
SETTINGS disk = disk(
    type=s3,
    endpoint='**********************',
    use_environment_credentials=1,
    metadata_type=plain_rewritable
);

insert into test_proj_001 values (now(), 1, 'abc'), (now()-interval 1 day, 2, 'def')
```

Then some query work ok:

```
:) select count(*) from test_proj_001

SELECT count(*)
FROM test_proj_001

Query id: c719a2ba-fd78-4ebb-aa35-f28a1092aa0a

   ┌─count()─┐
1. │       2 │
   └─────────┘

1 row in set. Elapsed: 0.003 sec.
```

Or:

```
:) select * from test_proj_001

SELECT *
FROM test_proj_001

Query id: 71acc183-1ed3-4555-895e-e2750f8ddc1c

   ┌───────────────timestamp─┬─number─┬─blob─┐
1. │ 2024-10-01 08:48:41.000 │      2 │ def  │
2. │ 2024-10-02 08:48:41.000 │      1 │ abc  │
   └─────────────────────────┴────────┴──────┘

2 rows in set. Elapsed: 0.084 sec
```

But query that could make use of the projection fail:

```
:) select max(number) from test_proj_001

SELECT max(number)
FROM test_proj_001

Query id: 8ce40cea-8763-4f42-9858-634cf3890a50


Elapsed: 0.085 sec.

Received exception:
Code: 246. DB::Exception: Empty marks file 'test_proj_001/data/default/test_proj_001/202410_1_1_0/min_max_number.proj/data.cmrk3': 0, must be: 80: (while reading from part test_proj_001/data/default/test_proj_001/202410_1_1_0/min_max_number.proj/ in table default.test_proj_001 located on disk __tmp_internal_132222126954221991566785453547750829663 of type s3, from mark 0 with max_rows_to_read = 1): While executing MergeTreeSelect(pool: PrefetchedReadPool, algorithm: Thread). (CORRUPTED_DATA)
```

**Expected behavior**

I expect the query to run without error, and to make use of the projection.
BTW, I listed all files on the object store and see nothing that looks like a projection part.

**Error message and/or stacktrace**

```
Code: 246. DB::Exception: Empty marks file 'test_proj_001/data/default/test_proj_001/202410_1_1_0/min_max_number.proj/data.cmrk3': 0, must be: 80: (while reading from part test_proj_001/data/default/test_proj_001/202410_1_1_0/min_max_number.proj/ in table default.test_proj_001 located on disk __tmp_internal_132222126954221991566785453547750829663 of type s3, from mark 0 with max_rows_to_read = 1): While executing MergeTreeSelect(pool: PrefetchedReadPool, algorithm: Thread). (CORRUPTED_DATA)
```

**Additional context**

> Add any other context about the problem here.
</issue>

I need you to solve the provided issue by generating a code fix that can be applied directly to the repository

Respond below:
