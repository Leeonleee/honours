diff --git a/tests/queries/0_stateless/03130_generateSnowflakeId.reference b/tests/queries/0_stateless/03130_generateSnowflakeId.reference
index 39669d21bee0..fd264f00d364 100644
--- a/tests/queries/0_stateless/03130_generateSnowflakeId.reference
+++ b/tests/queries/0_stateless/03130_generateSnowflakeId.reference
@@ -1,5 +1,11 @@
+Negative tests
+The first bit must be zero
 1
+Test disabling of common subexpression elimination via first parameter
 0
 0
 1
+Test user-provided machine ID
+1
+Generated Snowflake IDs are unique
 100
diff --git a/tests/queries/0_stateless/03130_generateSnowflakeId.sql b/tests/queries/0_stateless/03130_generateSnowflakeId.sql
index 0717c81aa0d4..6c0a6cc0f2ca 100644
--- a/tests/queries/0_stateless/03130_generateSnowflakeId.sql
+++ b/tests/queries/0_stateless/03130_generateSnowflakeId.sql
@@ -1,13 +1,22 @@
 -- Test SQL function 'generateSnowflakeID'
 
-SELECT bitAnd(bitShiftRight(toUInt64(generateSnowflakeID()), 63), 1) = 0; -- check first bit is zero
+SELECT 'Negative tests';
+SELECT generateSnowflakeID(1, 2, 3); -- { serverError NUMBER_OF_ARGUMENTS_DOESNT_MATCH }
+SELECT generateSnowflakeID(1, 'not_an_int'); -- { serverError ILLEGAL_TYPE_OF_ARGUMENT }
+SELECT generateSnowflakeID(1, materialize(2)); -- { serverError ILLEGAL_COLUMN }
 
+ SELECT 'The first bit must be zero';
+SELECT bitAnd(bitShiftRight(generateSnowflakeID(), 63), 1) = 0;
+
+SELECT 'Test disabling of common subexpression elimination via first parameter';
 SELECT generateSnowflakeID(1) = generateSnowflakeID(2); -- disabled common subexpression elimination --> lhs != rhs
 SELECT generateSnowflakeID() = generateSnowflakeID(1); -- same as ^^
-SELECT generateSnowflakeID(1) = generateSnowflakeID(1); -- enabled common subexpression elimination
+SELECT generateSnowflakeID(1) = generateSnowflakeID(1); -- with common subexpression elimination
 
-SELECT generateSnowflakeID(1, 2); -- { serverError NUMBER_OF_ARGUMENTS_DOESNT_MATCH }
+SELECT 'Test user-provided machine ID';
+SELECT bitAnd(bitShiftRight(generateSnowflakeID(1, 123), 12), 1024 - 1) = 123; -- the machine id is actually set in the generated snowflake ID (1024 = 2^10)
 
+SELECT 'Generated Snowflake IDs are unique';
 SELECT count(*)
 FROM
 (
