diff --git a/tests/queries/0_stateless/02127_storage_join_settings_with_persistency.reference b/tests/queries/0_stateless/02127_storage_join_settings_with_persistency.reference
new file mode 100644
index 000000000000..16f7a2012764
--- /dev/null
+++ b/tests/queries/0_stateless/02127_storage_join_settings_with_persistency.reference
@@ -0,0 +1,2 @@
+CREATE TABLE default.`02127_join_settings_with_persistency_1`
(
    `k` UInt64,
    `s` String
)
ENGINE = Join(ANY, LEFT, k)
SETTINGS persistent = 1, join_any_take_last_row = 0
+CREATE TABLE default.`02127_join_settings_with_persistency_0`
(
    `k` UInt64,
    `s` String
)
ENGINE = Join(ANY, LEFT, k)
SETTINGS persistent = 0, join_any_take_last_row = 0
diff --git a/tests/queries/0_stateless/02127_storage_join_settings_with_persistency.sql b/tests/queries/0_stateless/02127_storage_join_settings_with_persistency.sql
new file mode 100644
index 000000000000..1dc1529ebad6
--- /dev/null
+++ b/tests/queries/0_stateless/02127_storage_join_settings_with_persistency.sql
@@ -0,0 +1,6 @@
+DROP TABLE IF EXISTS 02127_join_settings_with_persistency_1;
+CREATE TABLE 02127_join_settings_with_persistency_1 (k UInt64, s String) ENGINE = Join(ANY, LEFT, k) SETTINGS persistent=1, join_any_take_last_row=0;
+SHOW CREATE TABLE 02127_join_settings_with_persistency_1;
+DROP TABLE IF EXISTS 02127_join_settings_with_persistency_0;
+CREATE TABLE 02127_join_settings_with_persistency_0 (k UInt64, s String) ENGINE = Join(ANY, LEFT, k) SETTINGS persistent=0, join_any_take_last_row=0;
+SHOW CREATE TABLE 02127_join_settings_with_persistency_0;
