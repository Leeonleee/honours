{
  "repo": "ClickHouse/ClickHouse",
  "pull_number": 8940,
  "instance_id": "ClickHouse__ClickHouse-8940",
  "issue_numbers": [
    "8727"
  ],
  "base_commit": "23dedcbfa974a068a1993ecc9d6e65cd2d81f82e",
  "patch": "diff --git a/dbms/src/Parsers/ASTShowTablesQuery.cpp b/dbms/src/Parsers/ASTShowTablesQuery.cpp\nindex 7742cfcf06b3..4409ec63e28e 100644\n--- a/dbms/src/Parsers/ASTShowTablesQuery.cpp\n+++ b/dbms/src/Parsers/ASTShowTablesQuery.cpp\n@@ -30,7 +30,7 @@ void ASTShowTablesQuery::formatQueryImpl(const FormatSettings & settings, Format\n                 << backQuoteIfNeed(from);\n \n         if (!like.empty())\n-            settings.ostr << (settings.hilite ? hilite_keyword : \"\") << \" LIKE \" << (settings.hilite ? hilite_none : \"\")\n+            settings.ostr << (settings.hilite ? hilite_keyword : \"\") << (not_like ? \" NOT\" : \"\") << \" LIKE \" << (settings.hilite ? hilite_none : \"\")\n                 << std::quoted(like, '\\'');\n \n         if (limit_length)\n",
  "test_patch": "diff --git a/dbms/tests/queries/0_stateless/01073_show_tables_not_like.reference b/dbms/tests/queries/0_stateless/01073_show_tables_not_like.reference\nnew file mode 100644\nindex 000000000000..31046c8e5535\n--- /dev/null\n+++ b/dbms/tests/queries/0_stateless/01073_show_tables_not_like.reference\n@@ -0,0 +1,22 @@\n+---\n+test1\n+test2\n+--\n+test1\n+test2\n+--\n+--\n+test1\n+--\n+test1\n+---\n+test1\n+test2\n+--\n+test1\n+test2\n+--\n+--\n+test1\n+--\n+test1\ndiff --git a/dbms/tests/queries/0_stateless/01073_show_tables_not_like.sql b/dbms/tests/queries/0_stateless/01073_show_tables_not_like.sql\nnew file mode 100644\nindex 000000000000..bdf88449ccb1\n--- /dev/null\n+++ b/dbms/tests/queries/0_stateless/01073_show_tables_not_like.sql\n@@ -0,0 +1,33 @@\n+SHOW TABLES NOT LIKE '%';\n+\n+DROP DATABASE IF EXISTS test_01073;\n+CREATE DATABASE test_01073;\n+USE test_01073;\n+\n+SHOW TABLES;\n+SELECT '---';\n+CREATE TABLE test1 (x UInt8) ENGINE = Memory;\n+CREATE TABLE test2 (x UInt8) ENGINE = Memory;\n+\n+SHOW TABLES;\n+SELECT '--';\n+SHOW TABLES LIKE 'tes%';\n+SELECT '--';\n+SHOW TABLES NOT LIKE 'tes%';\n+SELECT '--';\n+SHOW TABLES LIKE 'tes%1';\n+SELECT '--';\n+SHOW TABLES NOT LIKE 'tes%2';\n+\n+SELECT '---';\n+SHOW TABLES FROM test_01073;\n+SELECT '--';\n+SHOW TABLES FROM test_01073 LIKE 'tes%';\n+SELECT '--';\n+SHOW TABLES FROM test_01073 NOT LIKE 'tes%';\n+SELECT '--';\n+SHOW TABLES FROM test_01073 LIKE 'tes%1';\n+SELECT '--';\n+SHOW TABLES FROM test_01073 NOT LIKE 'tes%2';\n+\n+DROP DATABASE test_01073;\n",
  "problem_statement": "The token 'NOT' didn't work in 'SHOW TABLES NOT LIKE' query\nThe token 'NOT' didn't work in 'SHOW TABLES NOT LIKE' query with version 19.13.3.26, the following queries both show the tables start with 'example'.\r\n```SQL\r\nSHOW TABLES LIKE 'example%';\r\nSHOW TABLES NOT LIKE 'example%';\r\n```\r\n\n",
  "hints_text": "That's ridiculous! Will fix.",
  "created_at": "2020-01-31T18:43:40Z",
  "modified_files": [
    "dbms/src/Parsers/ASTShowTablesQuery.cpp"
  ],
  "modified_test_files": [
    "b/dbms/tests/queries/0_stateless/01073_show_tables_not_like.reference",
    "b/dbms/tests/queries/0_stateless/01073_show_tables_not_like.sql"
  ]
}