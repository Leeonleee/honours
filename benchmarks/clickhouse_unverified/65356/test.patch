diff --git a/tests/queries/0_stateless/03173_forbid_qualify.reference b/tests/queries/0_stateless/03173_forbid_qualify.reference
new file mode 100644
index 000000000000..c2f595d8c4bd
--- /dev/null
+++ b/tests/queries/0_stateless/03173_forbid_qualify.reference
@@ -0,0 +1,3 @@
+100
+49
+100
diff --git a/tests/queries/0_stateless/03173_forbid_qualify.sql b/tests/queries/0_stateless/03173_forbid_qualify.sql
new file mode 100644
index 000000000000..d8cb2bad2eaa
--- /dev/null
+++ b/tests/queries/0_stateless/03173_forbid_qualify.sql
@@ -0,0 +1,11 @@
+drop table if exists test_qualify;
+create table test_qualify (number Int64) ENGINE = MergeTree ORDER BY (number);
+
+insert into test_qualify SELECT * FROM numbers(100);
+
+select count() from test_qualify; -- 100
+select * from test_qualify qualify row_number() over (order by number) = 50 SETTINGS allow_experimental_analyzer = 1; -- 49
+select * from test_qualify qualify row_number() over (order by number) = 50 SETTINGS allow_experimental_analyzer = 0; -- { serverError NOT_IMPLEMENTED }
+
+delete from test_qualify where number in (select number from test_qualify qualify row_number() over (order by number) = 50); -- { serverError UNFINISHED }
+select count() from test_qualify; -- 100
