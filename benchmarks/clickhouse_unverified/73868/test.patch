diff --git a/tests/queries/0_stateless/03300_merge_parts_metric.reference b/tests/queries/0_stateless/03300_merge_parts_metric.reference
new file mode 100644
index 000000000000..d00491fd7e5b
--- /dev/null
+++ b/tests/queries/0_stateless/03300_merge_parts_metric.reference
@@ -0,0 +1,1 @@
+1
diff --git a/tests/queries/0_stateless/03300_merge_parts_metric.sh b/tests/queries/0_stateless/03300_merge_parts_metric.sh
new file mode 100755
index 000000000000..502dfdf41b34
--- /dev/null
+++ b/tests/queries/0_stateless/03300_merge_parts_metric.sh
@@ -0,0 +1,13 @@
+#!/usr/bin/env bash
+# Tags: long
+
+CUR_DIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
+# shellcheck source=../shell_config.sh
+. "$CUR_DIR"/../shell_config.sh
+
+# Among 1000 invocations, the values are equal most of the time
+# Note: they could be non-equal due to timing differences.
+
+$CLICKHOUSE_CLIENT --query "DROP TABLE IF EXISTS test; CREATE TABLE test (x Bool) ENGINE = Memory;"
+yes "INSERT INTO test SELECT sum(length(source_part_names)) = (SELECT value FROM system.metrics WHERE name = 'MergeParts') FROM system.merges;" | head -n1000 | $CLICKHOUSE_CLIENT
+$CLICKHOUSE_CLIENT --query "SELECT sum(x) > 500 FROM test; DROP TABLE test;"
