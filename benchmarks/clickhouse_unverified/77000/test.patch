diff --git a/tests/queries/0_stateless/03366_bfloat16_sorting.reference b/tests/queries/0_stateless/03366_bfloat16_sorting.reference
new file mode 100644
index 000000000000..201d46485e11
--- /dev/null
+++ b/tests/queries/0_stateless/03366_bfloat16_sorting.reference
@@ -0,0 +1,290 @@
+-inf
+-9187343000000000000
+-8718969000000000000
+-8466767300000000000
+-8322652000000000000
+-8250594500000000000
+-7998393000000000000
+-7818249000000000000
+-7602076000000000000
+-7457961000000000000
+-6341068300000000000
+-6305039500000000000
+-6305039500000000000
+-6269010700000000000
+-6232982000000000000
+-5512406000000000000
+-5440348300000000000
+-5296233000000000000
+-5224175600000000000
+-5188147000000000000
+-5044031600000000000
+-5008003000000000000
+-4899916400000000000
+-4827859000000000000
+-4683743600000000000
+-4539628400000000000
+-4485585200000000000
+-4431542000000000000
+-4305441200000000000
+-4287426800000000000
+-4143311700000000000
+-3728980500000000000
+-3710966000000000000
+-3674937300000000000
+-2882303800000000000
+-2864289400000000000
+-2810246200000000000
+-2738188600000000000
+-2287828600000000000
+-2251799800000000000
+-2026619800000000000
+-1801439900000000000
+-1630303000000000000
+-1279022300000000000
+-1026820700000000000
+-562949950000000000
+-2122317800
+-2097152000
+-2038431700
+-1979711500
+-1954545700
+-1887436800
+-1778384900
+-1652555800
+-1635778600
+-1627390000
+-1551892500
+-1551892500
+-1484783600
+-1350565900
+-1350565900
+-1283457000
+-1275068400
+-1191182300
+-1149239300
+-977272800
+-805306400
+-792723460
+-775946240
+-746586100
+-738197500
+-700448800
+-679477250
+-671088640
+-545259500
+-463470600
+-459276300
+-457179140
+-452984830
+-354418700
+-333447170
+-310378500
+-261095420
+-229638140
+-213909500
+-6750208
+-1011712
+-958464
+-573440
+-69120
+-67584
+-58112
+-29312
+-8512
+-4960
+-3872
+-1928
+-976
+-856
+-752
+-704
+-520
+-172
+-156
+-96
+-53.75
+-46.25
+-38.25
+-33
+-28.25
+-15.625
+-15.375
+-12.5625
+-10.375
+-9.375
+-9.1875
+-8.5625
+-7.6875
+-7.4375
+-7.34375
+-6.75
+-3.515625
+-3
+-2.828125
+-2.6875
+-2
+-1.7578125
+-1.6953125
+-1.234375
+-1.09375
+-1.0859375
+-0.87890625
+-0.859375
+-0.703125
+-0.69921875
+-0.12792969
+-0.028198242
+-0
+0
+0
+0
+0
+0.48242188
+1.5
+1.796875
+1.828125
+3.59375
+5.125
+7.90625
+7.96875
+8.625
+9
+9.375
+9.4375
+9.5625
+13
+18.125
+21.625
+43.75
+56
+67.5
+80
+99
+134
+282
+700
+772
+824
+1128
+4768
+8704
+9152
+10048
+70656
+83968
+144384
+223232
+485376
+913408
+88604670
+115867650
+181403650
+229638140
+310378500
+354418700
+402653200
+415236100
+450887680
+488636400
+520093700
+788529150
+851443700
+914358300
+914358300
+1040187400
+1124073500
+1132462100
+1149239300
+1191182300
+1249902600
+1392508900
+1434452000
+1442840600
+1535115300
+1627390000
+1652555800
+1652555800
+1677721600
+1719664600
+1728053200
+1811939300
+1811939300
+1828716500
+1837105200
+1845493800
+1887436800
+1937768400
+1954545700
+2030043100
+2071986200
+2097152000
+346777170000000000
+869194700000000000
+1098878300000000000
+1297036700000000000
+1405123100000000000
+1612288700000000000
+1621295900000000000
+1756403900000000000
+2071655800000000000
+2161727800000000000
+2413929400000000000
+2558044600000000000
+2882303800000000000
+2918332600000000000
+3008404600000000000
+3098476500000000000
+3602879700000000000
+3638908500000000000
+3656923000000000000
+3999196500000000000
+4035225300000000000
+4215369300000000000
+4305441200000000000
+4827859000000000000
+5080060400000000000
+5188147000000000000
+5260204400000000000
+5728579000000000000
+5728579000000000000
+5836665000000000000
+5836665000000000000
+5980780300000000000
+5980780300000000000
+6232982000000000000
+6413126000000000000
+6521212000000000000
+6953558000000000000
+7097673000000000000
+7421932000000000000
+7530018600000000000
+7746191400000000000
+7854278000000000000
+7890306500000000000
+7890306500000000000
+8142508000000000000
+8430738500000000000
+8430738500000000000
+8646911300000000000
+8718969000000000000
+8718969000000000000
+8899113000000000000
+8971170500000000000
+9079257000000000000
+9079257000000000000
+inf
+inf
+inf
+nan
+nan
+nan
+nan
+nan
+nan
+nan
+nan
+nan
+nan
+nan
+nan
diff --git a/tests/queries/0_stateless/03366_bfloat16_sorting.sql b/tests/queries/0_stateless/03366_bfloat16_sorting.sql
new file mode 100644
index 000000000000..8e8a6082b450
--- /dev/null
+++ b/tests/queries/0_stateless/03366_bfloat16_sorting.sql
@@ -0,0 +1,4 @@
+SELECT * FROM format(Values, 'x BFloat16', '
+(915309.3), (-172.4), (-1555612173), (-794649755), (9.0), (1853837358), (-752.038), (1396433067), (-807596209), (6980930564848204980), (inf), (-334802707), (-9208770324484017588), (1542974135), (8.65110), (3653113333946823132), (-0.7048), (-521.0), (8435282414075074417), (-6292128116417116397), (-1.1), (402684563), (7100378348544520322), (-1.758), (5866537631201593121), (1448199529), (-1012621), (-69567.11), (-976.8334), (-28.35), (-8547.0), (+0.0), (5106142703787698805), (8753460139368692361), (-962398.0), (-1191866042), (-3.53), (5736130821808181266), (1.5), (-2102861541), (-4318589268046737694), (+0.0), (8925059011873647780), (-156.896869), (-2882154502015236978), (-1149877585), (0.48367), (1135103111), (1842836061), (-0.02826), (-3726604190761547609), (-453901554.40), (2888527236479160511), (-7.454), (854116431), (6258347412277750223), (-1632245551464937874), (-3887.35), (8767.14), (-2026982035343500009), (10084.047), (-12.6150), (-4490844512257432684), (80.0), (4003882477879050470), (-8032628616449150130), (nan), (283.11), (-2040930083), (-1660845000), (-46.4), (2431480081340864910), (-8348560450377606243), (-8502763961981072530), (-15.67900), (230036155), (1942939659), (4794.81023), (-1639852492), (-1352376506), (-2.7), (-1.088), (-1286266918863494194), (-5474135460424898823), (-701987997), (-3677164403360004369), (7.9723935), (-6243785367315650126), (1131.4), (13.0), (88967630.99), (-4857582370574805786), (-4288683376502787204), (1299393795189677177), (827.0), (-779228479), (5278875253796893698), (-1.241), (-9.4), (8652067825981452928), (5.13222918), (-2739239481541406400), (-38.29), (-1557979152), (-457695388), (-1959634948), (-463871221), (-7491614107579678858), (7901991093387175754), (-749021875), (-563485266992292414), (7903784173186423016), (6415568457236688716), (0.0), (1041044414), (-inf), (-7.36), (1.834), (56.0), (-0.0), (nan), (1407263544961752054), (-2825675448399084472), (-704.2), (7438299440420973263), (2922890613588943306), (452195848), (-673820791), (9172.0), (-7847859370969306041), (1956615306), (144567.23), (-33.1076), (-53.91200), (-6.75), (-4448835675253045899), (2168295801156564119), (1655170692), (4316746107587705818), (-8269286236795419058), (1727302703), (-214033129), (-7.7), (nan), (-0.7), (+nan), (-4547328351920373605), (nan), (-1487104083), (1658546204), (1151636392), (416290247.08), (-4699301667687142318), (-1.7), (-6323293279463878865), (5855641835618078507), (6000839524613739767), (-1029895710511952591), (486712), (-3730616670168004577), (3010252056832300847), (-1929.84917), (-2253628015236776383), (-1355690956), (1.8), (1255622011), (-7633225657025354393), (-1809222556741732999), (8451912649540627017), (134.521), (-6312210627363870622), (-230600560), (9.45), (-0.8798), (-856.606), (nan), (1626812583630422427), (116036431), (-2896591025188201292), (2101820842), (2079731433), (-5311080917199036345), (-577360.40844459), (-58257.86), (-6364996476077464518), (9112295453040021646), (8734695561715260733), (-355588047), (1895493280), (349020560979472682), (914602758), (5192612204687053771), (-5241047726046761998), (1099543785538793655), (-311288720), (1633155009), (1613280409437033273), (+nan), (-10.4), (-68033.01), (-8728247972026697820), (7563764808015298425), (-0.860), (-2.0), (355270636), (181943082), (2077491986200197340), (-5196084623766115387), (-0.1280), (18.24323), (1439645894), (-3.0), (+nan), (-4920802313749507761), (9.581223), (-4977.639), (21.6613), (-1281671910), (-15.4), (-5066115181153139762), (1831511780), (3616962447275671394), (-5035837218861299864), (917383330), (+inf), (223894.264), (-96.275444), (nan), (-547606170), (-261714371), (1734489497), (1760637531924834025), (-2130171631), (99.40196), (3106130344652597122), (9084751387559563274), (-9.2), (772.20502704), (5987185449054785806), (+nan), (-461241595), (869648491758383603), (9.4), (7760123765394357048), (-979023095), (-682791909), (0.0), (-2.84), (-1887928434), (-8.602), (43.8), (-740133382), (-1628407200), (nan), (4048950104344667845), (7.923), (-2290446205925660340), (1817370121), (700.0), (1683434407), (8994999237835107052), (8158939128335705548), (-6779280.5), (520417636), (4856231070881691400), (+inf), (84333.5), (1814647746), (-1783864249), (2035802471), (70752.0), (1124938650), (5737532713519861979), (1196647506), (-4146469507106105938), (7869998886095964339), (312457241), (nan), (3663885939535420359), (-29385.769192130), (4217936517369282398), (67.9), (-1981743187), (489740628), (6528054616798929895), (-5516525484994056924), (3.6), (-1291051489), (791837371), (2559503485226905057)
+')
+ORDER BY x;
diff --git a/tests/queries/0_stateless/03367_bfloat16_tuple_final.reference b/tests/queries/0_stateless/03367_bfloat16_tuple_final.reference
new file mode 100644
index 000000000000..00ea75b9dc0b
--- /dev/null
+++ b/tests/queries/0_stateless/03367_bfloat16_tuple_final.reference
@@ -0,0 +1,262 @@
+(-inf)
+(-9187343000000000000)
+(-8718969000000000000)
+(-8466767300000000000)
+(-8322652000000000000)
+(-8250594500000000000)
+(-7998393000000000000)
+(-7818249000000000000)
+(-7602076000000000000)
+(-7457961000000000000)
+(-6341068300000000000)
+(-6305039500000000000)
+(-6269010700000000000)
+(-6232982000000000000)
+(-5512406000000000000)
+(-5440348300000000000)
+(-5296233000000000000)
+(-5224175600000000000)
+(-5188147000000000000)
+(-5044031600000000000)
+(-5008003000000000000)
+(-4899916400000000000)
+(-4827859000000000000)
+(-4683743600000000000)
+(-4539628400000000000)
+(-4485585200000000000)
+(-4431542000000000000)
+(-4305441200000000000)
+(-4287426800000000000)
+(-4143311700000000000)
+(-3728980500000000000)
+(-3710966000000000000)
+(-3674937300000000000)
+(-3008404600000000000)
+(-2882303800000000000)
+(-2864289400000000000)
+(-2810246200000000000)
+(-2738188600000000000)
+(-2287828600000000000)
+(-2251799800000000000)
+(-2026619800000000000)
+(-1801439900000000000)
+(-1630303000000000000)
+(-1279022300000000000)
+(-1026820700000000000)
+(-562949950000000000)
+(-2122317800)
+(-2097152000)
+(-2038431700)
+(-1979711500)
+(-1954545700)
+(-1887436800)
+(-1778384900)
+(-1652555800)
+(-1635778600)
+(-1627390000)
+(-1551892500)
+(-1484783600)
+(-1350565900)
+(-1283457000)
+(-1275068400)
+(-1191182300)
+(-1149239300)
+(-977272800)
+(-805306400)
+(-792723460)
+(-775946240)
+(-746586100)
+(-738197500)
+(-700448800)
+(-679477250)
+(-671088640)
+(-545259500)
+(-463470600)
+(-459276300)
+(-457179140)
+(-452984830)
+(-354418700)
+(-333447170)
+(-310378500)
+(-261095420)
+(-229638140)
+(-213909500)
+(-6750208)
+(-1011712)
+(-958464)
+(-573440)
+(-69120)
+(-67584)
+(-58112)
+(-29312)
+(-8512)
+(-4960)
+(-3872)
+(-1928)
+(-976)
+(-856)
+(-752)
+(-704)
+(-520)
+(-172)
+(-156)
+(-96)
+(-53.75)
+(-46.25)
+(-38.25)
+(-33)
+(-28.25)
+(-15.625)
+(-15.375)
+(-12.5625)
+(-10.375)
+(-9.375)
+(-9.1875)
+(-8.5625)
+(-7.6875)
+(-7.4375)
+(-7.34375)
+(-6.75)
+(-3.515625)
+(-3)
+(-2.828125)
+(-2.6875)
+(-2)
+(-1.7578125)
+(-1.6953125)
+(-1.234375)
+(-1.09375)
+(-1.0859375)
+(-0.87890625)
+(-0.859375)
+(-0.703125)
+(-0.69921875)
+(-0.12792969)
+(-0.028198242)
+(0)
+(0.48242188)
+(1.5)
+(1.796875)
+(1.828125)
+(3.59375)
+(5.125)
+(7.90625)
+(7.96875)
+(8.625)
+(9)
+(9.375)
+(9.4375)
+(9.5625)
+(13)
+(18.125)
+(21.625)
+(43.75)
+(56)
+(67.5)
+(80)
+(99)
+(134)
+(282)
+(700)
+(772)
+(824)
+(1128)
+(4768)
+(8704)
+(9152)
+(10048)
+(70656)
+(83968)
+(144384)
+(223232)
+(485376)
+(913408)
+(88604670)
+(115867650)
+(181403650)
+(229638140)
+(310378500)
+(354418700)
+(402653200)
+(415236100)
+(450887680)
+(488636400)
+(520093700)
+(788529150)
+(851443700)
+(914358300)
+(1040187400)
+(1124073500)
+(1132462100)
+(1149239300)
+(1191182300)
+(1249902600)
+(1392508900)
+(1434452000)
+(1442840600)
+(1535115300)
+(1627390000)
+(1652555800)
+(1677721600)
+(1719664600)
+(1728053200)
+(1811939300)
+(1828716500)
+(1837105200)
+(1845493800)
+(1887436800)
+(1937768400)
+(1954545700)
+(2030043100)
+(2071986200)
+(2097152000)
+(346777170000000000)
+(421086570000000000)
+(869194700000000000)
+(1098878300000000000)
+(1297036700000000000)
+(1405123100000000000)
+(1612288700000000000)
+(1621295900000000000)
+(1756403900000000000)
+(2071655800000000000)
+(2161727800000000000)
+(2413929400000000000)
+(2558044600000000000)
+(2882303800000000000)
+(2918332600000000000)
+(3008404600000000000)
+(3098476500000000000)
+(3602879700000000000)
+(3638908500000000000)
+(3656923000000000000)
+(3999196500000000000)
+(4035225300000000000)
+(4215369300000000000)
+(4305441200000000000)
+(4827859000000000000)
+(5080060400000000000)
+(5188147000000000000)
+(5260204400000000000)
+(5728579000000000000)
+(5836665000000000000)
+(5980780300000000000)
+(6232982000000000000)
+(6413126000000000000)
+(6521212000000000000)
+(6953558000000000000)
+(7097673000000000000)
+(7421932000000000000)
+(7530018600000000000)
+(7746191400000000000)
+(7854278000000000000)
+(7890306500000000000)
+(8142508000000000000)
+(8430738500000000000)
+(8646911300000000000)
+(8718969000000000000)
+(8899113000000000000)
+(8971170500000000000)
+(9079257000000000000)
+(inf)
+(nan)
diff --git a/tests/queries/0_stateless/03367_bfloat16_tuple_final.sql b/tests/queries/0_stateless/03367_bfloat16_tuple_final.sql
new file mode 100644
index 000000000000..9101e03f879a
--- /dev/null
+++ b/tests/queries/0_stateless/03367_bfloat16_tuple_final.sql
@@ -0,0 +1,5 @@
+DROP TABLE IF EXISTS t0;
+CREATE TABLE t0 (c0 Tuple(BFloat16)) ENGINE = SummingMergeTree() ORDER BY (c0);
+INSERT INTO TABLE t0 (c0) VALUES ((-3023198492688736344, )), ((915309.3, )), ((-172.4, )), ((-1555612173, )), ((-794649755, )), ((9.0, )), ((1853837358, )), ((-752.038, )), ((1396433067, )), ((-807596209, )), ((6980930564848204980, )), ((inf, )), ((-334802707, )), ((-9208770324484017588, )), ((1542974135, )), ((8.65110, )), ((3653113333946823132, )), ((-0.7048, )), ((-521.0, )), ((8435282414075074417, )), ((-6292128116417116397, )), ((-1.1, )), ((402684563, )), ((7100378348544520322, )), ((-1.758, )), ((5866537631201593121, )), ((1448199529, )), ((-1012621, )), ((-69567.11, )), ((-976.8334, )), ((-28.35, )), ((-8547.0, )), ((+0.0, )), ((5106142703787698805, )), ((8753460139368692361, )), ((-962398.0, )), ((-1191866042, )), ((-3.53, )), ((5736130821808181266, )), ((1.5, )), ((-2102861541, )), ((-4318589268046737694, )), ((+0.0, )), ((8925059011873647780, )), ((-156.896869, )), ((-2882154502015236978, )), ((-1149877585, )), ((0.48367, )), ((1135103111, )), ((1842836061, )), ((-0.02826, )), ((-3726604190761547609, )), ((-453901554.40, )), ((2888527236479160511, )), ((-7.454, )), ((854116431, )), ((6258347412277750223, )), ((-1632245551464937874, )), ((-3887.35, )), ((8767.14, )), ((-2026982035343500009, )), ((10084.047, )), ((-12.6150, )), ((-4490844512257432684, )), ((80.0, )), ((4003882477879050470, )), ((-8032628616449150130, )), ((nan, )), ((283.11, )), ((-2040930083, )), ((-1660845000, )), ((-46.4, )), ((2431480081340864910, )), ((-8348560450377606243, )), ((-8502763961981072530, )), ((-15.67900, )), ((230036155, )), ((1942939659, )), ((4794.81023, )), ((-1639852492, )), ((-1352376506, )), ((-2.7, )), ((-1.088, )), ((-1286266918863494194, )), ((-5474135460424898823, )), ((-701987997, )), ((-3677164403360004369, )), ((7.9723935, )), ((-6243785367315650126, )), ((1131.4, )), ((13.0, )), ((88967630.99, )), ((-4857582370574805786, )), ((-4288683376502787204, )), ((1299393795189677177, )), ((827.0, )), ((-779228479, )), ((5278875253796893698, )), ((-1.241, )), ((-9.4, )), ((8652067825981452928, )), ((5.13222918, )), ((-2739239481541406400, )), ((-38.29, )), ((-1557979152, )), ((-457695388, )), ((-1959634948, )), ((-463871221, )), ((-7491614107579678858, )), ((7901991093387175754, )), ((-749021875, )), ((-563485266992292414, )), ((7903784173186423016, )), ((6415568457236688716, )), ((0.0, )), ((1041044414, )), ((-inf, )), ((-7.36, )), ((1.834, )), ((56.0, )), ((-0.0, )), ((nan, )), ((1407263544961752054, )), ((-2825675448399084472, )), ((-704.2, )), ((7438299440420973263, )), ((2922890613588943306, )), ((452195848, )), ((-673820791, )), ((9172.0, )), ((-7847859370969306041, )), ((1956615306, )), ((144567.23, )), ((-33.1076, )), ((-53.91200, )), ((-6.75, )), ((-4448835675253045899, )), ((2168295801156564119, )), ((1655170692, )), ((4316746107587705818, )), ((-8269286236795419058, )), ((1727302703, )), ((-214033129, )), ((-7.7, )), ((nan, )), ((-0.7, )), ((+nan, )), ((-4547328351920373605, )), ((nan, )), ((-1487104083, )), ((1658546204, )), ((1151636392, )), ((416290247.08, )), ((-4699301667687142318, )), ((-1.7, )), ((-6323293279463878865, )), ((5855641835618078507, )), ((6000839524613739767, )), ((-1029895710511952591, )), ((486712, )), ((-3730616670168004577, )), ((3010252056832300847, )), ((-1929.84917, )), ((-2253628015236776383, )), ((-1355690956, )), ((1.8, )), ((1255622011, )), ((-7633225657025354393, )), ((-1809222556741732999, )), ((8451912649540627017, )), ((134.521, )), ((-6312210627363870622, )), ((-230600560, )), ((9.45, )), ((-0.8798, )), ((-856.606, )), ((-nan, )), ((1626812583630422427, )), ((116036431, )), ((-2896591025188201292, )), ((2101820842, )), ((2079731433, )), ((-5311080917199036345, )), ((-577360.40844459, )), ((-58257.86, )), ((-6364996476077464518, )), ((9112295453040021646, )), ((8734695561715260733, )), ((-355588047, )), ((1895493280, )), ((349020560979472682, )), ((914602758, )), ((5192612204687053771, )), ((-5241047726046761998, )), ((1099543785538793655, )), ((-311288720, )), ((1633155009, )), ((1613280409437033273, )), ((+nan, )), ((-10.4, )), ((-68033.01, )), ((-8728247972026697820, )), ((7563764808015298425, )), ((-0.860, )), ((-2.0, )), ((355270636, )), ((181943082, )), ((2077491986200197340, )), ((-5196084623766115387, )), ((-0.1280, )), ((18.24323, )), ((1439645894, )), ((-3.0, )), ((+nan, )), ((-4920802313749507761, )), ((9.581223, )), ((-4977.639, )), ((21.6613, )), ((-1281671910, )), ((-15.4, )), ((-5066115181153139762, )), ((1831511780, )), ((3616962447275671394, )), ((-5035837218861299864, )), ((917383330, )), ((+inf, )), ((223894.264, )), ((-96.275444, )), ((-nan, )), ((-547606170, )), ((-261714371, )), ((1734489497, )), ((1760637531924834025, )), ((-2130171631, )), ((99.40196, )), ((3106130344652597122, )), ((9084751387559563274, )), ((-9.2, )), ((772.20502704, )), ((5987185449054785806, )), ((+nan, )), ((-461241595, )), ((869648491758383603, )), ((9.4, )), ((7760123765394357048, )), ((-979023095, )), ((-682791909, )), ((0.0, )), ((-2.84, )), ((-1887928434, )), ((-8.602, )), ((43.8, )), ((-740133382, )), ((-1628407200, )), ((nan, )), ((4048950104344667845, )), ((7.923, )), ((-2290446205925660340, )), ((1817370121, )), ((700.0, )), ((1683434407, )), ((8994999237835107052, )), ((8158939128335705548, )), ((-6779280.5, )), ((520417636, )), ((4856231070881691400, )), ((+inf, )), ((84333.5, )), ((1814647746, )), ((-1783864249, )), ((2035802471, )), ((70752.0, )), ((1124938650, )), ((5737532713519861979, )), ((1196647506, )), ((-4146469507106105938, )), ((7869998886095964339, )), ((312457241, )), ((-nan, )), ((3663885939535420359, )), ((-29385.769192130, )), ((4217936517369282398, )), ((67.9, )), ((-1981743187, )), ((489740628, )), ((6528054616798929895, )), ((-5516525484994056924, )), ((3.6, )), ((-1291051489, )), ((791837371, )), ((2559503485226905057, )), ((423224585269353485, ));
+SELECT c0 FROM t0 FINAL;
+DROP TABLE t0;
diff --git a/tests/queries/0_stateless/03368_bfloat16_merge_join.reference b/tests/queries/0_stateless/03368_bfloat16_merge_join.reference
new file mode 100644
index 000000000000..aa47d0d46d47
--- /dev/null
+++ b/tests/queries/0_stateless/03368_bfloat16_merge_join.reference
@@ -0,0 +1,2 @@
+0
+0
diff --git a/tests/queries/0_stateless/03368_bfloat16_merge_join.sql b/tests/queries/0_stateless/03368_bfloat16_merge_join.sql
new file mode 100644
index 000000000000..c1e64c64de92
--- /dev/null
+++ b/tests/queries/0_stateless/03368_bfloat16_merge_join.sql
@@ -0,0 +1,7 @@
+DROP TABLE IF EXISTS t0;
+CREATE TABLE t0 (c0 Float64, c1 BFloat16) ENGINE = MergeTree() PARTITION BY (murmurHash3_64(c0)) PRIMARY KEY (c0);
+SET join_algorithm = 'full_sorting_merge';
+INSERT INTO TABLE t0 (c0, c1) VALUES (4, -1), (-1745033997, 7), (-1940737579, nan);
+SELECT count() FROM t0 t0d0 JOIN t0 t1d0 ON t1d0.c0 = t0d0.c0 JOIN t0 t2d0 ON t1d0.c1 = t2d0.c1 WHERE t1d0.c0 != t2d0.c0;
+SELECT sum(t1d0.c0 != t2d0.c0) FROM t0 t0d0 JOIN t0 t1d0 ON t1d0.c0 = t0d0.c0 JOIN t0 t2d0 ON t1d0.c1 = t2d0.c1;
+DROP TABLE t0;
