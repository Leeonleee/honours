diff --git a/tests/queries/0_stateless/01428_hash_set_nan_key.reference b/tests/queries/0_stateless/01428_hash_set_nan_key.reference
new file mode 100644
index 000000000000..6bd552c8e41e
--- /dev/null
+++ b/tests/queries/0_stateless/01428_hash_set_nan_key.reference
@@ -0,0 +1,7 @@
+1
+1
+nan
+nan
+[nan]
+nan
+10
diff --git a/tests/queries/0_stateless/01428_hash_set_nan_key.sql b/tests/queries/0_stateless/01428_hash_set_nan_key.sql
new file mode 100644
index 000000000000..0408e30070a3
--- /dev/null
+++ b/tests/queries/0_stateless/01428_hash_set_nan_key.sql
@@ -0,0 +1,10 @@
+SELECT uniqExact(nan) FROM numbers(1000);
+SELECT uniqExact(number % inf) FROM numbers(1000);
+SELECT sumDistinct(number % inf) FROM numbers(1000);
+SELECT DISTINCT number % inf FROM numbers(1000);
+
+SELECT topKWeightedMerge(1)(initializeAggregation('topKWeightedState(1)', nan, arrayJoin(range(10))));
+
+select number % inf k from numbers(256) group by k;
+
+SELECT uniqExact(reinterpretAsFloat64(reinterpretAsFixedString(reinterpretAsUInt64(reinterpretAsFixedString(nan)) + number))) FROM numbers(10);
