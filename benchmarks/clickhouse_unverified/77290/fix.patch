diff --git a/base/base/BFloat16.h b/base/base/BFloat16.h
index 51cd4ee99907..266f125da7ce 100644
--- a/base/base/BFloat16.h
+++ b/base/base/BFloat16.h
@@ -90,12 +90,12 @@ class BFloat16
 
     constexpr bool operator==(const BFloat16 & other) const
     {
-        return x == other.x;
+        return Float32(*this) == Float32(other);
     }
 
     constexpr bool operator!=(const BFloat16 & other) const
     {
-        return x != other.x;
+        return Float32(*this) != Float32(other);
     }
 
     constexpr BFloat16 operator+(const BFloat16 & other) const
diff --git a/src/Processors/QueryPlan/PartsSplitter.cpp b/src/Processors/QueryPlan/PartsSplitter.cpp
index 8e926aa75274..0287a0d5a651 100644
--- a/src/Processors/QueryPlan/PartsSplitter.cpp
+++ b/src/Processors/QueryPlan/PartsSplitter.cpp
@@ -56,6 +56,7 @@ bool isSafePrimaryDataKeyType(const IDataType & data_type)
     {
         case TypeIndex::Float32:
         case TypeIndex::Float64:
+        case TypeIndex::BFloat16:
         case TypeIndex::Nullable:
         case TypeIndex::ObjectDeprecated:
         case TypeIndex::Object:
