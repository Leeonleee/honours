diff --git a/tests/queries/0_stateless/01044_great_circle_angle.reference b/tests/queries/0_stateless/01044_great_circle_angle.reference
index ebdeaa10067e..c247e398824f 100644
--- a/tests/queries/0_stateless/01044_great_circle_angle.reference
+++ b/tests/queries/0_stateless/01044_great_circle_angle.reference
@@ -29,24 +29,24 @@
 ██████████████████████████████████▎
 ████████████████████████████████████▏
 ██████████████████████████████████████
-███████████████████████████████████████▊
-█████████████████████████████████████████▋
+███████████████████████████████████████▉
+█████████████████████████████████████████▊
 ███████████████████████████████████████████▌
 █████████████████████████████████████████████▍
 ███████████████████████████████████████████████▏
-████████████████████████████████████████████████▊
+████████████████████████████████████████████████▉
 ██████████████████████████████████████████████████▌
 ████████████████████████████████████████████████████▏
-█████████████████████████████████████████████████████▊
+█████████████████████████████████████████████████████▉
 ███████████████████████████████████████████████████████▍
 █████████████████████████████████████████████████████████
 ██████████████████████████████████████████████████████████▌
 ████████████████████████████████████████████████████████████
 █████████████████████████████████████████████████████████████▌
-██████████████████████████████████████████████████████████████▊
+██████████████████████████████████████████████████████████████▉
 ████████████████████████████████████████████████████████████████▎
 █████████████████████████████████████████████████████████████████▌
-██████████████████████████████████████████████████████████████████▋
+██████████████████████████████████████████████████████████████████▊
 ████████████████████████████████████████████████████████████████████
 █████████████████████████████████████████████████████████████████████▏
 ██████████████████████████████████████████████████████████████████████▎
@@ -59,13 +59,13 @@
 ████████████████████████████████████████████████████████████████████████████▍
 █████████████████████████████████████████████████████████████████████████████
 █████████████████████████████████████████████████████████████████████████████▌
-█████████████████████████████████████████████████████████████████████████████▊
+█████████████████████████████████████████████████████████████████████████████▉
 ██████████████████████████████████████████████████████████████████████████████▎
 ██████████████████████████████████████████████████████████████████████████████▋
-██████████████████████████████████████████████████████████████████████████████▋
-██████████████████████████████████████████████████████████████████████████████▊
-██████████████████████████████████████████████████████████████████████████████▊
 ██████████████████████████████████████████████████████████████████████████████▊
+██████████████████████████████████████████████████████████████████████████████▉
+██████████████████████████████████████████████████████████████████████████████▉
+██████████████████████████████████████████████████████████████████████████████▉
 ██████████████████████████████████████████████████████████████████████████████▋
 ██████████████████████████████████████████████████████████████████████████████▍
 ██████████████████████████████████████████████████████████████████████████████
@@ -84,18 +84,18 @@
 ██████████████████████████████████████████████████████████████▌
 ████████████████████████████████████████████████████████████▍
 ██████████████████████████████████████████████████████████▏
-███████████████████████████████████████████████████████▋
+███████████████████████████████████████████████████████▊
 █████████████████████████████████████████████████████▏
 ██████████████████████████████████████████████████▍
 ███████████████████████████████████████████████▌
 ████████████████████████████████████████████▌
 █████████████████████████████████████████▎
-█████████████████████████████████████▊
+█████████████████████████████████████▉
 ██████████████████████████████████▍
 ██████████████████████████████▋
-██████████████████████████▋
-██████████████████████▋
+██████████████████████████▊
+██████████████████████▊
 ██████████████████▌
 ██████████████▏
 █████████▋
-████▊
+████▉
diff --git a/tests/queries/0_stateless/02020_exponential_smoothing.reference b/tests/queries/0_stateless/02020_exponential_smoothing.reference
index 95f5cb0c310a..1e98bca8a23a 100644
--- a/tests/queries/0_stateless/02020_exponential_smoothing.reference
+++ b/tests/queries/0_stateless/02020_exponential_smoothing.reference
@@ -31,14 +31,14 @@ exponentialMovingAverage
 9	9	8.002
 1	0	0.067	███▎
 0	1	0.062	███
-0	2	0.058	██▊
+0	2	0.058	██▉
 0	3	0.054	██▋
 0	4	0.051	██▌
 0	5	0.047	██▎
 0	6	0.044	██▏
 0	7	0.041	██
-0	8	0.038	█▊
-0	9	0.036	█▋
+0	8	0.038	█▉
+0	9	0.036	█▊
 0	10	0.033	█▋
 0	11	0.031	█▌
 0	12	0.029	█▍
@@ -47,16 +47,16 @@ exponentialMovingAverage
 0	15	0.024	█▏
 0	16	0.022	█
 0	17	0.021	█
-0	18	0.019	▊
-0	19	0.018	▊
-0	20	0.017	▋
-0	21	0.016	▋
+0	18	0.019	▉
+0	19	0.018	▉
+0	20	0.017	▊
+0	21	0.016	▊
 0	22	0.015	▋
 0	23	0.014	▋
 0	24	0.013	▋
-1	25	0.079	███▊
+1	25	0.079	███▉
 1	26	0.14	███████
-1	27	0.198	█████████▊
+1	27	0.198	█████████▉
 1	28	0.252	████████████▌
 1	29	0.302	███████████████
 1	30	0.349	█████████████████▍
@@ -64,68 +64,68 @@ exponentialMovingAverage
 1	32	0.433	█████████████████████▋
 1	33	0.471	███████████████████████▌
 1	34	0.506	█████████████████████████▎
-1	35	0.539	██████████████████████████▊
+1	35	0.539	██████████████████████████▉
 1	36	0.57	████████████████████████████▌
-1	37	0.599	█████████████████████████████▊
+1	37	0.599	█████████████████████████████▉
 1	38	0.626	███████████████████████████████▎
 1	39	0.651	████████████████████████████████▌
 1	40	0.674	█████████████████████████████████▋
-1	41	0.696	██████████████████████████████████▋
-1	42	0.716	███████████████████████████████████▋
-1	43	0.735	████████████████████████████████████▋
+1	41	0.696	██████████████████████████████████▊
+1	42	0.716	███████████████████████████████████▊
+1	43	0.735	████████████████████████████████████▊
 1	44	0.753	█████████████████████████████████████▋
 1	45	0.77	██████████████████████████████████████▍
 1	46	0.785	███████████████████████████████████████▎
-1	47	0.8	███████████████████████████████████████▊
+1	47	0.8	███████████████████████████████████████▉
 1	48	0.813	████████████████████████████████████████▋
 1	49	0.825	█████████████████████████████████████████▎
 1	0	0.5	█████████████████████████
 0	1	0.25	████████████▌
 0	2	0.125	██████▎
-0	3	0.062	███
+0	3	0.062	███▏
 0	4	0.031	█▌
-1	5	0.516	█████████████████████████▋
-0	6	0.258	████████████▊
+1	5	0.516	█████████████████████████▊
+0	6	0.258	████████████▉
 0	7	0.129	██████▍
 0	8	0.064	███▏
 0	9	0.032	█▌
-1	10	0.516	█████████████████████████▋
-0	11	0.258	████████████▊
+1	10	0.516	█████████████████████████▊
+0	11	0.258	████████████▉
 0	12	0.129	██████▍
 0	13	0.065	███▏
 0	14	0.032	█▌
-1	15	0.516	█████████████████████████▋
-0	16	0.258	████████████▊
+1	15	0.516	█████████████████████████▊
+0	16	0.258	████████████▉
 0	17	0.129	██████▍
 0	18	0.065	███▏
 0	19	0.032	█▌
-1	20	0.516	█████████████████████████▋
-0	21	0.258	████████████▊
+1	20	0.516	█████████████████████████▊
+0	21	0.258	████████████▉
 0	22	0.129	██████▍
 0	23	0.065	███▏
 0	24	0.032	█▌
-1	25	0.516	█████████████████████████▋
-0	26	0.258	████████████▊
+1	25	0.516	█████████████████████████▊
+0	26	0.258	████████████▉
 0	27	0.129	██████▍
 0	28	0.065	███▏
 0	29	0.032	█▌
-1	30	0.516	█████████████████████████▋
-0	31	0.258	████████████▊
+1	30	0.516	█████████████████████████▊
+0	31	0.258	████████████▉
 0	32	0.129	██████▍
 0	33	0.065	███▏
 0	34	0.032	█▌
-1	35	0.516	█████████████████████████▋
-0	36	0.258	████████████▊
+1	35	0.516	█████████████████████████▊
+0	36	0.258	████████████▉
 0	37	0.129	██████▍
 0	38	0.065	███▏
 0	39	0.032	█▌
-1	40	0.516	█████████████████████████▋
-0	41	0.258	████████████▊
+1	40	0.516	█████████████████████████▊
+0	41	0.258	████████████▉
 0	42	0.129	██████▍
 0	43	0.065	███▏
 0	44	0.032	█▌
-1	45	0.516	█████████████████████████▋
-0	46	0.258	████████████▊
+1	45	0.516	█████████████████████████▊
+0	46	0.258	████████████▉
 0	47	0.129	██████▍
 0	48	0.065	███▏
 0	49	0.032	█▌
@@ -170,15 +170,15 @@ exponentialTimeDecayedSum
 0	7	0.497	██▍
 0	8	0.449	██▏
 0	9	0.407	██
-0	10	0.368	█▋
+0	10	0.368	█▊
 0	11	0.333	█▋
 0	12	0.301	█▌
 0	13	0.273	█▎
 0	14	0.247	█▏
 0	15	0.223	█
 0	16	0.202	█
-0	17	0.183	▊
-0	18	0.165	▋
+0	17	0.183	▉
+0	18	0.165	▊
 0	19	0.15	▋
 0	20	0.135	▋
 0	21	0.122	▌
@@ -186,80 +186,80 @@ exponentialTimeDecayedSum
 0	23	0.1	▌
 0	24	0.091	▍
 1	25	1.082	█████▍
-1	26	1.979	█████████▊
-1	27	2.791	█████████████▊
+1	26	1.979	█████████▉
+1	27	2.791	█████████████▉
 1	28	3.525	█████████████████▋
-1	29	4.19	████████████████████▊
-1	30	4.791	███████████████████████▊
+1	29	4.19	████████████████████▉
+1	30	4.791	███████████████████████▉
 1	31	5.335	██████████████████████████▋
 1	32	5.827	█████████████████████████████▏
 1	33	6.273	███████████████████████████████▎
 1	34	6.676	█████████████████████████████████▍
 1	35	7.041	███████████████████████████████████▏
-1	36	7.371	████████████████████████████████████▋
+1	36	7.371	████████████████████████████████████▊
 1	37	7.669	██████████████████████████████████████▎
 1	38	7.939	███████████████████████████████████████▋
-1	39	8.184	████████████████████████████████████████▊
+1	39	8.184	████████████████████████████████████████▉
 1	40	8.405	██████████████████████████████████████████
 1	41	8.605	███████████████████████████████████████████
-1	42	8.786	███████████████████████████████████████████▊
-1	43	8.95	████████████████████████████████████████████▋
+1	42	8.786	███████████████████████████████████████████▉
+1	43	8.95	████████████████████████████████████████████▊
 1	44	9.098	█████████████████████████████████████████████▍
 1	45	9.233	██████████████████████████████████████████████▏
-1	46	9.354	██████████████████████████████████████████████▋
+1	46	9.354	██████████████████████████████████████████████▊
 1	47	9.464	███████████████████████████████████████████████▎
-1	48	9.563	███████████████████████████████████████████████▋
+1	48	9.563	███████████████████████████████████████████████▊
 1	49	9.653	████████████████████████████████████████████████▎
 1	0	1	██████████████████████████████████████████████████
 0	1	0.368	██████████████████▍
-0	2	0.135	██████▋
+0	2	0.135	██████▊
 0	3	0.05	██▍
-0	4	0.018	▊
+0	4	0.018	▉
 1	5	1.007	██████████████████████████████████████████████████
 0	6	0.37	██████████████████▌
-0	7	0.136	██████▋
+0	7	0.136	██████▊
 0	8	0.05	██▌
-0	9	0.018	▊
+0	9	0.018	▉
 1	10	1.007	██████████████████████████████████████████████████
 0	11	0.37	██████████████████▌
-0	12	0.136	██████▋
+0	12	0.136	██████▊
 0	13	0.05	██▌
-0	14	0.018	▊
+0	14	0.018	▉
 1	15	1.007	██████████████████████████████████████████████████
 0	16	0.37	██████████████████▌
-0	17	0.136	██████▋
+0	17	0.136	██████▊
 0	18	0.05	██▌
-0	19	0.018	▊
+0	19	0.018	▉
 1	20	1.007	██████████████████████████████████████████████████
 0	21	0.37	██████████████████▌
-0	22	0.136	██████▋
+0	22	0.136	██████▊
 0	23	0.05	██▌
-0	24	0.018	▊
+0	24	0.018	▉
 1	25	1.007	██████████████████████████████████████████████████
 0	26	0.37	██████████████████▌
-0	27	0.136	██████▋
+0	27	0.136	██████▊
 0	28	0.05	██▌
-0	29	0.018	▊
+0	29	0.018	▉
 1	30	1.007	██████████████████████████████████████████████████
 0	31	0.37	██████████████████▌
-0	32	0.136	██████▋
+0	32	0.136	██████▊
 0	33	0.05	██▌
-0	34	0.018	▊
+0	34	0.018	▉
 1	35	1.007	██████████████████████████████████████████████████
 0	36	0.37	██████████████████▌
-0	37	0.136	██████▋
+0	37	0.136	██████▊
 0	38	0.05	██▌
-0	39	0.018	▊
+0	39	0.018	▉
 1	40	1.007	██████████████████████████████████████████████████
 0	41	0.37	██████████████████▌
-0	42	0.136	██████▋
+0	42	0.136	██████▊
 0	43	0.05	██▌
-0	44	0.018	▊
+0	44	0.018	▉
 1	45	1.007	██████████████████████████████████████████████████
 0	46	0.37	██████████████████▌
-0	47	0.136	██████▋
+0	47	0.136	██████▊
 0	48	0.05	██▌
-0	49	0.018	▊
+0	49	0.018	▉
 exponentialTimeDecayedMax
 1	0	1
 0	1	0.368
@@ -301,15 +301,15 @@ exponentialTimeDecayedMax
 0	7	0.497	██▍
 0	8	0.449	██▏
 0	9	0.407	██
-0	10	0.368	█▋
+0	10	0.368	█▊
 0	11	0.333	█▋
 0	12	0.301	█▌
 0	13	0.273	█▎
 0	14	0.247	█▏
 0	15	0.223	█
 0	16	0.202	█
-0	17	0.183	▊
-0	18	0.165	▋
+0	17	0.183	▉
+0	18	0.165	▊
 0	19	0.15	▋
 0	20	0.135	▋
 0	21	0.122	▌
@@ -343,54 +343,54 @@ exponentialTimeDecayedMax
 1	49	1	█████
 1	0	1	██████████████████████████████████████████████████
 0	1	0.368	██████████████████▍
-0	2	0.135	██████▋
+0	2	0.135	██████▊
 0	3	0.05	██▍
-0	4	0.018	▊
+0	4	0.018	▉
 1	5	1	██████████████████████████████████████████████████
 0	6	0.368	██████████████████▍
-0	7	0.135	██████▋
+0	7	0.135	██████▊
 0	8	0.05	██▍
-0	9	0.018	▊
+0	9	0.018	▉
 1	10	1	██████████████████████████████████████████████████
 0	11	0.368	██████████████████▍
-0	12	0.135	██████▋
+0	12	0.135	██████▊
 0	13	0.05	██▍
-0	14	0.018	▊
+0	14	0.018	▉
 1	15	1	██████████████████████████████████████████████████
 0	16	0.368	██████████████████▍
-0	17	0.135	██████▋
+0	17	0.135	██████▊
 0	18	0.05	██▍
-0	19	0.018	▊
+0	19	0.018	▉
 1	20	1	██████████████████████████████████████████████████
 0	21	0.368	██████████████████▍
-0	22	0.135	██████▋
+0	22	0.135	██████▊
 0	23	0.05	██▍
-0	24	0.018	▊
+0	24	0.018	▉
 1	25	1	██████████████████████████████████████████████████
 0	26	0.368	██████████████████▍
-0	27	0.135	██████▋
+0	27	0.135	██████▊
 0	28	0.05	██▍
-0	29	0.018	▊
+0	29	0.018	▉
 1	30	1	██████████████████████████████████████████████████
 0	31	0.368	██████████████████▍
-0	32	0.135	██████▋
+0	32	0.135	██████▊
 0	33	0.05	██▍
-0	34	0.018	▊
+0	34	0.018	▉
 1	35	1	██████████████████████████████████████████████████
 0	36	0.368	██████████████████▍
-0	37	0.135	██████▋
+0	37	0.135	██████▊
 0	38	0.05	██▍
-0	39	0.018	▊
+0	39	0.018	▉
 1	40	1	██████████████████████████████████████████████████
 0	41	0.368	██████████████████▍
-0	42	0.135	██████▋
+0	42	0.135	██████▊
 0	43	0.05	██▍
-0	44	0.018	▊
+0	44	0.018	▉
 1	45	1	██████████████████████████████████████████████████
 0	46	0.368	██████████████████▍
-0	47	0.135	██████▋
+0	47	0.135	██████▊
 0	48	0.05	██▍
-0	49	0.018	▊
+0	49	0.018	▉
 exponentialTimeDecayedCount
 1	0	1
 0	1	1.368
@@ -428,19 +428,19 @@ exponentialTimeDecayedCount
 0	3	3.038	███████████████▏
 0	4	3.487	█████████████████▍
 0	5	3.855	███████████████████▎
-0	6	4.156	████████████████████▋
+0	6	4.156	████████████████████▊
 0	7	4.403	██████████████████████
 0	8	4.605	███████████████████████
-0	9	4.77	███████████████████████▋
+0	9	4.77	███████████████████████▊
 0	10	4.905	████████████████████████▌
 0	11	5.016	█████████████████████████
 0	12	5.107	█████████████████████████▌
-0	13	5.181	█████████████████████████▊
+0	13	5.181	█████████████████████████▉
 0	14	5.242	██████████████████████████▏
 0	15	5.292	██████████████████████████▍
 0	16	5.333	██████████████████████████▋
-0	17	5.366	██████████████████████████▋
-0	18	5.393	██████████████████████████▊
+0	17	5.366	██████████████████████████▊
+0	18	5.393	██████████████████████████▉
 0	19	5.416	███████████████████████████
 0	20	5.434	███████████████████████████▏
 0	21	5.449	███████████████████████████▏
@@ -473,11 +473,11 @@ exponentialTimeDecayedCount
 1	48	5.516	███████████████████████████▌
 1	49	5.516	███████████████████████████▌
 1	0	1	██▌
-0	1	1.905	████▋
-0	2	2.724	██████▋
+0	1	1.905	████▊
+0	2	2.724	██████▊
 0	3	3.464	████████▋
 0	4	4.135	██████████▎
-1	5	4.741	███████████▋
+1	5	4.741	███████████▊
 0	6	5.29	█████████████▏
 0	7	5.787	██████████████▍
 0	8	6.236	███████████████▌
@@ -485,23 +485,23 @@ exponentialTimeDecayedCount
 1	10	7.01	█████████████████▌
 0	11	7.343	██████████████████▎
 0	12	7.644	███████████████████
-0	13	7.917	███████████████████▋
+0	13	7.917	███████████████████▊
 0	14	8.164	████████████████████▍
-1	15	8.387	████████████████████▊
+1	15	8.387	████████████████████▉
 0	16	8.589	█████████████████████▍
-0	17	8.771	█████████████████████▊
+0	17	8.771	█████████████████████▉
 0	18	8.937	██████████████████████▎
 0	19	9.086	██████████████████████▋
 1	20	9.222	███████████████████████
 0	21	9.344	███████████████████████▎
 0	22	9.455	███████████████████████▋
-0	23	9.555	███████████████████████▊
+0	23	9.555	███████████████████████▉
 0	24	9.646	████████████████████████
 1	25	9.728	████████████████████████▎
 0	26	9.802	████████████████████████▌
 0	27	9.869	████████████████████████▋
-0	28	9.93	████████████████████████▋
-0	29	9.985	████████████████████████▊
+0	28	9.93	████████████████████████▊
+0	29	9.985	████████████████████████▉
 1	30	10.035	█████████████████████████
 0	31	10.08	█████████████████████████▏
 0	32	10.121	█████████████████████████▎
@@ -511,12 +511,12 @@ exponentialTimeDecayedCount
 0	36	10.249	█████████████████████████▌
 0	37	10.273	█████████████████████████▋
 0	38	10.296	█████████████████████████▋
-0	39	10.316	█████████████████████████▋
-1	40	10.334	█████████████████████████▋
-0	41	10.351	█████████████████████████▊
-0	42	10.366	█████████████████████████▊
-0	43	10.379	█████████████████████████▊
-0	44	10.392	█████████████████████████▊
+0	39	10.316	█████████████████████████▊
+1	40	10.334	█████████████████████████▊
+0	41	10.351	█████████████████████████▉
+0	42	10.366	█████████████████████████▉
+0	43	10.379	█████████████████████████▉
+0	44	10.392	█████████████████████████▉
 1	45	10.403	██████████████████████████
 0	46	10.413	██████████████████████████
 0	47	10.422	██████████████████████████
@@ -554,13 +554,13 @@ exponentialTimeDecayedAvg
 8	8	7.419
 9	9	8.418
 1	0	1	██████████
-0	1	0.475	████▋
+0	1	0.475	████▊
 0	2	0.301	███
 0	3	0.214	██▏
 0	4	0.162	█▌
 0	5	0.128	█▎
 0	6	0.104	█
-0	7	0.086	▋
+0	7	0.086	▊
 0	8	0.072	▋
 0	9	0.061	▌
 0	10	0.052	▌
@@ -580,42 +580,42 @@ exponentialTimeDecayedAvg
 0	24	0.009	
 1	25	0.111	█
 1	26	0.202	██
-1	27	0.283	██▋
+1	27	0.283	██▊
 1	28	0.355	███▌
 1	29	0.42	████▏
-1	30	0.477	████▋
+1	30	0.477	████▊
 1	31	0.529	█████▎
-1	32	0.576	█████▋
+1	32	0.576	█████▊
 1	33	0.618	██████▏
 1	34	0.655	██████▌
-1	35	0.689	██████▊
+1	35	0.689	██████▉
 1	36	0.719	███████▏
 1	37	0.747	███████▍
 1	38	0.771	███████▋
-1	39	0.793	███████▊
+1	39	0.793	███████▉
 1	40	0.813	████████▏
 1	41	0.831	████████▎
 1	42	0.848	████████▍
 1	43	0.862	████████▌
-1	44	0.876	████████▋
-1	45	0.888	████████▊
-1	46	0.898	████████▊
+1	44	0.876	████████▊
+1	45	0.888	████████▉
+1	46	0.898	████████▉
 1	47	0.908	█████████
 1	48	0.917	█████████▏
 1	49	0.925	█████████▏
 1	0	1	██████████████████████████████████████████████████
-0	1	0.498	█████████████████████████████████████████████████▋
+0	1	0.498	█████████████████████████████████████████████████▊
 0	2	0.33	█████████████████████████████████
 0	3	0.246	████████████████████████▋
 0	4	0.196	███████████████████▌
 1	5	0.333	█████████████████████████████████▎
 0	6	0.284	████████████████████████████▍
-0	7	0.248	████████████████████████▋
-0	8	0.219	█████████████████████▊
+0	7	0.248	████████████████████████▊
+0	8	0.219	█████████████████████▉
 0	9	0.196	███████████████████▌
 1	10	0.273	███████████████████████████▎
-0	11	0.249	████████████████████████▊
-0	12	0.229	██████████████████████▋
+0	11	0.249	████████████████████████▉
+0	12	0.229	██████████████████████▊
 0	13	0.211	█████████████████████
 0	14	0.196	███████████████████▌
 1	15	0.25	█████████████████████████
@@ -623,7 +623,7 @@ exponentialTimeDecayedAvg
 0	17	0.22	██████████████████████
 0	18	0.207	████████████████████▋
 0	19	0.196	███████████████████▌
-1	20	0.238	███████████████████████▋
+1	20	0.238	███████████████████████▊
 0	21	0.226	██████████████████████▌
 0	22	0.215	█████████████████████▌
 0	23	0.205	████████████████████▌
@@ -634,21 +634,21 @@ exponentialTimeDecayedAvg
 0	28	0.204	████████████████████▍
 0	29	0.196	███████████████████▌
 1	30	0.226	██████████████████████▌
-0	31	0.218	█████████████████████▋
+0	31	0.218	█████████████████████▊
 0	32	0.21	█████████████████████
 0	33	0.203	████████████████████▎
 0	34	0.196	███████████████████▌
 1	35	0.222	██████████████████████▏
 0	36	0.215	█████████████████████▌
-0	37	0.209	████████████████████▋
+0	37	0.209	████████████████████▊
 0	38	0.202	████████████████████▏
 0	39	0.196	███████████████████▌
-1	40	0.22	█████████████████████▊
+1	40	0.22	█████████████████████▉
 0	41	0.213	█████████████████████▎
 0	42	0.207	████████████████████▋
 0	43	0.202	████████████████████▏
 0	44	0.196	███████████████████▌
-1	45	0.218	█████████████████████▋
+1	45	0.218	█████████████████████▊
 0	46	0.212	█████████████████████▏
 0	47	0.206	████████████████████▋
 0	48	0.201	████████████████████
diff --git a/tests/queries/0_stateless/02504_bar_fractions.reference b/tests/queries/0_stateless/02504_bar_fractions.reference
new file mode 100644
index 000000000000..2a7b46069df3
--- /dev/null
+++ b/tests/queries/0_stateless/02504_bar_fractions.reference
@@ -0,0 +1,20 @@
+0				
+0.125	▏		E2968F	
+0.25	▎	▏	E2968E	E2968F
+0.375	▍	▎	E2968D	E2968E
+0.5	▌	▍	E2968C	E2968D
+0.625	▋	▌	E2968B	E2968C
+0.75	▊	▋	E2968A	E2968B
+0.875	▉	▊	E29689	E2968A
+1	█	▉	E29688	E29689
+1.125	█▏	█	E29688E2968F	E29688
+1.25	█▎	█▏	E29688E2968E	E29688E2968F
+1.375	█▍	█▎	E29688E2968D	E29688E2968E
+1.5	█▌	█▍	E29688E2968C	E29688E2968D
+1.625	█▋	█▌	E29688E2968B	E29688E2968C
+1.75	█▊	█▋	E29688E2968A	E29688E2968B
+1.875	█▉	█▊	E29688E29689	E29688E2968A
+2	██	█▉	E29688E29688	E29688E29689
+2.125	██▏	██	E29688E29688E2968F	E29688E29688
+2.25	██▎	██▏	E29688E29688E2968E	E29688E29688E2968F
+2.375	██▍	██▎	E29688E29688E2968D	E29688E29688E2968E
diff --git a/tests/queries/0_stateless/02504_bar_fractions.sql b/tests/queries/0_stateless/02504_bar_fractions.sql
new file mode 100644
index 000000000000..d182bced55ee
--- /dev/null
+++ b/tests/queries/0_stateless/02504_bar_fractions.sql
@@ -0,0 +1,7 @@
+SELECT
+    number / 8 AS width,
+    bar(width, 0, 3, 3) AS b,
+    bar(width - 0.001, 0, 3, 3) AS `b_minus`,
+    hex(b),
+    hex(b_minus)
+FROM numbers(20);
diff --git a/tests/queries/1_stateful/00047_bar.reference b/tests/queries/1_stateful/00047_bar.reference
index c038f59946e2..86f7ca3a9b6d 100644
--- a/tests/queries/1_stateful/00047_bar.reference
+++ b/tests/queries/1_stateful/00047_bar.reference
@@ -2,21 +2,21 @@
 732797	475698	████████████████████████████████████████████████████████████████████████▋
 598875	337212	███████████████████████████████████████████████████▌
 792887	252197	██████████████████████████████████████▌
-3807842	196036	█████████████████████████████▊
+3807842	196036	█████████████████████████████▉
 25703952	147211	██████████████████████▌
-716829	90109	█████████████▋
+716829	90109	█████████████▊
 59183	85379	█████████████
-33010362	77807	███████████▊
-800784	77492	███████████▋
+33010362	77807	███████████▉
+800784	77492	███████████▊
 20810645	73213	███████████▏
 25843850	68945	██████████▌
 23447120	67570	██████████▎
-14739804	64174	█████████▋
+14739804	64174	█████████▊
 32077710	60456	█████████▏
-22446879	58389	████████▊
+22446879	58389	████████▉
 170282	57017	████████▋
 11482817	52345	████████
-63469	52142	███████▊
+63469	52142	███████▉
 29103473	47758	███████▎
 10136747	44080	██████▋
 27528801	43395	██████▋
@@ -27,12 +27,12 @@
 28600281	32776	█████
 32046685	28788	████▍
 10130880	26603	████
-8676831	25733	███▊
-53230	25595	███▊
-20271226	25585	███▊
-17420663	25496	███▊
-631207	25270	███▋
-633130	24744	███▋
+8676831	25733	███▉
+53230	25595	███▉
+20271226	25585	███▉
+17420663	25496	███▉
+631207	25270	███▊
+633130	24744	███▊
 14324015	23349	███▌
 8537965	21270	███▎
 11285298	20825	███▏
@@ -41,9 +41,9 @@
 16368233	19897	███
 81602	19724	███
 62896	19717	███
-12967664	19402	██▊
-15996597	18557	██▋
-4379238	18370	██▋
+12967664	19402	██▉
+15996597	18557	██▊
+4379238	18370	██▊
 90982	17443	██▋
 18211045	17390	██▋
 14625884	17302	██▋
@@ -68,19 +68,19 @@
 125776	13308	██
 11312316	13181	██
 32667326	13181	██
-28628973	12922	█▊
-122804	12520	█▊
-12322758	12352	█▊
-1301819	12283	█▊
-10769545	12183	█▋
-21566939	12170	█▋
-28905364	12158	█▋
-4250765	12049	█▋
-15009727	11818	█▋
-12761932	11733	█▋
-26995888	11658	█▋
-12759346	11514	█▋
-1507911	11452	█▋
+28628973	12922	█▉
+122804	12520	█▉
+12322758	12352	█▉
+1301819	12283	█▉
+10769545	12183	█▊
+21566939	12170	█▊
+28905364	12158	█▊
+4250765	12049	█▊
+15009727	11818	█▊
+12761932	11733	█▊
+26995888	11658	█▊
+12759346	11514	█▊
+1507911	11452	█▊
 968488	11444	█▋
 15736172	11358	█▋
 54310	11193	█▋
@@ -102,21 +102,21 @@
 732797	475698	████████████████████████████████████████████████████████████████████████▋
 598875	337212	███████████████████████████████████████████████████▌
 792887	252197	██████████████████████████████████████▌
-3807842	196036	█████████████████████████████▊
+3807842	196036	█████████████████████████████▉
 25703952	147211	██████████████████████▌
-716829	90109	█████████████▋
+716829	90109	█████████████▊
 59183	85379	█████████████
-33010362	77807	███████████▊
-800784	77492	███████████▋
+33010362	77807	███████████▉
+800784	77492	███████████▊
 20810645	73213	███████████▏
 25843850	68945	██████████▌
 23447120	67570	██████████▎
-14739804	64174	█████████▋
+14739804	64174	█████████▊
 32077710	60456	█████████▏
-22446879	58389	████████▊
+22446879	58389	████████▉
 170282	57017	████████▋
 11482817	52345	████████
-63469	52142	███████▊
+63469	52142	███████▉
 29103473	47758	███████▎
 10136747	44080	██████▋
 27528801	43395	██████▋
@@ -127,12 +127,12 @@
 28600281	32776	█████
 32046685	28788	████▍
 10130880	26603	████
-8676831	25733	███▊
-53230	25595	███▊
-20271226	25585	███▊
-17420663	25496	███▊
-631207	25270	███▋
-633130	24744	███▋
+8676831	25733	███▉
+53230	25595	███▉
+20271226	25585	███▉
+17420663	25496	███▉
+631207	25270	███▊
+633130	24744	███▊
 14324015	23349	███▌
 8537965	21270	███▎
 11285298	20825	███▏
@@ -141,9 +141,9 @@
 16368233	19897	███
 81602	19724	███
 62896	19717	███
-12967664	19402	██▊
-15996597	18557	██▋
-4379238	18370	██▋
+12967664	19402	██▉
+15996597	18557	██▊
+4379238	18370	██▊
 90982	17443	██▋
 18211045	17390	██▋
 14625884	17302	██▋
@@ -168,19 +168,19 @@
 125776	13308	██
 11312316	13181	██
 32667326	13181	██
-28628973	12922	█▊
-122804	12520	█▊
-12322758	12352	█▊
-1301819	12283	█▊
-10769545	12183	█▋
-21566939	12170	█▋
-28905364	12158	█▋
-4250765	12049	█▋
-15009727	11818	█▋
-12761932	11733	█▋
-26995888	11658	█▋
-12759346	11514	█▋
-1507911	11452	█▋
+28628973	12922	█▉
+122804	12520	█▉
+12322758	12352	█▉
+1301819	12283	█▉
+10769545	12183	█▊
+21566939	12170	█▊
+28905364	12158	█▊
+4250765	12049	█▊
+15009727	11818	█▊
+12761932	11733	█▊
+26995888	11658	█▊
+12759346	11514	█▊
+1507911	11452	█▊
 968488	11444	█▋
 15736172	11358	█▋
 54310	11193	█▋
diff --git a/tests/queries/1_stateful/00062_loyalty.reference b/tests/queries/1_stateful/00062_loyalty.reference
index 605e4881dd40..f6451faa815d 100644
--- a/tests/queries/1_stateful/00062_loyalty.reference
+++ b/tests/queries/1_stateful/00062_loyalty.reference
@@ -1,12 +1,12 @@
 -10	5604	███████████████████████████████████████████████████████████████████████████████▎
--9	603	██████████████████████████████████████████████████████████▊
+-9	603	██████████████████████████████████████████████████████████▉
 -8	236	██████████████████████████████████████████████████▎
 -7	133	█████████████████████████████████████████████
 -6	123	████████████████████████████████████████████▎
--5	105	██████████████████████████████████████████▊
+-5	105	██████████████████████████████████████████▉
 5	82	████████████████████████████████████████▋
 6	91	█████████████████████████████████████████▌
 7	102	██████████████████████████████████████████▌
 8	156	██████████████████████████████████████████████▍
 9	222	█████████████████████████████████████████████████▋
-10	4291	████████████████████████████████████████████████████████████████████████████▊
+10	4291	████████████████████████████████████████████████████████████████████████████▉
diff --git a/tests/queries/1_stateful/00063_loyalty_joins.reference b/tests/queries/1_stateful/00063_loyalty_joins.reference
index e4c3619bf5a0..f925b457c6ac 100644
--- a/tests/queries/1_stateful/00063_loyalty_joins.reference
+++ b/tests/queries/1_stateful/00063_loyalty_joins.reference
@@ -37,15 +37,15 @@
 8	74083
 9	145771
 10	1244506
--10	2932018	███████████████████████████████████████████████████████████████████████████████▊
+-10	2932018	███████████████████████████████████████████████████████████████████████████████▉
 -9	472052	██████████████████████████████████████████████████████████████████████
 -8	136048	███████████████████████████████████████████████████████████████▍
 -7	73688	████████████████████████████████████████████████████████████
 -6	56766	██████████████████████████████████████████████████████████▋
 -5	55691	██████████████████████████████████████████████████████████▌
 5	47082	█████████████████████████████████████████████████████████▋
-6	32860	███████████████████████████████████████████████████████▋
+6	32860	███████████████████████████████████████████████████████▊
 7	52819	██████████████████████████████████████████████████████████▎
 8	74083	████████████████████████████████████████████████████████████▏
-9	145771	███████████████████████████████████████████████████████████████▋
+9	145771	███████████████████████████████████████████████████████████████▊
 10	1244506	███████████████████████████████████████████████████████████████████████████▎
