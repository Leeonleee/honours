diff --git a/tests/integration/test_explain_estimates/__init__.py b/tests/integration/test_explain_estimates/__init__.py
new file mode 100644
index 000000000000..e69de29bb2d1
diff --git a/tests/integration/test_explain_estimates/test.py b/tests/integration/test_explain_estimates/test.py
new file mode 100644
index 000000000000..a2b65564dbcd
--- /dev/null
+++ b/tests/integration/test_explain_estimates/test.py
@@ -0,0 +1,24 @@
+import pytest
+
+from helpers.cluster import ClickHouseCluster
+
+cluster = ClickHouseCluster(__file__)
+node1 = cluster.add_instance('instance')
+
+@pytest.fixture(scope="module")
+def start_cluster():
+    try:
+        cluster.start()
+        yield cluster
+
+    finally:
+        cluster.shutdown()
+
+
+def test_explain_estimates(start_cluster):
+    node1.query("CREATE TABLE test (i Int64) ENGINE = MergeTree() ORDER BY i SETTINGS index_granularity = 16, write_final_mark = 0")
+    node1.query("INSERT INTO test SELECT number FROM numbers(128)")
+    node1.query("OPTIMIZE TABLE test")
+    system_parts_result = node1.query("SELECT any(database), any(table), count() as parts, sum(rows) as rows, sum(marks) as marks FROM system.parts WHERE database = 'default' AND table = 'test' and active = 1 GROUP BY (database, table)")
+    explain_estimates_result = node1.query("EXPLAIN ESTIMATE SELECT * FROM test")
+    assert(system_parts_result == explain_estimates_result)
diff --git a/tests/queries/1_stateful/00166_explain_estimate.reference b/tests/queries/1_stateful/00166_explain_estimate.reference
new file mode 100644
index 000000000000..71ddd6815812
--- /dev/null
+++ b/tests/queries/1_stateful/00166_explain_estimate.reference
@@ -0,0 +1,5 @@
+test	hits	1	57344	7
+test	hits	1	8839168	1079
+test	hits	1	835584	102
+test	hits	1	8003584	977
+test	hits	2	581632	71
diff --git a/tests/queries/1_stateful/00166_explain_estimate.sql b/tests/queries/1_stateful/00166_explain_estimate.sql
new file mode 100644
index 000000000000..06725ff7f9f9
--- /dev/null
+++ b/tests/queries/1_stateful/00166_explain_estimate.sql
@@ -0,0 +1,5 @@
+EXPLAIN ESTIMATE SELECT count() FROM test.hits WHERE CounterID = 29103473;
+EXPLAIN ESTIMATE SELECT count() FROM test.hits WHERE CounterID != 29103473;
+EXPLAIN ESTIMATE SELECT count() FROM test.hits WHERE CounterID > 29103473;
+EXPLAIN ESTIMATE SELECT count() FROM test.hits WHERE CounterID < 29103473;
+EXPLAIN ESTIMATE SELECT count() FROM test.hits WHERE CounterID = 29103473 UNION ALL SELECT count() FROM test.hits WHERE CounterID = 1704509;
