diff --git a/tests/queries/0_stateless/03279_insert_sparse_parsing_error.reference b/tests/queries/0_stateless/03279_insert_sparse_parsing_error.reference
new file mode 100644
index 000000000000..07d1b660d363
--- /dev/null
+++ b/tests/queries/0_stateless/03279_insert_sparse_parsing_error.reference
@@ -0,0 +1,6 @@
+Code: 27
+1	0	0
+2	0	0
+a	Default
+b	Sparse
+c	Sparse
diff --git a/tests/queries/0_stateless/03279_insert_sparse_parsing_error.sh b/tests/queries/0_stateless/03279_insert_sparse_parsing_error.sh
new file mode 100755
index 000000000000..1d46c084c693
--- /dev/null
+++ b/tests/queries/0_stateless/03279_insert_sparse_parsing_error.sh
@@ -0,0 +1,31 @@
+#!/usr/bin/env bash
+
+CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
+# shellcheck source=../shell_config.sh
+. "$CURDIR"/../shell_config.sh
+
+$CLICKHOUSE_CLIENT --query "
+    DROP TABLE IF EXISTS t_insert_sparse_columns;
+
+    CREATE TABLE t_insert_sparse_columns (a UInt64, b UInt64, c UInt64)
+    ENGINE = MergeTree ORDER BY a
+    SETTINGS ratio_of_defaults_for_sparse_serialization = 0.5, enable_block_number_column = 0, enable_block_offset_column = 0;
+
+    SYSTEM STOP MERGES t_insert_sparse_columns;
+"
+
+${CLICKHOUSE_CURL} -sS "${CLICKHOUSE_URL}&query=INSERT+INTO+t_insert_sparse_columns+FORMAT+CSV" --data-binary @- <<EOF
+1, 0, 0
+2, 0, 0
+EOF
+
+${CLICKHOUSE_CURL} -sS "${CLICKHOUSE_URL}&query=INSERT+INTO+t_insert_sparse_columns+FORMAT+CSV" --data-binary @- <<EOF 2>&1 | grep -o "Code: 27"
+3, 0
+4, 0
+EOF
+
+$CLICKHOUSE_CLIENT --query "
+    SELECT * FROM t_insert_sparse_columns;
+    SELECT column, serialization_kind FROM system.parts_columns WHERE database = currentDatabase() AND table = 't_insert_sparse_columns' AND active ORDER BY column, serialization_kind;
+    DROP TABLE IF EXISTS t_insert_sparse_columns;
+"
