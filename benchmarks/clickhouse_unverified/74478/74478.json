{
  "repo": "ClickHouse/ClickHouse",
  "pull_number": 74478,
  "instance_id": "ClickHouse__ClickHouse-74478",
  "issue_numbers": [
    "74299"
  ],
  "base_commit": "75f36f7d4c1542948e41d733f2bfedf6fe937959",
  "patch": "diff --git a/src/Interpreters/Context.cpp b/src/Interpreters/Context.cpp\nindex 12ba20e41e24..6d04eccb56b9 100644\n--- a/src/Interpreters/Context.cpp\n+++ b/src/Interpreters/Context.cpp\n@@ -1843,12 +1843,16 @@ void Context::setCurrentProfiles(const SettingsProfilesInfo & profiles_info, boo\n std::vector<UUID> Context::getCurrentProfiles() const\n {\n     SharedLockGuard lock(mutex);\n+    if (!settings_constraints_and_current_profiles)\n+        return {};\n     return settings_constraints_and_current_profiles->current_profiles;\n }\n \n std::vector<UUID> Context::getEnabledProfiles() const\n {\n     SharedLockGuard lock(mutex);\n+    if (!settings_constraints_and_current_profiles)\n+        return {};\n     return settings_constraints_and_current_profiles->enabled_profiles;\n }\n \n",
  "test_patch": "diff --git a/tests/queries/0_stateless/03312_issue_74299.reference b/tests/queries/0_stateless/03312_issue_74299.reference\nnew file mode 100644\nindex 000000000000..e69de29bb2d1\ndiff --git a/tests/queries/0_stateless/03312_issue_74299.sql b/tests/queries/0_stateless/03312_issue_74299.sql\nnew file mode 100644\nindex 000000000000..5007c0c571e3\n--- /dev/null\n+++ b/tests/queries/0_stateless/03312_issue_74299.sql\n@@ -0,0 +1,7 @@\n+DROP TABLE if exists t0;\n+\n+CREATE TABLE t0 (c0 Int) ENGINE = Memory;\n+\n+INSERT INTO TABLE t0 (c0) VALUES (currentProfiles()); -- { clientError TYPE_MISMATCH }\n+\n+DROP TABLE t0;\n\\ No newline at end of file\n",
  "problem_statement": "INSERT INTERVAL SEGV\n**Describe the bug**\r\nAlso very easy to reproduce.\r\n\r\n**How to reproduce**\r\nRun Fiddle: https://fiddle.clickhouse.com/593644e6-cba1-45bb-9909-b821a587052c\n",
  "hints_text": "Hi @PedroTadim, if this bug is still available, can I give it a try ?\n> Hi @PedroTadim, if this bug is still available, can I give it a try ?\r\n\r\nSure!",
  "created_at": "2025-01-11T09:16:56Z",
  "modified_files": [
    "src/Interpreters/Context.cpp"
  ],
  "modified_test_files": [
    "b/tests/queries/0_stateless/03312_issue_74299.sql"
  ]
}