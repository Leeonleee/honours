diff --git a/tests/queries/0_stateless/02418_do_not_return_empty_blocks_from_ConvertingAggregatedToChunksTransform.reference b/tests/queries/0_stateless/02418_do_not_return_empty_blocks_from_ConvertingAggregatedToChunksTransform.reference
new file mode 100644
index 000000000000..f2586c9c42a6
--- /dev/null
+++ b/tests/queries/0_stateless/02418_do_not_return_empty_blocks_from_ConvertingAggregatedToChunksTransform.reference
@@ -0,0 +1,6 @@
+┌─[1mnumber[0m─┐
+│     42 │
+└────────┘
+┌─[1mnumber[0m─┐
+│     42 │
+└────────┘
diff --git a/tests/queries/0_stateless/02418_do_not_return_empty_blocks_from_ConvertingAggregatedToChunksTransform.sh b/tests/queries/0_stateless/02418_do_not_return_empty_blocks_from_ConvertingAggregatedToChunksTransform.sh
new file mode 100755
index 000000000000..08c7e18e12cf
--- /dev/null
+++ b/tests/queries/0_stateless/02418_do_not_return_empty_blocks_from_ConvertingAggregatedToChunksTransform.sh
@@ -0,0 +1,30 @@
+#!/usr/bin/env bash
+set -ue
+
+unset CLICKHOUSE_LOG_COMMENT
+
+CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
+# shellcheck source=../shell_config.sh
+. "$CURDIR"/../shell_config.sh
+
+${CLICKHOUSE_CURL} \
+   $CLICKHOUSE_URL \
+   --get \
+   --data-urlencode "query=
+     select number
+     from numbers_mt(1e6)
+     where number = 42
+     group by number
+     settings max_threads = 10, max_bytes_before_external_group_by = 1, group_by_two_level_threshold = 1
+     format PrettyCompact"
+
+${CLICKHOUSE_CURL} \
+  $CLICKHOUSE_URL \
+  --get \
+  --data-urlencode "query=
+    select number
+    from numbers_mt(1e6)
+    where number = 42
+    group by number
+    settings max_threads = 10, max_bytes_before_external_group_by = 0, group_by_two_level_threshold = 1
+    format PrettyCompact"
