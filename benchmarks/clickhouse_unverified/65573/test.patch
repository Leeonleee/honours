diff --git a/tests/queries/0_stateless/03174_projection_deduplicate.reference b/tests/queries/0_stateless/03174_projection_deduplicate.reference
new file mode 100644
index 000000000000..1796b2f1dee6
--- /dev/null
+++ b/tests/queries/0_stateless/03174_projection_deduplicate.reference
@@ -0,0 +1,3 @@
+1	one
+1	one
+1	one
diff --git a/tests/queries/0_stateless/03174_projection_deduplicate.sql b/tests/queries/0_stateless/03174_projection_deduplicate.sql
new file mode 100644
index 000000000000..46222b69dc79
--- /dev/null
+++ b/tests/queries/0_stateless/03174_projection_deduplicate.sql
@@ -0,0 +1,30 @@
+-- https://github.com/ClickHouse/ClickHouse/issues/65548
+DROP TABLE IF EXISTS test_projection_deduplicate;
+
+CREATE TABLE test_projection_deduplicate
+(
+    `id` Int32,
+    `string` String,
+    PROJECTION test_projection
+    (
+        SELECT id
+        GROUP BY id
+    )
+)
+ENGINE = MergeTree
+PRIMARY KEY id;
+
+INSERT INTO test_projection_deduplicate VALUES (1, 'one');
+INSERT INTO test_projection_deduplicate VALUES (1, 'one');
+
+OPTIMIZE TABLE test_projection_deduplicate DEDUPLICATE; -- { serverError NOT_IMPLEMENTED }
+
+SELECT * FROM test_projection_deduplicate;
+
+ALTER TABLE test_projection_deduplicate DROP PROJECTION test_projection;
+
+OPTIMIZE TABLE test_projection_deduplicate DEDUPLICATE;
+
+SELECT * FROM test_projection_deduplicate;
+
+DROP TABLE test_projection_deduplicate;
