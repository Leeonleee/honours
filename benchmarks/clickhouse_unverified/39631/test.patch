diff --git a/tests/queries/0_stateless/01568_window_functions_distributed.reference b/tests/queries/0_stateless/01568_window_functions_distributed.reference
index 13ac0769a245..29ff2e7133c6 100644
--- a/tests/queries/0_stateless/01568_window_functions_distributed.reference
+++ b/tests/queries/0_stateless/01568_window_functions_distributed.reference
@@ -22,6 +22,16 @@ select sum(number) over w as x, max(number) over w as y from t_01568 window w as
 21	8
 21	8
 21	8
+select sum(number) over w, max(number) over w from t_01568 window w as (partition by p) order by p;
+3	2
+3	2
+3	2
+12	5
+12	5
+12	5
+21	8
+21	8
+21	8
 select sum(number) over w as x, max(number) over w as y from remote('127.0.0.{1,2}', '', t_01568) window w as (partition by p) order by x, y;
 6	2
 6	2
@@ -41,6 +51,25 @@ select sum(number) over w as x, max(number) over w as y from remote('127.0.0.{1,
 42	8
 42	8
 42	8
+select sum(number) over w as x, max(number) over w as y from remote('127.0.0.{1,2}', '', t_01568) window w as (partition by p) order by x, y SETTINGS max_threads = 1;
+6	2
+6	2
+6	2
+6	2
+6	2
+6	2
+24	5
+24	5
+24	5
+24	5
+24	5
+24	5
+42	8
+42	8
+42	8
+42	8
+42	8
+42	8
 select distinct sum(number) over w as x, max(number) over w as y from remote('127.0.0.{1,2}', '', t_01568) window w as (partition by p) order by x, y;
 6	2
 24	5
diff --git a/tests/queries/0_stateless/01568_window_functions_distributed.sql b/tests/queries/0_stateless/01568_window_functions_distributed.sql
index 95072d6460f1..ecce7b412ba7 100644
--- a/tests/queries/0_stateless/01568_window_functions_distributed.sql
+++ b/tests/queries/0_stateless/01568_window_functions_distributed.sql
@@ -15,8 +15,12 @@ from numbers(9);
 
 select sum(number) over w as x, max(number) over w as y from t_01568 window w as (partition by p) order by x, y;
 
+select sum(number) over w, max(number) over w from t_01568 window w as (partition by p) order by p;
+
 select sum(number) over w as x, max(number) over w as y from remote('127.0.0.{1,2}', '', t_01568) window w as (partition by p) order by x, y;
 
+select sum(number) over w as x, max(number) over w as y from remote('127.0.0.{1,2}', '', t_01568) window w as (partition by p) order by x, y SETTINGS max_threads = 1;
+
 select distinct sum(number) over w as x, max(number) over w as y from remote('127.0.0.{1,2}', '', t_01568) window w as (partition by p) order by x, y;
 
 -- window functions + aggregation w/shards
diff --git a/tests/queries/0_stateless/02884_parallel_window_functions.reference b/tests/queries/0_stateless/02884_parallel_window_functions.reference
new file mode 100644
index 000000000000..bac15838dc2a
--- /dev/null
+++ b/tests/queries/0_stateless/02884_parallel_window_functions.reference
@@ -0,0 +1,100 @@
+1
+-- { echoOn }
+
+SELECT
+    nw,
+    sum(WR) AS R,
+    sumIf(WR, uniq_rows = 1) AS UNR
+FROM
+(
+    SELECT
+        uniq(nw) OVER (PARTITION BY ac) AS uniq_rows,
+        AVG(wg) AS WR,
+        ac,
+        nw
+    FROM window_funtion_threading
+    GROUP BY ac, nw
+)
+GROUP BY nw
+ORDER BY nw ASC, R DESC
+LIMIT 10;
+0	2	0
+1	2	0
+2	2	0
+SELECT
+    nw,
+    sum(WR) AS R,
+    sumIf(WR, uniq_rows = 1) AS UNR
+FROM
+(
+    SELECT
+        uniq(nw) OVER (PARTITION BY ac) AS uniq_rows,
+        AVG(wg) AS WR,
+        ac,
+        nw
+    FROM window_funtion_threading
+    GROUP BY ac, nw
+)
+GROUP BY nw
+ORDER BY nw ASC, R DESC
+LIMIT 10
+SETTINGS max_threads = 1;
+0	2	0
+1	2	0
+2	2	0
+SELECT
+    nw,
+    sum(WR) AS R,
+    sumIf(WR, uniq_rows = 1) AS UNR
+FROM
+(
+    SELECT
+        uniq(nw) OVER (PARTITION BY ac) AS uniq_rows,
+        AVG(wg) AS WR,
+        ac,
+        nw
+    FROM window_funtion_threading
+    WHERE (ac % 4) = 0
+    GROUP BY
+        ac,
+        nw
+    UNION ALL
+    SELECT
+        uniq(nw) OVER (PARTITION BY ac) AS uniq_rows,
+        AVG(wg) AS WR,
+        ac,
+        nw
+    FROM window_funtion_threading
+    WHERE (ac % 4) = 1
+    GROUP BY
+        ac,
+        nw
+    UNION ALL
+    SELECT
+        uniq(nw) OVER (PARTITION BY ac) AS uniq_rows,
+        AVG(wg) AS WR,
+        ac,
+        nw
+    FROM window_funtion_threading
+    WHERE (ac % 4) = 2
+    GROUP BY
+        ac,
+        nw
+    UNION ALL
+    SELECT
+        uniq(nw) OVER (PARTITION BY ac) AS uniq_rows,
+        AVG(wg) AS WR,
+        ac,
+        nw
+    FROM window_funtion_threading
+    WHERE (ac % 4) = 3
+    GROUP BY
+        ac,
+        nw
+)
+GROUP BY nw
+ORDER BY nw ASC, R DESC
+LIMIT 10;
+0	2	0
+1	2	0
+2	2	0
diff --git a/tests/queries/0_stateless/02884_parallel_window_functions.sql b/tests/queries/0_stateless/02884_parallel_window_functions.sql
new file mode 100644
index 000000000000..3151b42f8960
--- /dev/null
+++ b/tests/queries/0_stateless/02884_parallel_window_functions.sql
@@ -0,0 +1,119 @@
+CREATE TABLE window_funtion_threading
+Engine = MergeTree
+ORDER BY (ac, nw)
+AS SELECT
+        toUInt64(toFloat32(number % 2) % 20000000) as ac,
+        toFloat32(1) as wg,        
+        toUInt16(toFloat32(number % 3) % 400) as nw
+FROM numbers_mt(10000000);
+
+SELECT count() FROM (EXPLAIN PIPELINE SELECT
+    nw,
+    sum(WR) AS R,
+    sumIf(WR, uniq_rows = 1) AS UNR
+FROM
+(
+    SELECT
+        uniq(nw) OVER (PARTITION BY ac) AS uniq_rows,
+        AVG(wg) AS WR,
+        ac,
+        nw
+    FROM window_funtion_threading
+    GROUP BY ac, nw
+)
+GROUP BY nw
+ORDER BY nw ASC, R DESC
+LIMIT 10) where explain ilike '%ScatterByPartitionTransform%' SETTINGS max_threads = 4;
+
+-- { echoOn }
+
+SELECT
+    nw,
+    sum(WR) AS R,
+    sumIf(WR, uniq_rows = 1) AS UNR
+FROM
+(
+    SELECT
+        uniq(nw) OVER (PARTITION BY ac) AS uniq_rows,
+        AVG(wg) AS WR,
+        ac,
+        nw
+    FROM window_funtion_threading
+    GROUP BY ac, nw
+)
+GROUP BY nw
+ORDER BY nw ASC, R DESC
+LIMIT 10;
+
+SELECT
+    nw,
+    sum(WR) AS R,
+    sumIf(WR, uniq_rows = 1) AS UNR
+FROM
+(
+    SELECT
+        uniq(nw) OVER (PARTITION BY ac) AS uniq_rows,
+        AVG(wg) AS WR,
+        ac,
+        nw
+    FROM window_funtion_threading
+    GROUP BY ac, nw
+)
+GROUP BY nw
+ORDER BY nw ASC, R DESC
+LIMIT 10
+SETTINGS max_threads = 1;
+
+SELECT
+    nw,
+    sum(WR) AS R,
+    sumIf(WR, uniq_rows = 1) AS UNR
+FROM
+(
+    SELECT
+        uniq(nw) OVER (PARTITION BY ac) AS uniq_rows,
+        AVG(wg) AS WR,
+        ac,
+        nw
+    FROM window_funtion_threading
+    WHERE (ac % 4) = 0
+    GROUP BY
+        ac,
+        nw
+    UNION ALL
+    SELECT
+        uniq(nw) OVER (PARTITION BY ac) AS uniq_rows,
+        AVG(wg) AS WR,
+        ac,
+        nw
+    FROM window_funtion_threading
+    WHERE (ac % 4) = 1
+    GROUP BY
+        ac,
+        nw
+    UNION ALL
+    SELECT
+        uniq(nw) OVER (PARTITION BY ac) AS uniq_rows,
+        AVG(wg) AS WR,
+        ac,
+        nw
+    FROM window_funtion_threading
+    WHERE (ac % 4) = 2
+    GROUP BY
+        ac,
+        nw
+    UNION ALL
+    SELECT
+        uniq(nw) OVER (PARTITION BY ac) AS uniq_rows,
+        AVG(wg) AS WR,
+        ac,
+        nw
+    FROM window_funtion_threading
+    WHERE (ac % 4) = 3
+    GROUP BY
+        ac,
+        nw
+)
+GROUP BY nw
+ORDER BY nw ASC, R DESC
+LIMIT 10;
