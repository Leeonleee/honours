You will be provided with a partial code base and an issue statement explaining a problem to resolve.

<issue>
ReplacingMergeTree depends on the order of part attachment
When attaching a partition, parts are attached in an unspecifing order. If the order of the parts is violated, ReplacingMergeTree might lose data. I have written a test to reproduce this scenario.

Reason:

To get the list of detached parts, the following function is used:
https://github.com/ClickHouse/ClickHouse/blob/master/src/Storages/MergeTree/MergeTreeData.cpp#L6446

This function uses an iterator to traverse the directory for the local disk:
```cpp
disk->iterateDirectory(detached_path)
```
This iterator is a wrapper around the standard:
```cpp
fs::directory_iterator entry
```
And its order is unspecified - The iteration order is unspecified

https://en.cppreference.com/w/cpp/filesystem/directory_iterator

Solution:
I suggest providing guaranteed order for part attachment for some engines (ReplacingMergeTree).

What do you think?
</issue>

I need you to solve the provided issue by generating a code fix that can be applied directly to the repository

Respond below:
