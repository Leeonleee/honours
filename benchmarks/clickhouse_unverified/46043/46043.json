{
  "repo": "ClickHouse/ClickHouse",
  "pull_number": 46043,
  "instance_id": "ClickHouse__ClickHouse-46043",
  "issue_numbers": [
    "4331"
  ],
  "base_commit": "496cacf25e19141891bd37042b51f1a4ebac3325",
  "patch": "diff --git a/src/Parsers/ParserCreateQuery.cpp b/src/Parsers/ParserCreateQuery.cpp\nindex 208737b5bda3..8cbfac914656 100644\n--- a/src/Parsers/ParserCreateQuery.cpp\n+++ b/src/Parsers/ParserCreateQuery.cpp\n@@ -1299,14 +1299,13 @@ bool ParserCreateViewQuery::parseImpl(Pos & pos, ASTPtr & node, Expected & expec\n             return false;\n     }\n \n-\n-    if (ParserKeyword{\"TO INNER UUID\"}.ignore(pos, expected))\n+    if (is_materialized_view && ParserKeyword{\"TO INNER UUID\"}.ignore(pos, expected))\n     {\n         ParserStringLiteral literal_p;\n         if (!literal_p.parse(pos, to_inner_uuid, expected))\n             return false;\n     }\n-    else if (ParserKeyword{\"TO\"}.ignore(pos, expected))\n+    else if (is_materialized_view && ParserKeyword{\"TO\"}.ignore(pos, expected))\n     {\n         // TO [db.]table\n         if (!table_name_p.parse(pos, to_table, expected))\n",
  "test_patch": "diff --git a/tests/queries/0_stateless/02554_invalid_create_view_syntax.reference b/tests/queries/0_stateless/02554_invalid_create_view_syntax.reference\nnew file mode 100644\nindex 000000000000..e69de29bb2d1\ndiff --git a/tests/queries/0_stateless/02554_invalid_create_view_syntax.sql b/tests/queries/0_stateless/02554_invalid_create_view_syntax.sql\nnew file mode 100644\nindex 000000000000..bf16d635312e\n--- /dev/null\n+++ b/tests/queries/0_stateless/02554_invalid_create_view_syntax.sql\n@@ -0,0 +1,1 @@\n+CREATE VIEW X TO Y AS SELECT 1; -- { clientError 62 }\n",
  "problem_statement": "Wrong / meaningless syntax [create view ... to ...] allowed\nConnected to ClickHouse server version 19.1.6\r\n\r\nCREATE VIEW X TO Y AS SELECT 1\r\n\r\nOk.\r\n0 rows in set. Elapsed: 0.002 sec.\n",
  "hints_text": "not fixed yet.",
  "created_at": "2023-02-04T12:49:05Z",
  "modified_files": [
    "src/Parsers/ParserCreateQuery.cpp"
  ],
  "modified_test_files": [
    "b/tests/queries/0_stateless/02554_invalid_create_view_syntax.sql"
  ]
}