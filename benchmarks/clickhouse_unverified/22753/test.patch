diff --git a/tests/queries/0_stateless/00826_cross_to_inner_join.reference b/tests/queries/0_stateless/00826_cross_to_inner_join.reference
index 9b630d0d3919..973c5b078a36 100644
--- a/tests/queries/0_stateless/00826_cross_to_inner_join.reference
+++ b/tests/queries/0_stateless/00826_cross_to_inner_join.reference
@@ -109,7 +109,7 @@ SELECT
     t2_00826.a,
     t2_00826.b
 FROM t1_00826
-ALL INNER JOIN t2_00826 ON (((a = t2_00826.a) AND (a = t2_00826.a)) AND (a = t2_00826.a)) AND (b = t2_00826.b)
+ALL INNER JOIN t2_00826 ON (a = t2_00826.a) AND (a = t2_00826.a) AND (a = t2_00826.a) AND (b = t2_00826.b)
 WHERE (a = t2_00826.a) AND ((a = t2_00826.a) AND ((a = t2_00826.a) AND (b = t2_00826.b)))
 --- cross split conjunction ---
 SELECT
diff --git a/tests/queries/0_stateless/00849_multiple_comma_join_2.reference b/tests/queries/0_stateless/00849_multiple_comma_join_2.reference
index 4db65b0b795e..fc39ef139359 100644
--- a/tests/queries/0_stateless/00849_multiple_comma_join_2.reference
+++ b/tests/queries/0_stateless/00849_multiple_comma_join_2.reference
@@ -127,7 +127,7 @@ FROM
     ) AS `--.s`
     CROSS JOIN t3
 ) AS `--.s`
-ALL INNER JOIN t4 ON ((a = `--t1.a`) AND (a = `--t2.a`)) AND (a = `--t3.a`)
+ALL INNER JOIN t4 ON (a = `--t1.a`) AND (a = `--t2.a`) AND (a = `--t3.a`)
 WHERE (a = `--t1.a`) AND (a = `--t2.a`) AND (a = `--t3.a`)
 SELECT `--t1.a` AS `t1.a`
 FROM 
diff --git a/tests/queries/0_stateless/00855_join_with_array_join.reference b/tests/queries/0_stateless/00855_join_with_array_join.reference
index 386bde518ea7..88f9253500c4 100644
--- a/tests/queries/0_stateless/00855_join_with_array_join.reference
+++ b/tests/queries/0_stateless/00855_join_with_array_join.reference
@@ -4,3 +4,8 @@
 4	0
 5	0
 6	0
+-
+1	0	
+2	2	a2
+1	0	
+2	2	a2
diff --git a/tests/queries/0_stateless/00855_join_with_array_join.sql b/tests/queries/0_stateless/00855_join_with_array_join.sql
index 10b03fec062a..506d94791105 100644
--- a/tests/queries/0_stateless/00855_join_with_array_join.sql
+++ b/tests/queries/0_stateless/00855_join_with_array_join.sql
@@ -1,10 +1,35 @@
 SET joined_subquery_requires_alias = 0;
 
-select ax, c from (select [1,2] ax, 0 c) array join ax join (select 0 c) using(c);
-select ax, c from (select [3,4] ax, 0 c) join (select 0 c) using(c) array join ax;
-select ax, c from (select [5,6] ax, 0 c) s1 join system.one s2 ON s1.c = s2.dummy array join ax;
-
-select ax, c from (select [7,8] ax, 0 c) s1
-join system.one s2 ON s1.c = s2.dummy
-join system.one s3 ON s1.c = s3.dummy
-array join ax; -- { serverError 48 }
+SELECT ax, c FROM (SELECT [1,2] ax, 0 c) ARRAY JOIN ax JOIN (SELECT 0 c) USING (c);
+SELECT ax, c FROM (SELECT [3,4] ax, 0 c) JOIN (SELECT 0 c) USING (c) ARRAY JOIN ax;
+SELECT ax, c FROM (SELECT [5,6] ax, 0 c) s1 JOIN system.one s2 ON s1.c = s2.dummy ARRAY JOIN ax;
+
+
+SELECT ax, c FROM (SELECT [101,102] ax, 0 c) s1
+JOIN system.one s2 ON s1.c = s2.dummy
+JOIN system.one s3 ON s1.c = s3.dummy
+ARRAY JOIN ax; -- { serverError 48 }
+
+SELECT '-';
+
+SET joined_subquery_requires_alias = 1;
+
+DROP TABLE IF EXISTS f;
+DROP TABLE IF EXISTS d;
+
+CREATE TABLE f (`d_ids` Array(Int64) ) ENGINE = TinyLog;
+INSERT INTO f VALUES ([1, 2]);
+
+CREATE TABLE d (`id` Int64, `name` String ) ENGINE = TinyLog;
+
+INSERT INTO d VALUES (2, 'a2'), (3, 'a3');
+
+SELECT d_ids, id, name FROM f LEFT ARRAY JOIN d_ids LEFT JOIN d ON d.id = d_ids ORDER BY id;
+SELECT did, id, name FROM f LEFT ARRAY JOIN d_ids as did LEFT JOIN d ON d.id = did ORDER BY id;
+
+-- name clash, doesn't work yet
+SELECT id, name FROM f LEFT ARRAY JOIN d_ids as id LEFT JOIN d ON d.id = id ORDER BY id; -- { serverError 403 }
+
+DROP TABLE IF EXISTS f;
+DROP TABLE IF EXISTS d;
+
diff --git a/tests/queries/0_stateless/00878_join_unexpected_results.reference b/tests/queries/0_stateless/00878_join_unexpected_results.reference
index 65fcbc257ca6..a389cb47a962 100644
--- a/tests/queries/0_stateless/00878_join_unexpected_results.reference
+++ b/tests/queries/0_stateless/00878_join_unexpected_results.reference
@@ -23,8 +23,6 @@ join_use_nulls = 1
 -
 \N	\N
 -
-1	1	\N	\N
-2	2	\N	\N
 -
 1	1	1	1
 2	2	\N	\N
@@ -51,8 +49,6 @@ join_use_nulls = 0
 -
 -
 -
-1	1	0	0
-2	2	0	0
 -
 1	1	1	1
 2	2	0	0
diff --git a/tests/queries/0_stateless/00878_join_unexpected_results.sql b/tests/queries/0_stateless/00878_join_unexpected_results.sql
index 6f6cd6e64792..0aef5208b26e 100644
--- a/tests/queries/0_stateless/00878_join_unexpected_results.sql
+++ b/tests/queries/0_stateless/00878_join_unexpected_results.sql
@@ -30,11 +30,11 @@ select * from t left outer join s on (t.a=s.a and t.b=s.b) where s.a is null;
 select '-';
 select s.* from t left outer join s on (t.a=s.a and t.b=s.b) where s.a is null;
 select '-';
-select t.*, s.* from t left join s on (s.a=t.a and t.b=s.b and t.a=toInt64(2)) order by t.a;
+select t.*, s.* from t left join s on (s.a=t.a and t.b=s.b and t.a=toInt64(2)) order by t.a; -- {serverError 403 }
 select '-';
 select t.*, s.* from t left join s on (s.a=t.a) order by t.a;
 select '-';
-select t.*, s.* from t left join s on (t.b=toInt64(2) and s.a=t.a) where s.b=2;
+select t.*, s.* from t left join s on (t.b=toInt64(2) and s.a=t.a) where s.b=2; -- {serverError 403 }
 
 select 'join_use_nulls = 0';
 set join_use_nulls = 0;
@@ -58,11 +58,11 @@ select '-';
 select '-';
 -- select s.* from t left outer join s on (t.a=s.a and t.b=s.b) where s.a is null; -- TODO
 select '-';
-select t.*, s.* from t left join s on (s.a=t.a and t.b=s.b and t.a=toInt64(2)) order by t.a;
+select t.*, s.* from t left join s on (s.a=t.a and t.b=s.b and t.a=toInt64(2)) order by t.a; -- {serverError 403 }
 select '-';
 select t.*, s.* from t left join s on (s.a=t.a) order by t.a;
 select '-';
-select t.*, s.* from t left join s on (t.b=toInt64(2) and s.a=t.a) where s.b=2;
+select t.*, s.* from t left join s on (t.b=toInt64(2) and s.a=t.a) where s.b=2; -- {serverError 403 }
 
 drop table t;
 drop table s;
diff --git a/tests/queries/0_stateless/01653_move_conditions_from_join_on_to_where.reference b/tests/queries/0_stateless/01653_move_conditions_from_join_on_to_where.reference
deleted file mode 100644
index 19487c9f942b..000000000000
--- a/tests/queries/0_stateless/01653_move_conditions_from_join_on_to_where.reference
+++ /dev/null
@@ -1,140 +0,0 @@
----------Q1----------
-2	2	2	20
-SELECT
-    a,
-    b,
-    table2.a,
-    table2.b
-FROM table1
-ALL INNER JOIN 
-(
-    SELECT
-        a,
-        b
-    FROM table2
-) AS table2 ON a = table2.a
-WHERE table2.b = toUInt32(20)
----------Q2----------
-2	2	2	20
-SELECT
-    a,
-    b,
-    table2.a,
-    table2.b
-FROM table1
-ALL INNER JOIN 
-(
-    SELECT
-        a,
-        b
-    FROM table2
-) AS table2 ON a = table2.a
-WHERE (table2.a < table2.b) AND (table2.b = toUInt32(20))
----------Q3----------
----------Q4----------
-6	40
-SELECT
-    a,
-    table2.b
-FROM table1
-ALL INNER JOIN 
-(
-    SELECT
-        a,
-        b
-    FROM table2
-) AS table2 ON a = toUInt32(10 - table2.a)
-WHERE (b = 6) AND (table2.b > 20)
----------Q5----------
-SELECT
-    a,
-    table2.b
-FROM table1
-ALL INNER JOIN 
-(
-    SELECT
-        a,
-        b
-    FROM table2
-    WHERE 0
-) AS table2 ON a = table2.a
-WHERE 0
----------Q6----------
----------Q7----------
-0	0	0	0
-SELECT
-    a,
-    b,
-    table2.a,
-    table2.b
-FROM table1
-ALL INNER JOIN 
-(
-    SELECT
-        a,
-        b
-    FROM table2
-) AS table2 ON a = table2.a
-WHERE (table2.b < toUInt32(40)) AND (b < 1)
----------Q8----------
----------Q9---will not be optimized----------
-SELECT
-    a,
-    b,
-    table2.a,
-    table2.b
-FROM table1
-ALL LEFT JOIN 
-(
-    SELECT
-        a,
-        b
-    FROM table2
-) AS table2 ON (a = table2.a) AND (b = toUInt32(10))
-SELECT
-    a,
-    b,
-    table2.a,
-    table2.b
-FROM table1
-ALL RIGHT JOIN 
-(
-    SELECT
-        a,
-        b
-    FROM table2
-) AS table2 ON (a = table2.a) AND (b = toUInt32(10))
-SELECT
-    a,
-    b,
-    table2.a,
-    table2.b
-FROM table1
-ALL FULL OUTER JOIN 
-(
-    SELECT
-        a,
-        b
-    FROM table2
-) AS table2 ON (a = table2.a) AND (b = toUInt32(10))
-SELECT
-    a,
-    b,
-    table2.a,
-    table2.b
-FROM table1
-ALL FULL OUTER JOIN 
-(
-    SELECT
-        a,
-        b
-    FROM table2
-) AS table2 ON (a = table2.a) AND (table2.b = toUInt32(10))
-WHERE a < toUInt32(20)
-SELECT
-    a,
-    b,
-    table2.a,
-    table2.b
-FROM table1
-CROSS JOIN table2
diff --git a/tests/queries/0_stateless/01653_move_conditions_from_join_on_to_where.sql b/tests/queries/0_stateless/01653_move_conditions_from_join_on_to_where.sql
deleted file mode 100644
index 23871a9c47c7..000000000000
--- a/tests/queries/0_stateless/01653_move_conditions_from_join_on_to_where.sql
+++ /dev/null
@@ -1,48 +0,0 @@
-DROP TABLE IF EXISTS table1;
-DROP TABLE IF EXISTS table2;
-
-CREATE TABLE table1 (a UInt32, b UInt32) ENGINE = Memory;
-CREATE TABLE table2 (a UInt32, b UInt32) ENGINE = Memory;
-
-INSERT INTO table1 SELECT number, number FROM numbers(10);
-INSERT INTO table2 SELECT number * 2, number * 20 FROM numbers(6);
-
-SELECT '---------Q1----------';
-SELECT * FROM table1 JOIN table2 ON (table1.a = table2.a) AND (table2.b = toUInt32(20));
-EXPLAIN SYNTAX SELECT * FROM table1 JOIN table2 ON (table1.a = table2.a) AND (table2.b = toUInt32(20));
-
-SELECT '---------Q2----------';
-SELECT * FROM table1 JOIN table2 ON (table1.a = table2.a) AND (table2.a < table2.b) AND (table2.b = toUInt32(20));
-EXPLAIN SYNTAX SELECT * FROM table1 JOIN table2 ON (table1.a = table2.a) AND (table2.a < table2.b) AND (table2.b = toUInt32(20));
-
-SELECT '---------Q3----------';
-SELECT * FROM table1 JOIN table2 ON (table1.a = toUInt32(table2.a + 5)) AND (table2.a < table1.b) AND (table2.b > toUInt32(20)); -- { serverError 48 }
-
-SELECT '---------Q4----------';
-SELECT table1.a, table2.b FROM table1 INNER JOIN table2 ON (table1.a = toUInt32(10 - table2.a)) AND (table1.b = 6) AND (table2.b > 20);
-EXPLAIN SYNTAX SELECT table1.a, table2.b FROM table1 INNER JOIN table2 ON (table1.a = toUInt32(10 - table2.a)) AND (table1.b = 6) AND (table2.b > 20);
-
-SELECT '---------Q5----------';
-SELECT table1.a, table2.b FROM table1 JOIN table2 ON (table1.a = table2.a) AND (table1.b = 6) AND (table2.b > 20) AND (10 < 6);
-EXPLAIN SYNTAX SELECT table1.a, table2.b FROM table1 JOIN table2 ON (table1.a = table2.a) AND (table1.b = 6) AND (table2.b > 20) AND (10 < 6);
-
-SELECT '---------Q6----------';
-SELECT table1.a, table2.b FROM table1 JOIN table2 ON (table1.b = 6) AND (table2.b > 20); -- { serverError 403 } 
-
-SELECT '---------Q7----------';
-SELECT * FROM table1 JOIN table2 ON (table1.a = table2.a) AND (table2.b < toUInt32(40)) where table1.b < 1;
-EXPLAIN SYNTAX SELECT * FROM table1 JOIN table2 ON (table1.a = table2.a) AND (table2.b < toUInt32(40)) where table1.b < 1;
-SELECT * FROM table1 JOIN table2 ON (table1.a = table2.a) AND (table2.b < toUInt32(40)) where table1.b > 10;
-
-SELECT '---------Q8----------';
-SELECT * FROM table1 INNER JOIN table2 ON (table1.a = table2.a) AND (table2.b < toUInt32(table1, 10)); -- { serverError 47 }
-
-SELECT '---------Q9---will not be optimized----------';
-EXPLAIN SYNTAX SELECT * FROM table1 LEFT JOIN table2 ON (table1.a = table2.a) AND (table1.b = toUInt32(10));
-EXPLAIN SYNTAX SELECT * FROM table1 RIGHT JOIN table2 ON (table1.a = table2.a) AND (table1.b = toUInt32(10));
-EXPLAIN SYNTAX SELECT * FROM table1 FULL JOIN table2 ON (table1.a = table2.a) AND (table1.b = toUInt32(10));
-EXPLAIN SYNTAX SELECT * FROM table1 FULL JOIN table2 ON (table1.a = table2.a) AND (table2.b = toUInt32(10)) WHERE table1.a < toUInt32(20);
-EXPLAIN SYNTAX SELECT * FROM table1 , table2;
-
-DROP TABLE table1;
-DROP TABLE table2;
