You will be provided with a partial code base and an issue statement explaining a problem to resolve.

<issue>
Improper HTTP status code on data parsing errors
ClickHouse returns 500 "Internal Server Error" on attempt to insert invalid data. Below the example:

```
# echo -e '1' | http  --verify no -v POST https://127.0.0.1:8443 query=='insert into test (f1, f2) format TSV'
POST /?query=insert+into+test+%28f1%2C+f2%29+format+TSV HTTP/1.1
Accept: application/json, */*;q=0.5
Accept-Encoding: gzip, deflate
Connection: keep-alive
Content-Length: 2
Content-Type: application/json
Host: 127.0.0.1:8443
User-Agent: HTTPie/2.1.0

1

HTTP/1.1 500 Internal Server Error
Connection: Keep-Alive
Content-Type: text/tab-separated-values; charset=UTF-8
Date: Sat, 02 May 2020 09:52:08 GMT
Keep-Alive: timeout=3
Transfer-Encoding: chunked
X-ClickHouse-Exception-Code: 27
X-ClickHouse-Format: TabSeparated
X-ClickHouse-Query-Id: 32de9567-4be9-4af2-8860-e76d12e65b2c
X-ClickHouse-Server-Display-Name: sas-72adix65lvucxtf4.db.yandex.net
X-ClickHouse-Summary: {"read_rows":"0","read_bytes":"0","written_rows":"0","written_bytes":"0","total_rows_to_read":"0"}
X-ClickHouse-Timezone: Europe/Moscow

Code: 27, e.displayText() = DB::Exception: Cannot parse input: expected '\t' before: '\n': (at row 1)

Row 1:
Column 0,   name: f1, type: String, parsed text: "1"
ERROR: Line feed found where tab is expected. It's like your file has less columns than expected.
And if your file have right number of columns, maybe it have unescaped backslash in value before tab, which cause tab has escaped.

 (version 20.4.1.3079 (official build))
```

Invalid data is a client-side error. So the code 400 or some other 4xx code is expected.
</issue>

I need you to solve the provided issue by generating a code fix that can be applied directly to the repository

Respond below:
