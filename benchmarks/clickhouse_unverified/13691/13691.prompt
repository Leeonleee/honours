You will be provided with a partial code base and an issue statement explaining a problem to resolve.

<issue>
Progress bar flicker in clickhouse-client.
When I execute the following query:

```
SELECT 
    toInt64(WatchID), 
    toInt8(JavaEnable), 
    toValidUTF8(toString(Title)), 
    toInt16(GoodEvent), 
    EventTime, 
    EventDate, 
    toInt32(CounterID), 
    toInt32(ClientIP), 
    toInt32(RegionID), 
    toInt64(UserID), 
    toInt8(CounterClass), 
    toInt8(OS), 
    toInt8(UserAgent), 
    toValidUTF8(toString(URL)), 
    toValidUTF8(toString(Referer)), 
    toInt8(Refresh), 
    toInt16(RefererCategoryID), 
    toInt32(RefererRegionID), 
    toInt16(URLCategoryID), 
    toInt32(URLRegionID), 
    toInt16(ResolutionWidth), 
    toInt16(ResolutionHeight), 
    toInt8(ResolutionDepth), 
    toInt8(FlashMajor), 
    toInt8(FlashMinor), 
    toValidUTF8(toString(FlashMinor2)), 
    toInt8(NetMajor), 
    toInt8(NetMinor), 
    toInt16(UserAgentMajor), 
    toValidUTF8(toString(UserAgentMinor)), 
    toInt8(CookieEnable), 
    toInt8(JavascriptEnable), 
    toInt8(IsMobile), 
    toInt8(MobilePhone), 
    toValidUTF8(toString(MobilePhoneModel)), 
    toValidUTF8(toString(Params)), 
    toInt32(IPNetworkID), 
    toInt8(TraficSourceID), 
    toInt16(SearchEngineID), 
    toValidUTF8(toString(SearchPhrase)), 
    toInt8(AdvEngineID), 
    toInt8(IsArtifical), 
    toInt16(WindowClientWidth), 
    toInt16(WindowClientHeight), 
    toInt16(ClientTimeZone), 
    ClientEventTime, 
    toInt8(SilverlightVersion1), 
    toInt8(SilverlightVersion2), 
    toInt32(SilverlightVersion3), 
    toInt16(SilverlightVersion4), 
    toValidUTF8(toString(PageCharset)), 
    toInt32(CodeVersion), 
    toInt8(IsLink), 
    toInt8(IsDownload), 
    toInt8(IsNotBounce), 
    toInt64(FUniqID), 
    toValidUTF8(toString(OriginalURL)), 
    toInt32(HID), 
    toInt8(IsOldCounter), 
    toInt8(IsEvent), 
    toInt8(IsParameter), 
    toInt8(DontCountHits), 
    toInt8(WithHash), 
    toValidUTF8(toString(HitColor)), 
    LocalEventTime, 
    toInt8(Age), 
    toInt8(Sex), 
    toInt8(Income), 
    toInt16(Interests), 
    toInt8(Robotness), 
    toInt32(RemoteIP), 
    toInt32(WindowName), 
    toInt32(OpenerName), 
    toInt16(HistoryLength), 
    toValidUTF8(toString(BrowserLanguage)), 
    toValidUTF8(toString(BrowserCountry)), 
    toValidUTF8(toString(SocialNetwork)), 
    toValidUTF8(toString(SocialAction)), 
    toInt16(HTTPError), 
    toInt32(SendTiming), 
    toInt32(DNSTiming), 
    toInt32(ConnectTiming), 
    toInt32(ResponseStartTiming), 
    toInt32(ResponseEndTiming), 
    toInt32(FetchTiming), 
    toInt8(SocialSourceNetworkID), 
    toValidUTF8(toString(SocialSourcePage)), 
    toInt64(ParamPrice), 
    toValidUTF8(toString(ParamOrderID)), 
    toValidUTF8(toString(ParamCurrency)), 
    toInt16(ParamCurrencyID), 
    toValidUTF8(toString(OpenstatServiceName)), 
    toValidUTF8(toString(OpenstatCampaignID)), 
    toValidUTF8(toString(OpenstatAdID)), 
    toValidUTF8(toString(OpenstatSourceID)), 
    toValidUTF8(toString(UTMSource)), 
    toValidUTF8(toString(UTMMedium)), 
    toValidUTF8(toString(UTMCampaign)), 
    toValidUTF8(toString(UTMContent)), 
    toValidUTF8(toString(UTMTerm)), 
    toValidUTF8(toString(FromTag)), 
    toInt8(HasGCLID), 
    toInt64(RefererHash), 
    toInt64(URLHash), 
    toInt32(CLID)
FROM hits_100m_obfuscated
INTO OUTFILE '/home/milovidov/example_datasets/hits_100m_obfuscated.csv'
```
JSON and JSONCompact formats produce invalid JSON objects in interactive mode of clickhouse-client
The last line in `data` section of the output is always empty. 

```
# clickhouse-client
ClickHouse client version 20.5.2.7 (official build).
Connecting to localhost:9001 as user default.
Connected to ClickHouse server version 20.5.2 revision 54435.

sas-vrxctd96rqw5lw25.db.yandex.net :) select 1 format JSON

SELECT 1
FORMAT JSON

{
	"meta":
	[
		{
			"name": "1",
			"type": "UInt8"
		}
	],

	"data":
	[
		{
			"1": 1

	],

	"rows": 1,

	"statistics":
	{
		"elapsed": 0.00019223,
		"rows_read": 1,
		"bytes_read": 1
	}
}

```

The issue appears only in interactive mode. In non-interactive mode clickhouse-client produces the correct output:

```
# clickhouse-client -q 'select 1 format JSON'
{
	"meta":
	[
		{
			"name": "1",
			"type": "UInt8"
		}
	],

	"data":
	[
		{
			"1": 1
		}
	],

	"rows": 1,

	"statistics":
	{
		"elapsed": 0.000220845,
		"rows_read": 1,
		"bytes_read": 1
	}
}
```
</issue>

I need you to solve the provided issue by generating a code fix that can be applied directly to the repository

Respond below:
