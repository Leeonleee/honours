diff --git a/tests/config/config.d/storage_conf_02961.xml b/tests/config/config.d/storage_conf_02961.xml
new file mode 100644
index 000000000000..436a5628e518
--- /dev/null
+++ b/tests/config/config.d/storage_conf_02961.xml
@@ -0,0 +1,43 @@
+<clickhouse>
+    <storage_configuration>
+        <disks>
+            <disk1_02961>
+                <type>local</type>
+                <path>disk1_02961/</path>
+            </disk1_02961>
+            <disk2_02961>
+                <type>local</type>
+                <path>disk2_02961/</path>
+            </disk2_02961>
+            <disk3_02961>
+                <type>local</type>
+                <path>disk3_02961/</path>
+            </disk3_02961>
+            <disk4_02961>
+                <type>local</type>
+                <path>disk4_02961/</path>
+            </disk4_02961>
+        </disks>
+        <policies>
+            <policy_02961>
+                <volumes>
+                    <vol1_02961>
+                        <disk>disk1_02961</disk>
+                        <volume_priority>2</volume_priority>
+                    </vol1_02961>
+                    <vol_untagged2_02961>
+                        <disk>disk2_02961</disk>
+                    </vol_untagged2_02961>
+                    <vol2_02961>
+                        <disk>disk3_02961</disk>
+                        <volume_priority>1</volume_priority>
+                    </vol2_02961>
+                    <vol_untagged1_02961>
+                        <disk>disk4_02961</disk>
+                    </vol_untagged1_02961>
+                </volumes>
+                <move_factor>0.2</move_factor>
+            </policy_02961>
+        </policies>
+    </storage_configuration>
+</clickhouse>
diff --git a/tests/config/install.sh b/tests/config/install.sh
index 9d55529c1f3b..cac4e626594a 100755
--- a/tests/config/install.sh
+++ b/tests/config/install.sh
@@ -185,6 +185,7 @@ if [[ -n "$EXPORT_S3_STORAGE_POLICIES" ]]; then
     ln -sf $SRC_PATH/config.d/storage_conf.xml $DEST_SERVER_PATH/config.d/
     ln -sf $SRC_PATH/config.d/storage_conf_02944.xml $DEST_SERVER_PATH/config.d/
     ln -sf $SRC_PATH/config.d/storage_conf_02963.xml $DEST_SERVER_PATH/config.d/
+    ln -sf $SRC_PATH/config.d/storage_conf_02961.xml $DEST_SERVER_PATH/config.d/
     ln -sf $SRC_PATH/users.d/s3_cache.xml $DEST_SERVER_PATH/users.d/
     ln -sf $SRC_PATH/users.d/s3_cache_new.xml $DEST_SERVER_PATH/users.d/
 fi
diff --git a/tests/queries/0_stateless/02961_storage_config_volume_priority.reference b/tests/queries/0_stateless/02961_storage_config_volume_priority.reference
new file mode 100644
index 000000000000..ba48e75ae259
--- /dev/null
+++ b/tests/queries/0_stateless/02961_storage_config_volume_priority.reference
@@ -0,0 +1,9 @@
+vol2_02961	1
+vol1_02961	2
+vol_untagged2_02961	3
+vol_untagged1_02961	4
+check non-unique values dont work
+1
+check no gaps in range allowed
+1
+restore valid config
diff --git a/tests/queries/0_stateless/02961_storage_config_volume_priority.sh b/tests/queries/0_stateless/02961_storage_config_volume_priority.sh
new file mode 100755
index 000000000000..4e085541a8d8
--- /dev/null
+++ b/tests/queries/0_stateless/02961_storage_config_volume_priority.sh
@@ -0,0 +1,51 @@
+#!/usr/bin/env bash
+# Tags: no-fasttest, no-parallel, no-random-settings
+
+CUR_DIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
+# shellcheck source=../shell_config.sh
+. "$CUR_DIR"/../shell_config.sh
+
+
+$CLICKHOUSE_CLIENT --query "
+SELECT
+    volume_name,
+    volume_priority
+FROM system.storage_policies
+WHERE policy_name = 'policy_02961'
+ORDER BY volume_priority ASC;
+"
+
+config_path=/etc/clickhouse-server/config.d/storage_conf_02961.xml
+config_path_tmp=$config_path.tmp
+
+echo 'check non-unique values dont work'
+cat $config_path \
+| sed "s|<volume_priority>2<\/volume_priority>|<volume_priority>1<\/volume_priority>|" \
+> $config_path_tmp
+mv $config_path_tmp $config_path
+
+$CLICKHOUSE_CLIENT -nm --query "
+set send_logs_level='error';
+SYSTEM RELOAD CONFIG" 2>&1 | grep -c 'volume_priority values must be unique across the policy'
+
+#first, restore original values
+cat $config_path \
+| sed '0,/<volume_priority>1<\/volume_priority>/s//<volume_priority>2<\/volume_priority>/' \
+> $config_path_tmp
+mv $config_path_tmp $config_path
+
+echo 'check no gaps in range allowed'
+cat $config_path \
+| sed '0,/<volume_priority>1<\/volume_priority>/s//<volume_priority>3<\/volume_priority>/' \
+> $config_path_tmp
+mv $config_path_tmp $config_path
+
+$CLICKHOUSE_CLIENT -nm --query "
+set send_logs_level='error';
+SYSTEM RELOAD CONFIG" 2>&1 | grep -c 'volume_priority values must cover the range from 1 to N (lowest priority specified) without gaps'
+
+echo 'restore valid config'
+cat $config_path \
+| sed '0,/<volume_priority>3<\/volume_priority>/s//<volume_priority>1<\/volume_priority>/' \
+> $config_path_tmp
+mv $config_path_tmp $config_path
