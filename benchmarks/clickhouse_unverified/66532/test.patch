diff --git a/tests/docker_scripts/stateless_runner.sh b/tests/docker_scripts/stateless_runner.sh
index 1677092c6c6a..e9b32c905e07 100755
--- a/tests/docker_scripts/stateless_runner.sh
+++ b/tests/docker_scripts/stateless_runner.sh
@@ -351,7 +351,7 @@ logs_saver_client_options="--max_block_size 8192 --max_memory_usage 10G --max_th
 
 # Try to get logs while server is running
 failed_to_save_logs=0
-for table in query_log zookeeper_log trace_log transactions_info_log metric_log blob_storage_log error_log
+for table in query_log zookeeper_log trace_log transactions_info_log metric_log blob_storage_log error_log query_metric_log
 do
     if ! clickhouse-client ${logs_saver_client_options} -q "select * from system.$table into outfile '/test_output/$table.tsv.zst' format TSVWithNamesAndTypes"; then
         failed_to_save_logs=1
@@ -418,7 +418,7 @@ if [ $failed_to_save_logs -ne 0 ]; then
     #   directly
     # - even though ci auto-compress some files (but not *.tsv) it does this only
     #   for files >64MB, we want this files to be compressed explicitly
-    for table in query_log zookeeper_log trace_log transactions_info_log metric_log blob_storage_log error_log
+    for table in query_log zookeeper_log trace_log transactions_info_log metric_log blob_storage_log error_log query_metric_log
     do
         clickhouse-local ${logs_saver_client_options} "$data_path_config" --only-system-tables --stacktrace -q "select * from system.$table format TSVWithNamesAndTypes" | zstd --threads=0 > /test_output/$table.tsv.zst ||:
 
diff --git a/tests/integration/test_MemoryTracking/configs/no_system_log.xml b/tests/integration/test_MemoryTracking/configs/no_system_log.xml
index 7d80c7fbf78b..739734bd3df6 100644
--- a/tests/integration/test_MemoryTracking/configs/no_system_log.xml
+++ b/tests/integration/test_MemoryTracking/configs/no_system_log.xml
@@ -3,6 +3,7 @@
 
     <query_thread_log remove="remove"/>
     <query_log remove="remove" />
+    <query_metric_log remove="remove" />
     <query_views_log remove="remove" />
     <metric_log remove="remove"/>
     <error_log remove="remove"/>
diff --git a/tests/integration/test_backup_restore_new/test.py b/tests/integration/test_backup_restore_new/test.py
index eca425b5dcc3..a7a22be1cf8d 100644
--- a/tests/integration/test_backup_restore_new/test.py
+++ b/tests/integration/test_backup_restore_new/test.py
@@ -1502,6 +1502,7 @@ def test_backup_all(exclude_system_log_tables):
         # See the list of log tables in src/Interpreters/SystemLog.cpp
         log_tables = [
             "query_log",
+            "query_metric_log",
             "query_thread_log",
             "part_log",
             "trace_log",
diff --git a/tests/integration/test_config_xml_full/configs/config.d/query_metric_log.xml b/tests/integration/test_config_xml_full/configs/config.d/query_metric_log.xml
new file mode 100644
index 000000000000..0d3ba22fdddb
--- /dev/null
+++ b/tests/integration/test_config_xml_full/configs/config.d/query_metric_log.xml
@@ -0,0 +1,8 @@
+<clickhouse>
+    <query_metric_log>
+        <database>system</database>
+        <table>query_metric_log</table>
+        <flush_interval_milliseconds>7500</flush_interval_milliseconds>
+        <collect_interval_milliseconds>1000</collect_interval_milliseconds>
+    </query_metric_log>
+</clickhouse>
diff --git a/tests/integration/test_config_xml_full/configs/config.xml b/tests/integration/test_config_xml_full/configs/config.xml
index 61aa0a5c7245..80b6a702032e 100644
--- a/tests/integration/test_config_xml_full/configs/config.xml
+++ b/tests/integration/test_config_xml_full/configs/config.xml
@@ -748,22 +748,6 @@
     </text_log>
     -->
 
-    <!-- Metric log contains rows with current values of ProfileEvents, CurrentMetrics collected with "collect_interval_milliseconds" interval. -->
-    <metric_log>
-        <database>system</database>
-        <table>metric_log</table>
-        <flush_interval_milliseconds>7500</flush_interval_milliseconds>
-        <collect_interval_milliseconds>1000</collect_interval_milliseconds>
-    </metric_log>
-
-    <!-- Error log contains rows with current values of errors collected with "collect_interval_milliseconds" interval. -->
-    <error_log>
-        <database>system</database>
-        <table>error_log</table>
-        <flush_interval_milliseconds>7500</flush_interval_milliseconds>
-        <collect_interval_milliseconds>1000</collect_interval_milliseconds>
-    </error_log>
-
     <!--
         Asynchronous metric log contains values of metrics from
         system.asynchronous_metrics.
diff --git a/tests/integration/test_config_xml_full/test.py b/tests/integration/test_config_xml_full/test.py
index 8513792f3b3f..036a6ca02ada 100644
--- a/tests/integration/test_config_xml_full/test.py
+++ b/tests/integration/test_config_xml_full/test.py
@@ -19,6 +19,7 @@ def test_xml_full_conf():
         "configs/config.d/part_log.xml",
         "configs/config.d/path.xml",
         "configs/config.d/query_masking_rules.xml",
+        "configs/config.d/query_metric_log.xml",
         "configs/config.d/tcp_with_proxy.xml",
         "configs/config.d/text_log.xml",
         "configs/config.d/zookeeper.xml",
diff --git a/tests/integration/test_config_xml_main/configs/config.d/error_log.yaml b/tests/integration/test_config_xml_main/configs/config.d/error_log.yaml
index f115989d203e..0ba80776dda2 100644
--- a/tests/integration/test_config_xml_main/configs/config.d/error_log.yaml
+++ b/tests/integration/test_config_xml_main/configs/config.d/error_log.yaml
@@ -1,6 +1,6 @@
 error_log:
   database: system
-  table: error_log 
+  table: error_log
   flush_interval_milliseconds: 7500
   collect_interval_milliseconds: 1000
 
diff --git a/tests/integration/test_config_xml_main/configs/config.d/query_metric_log.yaml b/tests/integration/test_config_xml_main/configs/config.d/query_metric_log.yaml
new file mode 100644
index 000000000000..0f6fae95dc32
--- /dev/null
+++ b/tests/integration/test_config_xml_main/configs/config.d/query_metric_log.yaml
@@ -0,0 +1,6 @@
+query_metric_log:
+  database: system
+  table: query_metric_log
+  flush_interval_milliseconds: 7500
+  collect_interval_milliseconds: 1000
+
diff --git a/tests/integration/test_config_xml_main/configs/config.xml b/tests/integration/test_config_xml_main/configs/config.xml
index 54fc590fc245..7f951e449028 100644
--- a/tests/integration/test_config_xml_main/configs/config.xml
+++ b/tests/integration/test_config_xml_main/configs/config.xml
@@ -26,7 +26,7 @@
         <verbose_logs>false</verbose_logs>
     </grpc>
     <openSSL>
-        <server> 
+        <server>
             <certificateFile>/etc/clickhouse-server/server.crt</certificateFile>
             <privateKeyFile>/etc/clickhouse-server/server.key</privateKeyFile>
             <dhParamsFile>/etc/clickhouse-server/dhparam.pem</dhParamsFile>
@@ -101,9 +101,9 @@
     <query_log>
         <database>system</database>
         <table>query_log</table>
-        
+
         <partition_by>toYYYYMM(event_date)</partition_by>
-        
+
         <flush_interval_milliseconds>7500</flush_interval_milliseconds>
     </query_log>
 
@@ -122,20 +122,6 @@
         <flush_interval_milliseconds>7500</flush_interval_milliseconds>
     </query_thread_log>
 
-    <metric_log>
-        <database>system</database>
-        <table>metric_log</table>
-        <flush_interval_milliseconds>7500</flush_interval_milliseconds>
-        <collect_interval_milliseconds>1000</collect_interval_milliseconds>
-    </metric_log>
-
-    <error_log>
-        <database>system</database>
-        <table>error_log</table>
-        <flush_interval_milliseconds>7500</flush_interval_milliseconds>
-        <collect_interval_milliseconds>1000</collect_interval_milliseconds>
-    </error_log>
-
     <asynchronous_metric_log>
         <database>system</database>
         <table>asynchronous_metric_log</table>
diff --git a/tests/integration/test_config_xml_main/test.py b/tests/integration/test_config_xml_main/test.py
index 4d74edfa01e3..c3ccd0eb556b 100644
--- a/tests/integration/test_config_xml_main/test.py
+++ b/tests/integration/test_config_xml_main/test.py
@@ -19,6 +19,7 @@ def test_xml_main_conf():
         "configs/config.d/part_log.yaml",
         "configs/config.d/path.yaml",
         "configs/config.d/query_masking_rules.yaml",
+        "configs/config.d/query_metric_log.yaml",
         "configs/config.d/tcp_with_proxy.yaml",
         "configs/config.d/test_cluster_with_incorrect_pw.yaml",
         "configs/config.d/text_log.yaml",
diff --git a/tests/integration/test_config_xml_yaml_mix/configs/config.d/query_metric_log.xml b/tests/integration/test_config_xml_yaml_mix/configs/config.d/query_metric_log.xml
new file mode 100644
index 000000000000..0d3ba22fdddb
--- /dev/null
+++ b/tests/integration/test_config_xml_yaml_mix/configs/config.d/query_metric_log.xml
@@ -0,0 +1,8 @@
+<clickhouse>
+    <query_metric_log>
+        <database>system</database>
+        <table>query_metric_log</table>
+        <flush_interval_milliseconds>7500</flush_interval_milliseconds>
+        <collect_interval_milliseconds>1000</collect_interval_milliseconds>
+    </query_metric_log>
+</clickhouse>
diff --git a/tests/integration/test_config_xml_yaml_mix/configs/config.xml b/tests/integration/test_config_xml_yaml_mix/configs/config.xml
index 13e51581ba4d..f1e5137ac001 100644
--- a/tests/integration/test_config_xml_yaml_mix/configs/config.xml
+++ b/tests/integration/test_config_xml_yaml_mix/configs/config.xml
@@ -26,7 +26,7 @@
         <verbose_logs>false</verbose_logs>
     </grpc>
     <openSSL>
-        <server> 
+        <server>
             <certificateFile>/etc/clickhouse-server/server.crt</certificateFile>
             <privateKeyFile>/etc/clickhouse-server/server.key</privateKeyFile>
             <dhParamsFile>/etc/clickhouse-server/dhparam.pem</dhParamsFile>
@@ -101,9 +101,9 @@
     <query_log>
         <database>system</database>
         <table>query_log</table>
-        
+
         <partition_by>toYYYYMM(event_date)</partition_by>
-        
+
         <flush_interval_milliseconds>7500</flush_interval_milliseconds>
     </query_log>
 
@@ -122,20 +122,6 @@
         <flush_interval_milliseconds>7500</flush_interval_milliseconds>
     </query_thread_log>
 
-    <metric_log>
-        <database>system</database>
-        <table>metric_log</table>
-        <flush_interval_milliseconds>7500</flush_interval_milliseconds>
-        <collect_interval_milliseconds>1000</collect_interval_milliseconds>
-    </metric_log>
-
-    <error_log>
-        <database>system</database>
-        <table>error_log</table>
-        <flush_interval_milliseconds>7500</flush_interval_milliseconds>
-        <collect_interval_milliseconds>1000</collect_interval_milliseconds>
-    </error_log>
-
     <asynchronous_metric_log>
         <database>system</database>
         <table>asynchronous_metric_log</table>
diff --git a/tests/integration/test_config_xml_yaml_mix/test.py b/tests/integration/test_config_xml_yaml_mix/test.py
index df1eaa9ded7c..ecfabc01f5c7 100644
--- a/tests/integration/test_config_xml_yaml_mix/test.py
+++ b/tests/integration/test_config_xml_yaml_mix/test.py
@@ -21,6 +21,7 @@ def test_extra_yaml_mix():
         "configs/config.d/part_log.xml",
         "configs/config.d/path.yaml",
         "configs/config.d/query_masking_rules.xml",
+        "configs/config.d/query_metric_log.xml",
         "configs/config.d/tcp_with_proxy.yaml",
         "configs/config.d/test_cluster_with_incorrect_pw.xml",
         "configs/config.d/text_log.yaml",
diff --git a/tests/integration/test_config_yaml_full/configs/config.d/query_metric_log.yaml b/tests/integration/test_config_yaml_full/configs/config.d/query_metric_log.yaml
new file mode 100644
index 000000000000..0f6fae95dc32
--- /dev/null
+++ b/tests/integration/test_config_yaml_full/configs/config.d/query_metric_log.yaml
@@ -0,0 +1,6 @@
+query_metric_log:
+  database: system
+  table: query_metric_log
+  flush_interval_milliseconds: 7500
+  collect_interval_milliseconds: 1000
+
diff --git a/tests/integration/test_config_yaml_full/configs/config.yaml b/tests/integration/test_config_yaml_full/configs/config.yaml
index 3bc8ccdf6019..894f1a374676 100644
--- a/tests/integration/test_config_yaml_full/configs/config.yaml
+++ b/tests/integration/test_config_yaml_full/configs/config.yaml
@@ -85,16 +85,6 @@ query_thread_log:
   table: query_thread_log
   partition_by: toYYYYMM(event_date)
   flush_interval_milliseconds: 7500
-metric_log:
-  database: system
-  table: metric_log
-  flush_interval_milliseconds: 7500
-  collect_interval_milliseconds: 1000
-error_log:
-  database: system
-  table: error_log
-  flush_interval_milliseconds: 7500
-  collect_interval_milliseconds: 1000
 asynchronous_metric_log:
   database: system
   table: asynchronous_metric_log
diff --git a/tests/integration/test_config_yaml_full/test.py b/tests/integration/test_config_yaml_full/test.py
index 986199fd2284..2bc7be3f2eab 100644
--- a/tests/integration/test_config_yaml_full/test.py
+++ b/tests/integration/test_config_yaml_full/test.py
@@ -20,6 +20,7 @@ def test_yaml_full_conf():
         "configs/config.d/part_log.yaml",
         "configs/config.d/path.yaml",
         "configs/config.d/query_masking_rules.yaml",
+        "configs/config.d/query_metric_log.yaml",
         "configs/config.d/tcp_with_proxy.yaml",
         "configs/config.d/test_cluster_with_incorrect_pw.yaml",
         "configs/config.d/text_log.yaml",
diff --git a/tests/integration/test_config_yaml_main/configs/config.d/query_metric_log.xml b/tests/integration/test_config_yaml_main/configs/config.d/query_metric_log.xml
new file mode 100644
index 000000000000..0d3ba22fdddb
--- /dev/null
+++ b/tests/integration/test_config_yaml_main/configs/config.d/query_metric_log.xml
@@ -0,0 +1,8 @@
+<clickhouse>
+    <query_metric_log>
+        <database>system</database>
+        <table>query_metric_log</table>
+        <flush_interval_milliseconds>7500</flush_interval_milliseconds>
+        <collect_interval_milliseconds>1000</collect_interval_milliseconds>
+    </query_metric_log>
+</clickhouse>
diff --git a/tests/integration/test_config_yaml_main/configs/config.yaml b/tests/integration/test_config_yaml_main/configs/config.yaml
index 6e62b13a0eeb..e8483f95bb0e 100644
--- a/tests/integration/test_config_yaml_main/configs/config.yaml
+++ b/tests/integration/test_config_yaml_main/configs/config.yaml
@@ -85,16 +85,6 @@ query_thread_log:
   table: query_thread_log
   partition_by: toYYYYMM(event_date)
   flush_interval_milliseconds: 7500
-metric_log:
-  database: system
-  table: metric_log
-  flush_interval_milliseconds: 7500
-  collect_interval_milliseconds: 1000
-error_log:
-  database: system
-  table: error_log
-  flush_interval_milliseconds: 7500
-  collect_interval_milliseconds: 1000
 asynchronous_metric_log:
   database: system
   table: asynchronous_metric_log
diff --git a/tests/integration/test_config_yaml_main/test.py b/tests/integration/test_config_yaml_main/test.py
index fb1d62b8cc78..1ee6c3298620 100644
--- a/tests/integration/test_config_yaml_main/test.py
+++ b/tests/integration/test_config_yaml_main/test.py
@@ -20,6 +20,7 @@ def test_yaml_main_conf():
         "configs/config.d/part_log.xml",
         "configs/config.d/path.xml",
         "configs/config.d/query_masking_rules.xml",
+        "configs/config.d/query_metric_log.xml",
         "configs/config.d/tcp_with_proxy.xml",
         "configs/config.d/test_cluster_with_incorrect_pw.xml",
         "configs/config.d/text_log.xml",
diff --git a/tests/integration/test_input_format_parallel_parsing_memory_tracking/configs/conf.xml b/tests/integration/test_input_format_parallel_parsing_memory_tracking/configs/conf.xml
index 4dceb11e2cdf..76ecddfe5d91 100644
--- a/tests/integration/test_input_format_parallel_parsing_memory_tracking/configs/conf.xml
+++ b/tests/integration/test_input_format_parallel_parsing_memory_tracking/configs/conf.xml
@@ -4,6 +4,7 @@
 
     <query_thread_log remove="remove"/>
     <query_log remove="remove" />
+    <query_metric_log remove="remove" />
     <query_views_log remove="remove" />
     <metric_log remove="remove"/>
     <error_log remove="remove"/>
diff --git a/tests/integration/test_memory_limit/configs/async_metrics_no.xml b/tests/integration/test_memory_limit/configs/async_metrics_no.xml
index 96cae3bf387b..15ebbe9e0bd1 100644
--- a/tests/integration/test_memory_limit/configs/async_metrics_no.xml
+++ b/tests/integration/test_memory_limit/configs/async_metrics_no.xml
@@ -5,6 +5,7 @@
 
     <query_thread_log remove="remove"/>
     <query_log remove="remove" />
+    <query_metric_log remove="remove" />
     <query_views_log remove="remove" />
     <metric_log remove="remove"/>
     <error_log remove="remove"/>
diff --git a/tests/integration/test_system_flush_logs/test.py b/tests/integration/test_system_flush_logs/test.py
index 8519a1e94e90..b99081283ff7 100644
--- a/tests/integration/test_system_flush_logs/test.py
+++ b/tests/integration/test_system_flush_logs/test.py
@@ -27,6 +27,7 @@ def test_system_logs_exists():
     system_logs = [
         ("system.text_log", 1),
         ("system.query_log", 1),
+        ("system.query_metric_log", 1),
         ("system.query_thread_log", 1),
         ("system.part_log", 1),
         ("system.trace_log", 1),
diff --git a/tests/integration/test_system_logs_recreate/test.py b/tests/integration/test_system_logs_recreate/test.py
index cb68028b42e9..cdc29ca108d4 100644
--- a/tests/integration/test_system_logs_recreate/test.py
+++ b/tests/integration/test_system_logs_recreate/test.py
@@ -27,6 +27,7 @@ def test_system_logs_recreate():
     system_logs = [
         # enabled by default
         "query_log",
+        "query_metric_log",
         "query_thread_log",
         "part_log",
         "trace_log",
diff --git a/tests/queries/0_stateless/03203_system_query_metric_log.reference b/tests/queries/0_stateless/03203_system_query_metric_log.reference
new file mode 100644
index 000000000000..d761659fce24
--- /dev/null
+++ b/tests/queries/0_stateless/03203_system_query_metric_log.reference
@@ -0,0 +1,12 @@
+number_of_metrics_1000_ok	timestamp_diff_in_metrics_1000_ok
+initial_data_1000_ok
+data_1000_ok
+number_of_metrics_1234_ok	timestamp_diff_in_metrics_1234_ok
+initial_data_1234_ok
+data_1234_ok
+number_of_metrics_123_ok	timestamp_diff_in_metrics_123_ok
+initial_data_123_ok
+data_123_ok
+0
+0
+3
diff --git a/tests/queries/0_stateless/03203_system_query_metric_log.sh b/tests/queries/0_stateless/03203_system_query_metric_log.sh
new file mode 100755
index 000000000000..1c189c6ce419
--- /dev/null
+++ b/tests/queries/0_stateless/03203_system_query_metric_log.sh
@@ -0,0 +1,81 @@
+#!/bin/bash
+
+CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
+# shellcheck source=../shell_config.sh
+. "$CURDIR"/../shell_config.sh
+
+readonly query_prefix=$CLICKHOUSE_DATABASE
+
+$CLICKHOUSE_CLIENT --query-id="${query_prefix}_1000" -q "SELECT sleep(2.5) FORMAT Null" &
+$CLICKHOUSE_CLIENT --query-id="${query_prefix}_1234" -q "SELECT sleep(2.5) SETTINGS query_metric_log_interval=1234 FORMAT Null" &
+$CLICKHOUSE_CLIENT --query-id="${query_prefix}_123" -q "SELECT sleep(2.5) SETTINGS query_metric_log_interval=123 FORMAT Null" &
+$CLICKHOUSE_CLIENT --query-id="${query_prefix}_0" -q "SELECT sleep(2.5) SETTINGS query_metric_log_interval=0 FORMAT Null" &
+$CLICKHOUSE_CLIENT --query-id="${query_prefix}_fast" -q "SELECT sleep(0.1) FORMAT Null" &
+
+wait
+
+$CLICKHOUSE_CLIENT -q "SYSTEM FLUSH LOGS"
+
+function check_log()
+{
+    interval=$1
+
+    # We calculate the diff of each row with its previous row to check whether the intervals at
+    # which data is collected is right. The first row is always skipped because the diff with the
+    # preceding one (itself) is 0. The last row is also skipped, because it doesn't contain a full
+    # interval.
+    $CLICKHOUSE_CLIENT --max_threads=1 -m -q """
+    WITH diff AS (
+        SELECT
+            row_number() OVER () AS row,
+            count() OVER () as total_rows,
+            event_time_microseconds,
+            first_value(event_time_microseconds) OVER (ORDER BY event_time_microseconds ROWS BETWEEN 1 PRECEDING AND 0 FOLLOWING) as prev,
+            dateDiff('ms', prev, event_time_microseconds) AS diff
+        FROM system.query_metric_log
+        WHERE event_date >= yesterday() AND query_id = '${query_prefix}_${interval}'
+        ORDER BY event_time_microseconds
+        OFFSET 1
+    )
+    SELECT if(count() BETWEEN ((ceil(2500 / $interval) - 2) * 0.8) AND ((ceil(2500 / $interval) - 2) * 1.2), 'number_of_metrics_${interval}_ok', 'number_of_metrics_${interval}_error'),
+           if(avg(diff) BETWEEN $interval * 0.8 AND $interval * 1.2, 'timestamp_diff_in_metrics_${interval}_ok', 'timestamp_diff_in_metrics_${interval}_error')
+    FROM diff WHERE row < total_rows
+    """
+
+    # Check that the first event contains information from the beginning of the query.
+    # Notice the rest of the events won't contain these because the diff will be 0.
+    $CLICKHOUSE_CLIENT -m -q """
+        SELECT if(ProfileEvent_Query = 1 AND ProfileEvent_SelectQuery = 1 AND ProfileEvent_InitialQuery = 1, 'initial_data_${interval}_ok', 'initial_data_${interval}_error')
+        FROM system.query_metric_log
+        WHERE event_date >= yesterday() AND query_id = '${query_prefix}_${interval}'
+        ORDER BY event_time_microseconds
+        LIMIT 1
+    """
+
+    # Also check that it contains some data that we know it's going to be there.
+    # Notice the Sleep events can be in any of the rows, not only in the first one.
+    $CLICKHOUSE_CLIENT -m -q """
+        SELECT if(sum(ProfileEvent_SleepFunctionCalls) = 1 AND
+                  sum(ProfileEvent_SleepFunctionMicroseconds) = 2500000 AND
+                  sum(ProfileEvent_SleepFunctionElapsedMicroseconds) = 2500000 AND
+                  sum(ProfileEvent_Query) = 1 AND
+                  sum(ProfileEvent_SelectQuery) = 1 AND
+                  sum(ProfileEvent_InitialQuery) = 1,
+                  'data_${interval}_ok', 'data_${interval}_error')
+        FROM system.query_metric_log
+        WHERE event_date >= yesterday() AND query_id = '${query_prefix}_${interval}'
+    """
+}
+
+check_log 1000
+check_log 1234
+check_log 123
+
+# query_metric_log_interval=0 disables the collection altogether
+$CLICKHOUSE_CLIENT -m -q """SELECT count() FROM system.query_metric_log WHERE event_date >= yesterday() AND query_id = '${query_prefix}_0'"""
+
+# a quick query that takes less than query_metric_log_interval is never collected
+$CLICKHOUSE_CLIENT -m -q """SELECT count() FROM system.query_metric_log WHERE event_date >= yesterday() AND query_id = '${query_prefix}_fast'"""
+
+# a query that takes more than query_metric_log_interval is collected including the final row
+$CLICKHOUSE_CLIENT -m -q """SELECT count() FROM system.query_metric_log WHERE event_date >= yesterday() AND query_id = '${query_prefix}_1000'"""
