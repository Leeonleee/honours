diff --git a/tests/queries/0_stateless/02346_additional_filters.reference b/tests/queries/0_stateless/02346_additional_filters.reference
index 22d53173e717..0a08995223d6 100644
--- a/tests/queries/0_stateless/02346_additional_filters.reference
+++ b/tests/queries/0_stateless/02346_additional_filters.reference
@@ -60,6 +60,14 @@ select * from remote('127.0.0.{1,2}', system.one) settings additional_table_filt
 0
 0
 select * from remote('127.0.0.{1,2}', system.one) settings additional_table_filters={'system.one' : 'dummy != 0'};
+select * from distr_table settings additional_table_filters={'distr_table' : 'x = 2'};
+2	bb
+2	bb
+select * from distr_table settings additional_table_filters={'distr_table' : 'x != 2 and x != 3'};
+1	a
+4	dddd
+1	a
+4	dddd
 select * from system.numbers limit 5;
 0
 1
diff --git a/tests/queries/0_stateless/02346_additional_filters.sql b/tests/queries/0_stateless/02346_additional_filters.sql
index 9e0bee4549ba..f6b665713ec8 100644
--- a/tests/queries/0_stateless/02346_additional_filters.sql
+++ b/tests/queries/0_stateless/02346_additional_filters.sql
@@ -1,3 +1,4 @@
+-- Tags: distributed
 drop table if exists table_1;
 drop table if exists table_2;
 drop table if exists v_numbers;
@@ -6,6 +7,8 @@ drop table if exists mv_table;
 create table table_1 (x UInt32, y String) engine = MergeTree order by x;
 insert into table_1 values (1, 'a'), (2, 'bb'), (3, 'ccc'), (4, 'dddd');
 
+CREATE TABLE distr_table (x UInt32, y String) ENGINE = Distributed(test_cluster_two_shards, currentDatabase(), 'table_1');
+
 -- { echoOn }
 
 select * from table_1;
@@ -29,6 +32,9 @@ select x from table_1 prewhere x != 2 where x != 2 settings additional_table_fil
 select * from remote('127.0.0.{1,2}', system.one) settings additional_table_filters={'system.one' : 'dummy = 0'};
 select * from remote('127.0.0.{1,2}', system.one) settings additional_table_filters={'system.one' : 'dummy != 0'};
 
+select * from distr_table settings additional_table_filters={'distr_table' : 'x = 2'};
+select * from distr_table settings additional_table_filters={'distr_table' : 'x != 2 and x != 3'};
+
 select * from system.numbers limit 5;
 select * from system.numbers as t limit 5 settings additional_table_filters={'t' : 'number % 2 != 0'};
 select * from system.numbers limit 5 settings additional_table_filters={'system.numbers' : 'number != 3'};
diff --git a/tests/queries/0_stateless/02346_additional_filters_distr.reference b/tests/queries/0_stateless/02346_additional_filters_distr.reference
new file mode 100644
index 000000000000..81814b5e7bb4
--- /dev/null
+++ b/tests/queries/0_stateless/02346_additional_filters_distr.reference
@@ -0,0 +1,3 @@
+4	dddd
+5	a
+6	bb
diff --git a/tests/queries/0_stateless/02346_additional_filters_distr.sql b/tests/queries/0_stateless/02346_additional_filters_distr.sql
new file mode 100644
index 000000000000..bc9c1715c72f
--- /dev/null
+++ b/tests/queries/0_stateless/02346_additional_filters_distr.sql
@@ -0,0 +1,20 @@
+-- Tags: no-parallel, distributed
+
+create database if not exists shard_0;
+create database if not exists shard_1;
+
+drop table if exists dist_02346;
+drop table if exists shard_0.data_02346;
+drop table if exists shard_1.data_02346;
+
+create table shard_0.data_02346 (x UInt32, y String) engine = MergeTree order by x settings index_granularity = 2;
+insert into shard_0.data_02346 values (1, 'a'), (2, 'bb'), (3, 'ccc'), (4, 'dddd');
+
+create table shard_1.data_02346 (x UInt32, y String) engine = MergeTree order by x settings index_granularity = 2;
+insert into shard_1.data_02346 values (5, 'a'), (6, 'bb'), (7, 'ccc'), (8, 'dddd');
+
+create table dist_02346 (x UInt32, y String) engine=Distributed('test_cluster_two_shards_different_databases', /* default_database= */ '', data_02346);
+
+set max_rows_to_read=4;
+
+select * from dist_02346 order by x settings additional_table_filters={'dist_02346' : 'x > 3 and x < 7'};
diff --git a/tests/queries/0_stateless/02346_additional_filters_index.reference b/tests/queries/0_stateless/02346_additional_filters_index.reference
new file mode 100644
index 000000000000..d4b9509cb3c4
--- /dev/null
+++ b/tests/queries/0_stateless/02346_additional_filters_index.reference
@@ -0,0 +1,30 @@
+-- { echoOn }
+set max_rows_to_read = 2;
+select * from table_1 order by x settings additional_table_filters={'table_1' : 'x > 3'};
+4	dddd
+select * from table_1 order by x settings additional_table_filters={'table_1' : 'x < 3'};
+1	a
+2	bb
+select * from table_1 order by x settings additional_table_filters={'table_1' : 'length(y) >= 3'};
+3	ccc
+4	dddd
+select * from table_1 order by x settings additional_table_filters={'table_1' : 'length(y) < 3'};
+1	a
+2	bb
+set max_rows_to_read = 4;
+select * from distr_table order by x settings additional_table_filters={'distr_table' : 'x > 3'};
+4	dddd
+4	dddd
+select * from distr_table order by x settings additional_table_filters={'distr_table' : 'x < 3'};
+1	a
+1	a
+2	bb
+2	bb
+select * from distr_table order by x settings additional_table_filters={'distr_table' : 'length(y) > 3'};
+4	dddd
+4	dddd
+select * from distr_table order by x settings additional_table_filters={'distr_table' : 'length(y) < 3'};
+1	a
+1	a
+2	bb
+2	bb
diff --git a/tests/queries/0_stateless/02346_additional_filters_index.sql b/tests/queries/0_stateless/02346_additional_filters_index.sql
new file mode 100644
index 000000000000..0d40cc1f898a
--- /dev/null
+++ b/tests/queries/0_stateless/02346_additional_filters_index.sql
@@ -0,0 +1,24 @@
+-- Tags: distributed
+
+create table table_1 (x UInt32, y String, INDEX a (length(y)) TYPE minmax GRANULARITY 1) engine = MergeTree order by x settings index_granularity = 2;
+insert into table_1 values (1, 'a'), (2, 'bb'), (3, 'ccc'), (4, 'dddd');
+
+CREATE TABLE distr_table (x UInt32, y String) ENGINE = Distributed(test_cluster_two_shards, currentDatabase(), 'table_1');
+
+-- { echoOn }
+set max_rows_to_read = 2;
+
+select * from table_1 order by x settings additional_table_filters={'table_1' : 'x > 3'};
+select * from table_1 order by x settings additional_table_filters={'table_1' : 'x < 3'};
+
+select * from table_1 order by x settings additional_table_filters={'table_1' : 'length(y) >= 3'};
+select * from table_1 order by x settings additional_table_filters={'table_1' : 'length(y) < 3'};
+
+set max_rows_to_read = 4;
+
+select * from distr_table order by x settings additional_table_filters={'distr_table' : 'x > 3'};
+select * from distr_table order by x settings additional_table_filters={'distr_table' : 'x < 3'};
+
+select * from distr_table order by x settings additional_table_filters={'distr_table' : 'length(y) > 3'};
+select * from distr_table order by x settings additional_table_filters={'distr_table' : 'length(y) < 3'};
+
