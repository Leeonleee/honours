diff --git a/tests/integration/test_replicated_database/test.py b/tests/integration/test_replicated_database/test.py
index a591c93d264b..3ced82ebb57e 100644
--- a/tests/integration/test_replicated_database/test.py
+++ b/tests/integration/test_replicated_database/test.py
@@ -799,7 +799,7 @@ def test_recover_staled_replica(started_cluster):
             settings=settings,
         )
         main_node.query_with_retry(
-            "ALTER TABLE recover.mv1 MODIFY QUERY SELECT m FROM recover.rmt1",
+            "ALTER TABLE recover.mv1 MODIFY QUERY SELECT m as n FROM recover.rmt1",
             settings=settings,
         )
         main_node.query_with_retry(
diff --git a/tests/queries/0_stateless/02888_obsolete_settings.reference b/tests/queries/0_stateless/02888_obsolete_settings.reference
index dbf781f183ff..0ef6404eabbc 100644
--- a/tests/queries/0_stateless/02888_obsolete_settings.reference
+++ b/tests/queries/0_stateless/02888_obsolete_settings.reference
@@ -1,5 +1,6 @@
 -- Obsolete server settings
 -- Obsolete general settings
+allow_experimental_alter_materialized_view_structure
 allow_experimental_bigint_types
 allow_experimental_database_atomic
 allow_experimental_geo_types
diff --git a/tests/queries/0_stateless/02931_alter_materialized_view_query_inconsistent.reference b/tests/queries/0_stateless/02931_alter_materialized_view_query_inconsistent.reference
new file mode 100644
index 000000000000..45e4b958f4b9
--- /dev/null
+++ b/tests/queries/0_stateless/02931_alter_materialized_view_query_inconsistent.reference
@@ -0,0 +1,3 @@
+v	UInt64					
+v2	UInt8					
+CREATE MATERIALIZED VIEW default.pipe TO default.dest
(
    `v` UInt64,
    `v2` UInt8
) AS
SELECT
    v * 2 AS v,
    1 AS v2
FROM default.src
diff --git a/tests/queries/0_stateless/02931_alter_materialized_view_query_inconsistent.sql b/tests/queries/0_stateless/02931_alter_materialized_view_query_inconsistent.sql
new file mode 100644
index 000000000000..895d5b3ab053
--- /dev/null
+++ b/tests/queries/0_stateless/02931_alter_materialized_view_query_inconsistent.sql
@@ -0,0 +1,18 @@
+DROP TABLE IF EXISTS pipe;
+DROP TABLE IF EXISTS src;
+DROP TABLE IF EXISTS dest;
+
+CREATE TABLE src(v UInt64) ENGINE = Null;
+CREATE TABLE dest(v UInt64) Engine = MergeTree() ORDER BY v;
+CREATE MATERIALIZED VIEW pipe TO dest AS SELECT v FROM src;
+
+ALTER TABLE dest ADD COLUMN v2 UInt64;
+
+ALTER TABLE pipe MODIFY QUERY SELECT v * 2 as v, 1 as v2 FROM src;
+
+DESCRIBE TABLE pipe;
+SHOW CREATE TABLE pipe;
+
+DROP TABLE IF EXISTS pipe;
+DROP TABLE IF EXISTS src;
+DROP TABLE IF EXISTS dest;
