diff --git a/tests/queries/0_stateless/01942_dateTimeToSnowflake.reference b/tests/queries/0_stateless/01942_dateTimeToSnowflake.reference
index dfca3a10eeb3..abc27beb5f7e 100644
--- a/tests/queries/0_stateless/01942_dateTimeToSnowflake.reference
+++ b/tests/queries/0_stateless/01942_dateTimeToSnowflake.reference
@@ -1,6 +1,7 @@
-const column
-2021-08-15 18:57:56	1426860702823350272
-2021-08-15 18:57:56.492	1426860704886947840
-non-const column
-2021-08-15 18:57:56	1426860702823350272
-2021-08-15 18:57:56.492	1426860704886947840
+-- const / non-const inputs
+2021-08-15 18:57:56	1426860702823350272	1426860702823350272
+2021-08-15 18:57:56.492	1426860704886947840	1426860704886947840
+-- different DateTime64 scales
+1426981498778550272	1426981500456271872	1426981500833759232	1426981500842147840	1426981500842147840
+1	1	1	1
+2023-11-11 11:11:11.1231	2023-11-11 11:11:11.123
diff --git a/tests/queries/0_stateless/01942_dateTimeToSnowflake.sql b/tests/queries/0_stateless/01942_dateTimeToSnowflake.sql
index 047d8be7be5d..1090179bb67e 100644
--- a/tests/queries/0_stateless/01942_dateTimeToSnowflake.sql
+++ b/tests/queries/0_stateless/01942_dateTimeToSnowflake.sql
@@ -1,23 +1,45 @@
+SET session_timezone = 'Africa/Juba';
+
 -- Error cases
-SELECT dateTimeToSnowflake();  -- {serverError 42}
-SELECT dateTime64ToSnowflake();  -- {serverError 42}
+SELECT dateTimeToSnowflake();  -- {serverError NUMBER_OF_ARGUMENTS_DOESNT_MATCH}
+SELECT dateTime64ToSnowflake();  -- {serverError NUMBER_OF_ARGUMENTS_DOESNT_MATCH}
+
+SELECT dateTimeToSnowflake('abc');  -- {serverError ILLEGAL_TYPE_OF_ARGUMENT}
+SELECT dateTime64ToSnowflake('abc');  -- {serverError ILLEGAL_TYPE_OF_ARGUMENT}
 
-SELECT dateTimeToSnowflake('abc');  -- {serverError 43}
-SELECT dateTime64ToSnowflake('abc');  -- {serverError 43}
+SELECT dateTimeToSnowflake('abc', 123);  -- {serverError NUMBER_OF_ARGUMENTS_DOESNT_MATCH}
+SELECT dateTime64ToSnowflake('abc', 123);  -- {serverError NUMBER_OF_ARGUMENTS_DOESNT_MATCH}
 
-SELECT dateTimeToSnowflake('abc', 123);  -- {serverError 42}
-SELECT dateTime64ToSnowflake('abc', 123);  -- {serverError 42}
+SELECT '-- const / non-const inputs';
 
-SELECT 'const column';
 WITH toDateTime('2021-08-15 18:57:56', 'Asia/Shanghai') AS dt
-SELECT dt, dateTimeToSnowflake(dt);
+SELECT dt, dateTimeToSnowflake(dt), materialize(dateTimeToSnowflake(dt));
 
 WITH toDateTime64('2021-08-15 18:57:56.492', 3, 'Asia/Shanghai') AS dt64
-SELECT dt64, dateTime64ToSnowflake(dt64);
+SELECT dt64, dateTime64ToSnowflake(dt64), materialize(dateTime64ToSnowflake(dt64));
+
+SELECT '-- different DateTime64 scales';
+
+WITH toDateTime64('2021-08-15 18:57:56.492', 0, 'UTC') AS dt64_0,
+     toDateTime64('2021-08-15 18:57:56.492', 1, 'UTC') AS dt64_1,
+     toDateTime64('2021-08-15 18:57:56.492', 2, 'UTC') AS dt64_2,
+     toDateTime64('2021-08-15 18:57:56.492', 3, 'UTC') AS dt64_3,
+     toDateTime64('2021-08-15 18:57:56.492', 4, 'UTC') AS dt64_4
+SELECT dateTime64ToSnowflake(dt64_0),
+       dateTime64ToSnowflake(dt64_1),
+       dateTime64ToSnowflake(dt64_2),
+       dateTime64ToSnowflake(dt64_3),
+       dateTime64ToSnowflake(dt64_4);
 
-SELECT 'non-const column';
-WITH toDateTime('2021-08-15 18:57:56', 'Asia/Shanghai') AS x
-SELECT materialize(x) as dt, dateTimeToSnowflake(dt);;
+-- DateTime64-to-Snowflake-to-DateTime64 is idempotent *if* the scale is <=3 (millisecond precision)
+WITH now64(0, 'UTC') AS dt64_0,
+     now64(1, 'UTC') AS dt64_1,
+     now64(2, 'UTC') AS dt64_2,
+     now64(3, 'UTC') AS dt64_3
+SELECT snowflakeToDateTime64(dateTime64ToSnowflake(dt64_0), 'UTC') == dt64_0,
+       snowflakeToDateTime64(dateTime64ToSnowflake(dt64_1), 'UTC') == dt64_1,
+       snowflakeToDateTime64(dateTime64ToSnowflake(dt64_2), 'UTC') == dt64_2,
+       snowflakeToDateTime64(dateTime64ToSnowflake(dt64_3), 'UTC') == dt64_3;
 
-WITH toDateTime64('2021-08-15 18:57:56.492', 3, 'Asia/Shanghai') AS x
-SELECT materialize(x) as dt64, dateTime64ToSnowflake(dt64);
+WITH toDateTime64('2023-11-11 11:11:11.1231', 4, 'UTC') AS dt64_4
+SELECT dt64_4, snowflakeToDateTime64(dateTime64ToSnowflake(dt64_4), 'UTC'); -- not idempotent
diff --git a/tests/queries/0_stateless/01942_snowflakeToDateTime.sql b/tests/queries/0_stateless/01942_snowflakeToDateTime.sql
index 0092eca848c6..f1a50dd370da 100644
--- a/tests/queries/0_stateless/01942_snowflakeToDateTime.sql
+++ b/tests/queries/0_stateless/01942_snowflakeToDateTime.sql
@@ -1,12 +1,12 @@
 -- -- Error cases
-SELECT snowflakeToDateTime();  -- {serverError 42}
-SELECT snowflakeToDateTime64();  -- {serverError 42}
+SELECT snowflakeToDateTime();  -- {serverError NUMBER_OF_ARGUMENTS_DOESNT_MATCH}
+SELECT snowflakeToDateTime64();  -- {serverError NUMBER_OF_ARGUMENTS_DOESNT_MATCH}
 
-SELECT snowflakeToDateTime('abc');  -- {serverError 43}
-SELECT snowflakeToDateTime64('abc');  -- {serverError 43}
+SELECT snowflakeToDateTime('abc');  -- {serverError ILLEGAL_TYPE_OF_ARGUMENT}
+SELECT snowflakeToDateTime64('abc');  -- {serverError ILLEGAL_TYPE_OF_ARGUMENT}
 
-SELECT snowflakeToDateTime('abc', 123);  -- {serverError 43}
-SELECT snowflakeToDateTime64('abc', 123);  -- {serverError 43}
+SELECT snowflakeToDateTime('abc', 123);  -- {serverError ILLEGAL_TYPE_OF_ARGUMENT}
+SELECT snowflakeToDateTime64('abc', 123);  -- {serverError ILLEGAL_TYPE_OF_ARGUMENT}
 
 SELECT 'const column';
 WITH
