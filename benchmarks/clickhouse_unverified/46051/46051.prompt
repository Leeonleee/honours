You will be provided with a partial code base and an issue statement explaining a problem to resolve.

<issue>
countDistinctIf with Date use much more memory than UInt16
**Describe the situation**
countDistinctIf with Date datatype use more memory than UInt16

**How to reproduce**
ClickHouse version 21.11

```
SELECT countDistinctIf(materialize(toUInt16(today())), 1)
FROM numbers_mt(100000000)
GROUP BY number % 1000000
FORMAT `Null`

Peak memory usage (for query): 1.51 GiB.

0 rows in set. Elapsed: 2.465 sec. Processed 100.00 million rows, 800.00 MB (40.57 million rows/s., 324.57 MB/s.)

SELECT countDistinctIf(materialize(today()), 1)
FROM numbers_mt(100000000)
GROUP BY number % 1000000
FORMAT `Null`

Peak memory usage (for query): 4.51 GiB.

0 rows in set. Elapsed: 4.455 sec. Processed 100.00 million rows, 800.00 MB (22.44 million rows/s., 179.56 MB/s.)
```


**Expected performance**
Speed and memory usage should be  the same as for UInt16
</issue>

I need you to solve the provided issue by generating a code fix that can be applied directly to the repository

Respond below:
