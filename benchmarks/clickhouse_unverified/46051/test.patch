diff --git a/tests/queries/0_stateless/02554_rewrite_count_distinct_if_with_count_distinct_implementation.reference b/tests/queries/0_stateless/02554_rewrite_count_distinct_if_with_count_distinct_implementation.reference
new file mode 100644
index 000000000000..efc3cd99060a
--- /dev/null
+++ b/tests/queries/0_stateless/02554_rewrite_count_distinct_if_with_count_distinct_implementation.reference
@@ -0,0 +1,6 @@
+2
+SELECT countDistinctIf(number % 10, (number % 5) = 2)
+FROM numbers(1000)
+2
+SELECT uniqExactIf(number % 10, (number % 5) = 2)
+FROM numbers(1000)
diff --git a/tests/queries/0_stateless/02554_rewrite_count_distinct_if_with_count_distinct_implementation.sql b/tests/queries/0_stateless/02554_rewrite_count_distinct_if_with_count_distinct_implementation.sql
new file mode 100644
index 000000000000..a81f53c1ef6d
--- /dev/null
+++ b/tests/queries/0_stateless/02554_rewrite_count_distinct_if_with_count_distinct_implementation.sql
@@ -0,0 +1,8 @@
+-- Tags: no-parallel
+SELECT countDistinctIf(number % 10, number % 5 = 2) FROM numbers(1000);
+EXPLAIN SYNTAX SELECT countDistinctIf(number % 10, number % 5 = 2) FROM numbers(1000);
+
+-- disable by default
+SET rewrite_count_distinct_if_with_count_distinct_implementation = 1;
+SELECT countDistinctIf(number % 10, number % 5 = 2) FROM numbers(1000);
+EXPLAIN SYNTAX SELECT countDistinctIf(number % 10, number % 5 = 2) FROM numbers(1000);
