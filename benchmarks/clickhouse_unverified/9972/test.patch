diff --git a/dbms/tests/queries/0_stateless/00818_inner_join_bug_3567.reference b/dbms/tests/queries/0_stateless/00818_inner_join_bug_3567.reference
index 7967cf7837ee..c0fe46ee9635 100644
--- a/dbms/tests/queries/0_stateless/00818_inner_join_bug_3567.reference
+++ b/dbms/tests/queries/0_stateless/00818_inner_join_bug_3567.reference
@@ -1,5 +1,19 @@
-a	2018-01-01 00:00:00			0000-00-00 00:00:00
-b	2018-01-01 00:00:00	b	b	2018-01-01 00:00:00
-c	2018-01-01 00:00:00	c	c	2018-01-01 00:00:00
-b	2018-01-01 00:00:00	b	b	2018-01-01 00:00:00
-c	2018-01-01 00:00:00	c	c	2018-01-01 00:00:00
+â”Œâ”€[1ma[0mâ”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[1mb[0mâ”€â”
+â”‚ a â”‚ 2018-01-01 â”‚
+â”‚ b â”‚ 2018-01-01 â”‚
+â”‚ c â”‚ 2018-01-01 â”‚
+â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+â”Œâ”€[1mc[0mâ”€â”¬â”€[1ma[0mâ”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[1md[0mâ”€â”¬â”€[1ma[0mâ”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[1mb[0mâ”€â”
+â”‚ B â”‚ b â”‚ 2018-01-01 â”‚ B â”‚ 2018-01-01 â”‚
+â”‚ C â”‚ c â”‚ 2018-01-01 â”‚ C â”‚ 2018-01-01 â”‚
+â”‚ D â”‚ d â”‚ 2018-01-01 â”‚ D â”‚ 2018-01-01 â”‚
+â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+â”Œâ”€[1ma[0mâ”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[1mb[0mâ”€â”¬â”€[1mc[0mâ”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[1md[0mâ”€â”
+â”‚ a â”‚ 2018-01-01 â”‚   â”‚ 0000-00-00 â”‚
+â”‚ b â”‚ 2018-01-01 â”‚ B â”‚ 2018-01-01 â”‚
+â”‚ c â”‚ 2018-01-01 â”‚ C â”‚ 2018-01-01 â”‚
+â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+â”Œâ”€[1ma[0mâ”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[1mb[0mâ”€â”¬â”€[1mc[0mâ”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[1md[0mâ”€â”
+â”‚ b â”‚ 2018-01-01 â”‚ B â”‚ 2018-01-01 â”‚
+â”‚ c â”‚ 2018-01-01 â”‚ C â”‚ 2018-01-01 â”‚
+â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
diff --git a/dbms/tests/queries/0_stateless/00818_inner_join_bug_3567.sql b/dbms/tests/queries/0_stateless/00818_inner_join_bug_3567.sql
index b8bd6d3384cf..2058d2309e43 100644
--- a/dbms/tests/queries/0_stateless/00818_inner_join_bug_3567.sql
+++ b/dbms/tests/queries/0_stateless/00818_inner_join_bug_3567.sql
@@ -1,14 +1,16 @@
-DROP TABLE IF EXISTS using1;
-DROP TABLE IF EXISTS using2;
+DROP TABLE IF EXISTS table1;
+DROP TABLE IF EXISTS table2;
 
-CREATE TABLE using1(a String, b DateTime) ENGINE=MergeTree order by a;
-CREATE TABLE using2(c String, a String, d DateTime) ENGINE=MergeTree order by c;
+CREATE TABLE table1(a String, b Date) ENGINE MergeTree order by a;
+CREATE TABLE table2(c String, a String, d Date) ENGINE MergeTree order by c;
 
-INSERT INTO using1 VALUES ('a', '2018-01-01 00:00:00') ('b', '2018-01-01 00:00:00') ('c', '2018-01-01 00:00:00');
-INSERT INTO using2 VALUES ('d', 'd', '2018-01-01 00:00:00') ('b', 'b', '2018-01-01 00:00:00') ('c', 'c', '2018-01-01 00:00:00');
+INSERT INTO table1 VALUES ('a', '2018-01-01') ('b', '2018-01-01') ('c', '2018-01-01');
+INSERT INTO table2 VALUES ('D', 'd', '2018-01-01') ('B', 'b', '2018-01-01') ('C', 'c', '2018-01-01');
 
-SELECT * FROM using1 t1 ALL LEFT JOIN (SELECT *, c as a, d as b FROM using2) t2 USING (a, b) ORDER BY d;
-SELECT * FROM using1 t1 ALL INNER JOIN (SELECT *, c as a, d as b FROM using2) t2 USING (a, b) ORDER BY d;
+SELECT * FROM table1 t1 FORMAT PrettyCompact;
+SELECT *, c as a, d as b FROM table2 FORMAT PrettyCompact;
+SELECT * FROM table1 t1 ALL LEFT JOIN (SELECT *, c, d as b FROM table2) t2 USING (a, b) ORDER BY d FORMAT PrettyCompact;
+SELECT * FROM table1 t1 ALL INNER JOIN (SELECT *, c, d as b FROM table2) t2 USING (a, b) ORDER BY d FORMAT PrettyCompact;
 
-DROP TABLE using1;
-DROP TABLE using2;
+DROP TABLE table1;
+DROP TABLE table2;
diff --git a/dbms/tests/queries/0_stateless/01104_distributed_numbers_test.sql b/dbms/tests/queries/0_stateless/01104_distributed_numbers_test.sql
index b301c0ac00f6..7f56a4e08fd3 100644
--- a/dbms/tests/queries/0_stateless/01104_distributed_numbers_test.sql
+++ b/dbms/tests/queries/0_stateless/01104_distributed_numbers_test.sql
@@ -1,5 +1,5 @@
 DROP TABLE IF EXISTS d_numbers;
-CREATE TABLE d_numbers (number UInt32) ENGINE = Distributed(test_cluster_two_shards_localhost, system, numbers, rand());
+CREATE TABLE d_numbers (number UInt32) ENGINE = Distributed(test_cluster_two_shards, system, numbers, rand());
 
 SET experimental_use_processors = 1;
 
diff --git a/dbms/tests/queries/0_stateless/01104_distributed_one_test.reference b/dbms/tests/queries/0_stateless/01104_distributed_one_test.reference
index 929dd64ae90f..efbf8ed025e4 100644
--- a/dbms/tests/queries/0_stateless/01104_distributed_one_test.reference
+++ b/dbms/tests/queries/0_stateless/01104_distributed_one_test.reference
@@ -4,3 +4,4 @@ distributed_0	2	1
 local_0	1
 distributed_0	1	1
 distributed_0	2	1
+remote_0	1
diff --git a/dbms/tests/queries/0_stateless/01104_distributed_one_test.sql b/dbms/tests/queries/0_stateless/01104_distributed_one_test.sql
index 92b4a83ebf36..0ae6a180570e 100644
--- a/dbms/tests/queries/0_stateless/01104_distributed_one_test.sql
+++ b/dbms/tests/queries/0_stateless/01104_distributed_one_test.sql
@@ -1,5 +1,5 @@
 DROP TABLE IF EXISTS d_one;
-CREATE TABLE d_one (dummy UInt8) ENGINE = Distributed(test_cluster_two_shards_localhost, system, one, rand());
+CREATE TABLE d_one (dummy UInt8) ENGINE = Distributed(test_cluster_two_shards, system, one, rand());
 
 SELECT 'local_0', toUInt8(1) AS dummy FROM system.one AS o WHERE o.dummy = 0;
 SELECT 'local_1', toUInt8(1) AS dummy FROM system.one AS o WHERE o.dummy = 1;
@@ -16,3 +16,6 @@ SELECT 'distributed_0', _shard_num, toUInt8(1) AS dummy FROM d_one AS o WHERE o.
 SELECT 'distributed_1', _shard_num, toUInt8(1) AS dummy FROM d_one AS o WHERE o.dummy = 1 ORDER BY _shard_num;
 
 DROP TABLE d_one;
+
+SELECT 'remote_0', toUInt8(1) AS dummy FROM remote('127.0.0.2', system, one) AS o WHERE o.dummy = 0;
+SELECT 'remote_1', toUInt8(1) AS dummy FROM remote('127.0.0.2', system, one) AS o WHERE o.dummy = 1;
