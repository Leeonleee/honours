diff --git a/tests/integration/test_table_functions_access_rights/test.py b/tests/integration/test_table_functions_access_rights/test.py
index 7bc02ab902e8..a4c8017af631 100644
--- a/tests/integration/test_table_functions_access_rights/test.py
+++ b/tests/integration/test_table_functions_access_rights/test.py
@@ -46,7 +46,7 @@ def test_merge():
     )
 
     instance.query("GRANT CREATE TEMPORARY TABLE ON *.* TO A")
-    assert "no tables in database matches" in instance.query_and_get_error(
+    assert "no tables in the database matches" in instance.query_and_get_error(
         select_query, user="A"
     )
 
diff --git a/tests/queries/0_stateless/00416_pocopatch_progress_in_http_headers.reference b/tests/queries/0_stateless/00416_pocopatch_progress_in_http_headers.reference
index 462f2f63fe1d..d2fec3e14e75 100644
--- a/tests/queries/0_stateless/00416_pocopatch_progress_in_http_headers.reference
+++ b/tests/queries/0_stateless/00416_pocopatch_progress_in_http_headers.reference
@@ -1,9 +1,9 @@
-< X-ClickHouse-Progress: {"read_rows":"0","read_bytes":"0","written_rows":"0","written_bytes":"0","total_rows_to_read":"10","result_rows":"0","result_bytes":"0"}
-< X-ClickHouse-Progress: {"read_rows":"5","read_bytes":"40","written_rows":"0","written_bytes":"0","total_rows_to_read":"10","result_rows":"0","result_bytes":"0"}
-< X-ClickHouse-Progress: {"read_rows":"10","read_bytes":"80","written_rows":"0","written_bytes":"0","total_rows_to_read":"10","result_rows":"0","result_bytes":"0"}
+< X-ClickHouse-Progress: {"total_rows_to_read":"10"}
+< X-ClickHouse-Progress: {"read_rows":"5","read_bytes":"40","total_rows_to_read":"10"}
+< X-ClickHouse-Progress: {"read_rows":"10","read_bytes":"80","total_rows_to_read":"10"}
 9
-< X-ClickHouse-Progress: {"read_rows":"0","read_bytes":"0","written_rows":"0","written_bytes":"0","total_rows_to_read":"10","result_rows":"0","result_bytes":"0"}
-< X-ClickHouse-Progress: {"read_rows":"1","read_bytes":"8","written_rows":"0","written_bytes":"0","total_rows_to_read":"10","result_rows":"0","result_bytes":"0"}
+< X-ClickHouse-Progress: {"total_rows_to_read":"10"}
+< X-ClickHouse-Progress: {"read_rows":"1","read_bytes":"8","total_rows_to_read":"10"}
 0
 1
 2
diff --git a/tests/queries/0_stateless/02136_scalar_progress.reference b/tests/queries/0_stateless/02136_scalar_progress.reference
index b8957f78e6df..bda8b6df979d 100644
--- a/tests/queries/0_stateless/02136_scalar_progress.reference
+++ b/tests/queries/0_stateless/02136_scalar_progress.reference
@@ -1,7 +1,7 @@
-< X-ClickHouse-Progress: {"read_rows":"0","read_bytes":"0","written_rows":"0","written_bytes":"0","total_rows_to_read":"100000","result_rows":"0","result_bytes":"0"}
-< X-ClickHouse-Progress: {"read_rows":"65505","read_bytes":"524040","written_rows":"0","written_bytes":"0","total_rows_to_read":"100000","result_rows":"0","result_bytes":"0"}
-< X-ClickHouse-Progress: {"read_rows":"100000","read_bytes":"800000","written_rows":"0","written_bytes":"0","total_rows_to_read":"100000","result_rows":"0","result_bytes":"0"}
-< X-ClickHouse-Progress: {"read_rows":"100000","read_bytes":"800000","written_rows":"0","written_bytes":"0","total_rows_to_read":"100001","result_rows":"0","result_bytes":"0"}
-< X-ClickHouse-Progress: {"read_rows":"100001","read_bytes":"800001","written_rows":"0","written_bytes":"0","total_rows_to_read":"100001","result_rows":"0","result_bytes":"0"}
-< X-ClickHouse-Progress: {"read_rows":"100001","read_bytes":"800001","written_rows":"0","written_bytes":"0","total_rows_to_read":"100001","result_rows":"1","result_bytes":"272"}
-< X-ClickHouse-Summary: {"read_rows":"100001","read_bytes":"800001","written_rows":"0","written_bytes":"0","total_rows_to_read":"100001","result_rows":"1","result_bytes":"272"}
+< X-ClickHouse-Progress: {"total_rows_to_read":"100000"}
+< X-ClickHouse-Progress: {"read_rows":"65505","read_bytes":"524040","total_rows_to_read":"100000"}
+< X-ClickHouse-Progress: {"read_rows":"100000","read_bytes":"800000","total_rows_to_read":"100000"}
+< X-ClickHouse-Progress: {"read_rows":"100000","read_bytes":"800000","total_rows_to_read":"100001"}
+< X-ClickHouse-Progress: {"read_rows":"100001","read_bytes":"800001","total_rows_to_read":"100001"}
+< X-ClickHouse-Progress: {"read_rows":"100001","read_bytes":"800001","total_rows_to_read":"100001","result_rows":"1","result_bytes":"272"}
+< X-ClickHouse-Summary: {"read_rows":"100001","read_bytes":"800001","total_rows_to_read":"100001","result_rows":"1","result_bytes":"272"}
diff --git a/tests/queries/0_stateless/02373_progress_contain_result.reference b/tests/queries/0_stateless/02373_progress_contain_result.reference
index a125646e7b83..3fbe190ff00e 100644
--- a/tests/queries/0_stateless/02373_progress_contain_result.reference
+++ b/tests/queries/0_stateless/02373_progress_contain_result.reference
@@ -1,1 +1,1 @@
-< X-ClickHouse-Summary: {"read_rows":"100","read_bytes":"800","written_rows":"0","written_bytes":"0","total_rows_to_read":"100","result_rows":"100","result_bytes":"227"}
+< X-ClickHouse-Summary: {"read_rows":"100","read_bytes":"800","total_rows_to_read":"100","result_rows":"100","result_bytes":"227"}
diff --git a/tests/queries/0_stateless/02423_insert_summary_behaviour.reference b/tests/queries/0_stateless/02423_insert_summary_behaviour.reference
index 8e7efaac109e..9323aaa15589 100644
--- a/tests/queries/0_stateless/02423_insert_summary_behaviour.reference
+++ b/tests/queries/0_stateless/02423_insert_summary_behaviour.reference
@@ -1,7 +1,7 @@
 No materialized views
-< X-ClickHouse-Summary: {"read_rows":"1","read_bytes":"8","written_rows":"1","written_bytes":"8","total_rows_to_read":"0","result_rows":"1","result_bytes":"8"}
-< X-ClickHouse-Summary: {"read_rows":"10","read_bytes":"80","written_rows":"10","written_bytes":"80","total_rows_to_read":"0","result_rows":"10","result_bytes":"80"}
-< X-ClickHouse-Summary: {"read_rows":"10","read_bytes":"80","written_rows":"10","written_bytes":"80","total_rows_to_read":"0","result_rows":"10","result_bytes":"80"}
+< X-ClickHouse-Summary: {"read_rows":"1","read_bytes":"8","written_rows":"1","written_bytes":"8","result_rows":"1","result_bytes":"8"}
+< X-ClickHouse-Summary: {"read_rows":"10","read_bytes":"80","written_rows":"10","written_bytes":"80","result_rows":"10","result_bytes":"80"}
+< X-ClickHouse-Summary: {"read_rows":"10","read_bytes":"80","written_rows":"10","written_bytes":"80","result_rows":"10","result_bytes":"80"}
 With materialized views
 < X-ClickHouse-Summary: {"read_rows":"5","read_bytes":"40","written_rows":"4","written_bytes":"32","total_rows_to_read":"2","result_rows":"4","result_bytes":"32"}
 < X-ClickHouse-Summary: {"read_rows":"32","read_bytes":"256","written_rows":"40","written_bytes":"320","total_rows_to_read":"2","result_rows":"40","result_bytes":"320"}
diff --git a/tests/queries/0_stateless/02457_insert_select_progress_http.reference b/tests/queries/0_stateless/02457_insert_select_progress_http.reference
index 5f13f4b92851..7e8dc666b015 100644
--- a/tests/queries/0_stateless/02457_insert_select_progress_http.reference
+++ b/tests/queries/0_stateless/02457_insert_select_progress_http.reference
@@ -1,13 +1,13 @@
-< X-ClickHouse-Progress: {"read_rows":"0","read_bytes":"0","written_rows":"0","written_bytes":"0","total_rows_to_read":"5","result_rows":"0","result_bytes":"0"}
-< X-ClickHouse-Progress: {"read_rows":"1","read_bytes":"8","written_rows":"0","written_bytes":"0","total_rows_to_read":"5","result_rows":"0","result_bytes":"0"}
-< X-ClickHouse-Progress: {"read_rows":"1","read_bytes":"8","written_rows":"1","written_bytes":"4","total_rows_to_read":"5","result_rows":"0","result_bytes":"0"}
-< X-ClickHouse-Progress: {"read_rows":"2","read_bytes":"16","written_rows":"1","written_bytes":"4","total_rows_to_read":"5","result_rows":"0","result_bytes":"0"}
-< X-ClickHouse-Progress: {"read_rows":"2","read_bytes":"16","written_rows":"2","written_bytes":"8","total_rows_to_read":"5","result_rows":"0","result_bytes":"0"}
-< X-ClickHouse-Progress: {"read_rows":"3","read_bytes":"24","written_rows":"2","written_bytes":"8","total_rows_to_read":"5","result_rows":"0","result_bytes":"0"}
-< X-ClickHouse-Progress: {"read_rows":"3","read_bytes":"24","written_rows":"3","written_bytes":"12","total_rows_to_read":"5","result_rows":"0","result_bytes":"0"}
-< X-ClickHouse-Progress: {"read_rows":"4","read_bytes":"32","written_rows":"3","written_bytes":"12","total_rows_to_read":"5","result_rows":"0","result_bytes":"0"}
-< X-ClickHouse-Progress: {"read_rows":"4","read_bytes":"32","written_rows":"4","written_bytes":"16","total_rows_to_read":"5","result_rows":"0","result_bytes":"0"}
-< X-ClickHouse-Progress: {"read_rows":"5","read_bytes":"40","written_rows":"4","written_bytes":"16","total_rows_to_read":"5","result_rows":"0","result_bytes":"0"}
-< X-ClickHouse-Progress: {"read_rows":"5","read_bytes":"40","written_rows":"5","written_bytes":"20","total_rows_to_read":"5","result_rows":"0","result_bytes":"0"}
+< X-ClickHouse-Progress: {"total_rows_to_read":"5"}
+< X-ClickHouse-Progress: {"read_rows":"1","read_bytes":"8","total_rows_to_read":"5"}
+< X-ClickHouse-Progress: {"read_rows":"1","read_bytes":"8","written_rows":"1","written_bytes":"4","total_rows_to_read":"5"}
+< X-ClickHouse-Progress: {"read_rows":"2","read_bytes":"16","written_rows":"1","written_bytes":"4","total_rows_to_read":"5"}
+< X-ClickHouse-Progress: {"read_rows":"2","read_bytes":"16","written_rows":"2","written_bytes":"8","total_rows_to_read":"5"}
+< X-ClickHouse-Progress: {"read_rows":"3","read_bytes":"24","written_rows":"2","written_bytes":"8","total_rows_to_read":"5"}
+< X-ClickHouse-Progress: {"read_rows":"3","read_bytes":"24","written_rows":"3","written_bytes":"12","total_rows_to_read":"5"}
+< X-ClickHouse-Progress: {"read_rows":"4","read_bytes":"32","written_rows":"3","written_bytes":"12","total_rows_to_read":"5"}
+< X-ClickHouse-Progress: {"read_rows":"4","read_bytes":"32","written_rows":"4","written_bytes":"16","total_rows_to_read":"5"}
+< X-ClickHouse-Progress: {"read_rows":"5","read_bytes":"40","written_rows":"4","written_bytes":"16","total_rows_to_read":"5"}
+< X-ClickHouse-Progress: {"read_rows":"5","read_bytes":"40","written_rows":"5","written_bytes":"20","total_rows_to_read":"5"}
 < X-ClickHouse-Progress: {"read_rows":"5","read_bytes":"40","written_rows":"5","written_bytes":"20","total_rows_to_read":"5","result_rows":"5","result_bytes":"20"}
 < X-ClickHouse-Summary: {"read_rows":"5","read_bytes":"40","written_rows":"5","written_bytes":"20","total_rows_to_read":"5","result_rows":"5","result_bytes":"20"}
diff --git a/tests/queries/0_stateless/03272_json_with_progress.reference b/tests/queries/0_stateless/03272_json_with_progress.reference
new file mode 100644
index 000000000000..3556a832e429
--- /dev/null
+++ b/tests/queries/0_stateless/03272_json_with_progress.reference
@@ -0,0 +1,10 @@
+{"progress":{}}
+{"progress":{"read_rows":"100000","read_bytes":"800000"}}
+{"row":{"number":"1"}}
+{"progress":{"read_rows":"200000","read_bytes":"1600000"}}
+{"progress":{"read_rows":"300000","read_bytes":"2400000"}}
+{"progress":{"read_rows":"400000","read_bytes":"3200000"}}
+{"progress":{"read_rows":"500000","read_bytes":"4000000"}}
+{"progress":{"read_rows":"600000","read_bytes":"4800000"}}
+{"progress":{"read_rows":"700000","read_bytes":"5600000"}}
+{"progress":{"read_rows":"800000","read_bytes":"6400000"}}
diff --git a/tests/queries/0_stateless/03272_json_with_progress.sh b/tests/queries/0_stateless/03272_json_with_progress.sh
new file mode 100755
index 000000000000..ab002cf05a25
--- /dev/null
+++ b/tests/queries/0_stateless/03272_json_with_progress.sh
@@ -0,0 +1,7 @@
+#!/usr/bin/env bash
+
+CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
+# shellcheck source=../shell_config.sh
+. "$CURDIR"/../shell_config.sh
+
+$CLICKHOUSE_CURL -sS "$CLICKHOUSE_URL" -d "SELECT number FROM system.numbers WHERE number % 1234567890 = 1 SETTINGS max_block_size = 100000, max_rows_to_read = 0, max_bytes_to_read = 0 FORMAT JSONEachRowWithProgress" 2>/dev/null | head -n10
