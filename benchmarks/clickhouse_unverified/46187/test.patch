diff --git a/tests/performance/countDigits.xml b/tests/performance/countDigits.xml
new file mode 100644
index 000000000000..5e822b3c4fd7
--- /dev/null
+++ b/tests/performance/countDigits.xml
@@ -0,0 +1,6 @@
+<test>
+    <query>SELECT count() FROM test.hits WHERE NOT ignore(countDigits(RegionID))</query>
+    <query>SELECT count() FROM test.hits WHERE NOT ignore(countDigits(AdvEngineID))</query>
+    <query>SELECT count() FROM test.hits WHERE NOT ignore(countDigits(ClientIP))</query>
+    <query>SELECT count() FROM test.hits WHERE NOT ignore(countDigits(WatchID))</query>
+</test>
diff --git a/tests/queries/0_stateless/01458_count_digits.reference b/tests/queries/0_stateless/01458_count_digits.reference
index 80c210bc0afa..93cb52f73524 100644
--- a/tests/queries/0_stateless/01458_count_digits.reference
+++ b/tests/queries/0_stateless/01458_count_digits.reference
@@ -1,7 +1,7 @@
-0	2	2	0	2	3	0	2	4
+1	2	2	1	2	3	1	2	4
 2	3	4
 10	10	19	19	39	39
 2	2	2	2	2	2	2	2	2	2	2	2
-0	0	0	0	0	0	0	0	0	0	0	0
+1	1	1	1	1	1	1	1	1	1	1	1
 3	3	3	5	5	5	10	10	10	19	19	20
 2	3	4	5	6	7
diff --git a/tests/queries/0_stateless/02560_count_digits.reference b/tests/queries/0_stateless/02560_count_digits.reference
new file mode 100644
index 000000000000..836975f7db45
--- /dev/null
+++ b/tests/queries/0_stateless/02560_count_digits.reference
@@ -0,0 +1,19 @@
+1
+1
+1
+5
+5
+20
+19
+39
+78
+39
+77
+8
+9
+10
+11
+8
+9
+10
+11
diff --git a/tests/queries/0_stateless/02560_count_digits.sql b/tests/queries/0_stateless/02560_count_digits.sql
new file mode 100644
index 000000000000..19f5403bdf5e
--- /dev/null
+++ b/tests/queries/0_stateless/02560_count_digits.sql
@@ -0,0 +1,22 @@
+SELECT countDigits(0);
+SELECT countDigits(1);
+SELECT countDigits(-1);
+SELECT countDigits(12345);
+SELECT countDigits(-12345);
+SELECT countDigits(0xFFFFFFFFFFFFFFFF);
+SELECT countDigits(CAST(0x8000000000000000 AS Int64));
+SELECT countDigits(CAST(-1 AS UInt128));
+SELECT countDigits(CAST(-1 AS UInt256));
+SELECT countDigits(CAST(CAST(-1 AS UInt128) DIV 2 + 1 AS Int128));
+SELECT countDigits(CAST(CAST(-1 AS UInt256) DIV 2 + 1 AS Int256));
+
+SELECT countDigits(-123.45678::Decimal32(5));
+SELECT countDigits(-123.456789::Decimal64(6));
+SELECT countDigits(-123.4567890::Decimal128(7));
+SELECT countDigits(-123.45678901::Decimal256(8));
+
+-- this behavior can be surprising, but actually reasonable:
+SELECT countDigits(-123.456::Decimal32(5));
+SELECT countDigits(-123.4567::Decimal64(6));
+SELECT countDigits(-123.45678::Decimal128(7));
+SELECT countDigits(-123.456789::Decimal256(8));
