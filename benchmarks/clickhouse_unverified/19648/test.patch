diff --git a/tests/queries/0_stateless/01671_merge_join_and_constants.reference b/tests/queries/0_stateless/01671_merge_join_and_constants.reference
new file mode 100644
index 000000000000..114fc9ff91fc
--- /dev/null
+++ b/tests/queries/0_stateless/01671_merge_join_and_constants.reference
@@ -0,0 +1,5 @@
+┌─[1ma[0m─┬──────────[1mb[0m─┬─[1mc[0m─┬──────────[1md[0m─┬─[1mt2.'0.10'[0m─┐
+│ a │ 2018-01-01 │   │ 1970-01-01 │           │
+│ b │ 2018-01-01 │ B │ 2018-01-01 │ 0.10      │
+│ c │ 2018-01-01 │ C │ 2018-01-01 │ 0.10      │
+└───┴────────────┴───┴────────────┴───────────┘
diff --git a/tests/queries/0_stateless/01671_merge_join_and_constants.sql b/tests/queries/0_stateless/01671_merge_join_and_constants.sql
new file mode 100644
index 000000000000..8611a96a7233
--- /dev/null
+++ b/tests/queries/0_stateless/01671_merge_join_and_constants.sql
@@ -0,0 +1,15 @@
+DROP TABLE IF EXISTS table1;
+DROP TABLE IF EXISTS table2;
+
+CREATE TABLE table1(a String, b Date) ENGINE MergeTree order by a;
+CREATE TABLE table2(c String, a String, d Date) ENGINE MergeTree order by c;
+
+INSERT INTO table1 VALUES ('a', '2018-01-01') ('b', '2018-01-01') ('c', '2018-01-01');
+INSERT INTO table2 VALUES ('D', 'd', '2018-01-01') ('B', 'b', '2018-01-01') ('C', 'c', '2018-01-01');
+
+set join_algorithm = 'partial_merge';
+
+SELECT * FROM table1 AS t1 ALL LEFT JOIN (SELECT *, '0.10', c, d AS b FROM table2) AS t2 USING (a, b) ORDER BY d ASC FORMAT PrettyCompact settings max_rows_in_join = 1;
+
+DROP TABLE IF EXISTS table1;
+DROP TABLE IF EXISTS table2;
