You will be provided with a partial code base and an issue statement explaining a problem to resolve.

<issue>
Logical error: data part is Outdated and has creation TID and CSN, but does not have removal tid
https://s3.amazonaws.com/clickhouse-test-reports/71124/b6ff82959f2ba2bc0d543dee6937075bdd7414d5/stress_test__tsan_.html

```
[ 99523 ] {} <Fatal> : Logical error: \'Data part 202410_1_42_8 is Outdated and has creation TID (94, 40, 3ce64a6c-c10e-4c02-8891-47977f2b6a1a) and CSN 95, but does not have removal tid. It\'s a bug or a result of manual intervention.\'.
 [ 99523 ] {} <Fatal> : Stack trace (when copying this message, always include the lines below):
 [ 99528 ] {} <Fatal> BaseDaemon: ########## Short fault info ############
 [ 99528 ] {} <Fatal> BaseDaemon: (version 24.11.1.60, build id: 23BB6D4F4BE148221995C289F938466E9A04E01F, git hash: dda3b00db5a1967a21a2197fbb3ccf35096fe9d4, architecture: x86_64) (from thread 99523) Received signal 6
 [ 99528 ] {} <Fatal> BaseDaemon: Signal description: Aborted
 [ 99528 ] {} <Fatal> BaseDaemon: 
 [ 99528 ] {} <Fatal> BaseDaemon: Stack trace: 0x0000556879387d1d 0x0000556879724ae2 0x00005568714358f6 0x0000556871435e16 0x00007f6766013520 0x00007f67660679fd 0x00007f6766013476 0x00007f6765ff97f3 0x00005568714344ff 0x0000556879344268 0x000055687934555f 0x00005568714b597e 0x0000556883d399cc 0x0000
 [ 99528 ] {} <Fatal> BaseDaemon: ########################################
 [ 99528 ] {} <Fatal> BaseDaemon: (version 24.11.1.60, build id: 23BB6D4F4BE148221995C289F938466E9A04E01F, git hash: dda3b00db5a1967a21a2197fbb3ccf35096fe9d4) (from thread 99523) (no query) Received signal Aborted (6)
 [ 99528 ] {} <Fatal> BaseDaemon: 
 [ 99528 ] {} <Fatal> BaseDaemon: Stack trace: 0x0000556879387d1d 0x0000556879724ae2 0x00005568714358f6 0x0000556871435e16 0x00007f6766013520 0x00007f67660679fd 0x00007f6766013476 0x00007f6765ff97f3 0x00005568714344ff 0x0000556879344268 0x000055687934555f 0x00005568714b597e 0x0000556883d399cc 0x0000
 [ 99528 ] {} <Fatal> BaseDaemon: 0.0. inlined from ./build_docker/./src/Common/StackTrace.cpp:380: StackTrace::tryCapture()
 [ 99528 ] {} <Fatal> BaseDaemon: 0. ./build_docker/./src/Common/StackTrace.cpp:349: StackTrace::StackTrace(ucontext_t const&) @ 0x000000000f630d1d
 [ 99528 ] {} <Fatal> BaseDaemon: 1. ./build_docker/./src/Common/SignalHandlers.cpp:85: signalHandler(int, siginfo_t*, void*) @ 0x000000000f9cdae2
 [ 99528 ] {} <Fatal> BaseDaemon: 2. __tsan::CallUserSignalHandler(__tsan::ThreadState*, bool, bool, int, __sanitizer::__sanitizer_siginfo*, void*) @ 0x00000000076de8f6
 [ 99528 ] {} <Fatal> BaseDaemon: 3. sighandler(int, __sanitizer::__sanitizer_siginfo*, void*) @ 0x00000000076dee16
 [ 99528 ] {} <Fatal> BaseDaemon: 4. ? @ 0x00007f6766013520
 [ 99528 ] {} <Fatal> BaseDaemon: 5. ? @ 0x00007f67660679fd
 [ 99528 ] {} <Fatal> BaseDaemon: 6. ? @ 0x00007f6766013476
 [ 99528 ] {} <Fatal> BaseDaemon: 7. ? @ 0x00007f6765ff97f3
 [ 99528 ] {} <Fatal> BaseDaemon: 8. __interceptor_abort @ 0x00000000076dd4ff
 [ 99528 ] {} <Fatal> BaseDaemon: 9. ./build_docker/./src/Common/Exception.cpp:48: DB::abortOnFailedAssertion(String const&, void* const*, unsigned long, unsigned long) @ 0x000000000f5ed268
 [ 99528 ] {} <Fatal> BaseDaemon: 10.0. inlined from ./build_docker/./src/Common/Exception.cpp:71: DB::handle_error_code(String const&, int, bool, std::vector<void*, std::allocator<void*>> const&)
 [ 99528 ] {} <Fatal> BaseDaemon: 10. ./build_docker/./src/Common/Exception.cpp:115: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x000000000f5ee55f
 [ 99528 ] {} <Fatal> BaseDaemon: 11. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000775e97e
 [ 99528 ] {} <Fatal> BaseDaemon: 12. ./src/Common/Exception.h:128: DB::Exception::Exception<String const&, DB::TransactionID&, unsigned long&>(int, FormatStringHelperImpl<std::type_identity<String const&>::type, std::type_identity<DB::TransactionID&>::type, std::type_identity<unsigned long&>::type>
 [ 99528 ] {} <Fatal> BaseDaemon: 13. ./build_docker/./src/Storages/MergeTree/MergeTreeData.cpp:1405: DB::preparePartForRemoval(std::shared_ptr<DB::IMergeTreeDataPart> const&) @ 0x0000000019f32556
 [ 99528 ] {} <Fatal> BaseDaemon: 14.0. inlined from ./build_docker/./src/Storages/MergeTree/MergeTreeData.cpp:2207: operator()
 [ 99528 ] {} <Fatal> BaseDaemon: 14.1. inlined from ./contrib/llvm-project/libcxx/include/__functional/invoke.h:394: ?
 [ 99528 ] {} <Fatal> BaseDaemon: 14.2. inlined from ./contrib/llvm-project/libcxx/include/__functional/invoke.h:479: ?
 [ 99528 ] {} <Fatal> BaseDaemon: 14.3. inlined from ./contrib/llvm-project/libcxx/include/__functional/function.h:235: ?
 [ 99528 ] {} <Fatal> BaseDaemon: 14. ./contrib/llvm-project/libcxx/include/__functional/function.h:716: ? @ 0x0000000019fd5c77
 [ 99528 ] {} <Fatal> BaseDaemon: 15.0. inlined from ./contrib/llvm-project/libcxx/include/__functional/function.h:848: ?
 [ 99528 ] {} <Fatal> BaseDaemon: 15.1. inlined from ./contrib/llvm-project/libcxx/include/__functional/function.h:1197: ?
 [ 99528 ] {} <Fatal> BaseDaemon: 15. ./src/Common/threadPoolCallbackRunner.h:160: DB::ThreadPoolCallbackRunnerLocal<void, ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>, std::function<void ()>>::operator()(std::function<void ()>&&, Priority)::\'lambda\'()::operator()() @ 0x0000000015c0ea98
 [ 99528 ] {} <Fatal> BaseDaemon: 16.0. inlined from ./contrib/llvm-project/libcxx/include/__functional/invoke.h:394: ?
 [ 99528 ] {} <Fatal> BaseDaemon: 16. ./contrib/llvm-project/libcxx/include/future:1694: std::__packaged_task_func<DB::ThreadPoolCallbackRunnerLocal<void, ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>, std::function<void ()>>::operator()(std::function<void ()>&&, Priority)::\'lambda\'(), std::
 [ 99528 ] {} <Fatal> BaseDaemon: 17.0. inlined from ./contrib/llvm-project/libcxx/include/future:1876: std::__packaged_task_function<void ()>::operator()() const
 [ 99528 ] {} <Fatal> BaseDaemon: 17. ./contrib/llvm-project/libcxx/include/future:2068: std::packaged_task<void ()>::operator()() @ 0x000000000fde5055
 [ 99528 ] {} <Fatal> BaseDaemon: 18.0. inlined from ./src/Common/threadPoolCallbackRunner.h:167: operator()
 [ 99528 ] {} <Fatal> BaseDaemon: 18.1. inlined from ./contrib/llvm-project/libcxx/include/__functional/invoke.h:394: ?
 [ 99528 ] {} <Fatal> BaseDaemon: 18.2. inlined from ./contrib/llvm-project/libcxx/include/__functional/invoke.h:479: ?
 [ 99528 ] {} <Fatal> BaseDaemon: 18.3. inlined from ./contrib/llvm-project/libcxx/include/__functional/function.h:235: ?
 [ 99528 ] {} <Fatal> BaseDaemon: 18. ./contrib/llvm-project/libcxx/include/__functional/function.h:716: ? @ 0x0000000015c0fbad
 [ 99528 ] {} <Fatal> BaseDaemon: 19.0. inlined from ./contrib/llvm-project/libcxx/include/__functional/function.h:848: ?
 [ 99528 ] {} <Fatal> BaseDaemon: 19.1. inlined from ./contrib/llvm-project/libcxx/include/__functional/function.h:1197: ?
 [ 99528 ] {} <Fatal> BaseDaemon: 19. ./build_docker/./src/Common/ThreadPool.cpp:775: ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>::ThreadFromThreadPool::worker() @ 0x000000000f6fba08
 [ 99528 ] {} <Fatal> BaseDaemon: 20.0. inlined from ./contrib/llvm-project/libcxx/include/__functional/invoke.h:359: ?
 [ 99528 ] {} <Fatal> BaseDaemon: 20.1. inlined from ./contrib/llvm-project/libcxx/include/tuple:1789: decltype(auto) std::__apply_tuple_impl[abi:v15007]<void (ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>::ThreadFromThreadPool::*&)(), std::tuple<ThreadPoolImpl<ThreadFromGlobalPoolImpl<false
 [ 99528 ] {} <Fatal> BaseDaemon: 20.2. inlined from ./contrib/llvm-project/libcxx/include/tuple:1798: decltype(auto) std::apply[abi:v15007]<void (ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>::ThreadFromThreadPool::*&)(), std::tuple<ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>::Thr
 [ 99528 ] {} <Fatal> BaseDaemon: 20. ./src/Common/ThreadPool.h:311: ThreadFromGlobalPoolImpl<false, true>::ThreadFromGlobalPoolImpl<void (ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>::ThreadFromThreadPool::*)(), ThreadPoolImpl<ThreadFromGlobalPoolImpl<false, true>>::ThreadFromThreadPool*>(
 [ 99528 ] {} <Fatal> BaseDaemon: 21.0. inlined from ./contrib/llvm-project/libcxx/include/__functional/invoke.h:394: ?
 [ 99528 ] {} <Fatal> BaseDaemon: 21.1. inlined from ./contrib/llvm-project/libcxx/include/__functional/invoke.h:479: ?
 [ 99528 ] {} <Fatal> BaseDaemon: 21.2. inlined from ./contrib/llvm-project/libcxx/include/__functional/function.h:235: ?
 [ 99528 ] {} <Fatal> BaseDaemon: 21. ./contrib/llvm-project/libcxx/include/__functional/function.h:716: ? @ 0x000000000f703302
 [ 99528 ] {} <Fatal> BaseDaemon: 22.0. inlined from ./contrib/llvm-project/libcxx/include/__functional/function.h:848: ?
 [ 99528 ] {} <Fatal> BaseDaemon: 22.1. inlined from ./contrib/llvm-project/libcxx/include/__functional/function.h:1197: ?
 [ 99528 ] {} <Fatal> BaseDaemon: 22. ./build_docker/./src/Common/ThreadPool.cpp:785: ThreadPoolImpl<std::thread>::ThreadFromThreadPool::worker() @ 0x000000000f6f857e
 [ 99528 ] {} <Fatal> BaseDaemon: 23.0. inlined from ./contrib/llvm-project/libcxx/include/__functional/invoke.h:359: ?
 [ 99528 ] {} <Fatal> BaseDaemon: 23.1. inlined from ./contrib/llvm-project/libcxx/include/thread:284: void std::__thread_execute[abi:v15007]<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void (ThreadPoolImpl<std::thread>::ThreadFromThreadPool::*)(), ThreadPoolImp
 [ 99528 ] {} <Fatal> BaseDaemon: 23. ./contrib/llvm-project/libcxx/include/thread:295: void* std::__thread_proxy[abi:v15007]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void (ThreadPoolImpl<std::thread>::ThreadFromThreadPool::*)(), ThreadPoolImpl<std
 [ 99528 ] {} <Fatal> BaseDaemon: 24. __tsan_thread_start_func @ 0x00000000076d6f2f
 [ 99528 ] {} <Fatal> BaseDaemon: 25. ? @ 0x00007f6766065ac3
 [ 99528 ] {} <Fatal> BaseDaemon: 26. ? @ 0x00007f67660f7850
 [ 99528 ] {} <Fatal> BaseDaemon: Integrity check of the executable skipped because the reference checksum could not be read.
 [ 99528 ] {} <Fatal> BaseDaemon: This ClickHouse version is not official and should be upgraded to the official build.
 [ 98725 ] {} <Fatal> Application: Child process was terminated by signal 6.
 [ 99523 ] {} <Fatal> : Logical error: \'Data part 202410_1_42_8 is Outdated and has creation TID (94, 40, 3ce64a6c-c10e-4c02-8891-47977f2b6a1a) and CSN 95, but does not have removal tid. It\'s a bug or a result of manual intervention.\'.
 [ 99523 ] {} <Fatal> : Stack trace (when copying this message, always include the lines below):
 [ 99528 ] {} <Fatal> BaseDaemon: ########## Short fault info ############
 [ 99528 ] {} <Fatal> BaseDaemon: (version 24.11.1.60, build id: 23BB6D4F4BE148221995C289F938466E9A04E01F, git hash: dda3b00db5a1967a21a2197fbb3ccf35096fe9d4, architecture: x86_64) (from thread 99523) Received signal 6
 [ 99528 ] {} <Fatal> BaseDaemon: Signal description: Aborted
 [ 99528 ] {} <Fatal> BaseDaemon: 
 [ 99528 ] {} <Fatal> BaseDaemon: Stack trace: 0x0000556879387d1d 0x0000556879724ae2 0x00005568714358f6 0x0000556871435e16 0x00007f6766013520 0x00007f67660679fd 0x00007f6766013476 0x00007f6765ff97f3 0x00005568714344ff 0x0000556879344268 0x000055687934555f 0x00005568714b597e 0x0000556883d399cc 0x0000
 [ 99528 ] {} <Fatal> BaseDaemon: ########################################
 [ 99528 ] {} <Fatal> BaseDaemon: (version 24.11.1.60, build id: 23BB6D4F4BE148221995C289F938466E9A04E01F, git hash: dda3b00db5a1967a21a2197fbb3ccf35096fe9d4) (from thread 99523) (no query) Received signal Aborted (6)
 [ 99528 ] {} <Fatal> BaseDaemon: 
 [ 99528 ] {} <Fatal> BaseDaemon: Stack trace: 0x0000556879387d1d 0x0000556879724ae2 0x00005568714358f6 0x0000556871435e16 0x00007f6766013520 0x00007f67660679fd 0x00007f6766013476 0x00007f6765ff97f3 0x00005568714344ff 0x0000556879344268 0x000055687934555f 0x00005568714b597e 0x0000556883d399cc 0x0000
 [ 99528 ] {} <Fatal> BaseDaemon: 0.0. inlined from ./build_docker/./src/Common/StackTrace.cpp:380: StackTrace::tryCapture()
 [ 99528 ] {} <Fatal> BaseDaemon: 0. ./build_docker/./src/Common/StackTrace.cpp:349: StackTrace::StackTrace(ucontext_t const&) @ 0x000000000f630d1d
 [ 99528 ] {} <Fatal> BaseDaemon: 1. ./build_docker/./src/Common/SignalHandlers.cpp:85: signalHandler(int, siginfo_t*, void*) @ 0x000000000f9cdae2
 [ 99528 ] {} <Fatal> BaseDaemon: 2. __tsan::CallUserSignalHandler(__tsan::ThreadState*, bool, bool, int, __sanitizer::__sanitizer_siginfo*, void*) @ 0x00000000076de8f6
 [ 99528 ] {} <Fatal> BaseDaemon: 3. sighandler(int, __sanitizer::__sanitizer_siginfo*, void*) @ 0x00000000076dee16
 [ 99528 ] {} <Fatal> BaseDaemon: 4. ? @ 0x00007f6766013520
 [ 99528 ] {} <Fatal> BaseDaemon: 5. ? @ 0x00007f67660679fd
 [ 99528 ] {} <Fatal> BaseDaemon: 6. ? @ 0x00007f6766013476
 [ 99528 ] {} <Fatal> BaseDaemon: 7. ? @ 0x00007f6765ff97f3
 [ 99528 ] {} <Fatal> BaseDaemon: 8. __interceptor_abort @ 0x00000000076dd4ff
 [ 99528 ] {} <Fatal> BaseDaemon: 9. ./build_docker/./src/Common/Exception.cpp:48: DB::abortOnFailedAssertion(String const&, void* const*, unsigned long, unsigned long) @ 0x000000000f5ed268
 [ 99528 ] {} <Fatal> BaseDaemon: 10.0. inlined from ./build_docker/./src/Common/Exception.cpp:71: DB::handle_error_code(String const&, int, bool, std::vector<void*, std::allocator<void*>> const&)
 [ 99528 ] {} <Fatal> BaseDaemon: 10. ./build_docker/./src/Common/Exception.cpp:115: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x000000000f5ee55f
 [ 99528 ] {} <Fatal> BaseDaemon: 11. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000775e97e
 [ 99528 ] {} <Fatal> BaseDaemon: 12. ./src/Common/Exception.h:128: DB::Exception::Exception<String const&, DB::TransactionID&, unsigned long&>(int, FormatStringHelperImpl<std::type_identity<String const&>::type, std::type_identity<DB::TransactionID&>::type, std::type_identity<unsigned long&>::type>
 [ 99528 ] {} <Fatal> BaseDaemon: 13. ./build_docker/./src/Storages/MergeTree/MergeTreeData.cpp:1405: DB::preparePartForRemoval(std::shared_ptr<DB::IMergeTreeDataPart> const&) @ 0x0000000019f32556
 [ 99528 ] {} <Fatal> BaseDaemon: 14.0. inlined from ./build_docker/./src/Storages/MergeTree/MergeTreeData.cpp:2207: operator()
 [ 99528 ] {} <Fatal> BaseDaemon: 14.1. inlined from ./contrib/llvm-project/libcxx/include/__functional/invoke.h:394: ?
 [ 99528 ] {} <Fatal> BaseDaemon: 14.2. inlined from ./contrib/llvm-project/libcxx/include/__functional/invoke.h:479: ?
 [ 99528 ] {} <Fatal> BaseDaemon: 14.3. inlined from ./contrib/llvm-project/libcxx/include/__functional/function.h:235: ?
 [ 99528 ] {} <Fatal> BaseDaemon: 14. ./contrib/llvm-project/libcxx/include/__functional/function.h:716: ? @ 0x0000000019fd5c77
 [ 99528 ] {} <Fatal> BaseDaemon: 15.0. inlined from ./contrib/llvm-project/libcxx/include/__functional/function.h:848: ?
```
</issue>

I need you to solve the provided issue by generating a code fix that can be applied directly to the repository

Respond below:
