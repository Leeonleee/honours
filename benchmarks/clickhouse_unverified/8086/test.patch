diff --git a/dbms/tests/performance/great_circle_dist.xml b/dbms/tests/performance/great_circle_dist.xml
index aa2096f183d0..99382543d606 100644
--- a/dbms/tests/performance/great_circle_dist.xml
+++ b/dbms/tests/performance/great_circle_dist.xml
@@ -9,8 +9,8 @@
     </stop_conditions>
 
     <!-- lon [-180; 180], lat [-90; 90] -->
-    <query>SELECT count() FROM system.numbers WHERE NOT ignore(greatCircleDistance((rand() % 360) * 1. - 180, (number % 150) * 1.2 - 90, (number % 360) + toFloat64(rand()) / 4294967296 - 180, (rand() % 180) * 1. - 90))</query>
+    <query>SELECT count() FROM system.numbers WHERE NOT ignore(greatCircleDistance((rand(1) % 360) * 1. - 180, (number % 150) * 1.2 - 90, (number % 360) + toFloat64(rand(2)) / 4294967296 - 180, (rand(3) % 180) * 1. - 90))</query>
     <!-- 55.755830, 37.617780 is center of Moscow -->
-    <query>SELECT count() FROM system.numbers WHERE NOT ignore(greatCircleDistance(55. + toFloat64(rand()) / 4294967296, 37. + toFloat64(rand()) / 4294967296, 55. + toFloat64(rand()) / 4294967296, 37. + toFloat64(rand()) / 4294967296))</query>
+    <query>SELECT count() FROM system.numbers WHERE NOT ignore(greatCircleDistance(55. + toFloat64(rand(1)) / 4294967296, 37. + toFloat64(rand(2)) / 4294967296, 55. + toFloat64(rand(3)) / 4294967296, 37. + toFloat64(rand(4)) / 4294967296))</query>
 </test>
 
diff --git a/dbms/tests/queries/0_stateless/01043_geo_distance.reference b/dbms/tests/queries/0_stateless/01043_geo_distance.reference
new file mode 100644
index 000000000000..d9712b93888f
--- /dev/null
+++ b/dbms/tests/queries/0_stateless/01043_geo_distance.reference
@@ -0,0 +1,8 @@
+111194.93
+111194.93
+110567.33
+111699.25
+10007543
+10007543
+10007543
+10001780
diff --git a/dbms/tests/queries/0_stateless/01043_geo_distance.sql b/dbms/tests/queries/0_stateless/01043_geo_distance.sql
new file mode 100644
index 000000000000..c1fb29b9eb7b
--- /dev/null
+++ b/dbms/tests/queries/0_stateless/01043_geo_distance.sql
@@ -0,0 +1,11 @@
+SELECT greatCircleDistance(0., 0., 0., 1.);
+SELECT greatCircleDistance(0., 89., 0, 90.);
+
+SELECT geoDistance(0., 0., 0., 1.);
+SELECT geoDistance(0., 89., 0., 90.);
+
+SELECT greatCircleDistance(0., 0., 90., 0.);
+SELECT greatCircleDistance(0., 0., 0., 90.);
+
+SELECT geoDistance(0., 0., 90., 0.);
+SELECT geoDistance(0., 0., 0., 90.);
