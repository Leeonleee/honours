diff --git a/src/Common/tests/gtest_DateLUTImpl.cpp b/src/Common/tests/gtest_DateLUTImpl.cpp
index 49013625ed34..aca17ae4f93c 100644
--- a/src/Common/tests/gtest_DateLUTImpl.cpp
+++ b/src/Common/tests/gtest_DateLUTImpl.cpp
@@ -134,6 +134,7 @@ TEST(DateLUTTest, TimeValuesInMiddleOfRange)
     EXPECT_EQ(lut.toRelativeMonthNum(time), 24237 /*unsigned*/);
     EXPECT_EQ(lut.toRelativeQuarterNum(time), 8078 /*unsigned*/);
     EXPECT_EQ(lut.toRelativeHourNum(time), 435736 /*time_t*/);
+    EXPECT_EQ(lut.toStableRelativeHourNum(time), 435757 /*time_t*/);
     EXPECT_EQ(lut.toRelativeMinuteNum(time), 26144180 /*time_t*/);
     EXPECT_EQ(lut.toStartOfMinuteInterval(time, 6), 1568650680 /*time_t*/);
     EXPECT_EQ(lut.toStartOfSecondInterval(time, 7), 1568650811 /*time_t*/);
@@ -196,6 +197,7 @@ TEST(DateLUTTest, TimeValuesAtLeftBoderOfRange)
     EXPECT_EQ(lut.toRelativeMonthNum(time), 23641 /*unsigned*/); // ?
     EXPECT_EQ(lut.toRelativeQuarterNum(time), 7880 /*unsigned*/); // ?
     EXPECT_EQ(lut.toRelativeHourNum(time), 0 /*time_t*/);
+    EXPECT_EQ(lut.toStableRelativeHourNum(time), 24 /*time_t*/);
     EXPECT_EQ(lut.toRelativeMinuteNum(time), 0 /*time_t*/);
     EXPECT_EQ(lut.toStartOfMinuteInterval(time, 6), 0 /*time_t*/);
     EXPECT_EQ(lut.toStartOfSecondInterval(time, 7), 0 /*time_t*/);
@@ -259,6 +261,7 @@ TEST(DateLUTTest, TimeValuesAtRightBoderOfRangeOfOldLUT)
     EXPECT_EQ(lut.toRelativeMonthNum(time), 25273 /*unsigned*/);
     EXPECT_EQ(lut.toRelativeQuarterNum(time), 8424 /*unsigned*/);
     EXPECT_EQ(lut.toRelativeHourNum(time), 1192873 /*time_t*/);
+    EXPECT_EQ(lut.toStableRelativeHourNum(time), 1192897 /*time_t*/);
     EXPECT_EQ(lut.toRelativeMinuteNum(time), 71572397 /*time_t*/);
     EXPECT_EQ(lut.toStartOfMinuteInterval(time, 6), 4294343520 /*time_t*/);
     EXPECT_EQ(lut.toStartOfSecondInterval(time, 7), 4294343872 /*time_t*/);
diff --git a/tests/queries/0_stateless/02457_datediff_via_unix_epoch.reference b/tests/queries/0_stateless/02457_datediff_via_unix_epoch.reference
new file mode 100644
index 000000000000..ba12c868037b
--- /dev/null
+++ b/tests/queries/0_stateless/02457_datediff_via_unix_epoch.reference
@@ -0,0 +1,16 @@
+year	1
+year	1
+quarter	1
+quarter	1
+month	1
+month	1
+week	1
+week	1
+day	11
+day	11
+hour	264
+hour	264
+minute	1440
+minute	20
+second	86400
+second	1200
diff --git a/tests/queries/0_stateless/02457_datediff_via_unix_epoch.sql b/tests/queries/0_stateless/02457_datediff_via_unix_epoch.sql
new file mode 100644
index 000000000000..796b4cc6e8f6
--- /dev/null
+++ b/tests/queries/0_stateless/02457_datediff_via_unix_epoch.sql
@@ -0,0 +1,23 @@
+select 'year', date_diff('year', toDate32('1969-12-25'), toDate32('1970-01-05'));
+select 'year', date_diff('year', toDateTime64('1969-12-25 10:00:00.000', 3), toDateTime64('1970-01-05 10:00:00.000', 3));
+
+select 'quarter', date_diff('quarter', toDate32('1969-12-25'), toDate32('1970-01-05'));
+select 'quarter', date_diff('quarter', toDateTime64('1969-12-25 10:00:00.000', 3), toDateTime64('1970-01-05 10:00:00.000', 3));
+
+select 'month', date_diff('month', toDate32('1969-12-25'), toDate32('1970-01-05'));
+select 'month', date_diff('month', toDateTime64('1969-12-25 10:00:00.000', 3), toDateTime64('1970-01-05 10:00:00.000', 3));
+
+select 'week', date_diff('week', toDate32('1969-12-25'), toDate32('1970-01-05'));
+select 'week', date_diff('week', toDateTime64('1969-12-25 10:00:00.000', 3), toDateTime64('1970-01-05 10:00:00.000', 3));
+
+select 'day', date_diff('day', toDate32('1969-12-25'), toDate32('1970-01-05'));
+select 'day', date_diff('day', toDateTime64('1969-12-25 10:00:00.000', 3), toDateTime64('1970-01-05 10:00:00.000', 3));
+
+select 'hour', date_diff('hour', toDate32('1969-12-25'), toDate32('1970-01-05'));
+select 'hour', date_diff('hour', toDateTime64('1969-12-25 10:00:00.000', 3), toDateTime64('1970-01-05 10:00:00.000', 3));
+
+select 'minute', date_diff('minute', toDate32('1969-12-31'), toDate32('1970-01-01'));
+select 'minute', date_diff('minute', toDateTime64('1969-12-31 23:50:00.000', 3), toDateTime64('1970-01-01 00:10:00.000', 3));
+
+select 'second', date_diff('second', toDate32('1969-12-31'), toDate32('1970-01-01'));
+select 'second', date_diff('second', toDateTime64('1969-12-31 23:50:00.000', 3), toDateTime64('1970-01-01 00:10:00.000', 3));
diff --git a/tests/queries/0_stateless/02458_datediff_date32.reference b/tests/queries/0_stateless/02458_datediff_date32.reference
new file mode 100644
index 000000000000..67bfa895199a
--- /dev/null
+++ b/tests/queries/0_stateless/02458_datediff_date32.reference
@@ -0,0 +1,169 @@
+-- { echo }
+
+-- Date32 vs Date32
+SELECT dateDiff('second', toDate32('1900-01-01'), toDate32('1900-01-02'));
+86400
+SELECT dateDiff('minute', toDate32('1900-01-01'), toDate32('1900-01-02'));
+1440
+SELECT dateDiff('hour', toDate32('1900-01-01'), toDate32('1900-01-02'));
+24
+SELECT dateDiff('day', toDate32('1900-01-01'), toDate32('1900-01-02'));
+1
+SELECT dateDiff('week', toDate32('1900-01-01'), toDate32('1900-01-08'));
+1
+SELECT dateDiff('month', toDate32('1900-01-01'), toDate32('1900-02-01'));
+1
+SELECT dateDiff('quarter', toDate32('1900-01-01'), toDate32('1900-04-01'));
+1
+SELECT dateDiff('year', toDate32('1900-01-01'), toDate32('1901-01-01'));
+1
+-- With DateTime64
+-- Date32 vs DateTime64
+SELECT dateDiff('second', toDate32('1900-01-01'), toDateTime64('1900-01-02 00:00:00', 3));
+86400
+SELECT dateDiff('minute', toDate32('1900-01-01'), toDateTime64('1900-01-02 00:00:00', 3));
+1440
+SELECT dateDiff('hour', toDate32('1900-01-01'), toDateTime64('1900-01-02 00:00:00', 3));
+24
+SELECT dateDiff('day', toDate32('1900-01-01'), toDateTime64('1900-01-02 00:00:00', 3));
+1
+SELECT dateDiff('week', toDate32('1900-01-01'), toDateTime64('1900-01-08 00:00:00', 3));
+1
+SELECT dateDiff('month', toDate32('1900-01-01'), toDateTime64('1900-02-01 00:00:00', 3));
+1
+SELECT dateDiff('quarter', toDate32('1900-01-01'), toDateTime64('1900-04-01 00:00:00', 3));
+1
+SELECT dateDiff('year', toDate32('1900-01-01'), toDateTime64('1901-01-01 00:00:00', 3));
+1
+-- DateTime64 vs Date32
+SELECT dateDiff('second', toDateTime64('1900-01-01 00:00:00', 3), toDate32('1900-01-02'));
+86400
+SELECT dateDiff('minute', toDateTime64('1900-01-01 00:00:00', 3), toDate32('1900-01-02'));
+1440
+SELECT dateDiff('hour', toDateTime64('1900-01-01 00:00:00', 3), toDate32('1900-01-02'));
+24
+SELECT dateDiff('day', toDateTime64('1900-01-01 00:00:00', 3), toDate32('1900-01-02'));
+1
+SELECT dateDiff('week', toDateTime64('1900-01-01 00:00:00', 3), toDate32('1900-01-08'));
+1
+SELECT dateDiff('month', toDateTime64('1900-01-01 00:00:00', 3), toDate32('1900-02-01'));
+1
+SELECT dateDiff('quarter', toDateTime64('1900-01-01 00:00:00', 3), toDate32('1900-04-01'));
+1
+SELECT dateDiff('year', toDateTime64('1900-01-01 00:00:00', 3), toDate32('1901-01-01'));
+1
+-- With DateTime
+-- Date32 vs DateTime
+SELECT dateDiff('second', toDate32('2015-08-18'), toDateTime('2015-08-19 00:00:00'));
+86400
+SELECT dateDiff('minute', toDate32('2015-08-18'), toDateTime('2015-08-19 00:00:00'));
+1440
+SELECT dateDiff('hour', toDate32('2015-08-18'), toDateTime('2015-08-19 00:00:00'));
+24
+SELECT dateDiff('day', toDate32('2015-08-18'), toDateTime('2015-08-19 00:00:00'));
+1
+SELECT dateDiff('week', toDate32('2015-08-18'), toDateTime('2015-08-25 00:00:00'));
+1
+SELECT dateDiff('month', toDate32('2015-08-18'), toDateTime('2015-09-18 00:00:00'));
+1
+SELECT dateDiff('quarter', toDate32('2015-08-18'), toDateTime('2015-11-18 00:00:00'));
+1
+SELECT dateDiff('year', toDate32('2015-08-18'), toDateTime('2016-08-18 00:00:00'));
+1
+-- DateTime vs Date32
+SELECT dateDiff('second', toDateTime('2015-08-18 00:00:00'), toDate32('2015-08-19'));
+86400
+SELECT dateDiff('minute', toDateTime('2015-08-18 00:00:00'), toDate32('2015-08-19'));
+1440
+SELECT dateDiff('hour', toDateTime('2015-08-18 00:00:00'), toDate32('2015-08-19'));
+24
+SELECT dateDiff('day', toDateTime('2015-08-18 00:00:00'), toDate32('2015-08-19'));
+1
+SELECT dateDiff('week', toDateTime('2015-08-18 00:00:00'), toDate32('2015-08-25'));
+1
+SELECT dateDiff('month', toDateTime('2015-08-18 00:00:00'), toDate32('2015-09-18'));
+1
+SELECT dateDiff('quarter', toDateTime('2015-08-18 00:00:00'), toDate32('2015-11-18'));
+1
+SELECT dateDiff('year', toDateTime('2015-08-18 00:00:00'), toDate32('2016-08-18'));
+1
+-- With Date
+-- Date32 vs Date
+SELECT dateDiff('second', toDate32('2015-08-18'), toDate('2015-08-19'));
+86400
+SELECT dateDiff('minute', toDate32('2015-08-18'), toDate('2015-08-19'));
+1440
+SELECT dateDiff('hour', toDate32('2015-08-18'), toDate('2015-08-19'));
+24
+SELECT dateDiff('day', toDate32('2015-08-18'), toDate('2015-08-19'));
+1
+SELECT dateDiff('week', toDate32('2015-08-18'), toDate('2015-08-25'));
+1
+SELECT dateDiff('month', toDate32('2015-08-18'), toDate('2015-09-18'));
+1
+SELECT dateDiff('quarter', toDate32('2015-08-18'), toDate('2015-11-18'));
+1
+SELECT dateDiff('year', toDate32('2015-08-18'), toDate('2016-08-18'));
+1
+-- Date vs Date32
+SELECT dateDiff('second', toDate('2015-08-18'), toDate32('2015-08-19'));
+86400
+SELECT dateDiff('minute', toDate('2015-08-18'), toDate32('2015-08-19'));
+1440
+SELECT dateDiff('hour', toDate('2015-08-18'), toDate32('2015-08-19'));
+24
+SELECT dateDiff('day', toDate('2015-08-18'), toDate32('2015-08-19'));
+1
+SELECT dateDiff('week', toDate('2015-08-18'), toDate32('2015-08-25'));
+1
+SELECT dateDiff('month', toDate('2015-08-18'), toDate32('2015-09-18'));
+1
+SELECT dateDiff('quarter', toDate('2015-08-18'), toDate32('2015-11-18'));
+1
+SELECT dateDiff('year', toDate('2015-08-18'), toDate32('2016-08-18'));
+1
+-- Const vs non-const columns
+SELECT dateDiff('day', toDate32('1900-01-01'), materialize(toDate32('1900-01-02')));
+1
+SELECT dateDiff('day', toDate32('1900-01-01'), materialize(toDateTime64('1900-01-02 00:00:00', 3)));
+1
+SELECT dateDiff('day', toDateTime64('1900-01-01 00:00:00', 3), materialize(toDate32('1900-01-02')));
+1
+SELECT dateDiff('day', toDate32('2015-08-18'), materialize(toDateTime('2015-08-19 00:00:00')));
+1
+SELECT dateDiff('day', toDateTime('2015-08-18 00:00:00'), materialize(toDate32('2015-08-19')));
+1
+SELECT dateDiff('day', toDate32('2015-08-18'), materialize(toDate('2015-08-19')));
+1
+SELECT dateDiff('day', toDate('2015-08-18'), materialize(toDate32('2015-08-19')));
+1
+-- Non-const vs const columns
+SELECT dateDiff('day', materialize(toDate32('1900-01-01')), toDate32('1900-01-02'));
+1
+SELECT dateDiff('day', materialize(toDate32('1900-01-01')), toDateTime64('1900-01-02 00:00:00', 3));
+1
+SELECT dateDiff('day', materialize(toDateTime64('1900-01-01 00:00:00', 3)), toDate32('1900-01-02'));
+1
+SELECT dateDiff('day', materialize(toDate32('2015-08-18')), toDateTime('2015-08-19 00:00:00'));
+1
+SELECT dateDiff('day', materialize(toDateTime('2015-08-18 00:00:00')), toDate32('2015-08-19'));
+1
+SELECT dateDiff('day', materialize(toDate32('2015-08-18')), toDate('2015-08-19'));
+1
+SELECT dateDiff('day', materialize(toDate('2015-08-18')), toDate32('2015-08-19'));
+1
+-- Non-const vs non-const columns
+SELECT dateDiff('day', materialize(toDate32('1900-01-01')), materialize(toDate32('1900-01-02')));
+1
+SELECT dateDiff('day', materialize(toDate32('1900-01-01')), materialize(toDateTime64('1900-01-02 00:00:00', 3)));
+1
+SELECT dateDiff('day', materialize(toDateTime64('1900-01-01 00:00:00', 3)), materialize(toDate32('1900-01-02')));
+1
+SELECT dateDiff('day', materialize(toDate32('2015-08-18')), materialize(toDateTime('2015-08-19 00:00:00')));
+1
+SELECT dateDiff('day', materialize(toDateTime('2015-08-18 00:00:00')), materialize(toDate32('2015-08-19')));
+1
+SELECT dateDiff('day', materialize(toDate32('2015-08-18')), materialize(toDate('2015-08-19')));
+1
+SELECT dateDiff('day', materialize(toDate('2015-08-18')), materialize(toDate32('2015-08-19')));
+1
diff --git a/tests/queries/0_stateless/02458_datediff_date32.sql b/tests/queries/0_stateless/02458_datediff_date32.sql
new file mode 100644
index 000000000000..4c26e04ac272
--- /dev/null
+++ b/tests/queries/0_stateless/02458_datediff_date32.sql
@@ -0,0 +1,101 @@
+-- { echo }
+
+-- Date32 vs Date32
+SELECT dateDiff('second', toDate32('1900-01-01'), toDate32('1900-01-02'));
+SELECT dateDiff('minute', toDate32('1900-01-01'), toDate32('1900-01-02'));
+SELECT dateDiff('hour', toDate32('1900-01-01'), toDate32('1900-01-02'));
+SELECT dateDiff('day', toDate32('1900-01-01'), toDate32('1900-01-02'));
+SELECT dateDiff('week', toDate32('1900-01-01'), toDate32('1900-01-08'));
+SELECT dateDiff('month', toDate32('1900-01-01'), toDate32('1900-02-01'));
+SELECT dateDiff('quarter', toDate32('1900-01-01'), toDate32('1900-04-01'));
+SELECT dateDiff('year', toDate32('1900-01-01'), toDate32('1901-01-01'));
+
+-- With DateTime64
+-- Date32 vs DateTime64
+SELECT dateDiff('second', toDate32('1900-01-01'), toDateTime64('1900-01-02 00:00:00', 3));
+SELECT dateDiff('minute', toDate32('1900-01-01'), toDateTime64('1900-01-02 00:00:00', 3));
+SELECT dateDiff('hour', toDate32('1900-01-01'), toDateTime64('1900-01-02 00:00:00', 3));
+SELECT dateDiff('day', toDate32('1900-01-01'), toDateTime64('1900-01-02 00:00:00', 3));
+SELECT dateDiff('week', toDate32('1900-01-01'), toDateTime64('1900-01-08 00:00:00', 3));
+SELECT dateDiff('month', toDate32('1900-01-01'), toDateTime64('1900-02-01 00:00:00', 3));
+SELECT dateDiff('quarter', toDate32('1900-01-01'), toDateTime64('1900-04-01 00:00:00', 3));
+SELECT dateDiff('year', toDate32('1900-01-01'), toDateTime64('1901-01-01 00:00:00', 3));
+
+-- DateTime64 vs Date32
+SELECT dateDiff('second', toDateTime64('1900-01-01 00:00:00', 3), toDate32('1900-01-02'));
+SELECT dateDiff('minute', toDateTime64('1900-01-01 00:00:00', 3), toDate32('1900-01-02'));
+SELECT dateDiff('hour', toDateTime64('1900-01-01 00:00:00', 3), toDate32('1900-01-02'));
+SELECT dateDiff('day', toDateTime64('1900-01-01 00:00:00', 3), toDate32('1900-01-02'));
+SELECT dateDiff('week', toDateTime64('1900-01-01 00:00:00', 3), toDate32('1900-01-08'));
+SELECT dateDiff('month', toDateTime64('1900-01-01 00:00:00', 3), toDate32('1900-02-01'));
+SELECT dateDiff('quarter', toDateTime64('1900-01-01 00:00:00', 3), toDate32('1900-04-01'));
+SELECT dateDiff('year', toDateTime64('1900-01-01 00:00:00', 3), toDate32('1901-01-01'));
+
+-- With DateTime
+-- Date32 vs DateTime
+SELECT dateDiff('second', toDate32('2015-08-18'), toDateTime('2015-08-19 00:00:00'));
+SELECT dateDiff('minute', toDate32('2015-08-18'), toDateTime('2015-08-19 00:00:00'));
+SELECT dateDiff('hour', toDate32('2015-08-18'), toDateTime('2015-08-19 00:00:00'));
+SELECT dateDiff('day', toDate32('2015-08-18'), toDateTime('2015-08-19 00:00:00'));
+SELECT dateDiff('week', toDate32('2015-08-18'), toDateTime('2015-08-25 00:00:00'));
+SELECT dateDiff('month', toDate32('2015-08-18'), toDateTime('2015-09-18 00:00:00'));
+SELECT dateDiff('quarter', toDate32('2015-08-18'), toDateTime('2015-11-18 00:00:00'));
+SELECT dateDiff('year', toDate32('2015-08-18'), toDateTime('2016-08-18 00:00:00'));
+
+-- DateTime vs Date32
+SELECT dateDiff('second', toDateTime('2015-08-18 00:00:00'), toDate32('2015-08-19'));
+SELECT dateDiff('minute', toDateTime('2015-08-18 00:00:00'), toDate32('2015-08-19'));
+SELECT dateDiff('hour', toDateTime('2015-08-18 00:00:00'), toDate32('2015-08-19'));
+SELECT dateDiff('day', toDateTime('2015-08-18 00:00:00'), toDate32('2015-08-19'));
+SELECT dateDiff('week', toDateTime('2015-08-18 00:00:00'), toDate32('2015-08-25'));
+SELECT dateDiff('month', toDateTime('2015-08-18 00:00:00'), toDate32('2015-09-18'));
+SELECT dateDiff('quarter', toDateTime('2015-08-18 00:00:00'), toDate32('2015-11-18'));
+SELECT dateDiff('year', toDateTime('2015-08-18 00:00:00'), toDate32('2016-08-18'));
+
+-- With Date
+-- Date32 vs Date
+SELECT dateDiff('second', toDate32('2015-08-18'), toDate('2015-08-19'));
+SELECT dateDiff('minute', toDate32('2015-08-18'), toDate('2015-08-19'));
+SELECT dateDiff('hour', toDate32('2015-08-18'), toDate('2015-08-19'));
+SELECT dateDiff('day', toDate32('2015-08-18'), toDate('2015-08-19'));
+SELECT dateDiff('week', toDate32('2015-08-18'), toDate('2015-08-25'));
+SELECT dateDiff('month', toDate32('2015-08-18'), toDate('2015-09-18'));
+SELECT dateDiff('quarter', toDate32('2015-08-18'), toDate('2015-11-18'));
+SELECT dateDiff('year', toDate32('2015-08-18'), toDate('2016-08-18'));
+
+-- Date vs Date32
+SELECT dateDiff('second', toDate('2015-08-18'), toDate32('2015-08-19'));
+SELECT dateDiff('minute', toDate('2015-08-18'), toDate32('2015-08-19'));
+SELECT dateDiff('hour', toDate('2015-08-18'), toDate32('2015-08-19'));
+SELECT dateDiff('day', toDate('2015-08-18'), toDate32('2015-08-19'));
+SELECT dateDiff('week', toDate('2015-08-18'), toDate32('2015-08-25'));
+SELECT dateDiff('month', toDate('2015-08-18'), toDate32('2015-09-18'));
+SELECT dateDiff('quarter', toDate('2015-08-18'), toDate32('2015-11-18'));
+SELECT dateDiff('year', toDate('2015-08-18'), toDate32('2016-08-18'));
+
+-- Const vs non-const columns
+SELECT dateDiff('day', toDate32('1900-01-01'), materialize(toDate32('1900-01-02')));
+SELECT dateDiff('day', toDate32('1900-01-01'), materialize(toDateTime64('1900-01-02 00:00:00', 3)));
+SELECT dateDiff('day', toDateTime64('1900-01-01 00:00:00', 3), materialize(toDate32('1900-01-02')));
+SELECT dateDiff('day', toDate32('2015-08-18'), materialize(toDateTime('2015-08-19 00:00:00')));
+SELECT dateDiff('day', toDateTime('2015-08-18 00:00:00'), materialize(toDate32('2015-08-19')));
+SELECT dateDiff('day', toDate32('2015-08-18'), materialize(toDate('2015-08-19')));
+SELECT dateDiff('day', toDate('2015-08-18'), materialize(toDate32('2015-08-19')));
+
+-- Non-const vs const columns
+SELECT dateDiff('day', materialize(toDate32('1900-01-01')), toDate32('1900-01-02'));
+SELECT dateDiff('day', materialize(toDate32('1900-01-01')), toDateTime64('1900-01-02 00:00:00', 3));
+SELECT dateDiff('day', materialize(toDateTime64('1900-01-01 00:00:00', 3)), toDate32('1900-01-02'));
+SELECT dateDiff('day', materialize(toDate32('2015-08-18')), toDateTime('2015-08-19 00:00:00'));
+SELECT dateDiff('day', materialize(toDateTime('2015-08-18 00:00:00')), toDate32('2015-08-19'));
+SELECT dateDiff('day', materialize(toDate32('2015-08-18')), toDate('2015-08-19'));
+SELECT dateDiff('day', materialize(toDate('2015-08-18')), toDate32('2015-08-19'));
+
+-- Non-const vs non-const columns
+SELECT dateDiff('day', materialize(toDate32('1900-01-01')), materialize(toDate32('1900-01-02')));
+SELECT dateDiff('day', materialize(toDate32('1900-01-01')), materialize(toDateTime64('1900-01-02 00:00:00', 3)));
+SELECT dateDiff('day', materialize(toDateTime64('1900-01-01 00:00:00', 3)), materialize(toDate32('1900-01-02')));
+SELECT dateDiff('day', materialize(toDate32('2015-08-18')), materialize(toDateTime('2015-08-19 00:00:00')));
+SELECT dateDiff('day', materialize(toDateTime('2015-08-18 00:00:00')), materialize(toDate32('2015-08-19')));
+SELECT dateDiff('day', materialize(toDate32('2015-08-18')), materialize(toDate('2015-08-19')));
+SELECT dateDiff('day', materialize(toDate('2015-08-18')), materialize(toDate32('2015-08-19')));
