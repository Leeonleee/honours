diff --git a/tests/queries/0_stateless/02293_grouping_function.reference b/tests/queries/0_stateless/02293_grouping_function.reference
new file mode 100644
index 000000000000..e71d6812ab58
--- /dev/null
+++ b/tests/queries/0_stateless/02293_grouping_function.reference
@@ -0,0 +1,176 @@
+-- { echoOn }
+SELECT
+    number,
+    grouping(number, number % 2) AS gr
+FROM numbers(10)
+GROUP BY
+    GROUPING SETS (
+        (number),
+        (number % 2)
+    )
+ORDER BY number, gr;
+0	1
+0	1
+0	2
+1	2
+2	2
+3	2
+4	2
+5	2
+6	2
+7	2
+8	2
+9	2
+SELECT
+    number,
+    grouping(number % 2, number) AS gr
+FROM numbers(10)
+GROUP BY
+    GROUPING SETS (
+        (number),
+        (number % 2)
+    )
+ORDER BY number, gr;
+0	1
+0	2
+0	2
+1	1
+2	1
+3	1
+4	1
+5	1
+6	1
+7	1
+8	1
+9	1
+SELECT
+    number,
+    grouping(number, number % 2) = 1 AS gr
+FROM numbers(10)
+GROUP BY
+    GROUPING SETS (
+        (number),
+        (number % 2)
+    )
+ORDER BY number, gr;
+0	0
+0	1
+0	1
+1	0
+2	0
+3	0
+4	0
+5	0
+6	0
+7	0
+8	0
+9	0
+SELECT
+    number
+FROM numbers(10)
+GROUP BY
+    GROUPING SETS (
+        (number),
+        (number % 2)
+    )
+ORDER BY number, grouping(number, number % 2) = 1;
+0
+0
+0
+1
+2
+3
+4
+5
+6
+7
+8
+9
+SELECT
+    number,
+    count(),
+    grouping(number, number % 2) AS gr
+FROM numbers(10)
+GROUP BY
+    GROUPING SETS (
+        (number),
+        (number, number % 2),
+        ()
+    )
+ORDER BY (gr, number);
+0	10	0
+0	1	2
+1	1	2
+2	1	2
+3	1	2
+4	1	2
+5	1	2
+6	1	2
+7	1	2
+8	1	2
+9	1	2
+0	1	3
+1	1	3
+2	1	3
+3	1	3
+4	1	3
+5	1	3
+6	1	3
+7	1	3
+8	1	3
+9	1	3
+SELECT
+    number
+FROM numbers(10)
+GROUP BY
+    GROUPING SETS (
+        (number),
+        (number % 2)
+    )
+HAVING grouping(number, number % 2) = 2
+ORDER BY number
+SETTINGS enable_optimize_predicate_expression = 0;
+0
+1
+2
+3
+4
+5
+6
+7
+8
+9
+SELECT
+    number
+FROM numbers(10)
+GROUP BY
+    GROUPING SETS (
+        (number),
+        (number % 2)
+    )
+HAVING grouping(number, number % 2) = 1
+ORDER BY number
+SETTINGS enable_optimize_predicate_expression = 0;
+0
+0
+SELECT
+    number,
+    GROUPING(number, number % 2) = 1 as gr
+FROM remote('127.0.0.{2,3}', numbers(10))
+GROUP BY
+    GROUPING SETS (
+    (number),
+    (number % 2))
+ORDER BY number, gr;
+0	0
+0	1
+0	1
+1	0
+2	0
+3	0
+4	0
+5	0
+6	0
+7	0
+8	0
+9	0
diff --git a/tests/queries/0_stateless/02293_grouping_function.sql b/tests/queries/0_stateless/02293_grouping_function.sql
new file mode 100644
index 000000000000..169fc09c3244
--- /dev/null
+++ b/tests/queries/0_stateless/02293_grouping_function.sql
@@ -0,0 +1,101 @@
+SELECT
+    number,
+    grouping(number, number % 2, number % 3) AS gr
+FROM numbers(10)
+GROUP BY
+    GROUPING SETS (
+        (number),
+        (number % 2)
+    )
+ORDER BY number, gr; -- { serverError BAD_ARGUMENTS }
+
+-- { echoOn }
+SELECT
+    number,
+    grouping(number, number % 2) AS gr
+FROM numbers(10)
+GROUP BY
+    GROUPING SETS (
+        (number),
+        (number % 2)
+    )
+ORDER BY number, gr;
+
+SELECT
+    number,
+    grouping(number % 2, number) AS gr
+FROM numbers(10)
+GROUP BY
+    GROUPING SETS (
+        (number),
+        (number % 2)
+    )
+ORDER BY number, gr;
+
+SELECT
+    number,
+    grouping(number, number % 2) = 1 AS gr
+FROM numbers(10)
+GROUP BY
+    GROUPING SETS (
+        (number),
+        (number % 2)
+    )
+ORDER BY number, gr;
+
+SELECT
+    number
+FROM numbers(10)
+GROUP BY
+    GROUPING SETS (
+        (number),
+        (number % 2)
+    )
+ORDER BY number, grouping(number, number % 2) = 1;
+
+SELECT
+    number,
+    count(),
+    grouping(number, number % 2) AS gr
+FROM numbers(10)
+GROUP BY
+    GROUPING SETS (
+        (number),
+        (number, number % 2),
+        ()
+    )
+ORDER BY (gr, number);
+
+SELECT
+    number
+FROM numbers(10)
+GROUP BY
+    GROUPING SETS (
+        (number),
+        (number % 2)
+    )
+HAVING grouping(number, number % 2) = 2
+ORDER BY number
+SETTINGS enable_optimize_predicate_expression = 0;
+
+SELECT
+    number
+FROM numbers(10)
+GROUP BY
+    GROUPING SETS (
+        (number),
+        (number % 2)
+    )
+HAVING grouping(number, number % 2) = 1
+ORDER BY number
+SETTINGS enable_optimize_predicate_expression = 0;
+
+SELECT
+    number,
+    GROUPING(number, number % 2) = 1 as gr
+FROM remote('127.0.0.{2,3}', numbers(10))
+GROUP BY
+    GROUPING SETS (
+    (number),
+    (number % 2))
+ORDER BY number, gr;
diff --git a/tests/queries/0_stateless/02293_grouping_function_group_by.reference b/tests/queries/0_stateless/02293_grouping_function_group_by.reference
new file mode 100644
index 000000000000..7f87aecd4bd1
--- /dev/null
+++ b/tests/queries/0_stateless/02293_grouping_function_group_by.reference
@@ -0,0 +1,273 @@
+-- { echoOn }
+SELECT
+    number,
+    grouping(number, number % 2) = 3
+FROM remote('127.0.0.{2,3}', numbers(10))
+GROUP BY
+    number,
+    number % 2
+ORDER BY number;
+0	1
+1	1
+2	1
+3	1
+4	1
+5	1
+6	1
+7	1
+8	1
+9	1
+SELECT
+    number,
+    grouping(number),
+    GROUPING(number % 2)
+FROM remote('127.0.0.{2,3}', numbers(10))
+GROUP BY
+    number,
+    number % 2
+ORDER BY number;
+0	1	1
+1	1	1
+2	1	1
+3	1	1
+4	1	1
+5	1	1
+6	1	1
+7	1	1
+8	1	1
+9	1	1
+SELECT
+    number,
+    grouping(number, number % 2) AS gr
+FROM remote('127.0.0.{2,3}', numbers(10))
+GROUP BY
+    number,
+    number % 2
+    WITH ROLLUP
+ORDER BY
+    number, gr;
+0	0
+0	2
+0	3
+1	2
+1	3
+2	2
+2	3
+3	2
+3	3
+4	2
+4	3
+5	2
+5	3
+6	2
+6	3
+7	2
+7	3
+8	2
+8	3
+9	2
+9	3
+SELECT
+    number,
+    grouping(number, number % 2) AS gr
+FROM remote('127.0.0.{2,3}', numbers(10))
+GROUP BY
+    ROLLUP(number, number % 2)
+ORDER BY
+    number, gr;
+0	0
+0	2
+0	3
+1	2
+1	3
+2	2
+2	3
+3	2
+3	3
+4	2
+4	3
+5	2
+5	3
+6	2
+6	3
+7	2
+7	3
+8	2
+8	3
+9	2
+9	3
+SELECT
+    number,
+    grouping(number, number % 2) AS gr
+FROM remote('127.0.0.{2,3}', numbers(10))
+GROUP BY
+    number,
+    number % 2
+    WITH CUBE
+ORDER BY
+    number, gr;
+0	0
+0	1
+0	1
+0	2
+0	3
+1	2
+1	3
+2	2
+2	3
+3	2
+3	3
+4	2
+4	3
+5	2
+5	3
+6	2
+6	3
+7	2
+7	3
+8	2
+8	3
+9	2
+9	3
+SELECT
+    number,
+    grouping(number, number % 2) AS gr
+FROM remote('127.0.0.{2,3}', numbers(10))
+GROUP BY
+    CUBE(number, number % 2)
+ORDER BY
+    number, gr;
+0	0
+0	1
+0	1
+0	2
+0	3
+1	2
+1	3
+2	2
+2	3
+3	2
+3	3
+4	2
+4	3
+5	2
+5	3
+6	2
+6	3
+7	2
+7	3
+8	2
+8	3
+9	2
+9	3
+SELECT
+    number,
+    grouping(number, number % 2) + 3 as gr
+FROM remote('127.0.0.{2,3}', numbers(10))
+GROUP BY
+    CUBE(number, number % 2)
+HAVING grouping(number) != 0
+ORDER BY
+    number, gr;
+0	5
+0	6
+1	5
+1	6
+2	5
+2	6
+3	5
+3	6
+4	5
+4	6
+5	5
+5	6
+6	5
+6	6
+7	5
+7	6
+8	5
+8	6
+9	5
+9	6
+SELECT
+    number,
+    grouping(number, number % 2) as gr
+FROM remote('127.0.0.{2,3}', numbers(10))
+GROUP BY
+    CUBE(number, number % 2) WITH TOTALS
+HAVING grouping(number) != 0
+ORDER BY
+    number, gr; -- { serverError NOT_IMPLEMENTED }
+SELECT
+    number,
+    grouping(number, number % 2) as gr
+FROM remote('127.0.0.{2,3}', numbers(10))
+GROUP BY
+    CUBE(number, number % 2) WITH TOTALS
+ORDER BY
+    number, gr;
+0	0
+0	1
+0	1
+0	2
+0	3
+1	2
+1	3
+2	2
+2	3
+3	2
+3	3
+4	2
+4	3
+5	2
+5	3
+6	2
+6	3
+7	2
+7	3
+8	2
+8	3
+9	2
+9	3
+
+0	0
+SELECT
+    number,
+    grouping(number, number % 2) as gr
+FROM remote('127.0.0.{2,3}', numbers(10))
+GROUP BY
+    ROLLUP(number, number % 2) WITH TOTALS
+HAVING grouping(number) != 0
+ORDER BY
+    number, gr; -- { serverError NOT_IMPLEMENTED }
+SELECT
+    number,
+    grouping(number, number % 2) as gr
+FROM remote('127.0.0.{2,3}', numbers(10))
+GROUP BY
+    ROLLUP(number, number % 2) WITH TOTALS
+ORDER BY
+    number, gr;
+0	0
+0	2
+0	3
+1	2
+1	3
+2	2
+2	3
+3	2
+3	3
+4	2
+4	3
+5	2
+5	3
+6	2
+6	3
+7	2
+7	3
+8	2
+8	3
+9	2
+9	3
+
+0	0
diff --git a/tests/queries/0_stateless/02293_grouping_function_group_by.sql b/tests/queries/0_stateless/02293_grouping_function_group_by.sql
new file mode 100644
index 000000000000..9bf9d43478b6
--- /dev/null
+++ b/tests/queries/0_stateless/02293_grouping_function_group_by.sql
@@ -0,0 +1,116 @@
+SELECT
+    number,
+    grouping(number, number % 2, number % 3) = 6
+FROM remote('127.0.0.{2,3}', numbers(10))
+GROUP BY
+    number,
+    number % 2
+ORDER BY number; -- { serverError BAD_ARGUMENTS }
+
+-- { echoOn }
+SELECT
+    number,
+    grouping(number, number % 2) = 3
+FROM remote('127.0.0.{2,3}', numbers(10))
+GROUP BY
+    number,
+    number % 2
+ORDER BY number;
+
+SELECT
+    number,
+    grouping(number),
+    GROUPING(number % 2)
+FROM remote('127.0.0.{2,3}', numbers(10))
+GROUP BY
+    number,
+    number % 2
+ORDER BY number;
+
+SELECT
+    number,
+    grouping(number, number % 2) AS gr
+FROM remote('127.0.0.{2,3}', numbers(10))
+GROUP BY
+    number,
+    number % 2
+    WITH ROLLUP
+ORDER BY
+    number, gr;
+
+SELECT
+    number,
+    grouping(number, number % 2) AS gr
+FROM remote('127.0.0.{2,3}', numbers(10))
+GROUP BY
+    ROLLUP(number, number % 2)
+ORDER BY
+    number, gr;
+
+SELECT
+    number,
+    grouping(number, number % 2) AS gr
+FROM remote('127.0.0.{2,3}', numbers(10))
+GROUP BY
+    number,
+    number % 2
+    WITH CUBE
+ORDER BY
+    number, gr;
+
+SELECT
+    number,
+    grouping(number, number % 2) AS gr
+FROM remote('127.0.0.{2,3}', numbers(10))
+GROUP BY
+    CUBE(number, number % 2)
+ORDER BY
+    number, gr;
+
+SELECT
+    number,
+    grouping(number, number % 2) + 3 as gr
+FROM remote('127.0.0.{2,3}', numbers(10))
+GROUP BY
+    CUBE(number, number % 2)
+HAVING grouping(number) != 0
+ORDER BY
+    number, gr;
+
+SELECT
+    number,
+    grouping(number, number % 2) as gr
+FROM remote('127.0.0.{2,3}', numbers(10))
+GROUP BY
+    CUBE(number, number % 2) WITH TOTALS
+HAVING grouping(number) != 0
+ORDER BY
+    number, gr; -- { serverError NOT_IMPLEMENTED }
+
+SELECT
+    number,
+    grouping(number, number % 2) as gr
+FROM remote('127.0.0.{2,3}', numbers(10))
+GROUP BY
+    CUBE(number, number % 2) WITH TOTALS
+ORDER BY
+    number, gr;
+
+SELECT
+    number,
+    grouping(number, number % 2) as gr
+FROM remote('127.0.0.{2,3}', numbers(10))
+GROUP BY
+    ROLLUP(number, number % 2) WITH TOTALS
+HAVING grouping(number) != 0
+ORDER BY
+    number, gr; -- { serverError NOT_IMPLEMENTED }
+
+SELECT
+    number,
+    grouping(number, number % 2) as gr
+FROM remote('127.0.0.{2,3}', numbers(10))
+GROUP BY
+    ROLLUP(number, number % 2) WITH TOTALS
+ORDER BY
+    number, gr;
