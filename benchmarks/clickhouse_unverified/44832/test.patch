diff --git a/tests/queries/0_stateless/01509_output_format_pretty_row_numbers.reference b/tests/queries/0_stateless/01509_output_format_pretty_row_numbers.reference
index 9010c371fdff..a270447ffc9d 100644
--- a/tests/queries/0_stateless/01509_output_format_pretty_row_numbers.reference
+++ b/tests/queries/0_stateless/01509_output_format_pretty_row_numbers.reference
@@ -209,4 +209,284 @@
  7.       6 
  8.       7 
  9.       8 
+10.       9 
+   ┏━━━┓
+   ┃ [1ma[0m ┃
+   ┡━━━┩
+1. │ 1 │
+   └───┘
+   ┏━━━┓
+   ┃ [1ma[0m ┃
+   ┡━━━┩
+2. │ 2 │
+   └───┘
+   ┌─[1ma[0m─┐
+1. │ 1 │
+   └───┘
+   ┌─[1ma[0m─┐
+2. │ 2 │
+   └───┘
+   ┌─[1ma[0m─┐
+1. │ 1 │
+2. │ 2 │
+   └───┘
+   ┏━━━┓
+   ┃ a ┃
+   ┡━━━┩
+1. │ 1 │
+   └───┘
+   ┏━━━┓
+   ┃ a ┃
+   ┡━━━┩
+2. │ 2 │
+   └───┘
+   ┌─a─┐
+1. │ 1 │
+   └───┘
+   ┌─a─┐
+2. │ 2 │
+   └───┘
+    [1ma[0m
+
+1.  1 
+    [1ma[0m
+
+2.  2 
+    a
+
+1.  1 
+    a
+
+2.  2 
+   ┏━━━━━━━━┓
+   ┃ [1mnumber[0m ┃
+   ┡━━━━━━━━┩
+1. │      0 │
+   └────────┘
+   ┏━━━━━━━━┓
+   ┃ [1mnumber[0m ┃
+   ┡━━━━━━━━┩
+2. │      1 │
+   └────────┘
+   ┏━━━━━━━━┓
+   ┃ [1mnumber[0m ┃
+   ┡━━━━━━━━┩
+3. │      2 │
+   └────────┘
+   ┏━━━━━━━━┓
+   ┃ [1mnumber[0m ┃
+   ┡━━━━━━━━┩
+4. │      3 │
+   └────────┘
+   ┏━━━━━━━━┓
+   ┃ [1mnumber[0m ┃
+   ┡━━━━━━━━┩
+5. │      4 │
+   └────────┘
+   ┏━━━━━━━━┓
+   ┃ [1mnumber[0m ┃
+   ┡━━━━━━━━┩
+6. │      5 │
+   └────────┘
+   ┏━━━━━━━━┓
+   ┃ [1mnumber[0m ┃
+   ┡━━━━━━━━┩
+7. │      6 │
+   └────────┘
+   ┏━━━━━━━━┓
+   ┃ [1mnumber[0m ┃
+   ┡━━━━━━━━┩
+8. │      7 │
+   └────────┘
+   ┏━━━━━━━━┓
+   ┃ [1mnumber[0m ┃
+   ┡━━━━━━━━┩
+9. │      8 │
+   └────────┘
+    ┏━━━━━━━━┓
+    ┃ [1mnumber[0m ┃
+    ┡━━━━━━━━┩
+10. │      9 │
+    └────────┘
+   ┌─[1mnumber[0m─┐
+1. │      0 │
+   └────────┘
+   ┌─[1mnumber[0m─┐
+2. │      1 │
+   └────────┘
+   ┌─[1mnumber[0m─┐
+3. │      2 │
+   └────────┘
+   ┌─[1mnumber[0m─┐
+4. │      3 │
+   └────────┘
+   ┌─[1mnumber[0m─┐
+5. │      4 │
+   └────────┘
+   ┌─[1mnumber[0m─┐
+6. │      5 │
+   └────────┘
+   ┌─[1mnumber[0m─┐
+7. │      6 │
+   └────────┘
+   ┌─[1mnumber[0m─┐
+8. │      7 │
+   └────────┘
+   ┌─[1mnumber[0m─┐
+9. │      8 │
+   └────────┘
+    ┌─[1mnumber[0m─┐
+10. │      9 │
+    └────────┘
+    ┌─[1mnumber[0m─┐
+ 1. │      0 │
+ 2. │      1 │
+ 3. │      2 │
+ 4. │      3 │
+ 5. │      4 │
+ 6. │      5 │
+ 7. │      6 │
+ 8. │      7 │
+ 9. │      8 │
+10. │      9 │
+    └────────┘
+   ┏━━━━━━━━┓
+   ┃ number ┃
+   ┡━━━━━━━━┩
+1. │      0 │
+   └────────┘
+   ┏━━━━━━━━┓
+   ┃ number ┃
+   ┡━━━━━━━━┩
+2. │      1 │
+   └────────┘
+   ┏━━━━━━━━┓
+   ┃ number ┃
+   ┡━━━━━━━━┩
+3. │      2 │
+   └────────┘
+   ┏━━━━━━━━┓
+   ┃ number ┃
+   ┡━━━━━━━━┩
+4. │      3 │
+   └────────┘
+   ┏━━━━━━━━┓
+   ┃ number ┃
+   ┡━━━━━━━━┩
+5. │      4 │
+   └────────┘
+   ┏━━━━━━━━┓
+   ┃ number ┃
+   ┡━━━━━━━━┩
+6. │      5 │
+   └────────┘
+   ┏━━━━━━━━┓
+   ┃ number ┃
+   ┡━━━━━━━━┩
+7. │      6 │
+   └────────┘
+   ┏━━━━━━━━┓
+   ┃ number ┃
+   ┡━━━━━━━━┩
+8. │      7 │
+   └────────┘
+   ┏━━━━━━━━┓
+   ┃ number ┃
+   ┡━━━━━━━━┩
+9. │      8 │
+   └────────┘
+    ┏━━━━━━━━┓
+    ┃ number ┃
+    ┡━━━━━━━━┩
+10. │      9 │
+    └────────┘
+   ┌─number─┐
+1. │      0 │
+   └────────┘
+   ┌─number─┐
+2. │      1 │
+   └────────┘
+   ┌─number─┐
+3. │      2 │
+   └────────┘
+   ┌─number─┐
+4. │      3 │
+   └────────┘
+   ┌─number─┐
+5. │      4 │
+   └────────┘
+   ┌─number─┐
+6. │      5 │
+   └────────┘
+   ┌─number─┐
+7. │      6 │
+   └────────┘
+   ┌─number─┐
+8. │      7 │
+   └────────┘
+   ┌─number─┐
+9. │      8 │
+   └────────┘
+    ┌─number─┐
+10. │      9 │
+    └────────┘
+    [1mnumber[0m
+
+1.       0 
+    [1mnumber[0m
+
+2.       1 
+    [1mnumber[0m
+
+3.       2 
+    [1mnumber[0m
+
+4.       3 
+    [1mnumber[0m
+
+5.       4 
+    [1mnumber[0m
+
+6.       5 
+    [1mnumber[0m
+
+7.       6 
+    [1mnumber[0m
+
+8.       7 
+    [1mnumber[0m
+
+9.       8 
+     [1mnumber[0m
+
+10.       9 
+    number
+
+1.       0 
+    number
+
+2.       1 
+    number
+
+3.       2 
+    number
+
+4.       3 
+    number
+
+5.       4 
+    number
+
+6.       5 
+    number
+
+7.       6 
+    number
+
+8.       7 
+    number
+
+9.       8 
+     number
+
 10.       9 
diff --git a/tests/queries/0_stateless/01509_output_format_pretty_row_numbers.sql b/tests/queries/0_stateless/01509_output_format_pretty_row_numbers.sql
index 3c0eeaf0e536..f8ec0be74d7d 100644
--- a/tests/queries/0_stateless/01509_output_format_pretty_row_numbers.sql
+++ b/tests/queries/0_stateless/01509_output_format_pretty_row_numbers.sql
@@ -13,3 +13,21 @@ SELECT * FROM numbers(10) FORMAT PrettyNoEscapes;
 SELECT * FROM numbers(10) FORMAT PrettyCompactNoEscapes;
 SELECT * FROM numbers(10) FORMAT PrettySpaceNoEscapes;
 SELECT * FROM numbers(10) FORMAT PrettySpace;
+
+SET max_block_size=1;
+
+SELECT * FROM (SELECT 1 AS a UNION ALL SELECT 2 as a) ORDER BY a FORMAT Pretty;
+SELECT * FROM (SELECT 1 AS a UNION ALL SELECT 2 as a) ORDER BY a FORMAT PrettyCompact;
+SELECT * FROM (SELECT 1 AS a UNION ALL SELECT 2 as a) ORDER BY a FORMAT PrettyCompactMonoBlock;
+SELECT * FROM (SELECT 1 AS a UNION ALL SELECT 2 as a) ORDER BY a FORMAT PrettyNoEscapes;
+SELECT * FROM (SELECT 1 AS a UNION ALL SELECT 2 as a) ORDER BY a FORMAT PrettyCompactNoEscapes;
+SELECT * FROM (SELECT 1 AS a UNION ALL SELECT 2 as a) ORDER BY a FORMAT PrettySpace;
+SELECT * FROM (SELECT 1 AS a UNION ALL SELECT 2 as a) ORDER BY a FORMAT PrettySpaceNoEscapes;
+
+SELECT * FROM numbers(10) ORDER BY number FORMAT Pretty;
+SELECT * FROM numbers(10) ORDER BY number FORMAT PrettyCompact;
+SELECT * FROM numbers(10) ORDER BY number FORMAT PrettyCompactMonoBlock;
+SELECT * FROM numbers(10) ORDER BY number FORMAT PrettyNoEscapes;
+SELECT * FROM numbers(10) ORDER BY number FORMAT PrettyCompactNoEscapes;
+SELECT * FROM numbers(10) ORDER BY number FORMAT PrettySpace;
+SELECT * FROM numbers(10) ORDER BY number FORMAT PrettySpaceNoEscapes;
