diff --git a/dbms/tests/queries/0_stateless/00818_join_bug_4271.reference b/dbms/tests/queries/0_stateless/00818_join_bug_4271.reference
new file mode 100644
index 000000000000..4d5913814214
--- /dev/null
+++ b/dbms/tests/queries/0_stateless/00818_join_bug_4271.reference
@@ -0,0 +1,9 @@
+1	1	a	1	1	a
+2	2	b	\N	\N	\N
+1	1	a	1	1	a
+2	2	b	\N	\N	\N
+1	1	a	1	1	a
+1	1	a	1	1	a
+2	2	b	\N	\N	\N
+1	1	a	1	1	a
+2	2	b	\N	\N	\N
diff --git a/dbms/tests/queries/0_stateless/00818_join_bug_4271.sql b/dbms/tests/queries/0_stateless/00818_join_bug_4271.sql
new file mode 100644
index 000000000000..8f7fc7f8ef4a
--- /dev/null
+++ b/dbms/tests/queries/0_stateless/00818_join_bug_4271.sql
@@ -0,0 +1,19 @@
+use test;
+
+drop table if exists t;
+drop table if exists s;
+
+create table t(a Nullable(Int64), b Nullable(Int64), c Nullable(String)) engine = Memory;
+create table s(a Nullable(Int64), b Nullable(Int64), c Nullable(String)) engine = Memory;
+
+insert into t values(1,1,'a'), (2,2,'b');
+insert into s values(1,1,'a');
+
+select * from t left join s on t.a = s.a;
+select * from t left join s on t.a = s.a and t.a = s.b;
+select * from t left join s on t.a = s.a where s.a = 1;
+select * from t left join s on t.a = s.a and t.a = s.a;
+select * from t left join s on t.a = s.a and t.b = s.a;
+
+drop table t;
+drop table s;
