diff --git a/tests/queries/0_stateless/01651_group_uniq_array_enum.reference b/tests/queries/0_stateless/01651_group_uniq_array_enum.reference
new file mode 100644
index 000000000000..ba4401b6afdf
--- /dev/null
+++ b/tests/queries/0_stateless/01651_group_uniq_array_enum.reference
@@ -0,0 +1,3 @@
+['Hello','World','Упячка']
+['Hello','World','World','Упячка','Упячка','Упячка']
+['world','hello']	Array(Enum8(\'world\' = 0, \'hello\' = 1))	['world','hello']	Array(Enum8(\'world\' = 0, \'hello\' = 1))
diff --git a/tests/queries/0_stateless/01651_group_uniq_array_enum.sql b/tests/queries/0_stateless/01651_group_uniq_array_enum.sql
new file mode 100644
index 000000000000..19de51f96816
--- /dev/null
+++ b/tests/queries/0_stateless/01651_group_uniq_array_enum.sql
@@ -0,0 +1,13 @@
+SELECT arraySort(groupUniqArray(x)) FROM (SELECT CAST(arrayJoin([1, 2, 3, 2, 3, 3]) AS Enum('Hello' = 1, 'World' = 2, 'Упячка' = 3)) AS x);
+SELECT arraySort(groupArray(x)) FROM (SELECT CAST(arrayJoin([1, 2, 3, 2, 3, 3]) AS Enum('Hello' = 1, 'World' = 2, 'Упячка' = 3)) AS x);
+
+SELECT
+    arraySort(groupUniqArray(val)) AS uniq,
+    toTypeName(uniq),
+    arraySort(groupArray(val)) AS arr,
+    toTypeName(arr)
+FROM
+(
+    SELECT CAST(number % 2, 'Enum(\'hello\' = 1, \'world\' = 0)') AS val
+    FROM numbers(2)
+);
