You will be provided with a partial code base and an issue statement explaining a problem to resolve.

<issue>
Zero copy replication can lead to data duplication in case of background moves 
I've added a test that reproduces the error https://github.com/ClickHouse/ClickHouse/pull/33642.
</issue>

I need you to solve the provided issue by generating a code fix that can be applied directly to the repository

Respond below:
