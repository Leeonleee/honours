diff --git a/src/Processors/Transforms/SortingTransform.cpp b/src/Processors/Transforms/SortingTransform.cpp
index e56db6e3842b..03c8e87ce7a6 100644
--- a/src/Processors/Transforms/SortingTransform.cpp
+++ b/src/Processors/Transforms/SortingTransform.cpp
@@ -285,7 +285,9 @@ IProcessor::Status SortingTransform::prepareGenerate()
 
     if (output.isFinished())
     {
-        inputs.front().close();
+        for (auto & input : inputs)
+            input.close();
+
         return Status::Finished;
     }
 
