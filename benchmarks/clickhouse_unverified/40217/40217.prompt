You will be provided with a partial code base and an issue statement explaining a problem to resolve.

<issue>
Casting of the date/timestamps to smaller types should return min/max instead of overflow
```sql
SELECT
    toDate32('2160-01-01') AS a,
    toDate('2160-01-01') AS b,
    toDate(a),
    toDateTime(a),
    toDateTime(b)

Query id: b1043ea4-a5c4-4ab8-98f2-e6d0fbcfbdf5

Row 1:
──────
a:                                  2160-01-01
b:                                  2149-06-06
toDate(toDate32('2160-01-01')):     1980-07-27 -- max date value expected, i.e. 2149-06-06  
toDateTime(toDate32('2160-01-01')): 2023-11-24 17:31:44 -- max datetime value expected, i.e. 2106-02-07 06:28:15
toDateTime(toDate('2160-01-01')):   2013-04-29 17:31:44 -- max datetime value expected, i.e. 2106-02-07 06:28:15
```

```sql
SELECT
    toDateTime64('2160-01-01 00:00:00', 0) AS a,
    toDateTime('2160-01-01 00:00:00') AS b,
    toDate(a),
    toDateTime(a)

Query id: a6085a36-4a41-467b-915d-b69638445754

Row 1:
──────
a:                                                  2160-01-01 00:00:00
b:                                                  2106-02-07 06:28:15
toDate(toDateTime64('2160-01-01 00:00:00', 0)):     1980-07-27 -- max malue, i.e. 2149-06-06  is expected
toDateTime(toDateTime64('2160-01-01 00:00:00', 0)): 2023-11-24 17:31:44 -- max value, i.e. 2106-02-07 06:28:15 is expected
```

P.S. It seems like fixing that may also be a fix for https://github.com/ClickHouse/ClickHouse/issues/39248 (which also can be fixed independently).
</issue>

I need you to solve the provided issue by generating a code fix that can be applied directly to the repository

Respond below:
