diff --git a/utils/iotest/iotest.cpp b/utils/iotest/iotest.cpp
index b327355d07b8..91f097693e47 100644
--- a/utils/iotest/iotest.cpp
+++ b/utils/iotest/iotest.cpp
@@ -156,7 +156,11 @@ int mainImpl(int argc, char ** argv)
         pool.scheduleOrThrowOnError([=]{ thread(fd, mode, min_offset, max_offset, block_size, count); });
     pool.wait();
 
-    fsync(fd);
+    #if defined(OS_DARWIN)
+        fsync(fd);
+    #else
+        fdatasync(fd);
+    #endif
 
     watch.stop();
 
diff --git a/utils/iotest/iotest_nonblock.cpp b/utils/iotest/iotest_nonblock.cpp
index 524d6298da55..430e951d36b7 100644
--- a/utils/iotest/iotest_nonblock.cpp
+++ b/utils/iotest/iotest_nonblock.cpp
@@ -136,8 +136,13 @@ int mainImpl(int argc, char ** argv)
 
     for (size_t i = 0; i < descriptors; ++i)
     {
+#if defined(OS_DARWIN)
         if (fsync(fds[i]))
             throwFromErrno("Cannot fsync", ErrorCodes::CANNOT_FSYNC);
+#else
+        if (fdatasync(fds[i]))
+            throwFromErrno("Cannot fdatasync", ErrorCodes::CANNOT_FSYNC);
+#endif
     }
 
     watch.stop();
