diff --git a/tests/config/config.d/zookeeper_write.xml b/tests/config/config.d/zookeeper_write.xml
new file mode 100644
index 000000000000..ce484261abab
--- /dev/null
+++ b/tests/config/config.d/zookeeper_write.xml
@@ -0,0 +1,3 @@
+<clickhouse>
+    <allow_zookeeper_write>true</allow_zookeeper_write>
+</clickhouse>
diff --git a/tests/config/install.sh b/tests/config/install.sh
index 3bc1967ab1f9..54031eb8f32d 100755
--- a/tests/config/install.sh
+++ b/tests/config/install.sh
@@ -16,6 +16,7 @@ mkdir -p $DEST_SERVER_PATH/users.d/
 mkdir -p $DEST_CLIENT_PATH
 
 ln -sf $SRC_PATH/config.d/zookeeper.xml $DEST_SERVER_PATH/config.d/
+ln -sf $SRC_PATH/config.d/zookeeper_write.xml $DEST_SERVER_PATH/config.d/
 ln -sf $SRC_PATH/config.d/listen.xml $DEST_SERVER_PATH/config.d/
 ln -sf $SRC_PATH/config.d/text_log.xml $DEST_SERVER_PATH/config.d/
 ln -sf $SRC_PATH/config.d/custom_settings_prefixes.xml $DEST_SERVER_PATH/config.d/
diff --git a/tests/queries/0_stateless/02311_system_zookeeper_insert.reference b/tests/queries/0_stateless/02311_system_zookeeper_insert.reference
new file mode 100644
index 000000000000..d8a35d57e075
--- /dev/null
+++ b/tests/queries/0_stateless/02311_system_zookeeper_insert.reference
@@ -0,0 +1,27 @@
+/default/1-insert-testc	c	
+/default/1-insert-testc/c	c	
+/default/1-insert-testc/c/c	c	
+/default/1-insert-testc/c/c	d	
+/default/1-insert-testc/c/c	e	
+/default/1-insert-testc/c/c	f	
+/default/1-insert-testc/c/c	kk	
+/default/1-insert-testc/c/c/c	c	
+/default/1-insert-testc/c/c/c/c	c	
+/default/1-insert-testc/c/c/c/c/c	c	
+/default/1-insert-testc/c/c/c/c/c/c	c	9
+/default/1-insert-testc/c/c/c/c/c/c/c	c	10
+/default/1-insert-testc/c/c/d	e	10
+/default/1-insert-testc/c/c/d	f	11
+/default/1-insert-testc/c/c/d	g	12
+/default/1-insert-testc/c/c/e	g	13
+/default/1-insert-testc/c/c/f	g	14
+/default/1-insert-testc/c/c/kk	g	14
+-------------------------
+/default/2-insert-testx	testb	z
+/default/2-insert-testx	testc	x
+/default/2-insert-testx	testz	y
+/default/2-insert-testz	c	
+/default/2-insert-testz/c	cd	
+/default/2-insert-testz/c/cd	dd	
+/default/2-insert-testz/c/cd	testc	
+/default/2-insert-testz/c/cd/dd	testc	y
diff --git a/tests/queries/0_stateless/02311_system_zookeeper_insert.sql b/tests/queries/0_stateless/02311_system_zookeeper_insert.sql
new file mode 100644
index 000000000000..e1c42278086e
--- /dev/null
+++ b/tests/queries/0_stateless/02311_system_zookeeper_insert.sql
@@ -0,0 +1,43 @@
+-- Tags: zookeeper
+
+set allow_unrestricted_reads_from_keeper = 'true';
+
+drop table if exists test_zkinsert;
+
+create table test_zkinsert (
+	name String,
+	path String,
+	value String
+) ENGINE Memory;
+
+-- test recursive create and big transaction
+insert into test_zkinsert (name, path, value) values ('c', '/1-insert-testc/c/c/c/c/c/c', 11), ('e', '/1-insert-testc/c/c/d', 10), ('c', '/1-insert-testc/c/c/c/c/c/c/c', 10), ('c', '/1-insert-testc/c/c/c/c/c/c', 9), ('f', '/1-insert-testc/c/c/d', 11), ('g', '/1-insert-testc/c/c/d', 12), ('g', '/1-insert-testc/c/c/e', 13), ('g', '/1-insert-testc/c/c/f', 14), ('g', '/1-insert-testc/c/c/kk', 14);
+-- insert same value, suppose to have no side effects
+insert into system.zookeeper (name, path, value) SELECT name, '/' || currentDatabase() || path, value from test_zkinsert;
+
+SELECT * FROM (SELECT path, name, value FROM system.zookeeper ORDER BY path, name) WHERE path LIKE '/' || currentDatabase() || '/1-insert-test%';
+
+SELECT '-------------------------';
+
+-- test inserting into root path
+insert into test_zkinsert (name, path, value) values ('testc', '/2-insert-testx', 'x');
+insert into test_zkinsert (name, path, value) values ('testz', '/2-insert-testx', 'y');
+insert into test_zkinsert (name, path, value) values ('testc', '/2-insert-testz//c/cd/dd//', 'y');
+insert into test_zkinsert (name, path) values ('testc', '/2-insert-testz//c/cd/');
+insert into test_zkinsert (name, value, path) values ('testb', 'z', '/2-insert-testx');
+
+insert into system.zookeeper (name, path, value) SELECT name, '/' || currentDatabase() || path, value from test_zkinsert;
+
+SELECT * FROM (SELECT path, name, value FROM system.zookeeper ORDER BY path, name) WHERE path LIKE '/' || currentDatabase() || '/2-insert-test%';
+
+-- test exceptions 
+insert into system.zookeeper (name, value) values ('abc', 'y'); -- { serverError 36 }
+insert into system.zookeeper (path, value) values ('a/b/c', 'y'); -- { serverError 36 }
+insert into system.zookeeper (name, version) values ('abc', 111); -- { serverError 44 }
+insert into system.zookeeper (name, versionxyz) values ('abc', 111); -- { serverError 16 }
+insert into system.zookeeper (name, path, value) values ('a/b/c', '/', 'y'); -- { serverError 36 }
+insert into system.zookeeper (name, path, value) values ('/', '/a/b/c', 'z'); -- { serverError 36 }
+insert into system.zookeeper (name, path, value) values ('', '/', 'y'); -- { serverError 36 }
+insert into system.zookeeper (name, path, value) values ('abc', '/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc/abc', 'y'); -- { serverError 36 }
+
+drop table if exists test_zkinsert;
diff --git a/tests/queries/0_stateless/02311_system_zookeeper_insert_priv.reference b/tests/queries/0_stateless/02311_system_zookeeper_insert_priv.reference
new file mode 100644
index 000000000000..d00491fd7e5b
--- /dev/null
+++ b/tests/queries/0_stateless/02311_system_zookeeper_insert_priv.reference
@@ -0,0 +1,1 @@
+1
diff --git a/tests/queries/0_stateless/02311_system_zookeeper_insert_priv.sh b/tests/queries/0_stateless/02311_system_zookeeper_insert_priv.sh
new file mode 100755
index 000000000000..24a1f7e7c390
--- /dev/null
+++ b/tests/queries/0_stateless/02311_system_zookeeper_insert_priv.sh
@@ -0,0 +1,15 @@
+#!/usr/bin/env bash
+# Tags: no-parallel
+
+
+CUR_DIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
+# shellcheck source=../shell_config.sh
+. "$CUR_DIR"/../shell_config.sh
+
+
+${CLICKHOUSE_CLIENT_BINARY}  --query "drop user if exists u_02311"
+${CLICKHOUSE_CLIENT_BINARY}  --query "create user u_02311"
+error="$(${CLICKHOUSE_CLIENT_BINARY}  --user=u_02311 --query "insert into system.zookeeper (path, name, value) values ('//3-insert-testc/c/c/kk', 'kk', '11')" 2>&1 > /dev/null)"
+echo "${error}" | grep -Fc "ACCESS_DENIED"
+
+${CLICKHOUSE_CLIENT_BINARY}  --query "drop user u_02311"
