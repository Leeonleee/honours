diff --git a/tests/queries/0_stateless/02845_arrayShiftRotate.reference b/tests/queries/0_stateless/02845_arrayShiftRotate.reference
new file mode 100644
index 000000000000..9a8670f387ce
--- /dev/null
+++ b/tests/queries/0_stateless/02845_arrayShiftRotate.reference
@@ -0,0 +1,115 @@
+== arrayRotateLeft
+[3,4,5,1,2]
+[4,5,1,2,3]
+[4,5,1,2,3]
+['l','l','o','H','e']
+[[[5,6],[7,8]],[[1,2],[3,4]]]
+
+== arrayRotateRight
+[4,5,1,2,3]
+[3,4,5,1,2]
+[3,4,5,1,2]
+['l','o','H','e','l']
+[[[5,6],[7,8]],[[1,2],[3,4]]]
+
+== arrayShiftLeft
+[4,5,0,0,0]
+[0,0,0,1,2]
+[0,0,0,0,0]
+['d','e','','','']
+[[5,6],[],[]]
+[[[5,6],[7,8]],[]]
+[4,5,7,7,7]
+['d','e','foo','foo','foo']
+[[5,6],[7,8],[7,8]]
+[2,3,4,5,6,1000]
+
+== arrayShiftRight
+[0,0,0,1,2]
+[4,5,0,0,0]
+[0,0,0,0,0]
+['','','','a','b']
+[[],[],[1,2]]
+[[],[[1,2],[3,4]]]
+[7,7,7,1,2]
+['foo','foo','foo','a','b']
+[[7,8],[7,8],[1,2]]
+[1000,1,2,3,4,5]
+
+== table
+== table with constants
+-- arrayRotateLeft
+[3,4,5,6,1,2]
+[3,4,5,6,1,2]
+[3,4,1,2]
+[15,16,23,42,4,8]
+[18,28,18,28,45,90,45,2,7]
+[159,26,5,3,14]
+-- arrayRotateRight
+[5,6,1,2,3,4]
+[5,6,1,2,3,4]
+[3,4,1,2]
+[23,42,4,8,15,16]
+[90,45,2,7,18,28,18,28,45]
+[26,5,3,14,159]
+-- arrayShiftLeft
+[4,5,6,0,0,0]
+[4,5,6,0,0,0]
+[4,0,0,0]
+[16,23,42,0,0,0]
+[28,18,28,45,90,45,0,0,0]
+[26,5,0,0,0]
+-- arrayShiftRight
+[0,0,0,1,2,3]
+[0,0,0,1,2,3]
+[0,0,0,1]
+[0,0,0,4,8,15]
+[0,0,0,2,7,18,28,18,28]
+[0,0,0,3,14]
+== table with constants and defaults
+-- arrayShiftLeft
+[4,5,6,7,7,7]
+[4,5,6,7,7,7]
+[4,7,7,7]
+[16,23,42,7,7,7]
+[28,18,28,45,90,45,7,7,7]
+[26,5,7,7,7]
+-- arrayShiftRight
+[7,7,7,1,2,3]
+[7,7,7,1,2,3]
+[7,7,7,1]
+[7,7,7,4,8,15]
+[7,7,7,2,7,18,28,18,28]
+[7,7,7,3,14]
+== table values
+-- arrayRotateLeft
+[3,4,5,6,1,2]
+[4,5,6,1,2,3]
+[4,1,2,3]
+[42,4,8,15,16,23]
+[90,45,2,7,18,28,18,28,45]
+[14,159,26,5,3]
+-- arrayRotateRight
+[5,6,1,2,3,4]
+[4,5,6,1,2,3]
+[2,3,4,1]
+[8,15,16,23,42,4]
+[18,28,18,28,45,90,45,2,7]
+[5,3,14,159,26]
+-- arrayShiftLeft
+[3,4,5,6,1,1]
+[4,5,6,2,2,2]
+[4,3,3,3]
+[42,4,4,4,4,4]
+[90,45,5,5,5,5,5,5,5]
+[6,6,6,6,6]
+-- arrayShiftRight
+[1,1,1,2,3,4]
+[2,2,2,1,2,3]
+[3,3,3,1]
+[4,4,4,4,4,4]
+[5,5,5,5,5,5,5,2,7]
+[6,6,6,6,6]
+== problematic cast cases
+[5]
+[[]]
diff --git a/tests/queries/0_stateless/02845_arrayShiftRotate.sql b/tests/queries/0_stateless/02845_arrayShiftRotate.sql
new file mode 100644
index 000000000000..bdb409c3fe5c
--- /dev/null
+++ b/tests/queries/0_stateless/02845_arrayShiftRotate.sql
@@ -0,0 +1,78 @@
+select '== arrayRotateLeft';
+select arrayRotateLeft([1,2,3,4,5], 2);
+select arrayRotateLeft([1,2,3,4,5], -2);
+select arrayRotateLeft([1,2,3,4,5], 8);
+select arrayRotateLeft(['H', 'e', 'l', 'l', 'o'], 2);
+select arrayRotateLeft([[[1, 2], [3, 4]], [[5, 6], [7, 8]]], 1);
+select '';
+
+select '== arrayRotateRight';
+select arrayRotateRight([1,2,3,4,5], 2);
+select arrayRotateRight([1,2,3,4,5], -2);
+select arrayRotateRight([1,2,3,4,5], 8);
+select arrayRotateRight(['H', 'e', 'l', 'l', 'o'], 2);
+select arrayRotateRight([[[1, 2], [3, 4]], [[5, 6], [7, 8]]], 1);
+select '';
+
+select '== arrayShiftLeft';
+select arrayShiftLeft([1, 2, 3, 4, 5], 3);
+select arrayShiftLeft([1, 2, 3, 4, 5], -3);
+select arrayShiftLeft([1, 2, 3, 4, 5], 8);
+select arrayShiftLeft(['a', 'b', 'c', 'd', 'e'], 3);
+select arrayShiftLeft([[1, 2], [3, 4], [5, 6]], 2);
+select arrayShiftLeft([[[1, 2], [3, 4]], [[5, 6], [7, 8]]], 1);
+select arrayShiftLeft([1, 2, 3, 4, 5], 3, 7);
+select arrayShiftLeft(['a', 'b', 'c', 'd', 'e'], 3, 'foo');
+select arrayShiftLeft([[1, 2], [3, 4], [5, 6]], 2, [7, 8]);
+select arrayShiftLeft(CAST('[1, 2, 3, 4, 5, 6]', 'Array(UInt16)'), 1, 1000);
+select '';
+
+select '== arrayShiftRight';
+select arrayShiftRight([1, 2, 3, 4, 5], 3);
+select arrayShiftRight([1, 2, 3, 4, 5], -3);
+select arrayShiftRight([1, 2, 3, 4, 5], 8);
+select arrayShiftRight(['a', 'b', 'c', 'd', 'e'], 3);
+select arrayShiftRight([[1, 2], [3, 4], [5, 6]], 2);
+select arrayShiftRight([[[1, 2], [3, 4]], [[5, 6], [7, 8]]], 1);
+select arrayShiftRight([1, 2, 3, 4, 5], 3, 7);
+select arrayShiftRight(['a', 'b', 'c', 'd', 'e'], 3, 'foo');
+select arrayShiftRight([[1, 2], [3, 4], [5, 6]], 2, [7, 8]);
+select arrayShiftRight(CAST('[1, 2, 3, 4, 5, 6]', 'Array(UInt16)'), 1, 1000);
+select '';
+
+select '== table';
+drop table if exists t02845;
+create table t02845 (a Array(UInt8), s Int16, d UInt8) engine = MergeTree order by d;
+insert into t02845 values ([1,2,3,4,5,6], 2, 1),([1,2,3,4,5,6], 3, 2),([1,2,3,4], 3, 3),([4,8,15,16,23,42], 5, 4),([2, 7, 18, 28, 18, 28, 45, 90, 45], 7, 5),([3, 14, 159, 26, 5], 11, 6);
+
+select '== table with constants';
+select '-- arrayRotateLeft';
+select arrayRotateLeft(a, 2) from t02845;
+select '-- arrayRotateRight';
+select arrayRotateRight(a, 2) from t02845;
+select '-- arrayShiftLeft';
+select arrayShiftLeft(a, 3) from t02845;
+select '-- arrayShiftRight';
+select arrayShiftRight(a, 3) from t02845;
+
+select '== table with constants and defaults';
+select '-- arrayShiftLeft';
+select arrayShiftLeft(a, 3, 7) from t02845;
+select '-- arrayShiftRight';
+select arrayShiftRight(a, 3, 7) from t02845;
+
+select '== table values';
+select '-- arrayRotateLeft';
+select arrayRotateLeft(a, s) from t02845;
+select '-- arrayRotateRight';
+select arrayRotateRight(a, s) from t02845;
+select '-- arrayShiftLeft';
+select arrayShiftLeft(a, s, d) from t02845;
+select '-- arrayShiftRight';
+select arrayShiftRight(a, s, d) from t02845;
+
+select '== problematic cast cases';
+select arrayShiftLeft([30000], 3, 5);
+select arrayShiftLeft([[1]], 3, []);
+select arrayShiftLeft(['foo'], 3, 3); -- { serverError ILLEGAL_TYPE_OF_ARGUMENT }
+select arrayShiftLeft([1], 3, 'foo'); -- { serverError ILLEGAL_TYPE_OF_ARGUMENT }
