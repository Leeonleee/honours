You will be provided with a partial code base and an issue statement explaining a problem to resolve.

<issue>
Transaction rollback aborted
Report: https://s3.amazonaws.com/clickhouse-test-reports/36947/240d063df3985d54215d636fe68bc7a08f3338c9/stress_test__debug__actions_.html
```
2022.05.10 16:43:37.766030 [ 765 ] {f41c7dc9-8dc0-4b38-9ea3-8b355f7511f4::200001_11_11_0_12} <Trace> MergedBlockOutputStream: filled checksums 200001_11_11_0_12 (state Temporary)
2022.05.10 16:43:38.033023 [ 765 ] {6012eeee-ae36-440f-a186-9c1e127fd032::all_1_166_21} <Trace> test_27.dst (6012eeee-ae36-440f-a186-9c1e127fd032): Renaming temporary part tmp_merge_all_1_166_21 to all_1_166_21.
2022.05.10 16:43:38.128466 [ 765 ] {6012eeee-ae36-440f-a186-9c1e127fd032::all_1_166_21} <Test> VersionMetadata: Trying to lock removal_tid by (198, 39, 78350abb-a9f7-4c76-b390-089625b0bd69), table: test_27.dst (6012eeee-ae36-440f-a186-9c1e127fd032), part: all_1_150_20
2022.05.10 16:43:38.140403 [ 765 ] {6012eeee-ae36-440f-a186-9c1e127fd032::all_1_166_21} <Test> test_27.dst (6012eeee-ae36-440f-a186-9c1e127fd032): Appending removal TID for all_1_150_20 (creation: (186, 106, 78350abb-a9f7-4c76-b390-089625b0bd69), removal (198, 39, 78350abb-a9f7-4c76-b390-089625b0bd69))
2022.05.10 16:43:38.146535 [ 765 ] {6012eeee-ae36-440f-a186-9c1e127fd032::all_1_166_21} <Test> VersionMetadata: Trying to lock removal_tid by (198, 39, 78350abb-a9f7-4c76-b390-089625b0bd69), table: test_27.dst (6012eeee-ae36-440f-a186-9c1e127fd032), part: all_152_152_0
2022.05.10 16:43:38.149169 [ 765 ] {6012eeee-ae36-440f-a186-9c1e127fd032::all_1_166_21} <Test> test_27.dst (6012eeee-ae36-440f-a186-9c1e127fd032): Appending removal TID for all_152_152_0 (creation: (184, 36, 78350abb-a9f7-4c76-b390-089625b0bd69), removal (198, 39, 78350abb-a9f7-4c76-b390-089625b0bd69))
2022.05.10 16:43:38.156443 [ 765 ] {6012eeee-ae36-440f-a186-9c1e127fd032::all_1_166_21} <Test> VersionMetadata: Trying to lock removal_tid by (198, 39, 78350abb-a9f7-4c76-b390-089625b0bd69), table: test_27.dst (6012eeee-ae36-440f-a186-9c1e127fd032), part: all_154_154_0
2022.05.10 16:43:38.156986 [ 765 ] {6012eeee-ae36-440f-a186-9c1e127fd032::all_1_166_21} <Test> test_27.dst (6012eeee-ae36-440f-a186-9c1e127fd032): Appending removal TID for all_154_154_0 (creation: (184, 37, 78350abb-a9f7-4c76-b390-089625b0bd69), removal (198, 39, 78350abb-a9f7-4c76-b390-089625b0bd69))
2022.05.10 16:43:38.159785 [ 765 ] {6012eeee-ae36-440f-a186-9c1e127fd032::all_1_166_21} <Test> VersionMetadata: Trying to lock removal_tid by (198, 39, 78350abb-a9f7-4c76-b390-089625b0bd69), table: test_27.dst (6012eeee-ae36-440f-a186-9c1e127fd032), part: all_155_155_0
2022.05.10 16:43:38.162823 [ 765 ] {6012eeee-ae36-440f-a186-9c1e127fd032::all_1_166_21} <Test> test_27.dst (6012eeee-ae36-440f-a186-9c1e127fd032): Appending removal TID for all_155_155_0 (creation: (184, 37, 78350abb-a9f7-4c76-b390-089625b0bd69), removal (198, 39, 78350abb-a9f7-4c76-b390-089625b0bd69))
2022.05.10 16:43:38.166237 [ 765 ] {6012eeee-ae36-440f-a186-9c1e127fd032::all_1_166_21} <Test> VersionMetadata: Trying to lock removal_tid by (198, 39, 78350abb-a9f7-4c76-b390-089625b0bd69), table: test_27.dst (6012eeee-ae36-440f-a186-9c1e127fd032), part: all_156_156_0
2022.05.10 16:43:38.176535 [ 765 ] {6012eeee-ae36-440f-a186-9c1e127fd032::all_1_166_21} <Test> test_27.dst (6012eeee-ae36-440f-a186-9c1e127fd032): Appending removal TID for all_156_156_0 (creation: (184, 36, 78350abb-a9f7-4c76-b390-089625b0bd69), removal (198, 39, 78350abb-a9f7-4c76-b390-089625b0bd69))
2022.05.10 16:43:38.180755 [ 765 ] {6012eeee-ae36-440f-a186-9c1e127fd032::all_1_166_21} <Test> VersionMetadata: Trying to lock removal_tid by (198, 39, 78350abb-a9f7-4c76-b390-089625b0bd69), table: test_27.dst (6012eeee-ae36-440f-a186-9c1e127fd032), part: all_163_163_0
2022.05.10 16:43:38.182130 [ 765 ] {6012eeee-ae36-440f-a186-9c1e127fd032::all_1_166_21} <Test> test_27.dst (6012eeee-ae36-440f-a186-9c1e127fd032): Appending removal TID for all_163_163_0 (creation: (192, 39, 78350abb-a9f7-4c76-b390-089625b0bd69), removal (198, 39, 78350abb-a9f7-4c76-b390-089625b0bd69))
2022.05.10 16:43:38.185295 [ 765 ] {6012eeee-ae36-440f-a186-9c1e127fd032::all_1_166_21} <Test> VersionMetadata: Trying to lock removal_tid by (198, 39, 78350abb-a9f7-4c76-b390-089625b0bd69), table: test_27.dst (6012eeee-ae36-440f-a186-9c1e127fd032), part: all_164_164_0
2022.05.10 16:43:38.195583 [ 765 ] {6012eeee-ae36-440f-a186-9c1e127fd032::all_1_166_21} <Test> test_27.dst (6012eeee-ae36-440f-a186-9c1e127fd032): Appending removal TID for all_164_164_0 (creation: (192, 42, 78350abb-a9f7-4c76-b390-089625b0bd69), removal (198, 39, 78350abb-a9f7-4c76-b390-089625b0bd69))
2022.05.10 16:43:38.200524 [ 765 ] {6012eeee-ae36-440f-a186-9c1e127fd032::all_1_166_21} <Test> VersionMetadata: Trying to lock removal_tid by (198, 39, 78350abb-a9f7-4c76-b390-089625b0bd69), table: test_27.dst (6012eeee-ae36-440f-a186-9c1e127fd032), part: all_165_165_0
2022.05.10 16:43:38.204152 [ 765 ] {6012eeee-ae36-440f-a186-9c1e127fd032::all_1_166_21} <Test> test_27.dst (6012eeee-ae36-440f-a186-9c1e127fd032): Appending removal TID for all_165_165_0 (creation: (192, 39, 78350abb-a9f7-4c76-b390-089625b0bd69), removal (198, 39, 78350abb-a9f7-4c76-b390-089625b0bd69))
2022.05.10 16:43:38.208219 [ 765 ] {6012eeee-ae36-440f-a186-9c1e127fd032::all_1_166_21} <Test> VersionMetadata: Trying to lock removal_tid by (198, 39, 78350abb-a9f7-4c76-b390-089625b0bd69), table: test_27.dst (6012eeee-ae36-440f-a186-9c1e127fd032), part: all_166_166_0
2022.05.10 16:43:38.210982 [ 765 ] {6012eeee-ae36-440f-a186-9c1e127fd032::all_1_166_21} <Test> test_27.dst (6012eeee-ae36-440f-a186-9c1e127fd032): Appending removal TID for all_166_166_0 (creation: (192, 42, 78350abb-a9f7-4c76-b390-089625b0bd69), removal (198, 39, 78350abb-a9f7-4c76-b390-089625b0bd69))
2022.05.10 16:43:38.222773 [ 765 ] {6012eeee-ae36-440f-a186-9c1e127fd032::all_1_166_21} <Trace> test_27.dst (6012eeee-ae36-440f-a186-9c1e127fd032) (MergerMutator): Merged 9 parts: from all_1_150_20 to all_166_166_0
2022.05.10 16:43:38.230849 [ 765 ] {} <Test> TransactionLog: Committing transaction (198, 39, 78350abb-a9f7-4c76-b390-089625b0bd69) state: RUNNING, snapshot: 198, affects 1 tables:
2022.05.10 16:43:51.756993 [ 765 ] {} <Error> void DB::MergeTreeTransactionHolder::onDestroy(): Code: 999. Coordination::Exception: Connection loss, path: /clickhouse/txn/log/csn-. (KEEPER_EXCEPTION), Stack trace (when copying this message, always include the lines below):
0. /build/build_docker/../contrib/libcxx/include/exception:133: std::exception::capture() @ 0x17368762 in /usr/bin/clickhouse
1. /build/build_docker/../contrib/libcxx/include/exception:111: std::exception::exception() @ 0x17368733 in /usr/bin/clickhouse
2. /build/build_docker/../contrib/poco/Foundation/src/Exception.cpp:27: Poco::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int) @ 0x2d60e4a0 in /usr/bin/clickhouse
3. /build/build_docker/../src/Common/Exception.cpp:56: DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x173447ee in /usr/bin/clickhouse
4. /build/build_docker/../src/Common/ZooKeeper/IKeeper.cpp:25: Coordination::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, Coordination::Error, int) @ 0x27c7f10f in /usr/bin/clickhouse
5. /build/build_docker/../src/Common/ZooKeeper/IKeeper.cpp:46: Coordination::Exception::Exception(Coordination::Error, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) @ 0x27c7f6d5 in /usr/bin/clickhouse
6. /build/build_docker/../src/Common/ZooKeeper/ZooKeeper.cpp:409: zkutil::ZooKeeper::tryCreate(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >&) @ 0x27c86d7e in /usr/bin/clickhouse
7. /build/build_docker/../src/Common/ZooKeeper/ZooKeeper.cpp:397: zkutil::ZooKeeper::create(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int) @ 0x27c86c90 in /usr/bin/clickhouse
8. /build/build_docker/../src/Interpreters/TransactionLog.cpp:356: DB::TransactionLog::commitTransaction(std::__1::shared_ptr<DB::MergeTreeTransaction> const&) @ 0x2640e734 in /usr/bin/clickhouse
9. /build/build_docker/../src/Interpreters/MergeTreeTransactionHolder.cpp:56: DB::MergeTreeTransactionHolder::onDestroy() @ 0x2617b5a7 in /usr/bin/clickhouse
10. /build/build_docker/../src/Interpreters/MergeTreeTransactionHolder.cpp:42: DB::MergeTreeTransactionHolder::~MergeTreeTransactionHolder() @ 0x2617b699 in /usr/bin/clickhouse
11. /build/build_docker/../src/Storages/MergeTree/MergePlainMergeTreeTask.h:13: DB::MergePlainMergeTreeTask::~MergePlainMergeTreeTask() @ 0x272e7721 in /usr/bin/clickhouse
12. /build/build_docker/../contrib/libcxx/include/__memory/construct_at.h:57: void std::__1::__destroy_at<DB::MergePlainMergeTreeTask, 0>(DB::MergePlainMergeTreeTask*) @ 0x272d7388 in /usr/bin/clickhouse
13. /build/build_docker/../contrib/libcxx/include/__memory/construct_at.h:82: void std::__1::destroy_at<DB::MergePlainMergeTreeTask, 0>(DB::MergePlainMergeTreeTask*) @ 0x272d7315 in /usr/bin/clickhouse
14. /build/build_docker/../contrib/libcxx/include/__memory/allocator_traits.h:321: void std::__1::allocator_traits<std::__1::allocator<DB::MergePlainMergeTreeTask> >::destroy<DB::MergePlainMergeTreeTask, void, void>(std::__1::allocator<DB::MergePlainMergeTreeTask>&, DB::MergePlainMergeTreeTask*) @ 0x272d72f9 in /usr/bin/clickhouse
15. /build/build_docker/../contrib/libcxx/include/__memory/shared_ptr.h:310: std::__1::__shared_ptr_emplace<DB::MergePlainMergeTreeTask, std::__1::allocator<DB::MergePlainMergeTreeTask> >::__on_zero_shared() @ 0x272d710e in /usr/bin/clickhouse
16. /build/build_docker/../contrib/libcxx/include/__memory/shared_ptr.h:175: std::__1::__shared_count::__release_shared() @ 0x17338831 in /usr/bin/clickhouse
17. /build/build_docker/../contrib/libcxx/include/__memory/shared_ptr.h:216: std::__1::__shared_weak_count::__release_shared() @ 0x173387d9 in /usr/bin/clickhouse
18. /build/build_docker/../contrib/libcxx/include/__memory/shared_ptr.h:704: std::__1::shared_ptr<DB::IExecutableTask>::~shared_ptr() @ 0x26e556cc in /usr/bin/clickhouse
19. /build/build_docker/../contrib/libcxx/include/__memory/shared_ptr.h:770: std::__1::shared_ptr<DB::IExecutableTask>::reset() @ 0x26f413f3 in /usr/bin/clickhouse
20. /build/build_docker/../src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:199: DB::MergeTreeBackgroundExecutor<DB::MergeMutateRuntimeQueue>::routine(std::__1::shared_ptr<DB::TaskRuntimeData>) @ 0x26f410f9 in /usr/bin/clickhouse
21. /build/build_docker/../src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:229: DB::MergeTreeBackgroundExecutor<DB::MergeMutateRuntimeQueue>::threadFunction() @ 0x26f417e2 in /usr/bin/clickhouse
22. /build/build_docker/../src/Storages/MergeTree/MergeTreeBackgroundExecutor.h:183: DB::MergeTreeBackgroundExecutor<DB::MergeMutateRuntimeQueue>::MergeTreeBackgroundExecutor(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, unsigned long, unsigned long, unsigned long)::'lambda'()::operator()() const @ 0x26f4a078 in /usr/bin/clickhouse
23. /build/build_docker/../contrib/libcxx/include/type_traits:3640: decltype(static_cast<DB::MergeTreeBackgroundExecutor<DB::MergeMutateRuntimeQueue>::MergeTreeBackgroundExecutor(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, unsigned long, unsigned long, unsigned long)::'lambda'()&>(fp)()) std::__1::__invoke<DB::MergeTreeBackgroundExecutor<DB::MergeMutateRuntimeQueue>::MergeTreeBackgroundExecutor(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, unsigned long, unsigned long, unsigned long)::'lambda'()&>(DB::MergeTreeBackgroundExecutor<DB::MergeMutateRuntimeQueue>::MergeTreeBackgroundExecutor(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, unsigned long, unsigned long, unsigned long)::'lambda'()&) @ 0x26f4a035 in /usr/bin/clickhouse
24. /build/build_docker/../contrib/libcxx/include/__functional/invoke.h:62: void std::__1::__invoke_void_return_wrapper<void, true>::__call<DB::MergeTreeBackgroundExecutor<DB::MergeMutateRuntimeQueue>::MergeTreeBackgroundExecutor(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, unsigned long, unsigned long, unsigned long)::'lambda'()&>(DB::MergeTreeBackgroundExecutor<DB::MergeMutateRuntimeQueue>::MergeTreeBackgroundExecutor(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, unsigned long, unsigned long, unsigned long)::'lambda'()&) @ 0x26f49ffd in /usr/bin/clickhouse
25. /build/build_docker/../contrib/libcxx/include/__functional/function.h:230: std::__1::__function::__default_alloc_func<DB::MergeTreeBackgroundExecutor<DB::MergeMutateRuntimeQueue>::MergeTreeBackgroundExecutor(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, unsigned long, unsigned long, unsigned long)::'lambda'(), void ()>::operator()() @ 0x26f49fd5 in /usr/bin/clickhouse
26. /build/build_docker/../contrib/libcxx/include/__functional/function.h:711: void std::__1::__function::__policy_invoker<void ()>::__call_impl<std::__1::__function::__default_alloc_func<DB::MergeTreeBackgroundExecutor<DB::MergeMutateRuntimeQueue>::MergeTreeBackgroundExecutor(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, unsigned long, unsigned long, unsigned long)::'lambda'(), void ()> >(std::__1::__function::__policy_storage const*) @ 0x26f49f9d in /usr/bin/clickhouse
27. /build/build_docker/../contrib/libcxx/include/__functional/function.h:843: std::__1::__function::__policy_func<void ()>::operator()() const @ 0x173aa2c6 in /usr/bin/clickhouse
28. /build/build_docker/../contrib/libcxx/include/__functional/function.h:1184: std::__1::function<void ()>::operator()() const @ 0x173a67f5 in /usr/bin/clickhouse
29. /build/build_docker/../src/Common/ThreadPool.cpp:281: ThreadPoolImpl<ThreadFromGlobalPool>::worker(std::__1::__list_iterator<ThreadFromGlobalPool, void*>) @ 0x1745b80f in /usr/bin/clickhouse
30. /build/build_docker/../src/Common/ThreadPool.cpp:143: void ThreadPoolImpl<ThreadFromGlobalPool>::scheduleImpl<void>(std::__1::function<void ()>, int, std::__1::optional<unsigned long>)::'lambda0'()::operator()() const @ 0x174656e4 in /usr/bin/clickhouse
31. /build/build_docker/../contrib/libcxx/include/type_traits:3648: decltype(static_cast<void>(fp)()) std::__1::__invoke_constexpr<void ThreadPoolImpl<ThreadFromGlobalPool>::scheduleImpl<void>(std::__1::function<void ()>, int, std::__1::optional<unsigned long>)::'lambda0'()&>(void&&) @ 0x174656b5 in /usr/bin/clickhouse
 (version 22.5.1.1)
2022.05.10 16:43:51.764477 [ 765 ] {} <Trace> TransactionLog: Rolling back transaction (198, 39, 78350abb-a9f7-4c76-b390-089625b0bd69)
/var/log/clickhouse-server/clickhouse-server.err.log:2022.05.10 16:51:33.905172 [ 15371 ] {} <Fatal> BaseDaemon: ########################################
/var/log/clickhouse-server/clickhouse-server.err.log:2022.05.10 16:51:34.166110 [ 15371 ] {} <Fatal> BaseDaemon: (version 22.5.1.1, build id: CE457CD1E3B43B06) (from thread 765) (no query) Received signal Aborted (6)
/var/log/clickhouse-server/clickhouse-server.err.log:2022.05.10 16:51:34.170258 [ 15371 ] {} <Fatal> BaseDaemon: 
/var/log/clickhouse-server/clickhouse-server.err.log:2022.05.10 16:51:34.201226 [ 15371 ] {} <Fatal> BaseDaemon: Stack trace: 0x7fb2d48ae03b 0x7fb2d488d859 0x7fb2d488d729 0x7fb2d489f006 0x26ea6e01 0x2616e6b5 0x2640fd9b 0x2617b659 0x2617b699 0x272e7721 0x272d7388 0x272d7315 0x272d72f9 0x272d710e 0x17338831 0x173387d9 0x26e556cc 0x26f413f3 0x26f410f9 0x26f417e2 0x26f4a078 0x26f4a035 0x26f49ffd 0x26f49fd5 0x26f49f9d 0x173aa2c6 0x173a67f5 0x1745b80f 0x174656e4 0x174656b5 0x17465641 0x17465192 0x17464f36 0x17464e15 0x17464ddd 0x17464db5 0x17464d80 0x173aa2c6 0x173a67f5 0x1745940f 0x1745fe24
/var/log/clickhouse-server/clickhouse-server.err.log:2022.05.10 16:51:34.287812 [ 15371 ] {} <Fatal> BaseDaemon: 4. gsignal @ 0x7fb2d48ae03b in ?
/var/log/clickhouse-server/clickhouse-server.err.log:2022.05.10 16:51:34.312126 [ 15371 ] {} <Fatal> BaseDaemon: 5. abort @ 0x7fb2d488d859 in ?
/var/log/clickhouse-server/clickhouse-server.err.log:2022.05.10 16:51:34.324288 [ 15371 ] {} <Fatal> BaseDaemon: 6. ? @ 0x7fb2d488d729 in ?
/var/log/clickhouse-server/clickhouse-server.err.log:2022.05.10 16:51:34.338905 [ 15371 ] {} <Fatal> BaseDaemon: 7. ? @ 0x7fb2d489f006 in ?
/var/log/clickhouse-server/clickhouse-server.err.log:2022.05.10 16:51:35.336094 [ 15371 ] {} <Fatal> BaseDaemon: 8. /build/build_docker/../src/Storages/MergeTree/IMergeTreeDataPart.cpp:0: DB::IMergeTreeDataPart::appendRemovalTIDToVersionMetadata(bool) const @ 0x26ea6e01 in /usr/bin/clickhouse
/var/log/clickhouse-server/clickhouse-server.err.log:2022.05.10 16:51:36.125652 [ 15371 ] {} <Fatal> BaseDaemon: 9. /build/build_docker/../src/Interpreters/MergeTreeTransaction.cpp:278: DB::MergeTreeTransaction::rollback() @ 0x2616e6b5 in /usr/bin/clickhouse
/var/log/clickhouse-server/clickhouse-server.err.log:2022.05.10 16:51:36.741204 [ 15371 ] {} <Fatal> BaseDaemon: 10. /build/build_docker/../src/Interpreters/TransactionLog.cpp:396: DB::TransactionLog::rollbackTransaction(std::__1::shared_ptr<DB::MergeTreeTransaction> const&) @ 0x2640fd9b in /usr/bin/clickhouse
/var/log/clickhouse-server/clickhouse-server.err.log:2022.05.10 16:51:37.101879 [ 15371 ] {} <Fatal> BaseDaemon: 11. /build/build_docker/../src/Interpreters/MergeTreeTransactionHolder.cpp:66: DB::MergeTreeTransactionHolder::onDestroy() @ 0x2617b659 in /usr/bin/clickhouse
/var/log/clickhouse-server/clickhouse-server.err.log:2022.05.10 16:51:37.524433 [ 15371 ] {} <Fatal> BaseDaemon: 12. /build/build_docker/../src/Interpreters/MergeTreeTransactionHolder.cpp:42: DB::MergeTreeTransactionHolder::~MergeTreeTransactionHolder() @ 0x2617b699 in /usr/bin/clickhouse
/var/log/clickhouse-server/clickhouse-server.err.log:2022.05.10 16:51:37.733710 [ 15371 ] {} <Fatal> BaseDaemon: 13. /build/build_docker/../src/Storages/MergeTree/MergePlainMergeTreeTask.h:13: DB::MergePlainMergeTreeTask::~MergePlainMergeTreeTask() @ 0x272e7721 in /usr/bin/clickhouse
/var/log/clickhouse-server/clickhouse-server.err.log:2022.05.10 16:51:40.300674 [ 15371 ] {} <Fatal> BaseDaemon: 14. /build/build_docker/../contrib/libcxx/include/__memory/construct_at.h:57: void std::__1::__destroy_at<DB::MergePlainMergeTreeTask, 0>(DB::MergePlainMergeTreeTask*) @ 0x272d7388 in /usr/bin/clickhouse
/var/log/clickhouse-server/clickhouse-server.err.log:2022.05.10 16:51:42.070072 [ 15371 ] {} <Fatal> BaseDaemon: 15. /build/build_docker/../contrib/libcxx/include/__memory/construct_at.h:82: void std::__1::destroy_at<DB::MergePlainMergeTreeTask, 0>(DB::MergePlainMergeTreeTask*) @ 0x272d7315 in /usr/bin/clickhouse
/var/log/clickhouse-server/clickhouse-server.err.log:2022.05.10 16:51:43.753169 [ 15371 ] {} <Fatal> BaseDaemon: 16. /build/build_docker/../contrib/libcxx/include/__memory/allocator_traits.h:321: void std::__1::allocator_traits<std::__1::allocator<DB::MergePlainMergeTreeTask> >::destroy<DB::MergePlainMergeTreeTask, void, void>(std::__1::allocator<DB::MergePlainMergeTreeTask>&, DB::MergePlainMergeTreeTask*) @ 0x272d72f9 in /usr/bin/clickhouse
/var/log/clickhouse-server/clickhouse-server.err.log:2022.05.10 16:51:47.712647 [ 15371 ] {} <Fatal> BaseDaemon: 17. /build/build_docker/../contrib/libcxx/include/__memory/shared_ptr.h:310: std::__1::__shared_ptr_emplace<DB::MergePlainMergeTreeTask, std::__1::allocator<DB::MergePlainMergeTreeTask> >::__on_zero_shared() @ 0x272d710e in /usr/bin/clickhouse
/var/log/clickhouse-server/clickhouse-server.err.log:2022.05.10 16:51:47.880687 [ 15371 ] {} <Fatal> BaseDaemon: 18. /build/build_docker/../contrib/libcxx/include/__memory/shared_ptr.h:175: std::__1::__shared_count::__release_shared() @ 0x17338831 in /usr/bin/clickhouse
/var/log/clickhouse-server/clickhouse-server.err.log:2022.05.10 16:51:47.917788 [ 15371 ] {} <Fatal> BaseDaemon: 19. /build/build_docker/../contrib/libcxx/include/__memory/shared_ptr.h:216: std::__1::__shared_weak_count::__release_shared() @ 0x173387d9 in /usr/bin/clickhouse
/var/log/clickhouse-server/clickhouse-server.err.log:2022.05.10 16:51:48.171377 [ 15371 ] {} <Fatal> BaseDaemon: 20. /build/build_docker/../contrib/libcxx/include/__memory/shared_ptr.h:704: std::__1::shared_ptr<DB::IExecutableTask>::~shared_ptr() @ 0x26e556cc in /usr/bin/clickhouse
/var/log/clickhouse-server/clickhouse-server.err.log:2022.05.10 16:51:48.700714 [ 15371 ] {} <Fatal> BaseDaemon: 21. /build/build_docker/../contrib/libcxx/include/__memory/shared_ptr.h:770: std::__1::shared_ptr<DB::IExecutableTask>::reset() @ 0x26f413f3 in /usr/bin/clickhouse
/var/log/clickhouse-server/clickhouse-server.err.log:2022.05.10 16:51:48.906271 [ 15371 ] {} <Fatal> BaseDaemon: 22. /build/build_docker/../src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:199: DB::MergeTreeBackgroundExecutor<DB::MergeMutateRuntimeQueue>::routine(std::__1::shared_ptr<DB::TaskRuntimeData>) @ 0x26f410f9 in /usr/bin/clickhouse
/var/log/clickhouse-server/clickhouse-server.err.log:2022.05.10 16:51:49.209706 [ 15371 ] {} <Fatal> BaseDaemon: 23. /build/build_docker/../src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:229: DB::MergeTreeBackgroundExecutor<DB::MergeMutateRuntimeQueue>::threadFunction() @ 0x26f417e2 in /usr/bin/clickhouse
/var/log/clickhouse-server/clickhouse-server.err.log:2022.05.10 16:51:49.701005 [ 15371 ] {} <Fatal> BaseDaemon: 24. /build/build_docker/../src/Storages/MergeTree/MergeTreeBackgroundExecutor.h:183: DB::MergeTreeBackgroundExecutor<DB::MergeMutateRuntimeQueue>::MergeTreeBackgroundExecutor(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, unsigned long, unsigned long, unsigned long)::'lambda'()::operator()() const @ 0x26f4a078 in /usr/bin/clickhouse
/var/log/clickhouse-server/clickhouse-server.err.log:2022.05.10 16:51:49.940334 [ 15371 ] {} <Fatal> BaseDaemon: 25. /build/build_docker/../contrib/libcxx/include/type_traits:3640: decltype(static_cast<DB::MergeTreeBackgroundExecutor<DB::MergeMutateRuntimeQueue>::MergeTreeBackgroundExecutor(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, unsigned long, unsigned long, unsigned long)::'lambda'()&>(fp)()) std::__1::__invoke<DB::MergeTreeBackgroundExecutor<DB::MergeMutateRuntimeQueue>::MergeTreeBackgroundExecutor(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, unsigned long, unsigned long, unsigned long)::'lambda'()&>(DB::MergeTreeBackgroundExecutor<DB::MergeMutateRuntimeQueue>::MergeTreeBackgroundExecutor(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, unsigned long, unsigned long, unsigned long)::'lambda'()&) @ 0x26f4a035 in /usr/bin/clickhouse
/var/log/clickhouse-server/clickhouse-server.err.log:2022.05.10 16:51:50.327665 [ 15371 ] {} <Fatal> BaseDaemon: 26. /build/build_docker/../contrib/libcxx/include/__functional/invoke.h:62: void std::__1::__invoke_void_return_wrapper<void, true>::__call<DB::MergeTreeBackgroundExecutor<DB::MergeMutateRuntimeQueue>::MergeTreeBackgroundExecutor(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, unsigned long, unsigned long, unsigned long)::'lambda'()&>(DB::MergeTreeBackgroundExecutor<DB::MergeMutateRuntimeQueue>::MergeTreeBackgroundExecutor(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, unsigned long, unsigned long, unsigned long)::'lambda'()&) @ 0x26f49ffd in /usr/bin/clickhouse
/var/log/clickhouse-server/clickhouse-server.err.log:2022.05.10 16:51:51.182942 [ 657 ] {} <Fatal> Application: Child process was terminated by signal 6.
```
Logical error: TID exists
https://s3.amazonaws.com/clickhouse-test-reports/0/ee0cef35764cc11040f4e49484aaf7ccb6b34a69/stress_test__thread__actions_.html

```
2022.05.11 18:43:07.102816 [ 29625 ] {97a96732-a382-464b-84e6-a2b7eb3c48aa} <Fatal> : Logical error: 'I's a bug: TID 13371105542879853581 (159, 33, c36968aa-1241-4c3d-acce-a338a37547b6) exists'.
2022.05.11 18:54:00.506766 [ 33365 ] {} <Fatal> BaseDaemon: ########################################
2022.05.11 18:54:00.512030 [ 33365 ] {} <Fatal> BaseDaemon: (version 22.5.1.1 (official build), build id: 0E595FB130E67337) (from thread 29625) (query_id: 97a96732-a382-464b-84e6-a2b7eb3c48aa) (query: BEGIN TRANSACTION) Received signal Aborted (6)
2022.05.11 18:54:00.517724 [ 33365 ] {} <Fatal> BaseDaemon: 
2022.05.11 18:54:00.534411 [ 33365 ] {} <Fatal> BaseDaemon: Stack trace: 0x7fa9d14b203b 0x7fa9d1491859 0xae85163 0xaf3a5af 0xaf3a82a 0x19c75350 0x19c72a6b 0x19a203f2 0x19a20189 0x19d590b2 0x19d56862 0x1ab79aa7 0x1ab8a6c8 0x1f836423 0x1f836c93 0x1fa9b536 0x1fa996d0 0x1fa97d48 0xae7f7fd 0x7fa9d1669609 0x7fa9d158e163
2022.05.11 18:54:00.548981 [ 33365 ] {} <Fatal> BaseDaemon: 5. gsignal @ 0x7fa9d14b203b in ?
2022.05.11 18:54:00.561996 [ 33365 ] {} <Fatal> BaseDaemon: 6. abort @ 0x7fa9d1491859 in ?
2022.05.11 18:54:20.564198 [ 638 ] {} <Fatal> Application: Child process was terminated by signal 6.
```
</issue>

I need you to solve the provided issue by generating a code fix that can be applied directly to the repository

Respond below:
