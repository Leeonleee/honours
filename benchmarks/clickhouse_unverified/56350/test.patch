diff --git a/tests/queries/0_stateless/01035_avg_weighted_long.reference b/tests/queries/0_stateless/01035_avg_weighted_long.reference
index f3efdc522b71..3d95ee5e4531 100644
--- a/tests/queries/0_stateless/01035_avg_weighted_long.reference
+++ b/tests/queries/0_stateless/01035_avg_weighted_long.reference
@@ -1,7 +1,5 @@
 2.3333333333333335
 nan
-1
-1
 8
 nan
 8
@@ -211,20 +209,4 @@ nan
 1
 1
 1
-2
-2
-2
-2
-2
-2
-2
-2
-2
-2
-2
-2
-2
-2
-2
-2
 1
diff --git a/tests/queries/0_stateless/01035_avg_weighted_long.sh b/tests/queries/0_stateless/01035_avg_weighted_long.sh
index 8838b07a3d77..0e76d6e328d8 100755
--- a/tests/queries/0_stateless/01035_avg_weighted_long.sh
+++ b/tests/queries/0_stateless/01035_avg_weighted_long.sh
@@ -7,13 +7,9 @@ CUR_DIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
 
 ${CLICKHOUSE_CLIENT} --query="SELECT avgWeighted(x, weight) FROM (SELECT t.1 AS x, t.2 AS weight FROM (SELECT arrayJoin([(1, 5), (2, 4), (3, 3), (4, 2), (5, 1)]) AS t));"
 ${CLICKHOUSE_CLIENT} --query="SELECT avgWeighted(x, weight) FROM (SELECT t.1 AS x, t.2 AS weight FROM (SELECT arrayJoin([(1, 0), (2, 0), (3, 0), (4, 0), (5, 0)]) AS t));"
-${CLICKHOUSE_CLIENT} --query="SELECT avgWeighted(x, y) FROM (select toDecimal256(1, 0) x, toDecimal256(1, 1) y);"
-${CLICKHOUSE_CLIENT} --query="SELECT avgWeighted(x, y) FROM (select toDecimal32(1, 0) x, toDecimal256(1, 1) y);"
 
 types=("Int8" "Int16" "Int32" "Int64" "UInt8" "UInt16" "UInt32" "UInt64" "Float32" "Float64")
 exttypes=("Int128" "Int256" "UInt256")
-# Decimal types
-dtypes=("32" "64" "128" "256")
 
 (
     for left in "${types[@]}"
@@ -32,14 +28,6 @@ dtypes=("32" "64" "128" "256")
             echo "SELECT avgWeighted(to${left}(1), to${right}(2));"
         done
     done
-
-    for left in "${dtypes[@]}"
-    do
-        for right in "${dtypes[@]}"
-        do
-            echo "SELECT avgWeighted(toDecimal${left}(2, 4), toDecimal${right}(1, 4));"
-        done
-    done
 ) | clickhouse-client -nm
 
 echo "$(${CLICKHOUSE_CLIENT} --server_logs_file=/dev/null --query="SELECT avgWeighted(['string'], toFloat64(0))" 2>&1)" \
diff --git a/tests/queries/0_stateless/01668_avg_weighted_ubsan.reference b/tests/queries/0_stateless/01668_avg_weighted_ubsan.reference
index a8921b27cffc..ec064f61ba77 100644
--- a/tests/queries/0_stateless/01668_avg_weighted_ubsan.reference
+++ b/tests/queries/0_stateless/01668_avg_weighted_ubsan.reference
@@ -1,14 +1,1 @@
 -0
-nan
-nan
-1
-2
-3
-4
-5
-6
-7
-8
-9
-nan
-nan
diff --git a/tests/queries/0_stateless/01668_avg_weighted_ubsan.sql b/tests/queries/0_stateless/01668_avg_weighted_ubsan.sql
index 1c31c23eaee3..24e7dc0cb90d 100644
--- a/tests/queries/0_stateless/01668_avg_weighted_ubsan.sql
+++ b/tests/queries/0_stateless/01668_avg_weighted_ubsan.sql
@@ -1,5 +1,1 @@
 SELECT round(avgWeighted(x, y)) FROM (SELECT 1023 AS x, 1000000000 AS y UNION ALL SELECT 10 AS x, -9223372036854775808 AS y);
-select avgWeighted(number, toDecimal128(number, 9)) from numbers(0);
-SELECT avgWeighted(a, toDecimal64(c, 9)) OVER (PARTITION BY c) FROM (SELECT number AS a, number AS c FROM numbers(10));
-select avg(toDecimal128(number, 9)) from numbers(0);
-select avgWeighted(number, toDecimal128(0, 9)) from numbers(10);
diff --git a/tests/queries/0_stateless/02912_group_array_sample.reference b/tests/queries/0_stateless/02912_group_array_sample.reference
new file mode 100644
index 000000000000..d00491fd7e5b
--- /dev/null
+++ b/tests/queries/0_stateless/02912_group_array_sample.reference
@@ -0,0 +1,1 @@
+1
diff --git a/tests/queries/0_stateless/02912_group_array_sample.sql b/tests/queries/0_stateless/02912_group_array_sample.sql
new file mode 100644
index 000000000000..6cf9d45170b1
--- /dev/null
+++ b/tests/queries/0_stateless/02912_group_array_sample.sql
@@ -0,0 +1,2 @@
+-- Checks that the random seed is different for multiple states of aggregation:
+SELECT uniq(x) > 50 FROM (SELECT number, groupArraySample(10)(arrayJoin(range(1000))) AS x FROM numbers(100) GROUP BY number);
diff --git a/tests/queries/0_stateless/02913_sum_map_state.reference b/tests/queries/0_stateless/02913_sum_map_state.reference
new file mode 100644
index 000000000000..bfe24f39796b
--- /dev/null
+++ b/tests/queries/0_stateless/02913_sum_map_state.reference
@@ -0,0 +1,1 @@
+0200000000010000000000000000000000000000000100000002000000000000000000000000000000
diff --git a/tests/queries/0_stateless/02913_sum_map_state.sql b/tests/queries/0_stateless/02913_sum_map_state.sql
new file mode 100644
index 000000000000..9f4fd27bb2dc
--- /dev/null
+++ b/tests/queries/0_stateless/02913_sum_map_state.sql
@@ -0,0 +1,1 @@
+SELECT hex(sumMappedArraysState([CAST('0.1', 'Decimal(3)'), CAST('1', 'Decimal(3)')], [CAST('1.2', 'Decimal(3)'), CAST('2', 'Decimal(3)')]));
