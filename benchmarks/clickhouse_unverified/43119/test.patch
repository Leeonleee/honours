diff --git a/tests/queries/0_stateless/02479_analyzer_aggregation_totals_rollup_crash_fix.reference b/tests/queries/0_stateless/02479_analyzer_aggregation_totals_rollup_crash_fix.reference
new file mode 100644
index 000000000000..7c5d87e13898
--- /dev/null
+++ b/tests/queries/0_stateless/02479_analyzer_aggregation_totals_rollup_crash_fix.reference
@@ -0,0 +1,8 @@
+0
+0
+
+0
+((0.0001))	0
+((0.0001))	0
+
+((0.0001))	0
diff --git a/tests/queries/0_stateless/02479_analyzer_aggregation_totals_rollup_crash_fix.sql b/tests/queries/0_stateless/02479_analyzer_aggregation_totals_rollup_crash_fix.sql
new file mode 100644
index 000000000000..6cd3e6a93852
--- /dev/null
+++ b/tests/queries/0_stateless/02479_analyzer_aggregation_totals_rollup_crash_fix.sql
@@ -0,0 +1,5 @@
+SET allow_experimental_analyzer = 1;
+
+SELECT anyLast(number) FROM numbers(1) GROUP BY number WITH ROLLUP WITH TOTALS;
+
+SELECT tuple(tuple(0.0001)), anyLast(number) FROM numbers(1) GROUP BY number WITH ROLLUP WITH TOTALS;
