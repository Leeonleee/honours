diff --git a/src/Planner/PlannerWindowFunctions.cpp b/src/Planner/PlannerWindowFunctions.cpp
index 29c190b45ad2..4d8584e1f37e 100644
--- a/src/Planner/PlannerWindowFunctions.cpp
+++ b/src/Planner/PlannerWindowFunctions.cpp
@@ -139,7 +139,7 @@ extractWindowDescriptions(const QueryTreeNodes & window_function_nodes, const Pl
 
 void sortWindowDescriptions(std::vector<WindowDescription> & window_descriptions)
 {
-    auto window_description_comparator = [](const WindowDescription & lhs, const WindowDescription & rhs)
+    auto window_description_comparator = [](const WindowDescription & lhs, const WindowDescription & rhs) -> bool
     {
         const auto & left = lhs.full_sort_description;
         const auto & right = rhs.full_sort_description;
@@ -159,6 +159,18 @@ void sortWindowDescriptions(std::vector<WindowDescription> & window_descriptions
             if (left[i].nulls_direction > right[i].nulls_direction)
                 return false;
 
+            if (left[i].collator || right[i].collator)
+            {
+                if (!left[i].collator)
+                    return true;
+                if (!right[i].collator)
+                    return false;
+                if (left[i].collator->getLocale() < right[i].collator->getLocale())
+                    return true;
+                if (left[i].collator->getLocale() > right[i].collator->getLocale())
+                    return false;
+            }
+
             assert(left[i] == right[i]);
         }
 
