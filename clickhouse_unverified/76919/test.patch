diff --git a/tests/queries/0_stateless/03365_finish_sorting_crash.reference b/tests/queries/0_stateless/03365_finish_sorting_crash.reference
new file mode 100644
index 000000000000..e69de29bb2d1
diff --git a/tests/queries/0_stateless/03365_finish_sorting_crash.sql b/tests/queries/0_stateless/03365_finish_sorting_crash.sql
new file mode 100644
index 000000000000..d441c6bdc08d
--- /dev/null
+++ b/tests/queries/0_stateless/03365_finish_sorting_crash.sql
@@ -0,0 +1,10 @@
+CREATE TABLE test(
+    key String,
+    val Array(String)
+) engine = MergeTree
+order by key;
+
+insert into test VALUES ('', ['xx']);
+insert into test VALUES ('', []);
+
+SELECT key, arrayJoin(val) as res FROM test ORDER BY ALL settings max_threads = 1, read_in_order_two_level_merge_threshold = 0 format Null;
