{
  "repo": "ClickHouse/ClickHouse",
  "pull_number": 68052,
  "instance_id": "ClickHouse__ClickHouse-68052",
  "issue_numbers": [
    "65299",
    "66892"
  ],
  "base_commit": "42ae591017f410fffe5696ab396723f27626a528",
  "patch": "diff --git a/src/Interpreters/MutationsInterpreter.cpp b/src/Interpreters/MutationsInterpreter.cpp\nindex 57ad5caa4c77..5de33b3ed867 100644\n--- a/src/Interpreters/MutationsInterpreter.cpp\n+++ b/src/Interpreters/MutationsInterpreter.cpp\n@@ -146,7 +146,6 @@ ColumnDependencies getAllColumnDependencies(\n \n \n bool isStorageTouchedByMutations(\n-    MergeTreeData & storage,\n     MergeTreeData::DataPartPtr source_part,\n     const StorageMetadataPtr & metadata_snapshot,\n     const std::vector<MutationCommand> & commands,\n@@ -155,7 +154,9 @@ bool isStorageTouchedByMutations(\n     if (commands.empty())\n         return false;\n \n+    auto storage_from_part = std::make_shared<StorageFromMergeTreeDataPart>(source_part);\n     bool all_commands_can_be_skipped = true;\n+\n     for (const auto & command : commands)\n     {\n         if (command.type == MutationCommand::APPLY_DELETED_MASK)\n@@ -170,7 +171,7 @@ bool isStorageTouchedByMutations(\n \n             if (command.partition)\n             {\n-                const String partition_id = storage.getPartitionIDFromQuery(command.partition, context);\n+                const String partition_id = storage_from_part->getPartitionIDFromQuery(command.partition, context);\n                 if (partition_id == source_part->info.partition_id)\n                     all_commands_can_be_skipped = false;\n             }\n@@ -184,20 +185,18 @@ bool isStorageTouchedByMutations(\n     if (all_commands_can_be_skipped)\n         return false;\n \n-    auto storage_from_part = std::make_shared<StorageFromMergeTreeDataPart>(source_part);\n-\n     std::optional<InterpreterSelectQuery> interpreter_select_query;\n     BlockIO io;\n \n     if (context->getSettingsRef().allow_experimental_analyzer)\n     {\n-        auto select_query_tree = prepareQueryAffectedQueryTree(commands, storage.shared_from_this(), context);\n+        auto select_query_tree = prepareQueryAffectedQueryTree(commands, storage_from_part, context);\n         InterpreterSelectQueryAnalyzer interpreter(select_query_tree, context, SelectQueryOptions().ignoreLimits());\n         io = interpreter.execute();\n     }\n     else\n     {\n-        ASTPtr select_query = prepareQueryAffectedAST(commands, storage.shared_from_this(), context);\n+        ASTPtr select_query = prepareQueryAffectedAST(commands, storage_from_part, context);\n         /// Interpreter must be alive, when we use result of execute() method.\n         /// For some reason it may copy context and give it into ExpressionTransform\n         /// after that we will use context from destroyed stack frame in our stream.\ndiff --git a/src/Interpreters/MutationsInterpreter.h b/src/Interpreters/MutationsInterpreter.h\nindex 6aaa233cda3b..57863e9ae737 100644\n--- a/src/Interpreters/MutationsInterpreter.h\n+++ b/src/Interpreters/MutationsInterpreter.h\n@@ -19,7 +19,6 @@ using QueryPipelineBuilderPtr = std::unique_ptr<QueryPipelineBuilder>;\n \n /// Return false if the data isn't going to be changed by mutations.\n bool isStorageTouchedByMutations(\n-    MergeTreeData & storage,\n     MergeTreeData::DataPartPtr source_part,\n     const StorageMetadataPtr & metadata_snapshot,\n     const std::vector<MutationCommand> & commands,\ndiff --git a/src/Storages/MergeTree/MutateTask.cpp b/src/Storages/MergeTree/MutateTask.cpp\nindex 9a775db73e22..5fcf699de59c 100644\n--- a/src/Storages/MergeTree/MutateTask.cpp\n+++ b/src/Storages/MergeTree/MutateTask.cpp\n@@ -2134,7 +2134,7 @@ bool MutateTask::prepare()\n             ctx->commands_for_part.emplace_back(command);\n \n     if (ctx->source_part->isStoredOnDisk() && !isStorageTouchedByMutations(\n-        *ctx->data, ctx->source_part, ctx->metadata_snapshot, ctx->commands_for_part, context_for_reading))\n+        ctx->source_part, ctx->metadata_snapshot, ctx->commands_for_part, context_for_reading))\n     {\n         NameSet files_to_copy_instead_of_hardlinks;\n         auto settings_ptr = ctx->data->getSettings();\n",
  "test_patch": "diff --git a/tests/queries/0_stateless/03221_mutation_analyzer_skip_part.reference b/tests/queries/0_stateless/03221_mutation_analyzer_skip_part.reference\nnew file mode 100644\nindex 000000000000..68f8708dbaf4\n--- /dev/null\n+++ b/tests/queries/0_stateless/03221_mutation_analyzer_skip_part.reference\n@@ -0,0 +1,4 @@\n+1_1_1_0_3\t10000\n+1_1_1_0_4\t0\n+2_2_2_0_3\t0\n+2_2_2_0_4\t10000\ndiff --git a/tests/queries/0_stateless/03221_mutation_analyzer_skip_part.sql b/tests/queries/0_stateless/03221_mutation_analyzer_skip_part.sql\nnew file mode 100644\nindex 000000000000..bf9a10e2af40\n--- /dev/null\n+++ b/tests/queries/0_stateless/03221_mutation_analyzer_skip_part.sql\n@@ -0,0 +1,21 @@\n+DROP TABLE IF EXISTS t_mutate_skip_part;\n+\n+CREATE TABLE t_mutate_skip_part (key UInt64, id UInt64, v1 UInt64, v2 UInt64) ENGINE = MergeTree ORDER BY id PARTITION BY key;\n+\n+INSERT INTO t_mutate_skip_part SELECT 1, number, number, number FROM numbers(10000);\n+INSERT INTO t_mutate_skip_part SELECT 2, number, number, number FROM numbers(10000);\n+\n+SET mutations_sync = 2;\n+\n+ALTER TABLE t_mutate_skip_part UPDATE v1 = 1000 WHERE key = 1;\n+ALTER TABLE t_mutate_skip_part DELETE WHERE key = 2 AND v2 % 10 = 0;\n+\n+SYSTEM FLUSH LOGS;\n+\n+-- If part is skipped in mutation and hardlinked then read_rows must be 0.\n+SELECT part_name, read_rows\n+FROM system.part_log\n+WHERE database = currentDatabase() AND table = 't_mutate_skip_part' AND event_type = 'MutatePart'\n+ORDER BY part_name;\n+\n+DROP TABLE IF EXISTS t_mutate_skip_part;\n",
  "problem_statement": "ALTER DELETE with skip index on where clause not longer pruning parts\n**Describe the issue**\r\n\r\nI have a large event table from which we infrequently (1 or 2 per day) need to remove some of the most freshly written data.\r\nWe put a minmax skip index on the numeric field we use in the delete where clause, and when we have to run this mutation, it's always very fast because only the latest handful of parts are rewritten.\r\n\r\nAfter I upgraded from 23.12 to 24.5, the same mutation is rewriting every part of the table, like if no parts pruning based on the filter happens anymore. This is a total blocker for us as delete mutations are made unusable by this new behaviour.\r\n\r\nAfter having downgraded to 24.4, then 24.3 then 24.2, I finally managed to find out that this \"regression\" appeared in 24.3 (24.2 is working as before).\r\n\r\n* Which ClickHouse server versions are incompatible\r\n\r\n- 24.3\r\n- 24.4\r\n- 24.5\r\n\r\n* `CREATE TABLE` statements for all tables involved\r\n\r\n```sql\r\nCREATE TABLE evm_blocks_ethereum_mainnet\r\nON CLUSTER <SOME_CLUSTER> (\r\n    block_hash String,\r\n    block_number UInt64,\r\n    parent_hash String,\r\n    transactions_root String,\r\n    state_root String,\r\n    receipts_root String,\r\n    miner String,\r\n    difficulty UInt256,\r\n    total_difficulty UInt256,\r\n    size UInt32,\r\n    extra_data String,\r\n    gas_limit UInt32,\r\n    gas_used UInt32,\r\n    timestamp DateTime,\r\n    base_fee_per_gas UInt64,\r\n)\r\nENGINE = ReplicatedReplacingMergeTree('/clickhouse/tables/{installation}/{cluster}/{shard}/{database}/{uuid}', '{replica}')\r\nPARTITION BY toYYYYMM(timestamp)\r\nORDER BY (timestamp, block_number);\r\n\r\nALTER TABLE  evm_blocks_ethereum_mainnet\r\nON CLUSTER <SOME_CLUSTER>\r\nADD INDEX block_number block_number TYPE minmax GRANULARITY 4;\r\n```\r\n\r\n* Queries to run that lead to unexpected result\r\n\r\n```sql\r\nALTER TABLE evm_blocks_ethereum_mainnet DELETE WHERE block_number > <SOME_RECENT_BLOCK_NUMBER>\r\n```\r\n\nLightweight deletes using subqueries significantly slower in 24.3\n**Describe the unexpected behaviour**\r\n\r\nIn 24.3, lightweight deletions of the following form appear to run much slower in 24.3 vs 24.2.\r\n\r\n```\r\nDELETE FROM tbl\r\nWHERE (a,b,c) in (\r\n  select a,b,c from another_tbl\r\n)\r\n```\r\n\r\nThe subquery returns very quickly (typically only a few hundred rows), but adding the `DELETE` causes the drop in performance compared to 24.2.\r\n\r\nAfter the CH upgrade we go from few seconds to >1min for the mutation to complete.\r\n\r\nWe have found a workaround that speeds up the mutation significantly, but is less than ideal : \r\n\r\n```\r\nDELETE FROM tbl\r\nWHERE concatWithSeparator('|', a,b,c) in (\r\n  select concatWithSeparator('|', a,b,c) from another_tbl\r\n)\r\n```\r\n\r\n* Both tables have `ORDER BY a,b,c` and do not have partitions specified.\r\n* `a` is a time dimension, where values are in _hourly_ granularity\r\n* `tbl` contains about a million rows for each hour\r\n* the subquery always returns values for deletion for a single hour (the rows _are not_ distributed over all time).\r\n* as mentioned above the subquery returns a small number of rows to delete, up to a few hundred at most\r\n* if the subquery returns no rows, the statement completes quickly, so it looks like it is slow only when there is one or more rows to delete\r\n* deleting a single row takes about the same time as deleting a few hundred.\n",
  "hints_text": "> After I upgraded from 23.12 to 24.5, the same mutation is rewriting every part of the table, like if no parts pruning based on the filter happens anymore. This is a total blocker for us as delete mutations are made unusable by this new behaviour.\r\n\r\nTechnically, it always worked in such way.\r\nMaybe, this degradation have other reason/explanation. \r\nhttps://github.com/ClickHouse/ClickHouse/issues/59225#issuecomment-2164730199\nWhen I looked in the system.part_log table, I observed that prior to 2024.3, most entries generated by the mutation had read_rows = 0, while after the upgrade the number was never 0 anymore.\nI found out in previous issues that parts that where pruned by the where clause are supposed to be renamed only. \r\nThis behaviour is consistent with the previous perf characteristics  I used to observe for this mutation.\r\n\r\n[https://github.com/ClickHouse/ClickHouse/issues/12188](https://github.com/ClickHouse/ClickHouse/issues/12188)\nWhat about SELECTs? Is the index used?\r\n```\r\nexplain indexes=1\r\nSELECT count() from evm_blocks_ethereum_mainnet  \r\nWHERE block_number > <SOME_RECENT_BLOCK_NUMBER>\r\n```\nUnfortunately I cannot test your query by now because I downgraded the nodes to 24.2.\r\n\r\nBut the following query ran in low milliseconds so I am confident that the index is actually used.\r\n\r\n```sql\r\nselect\r\n    max(block_number)\r\nfrom evm_blocks_ethereum_mainnet\r\nsettings max_threads=1\r\n```\r\n\r\n\nHi @SaltTan ,\r\n\r\nIs there anything a can do to help investigate this issue ?\nHi! I have the same problem.\r\n\r\nTable:\r\n\r\n\r\n```\r\nclickhouse :) show create table tseries\r\n\r\nCREATE TABLE datalake.tseries\r\n(\r\n    `time` DateTime64(3, 'UTC') CODEC(DoubleDelta),\r\n    `tagID` UInt64,\r\n    `valInt` Int64,\r\n    `valFloat` Float64 CODEC(Gorilla),\r\n    `valStr` String,\r\n    `status` UInt16 CODEC(T64),\r\n    `preparedAt` DateTime64(3, 'UTC') CODEC(DoubleDelta),\r\n    `savedAt` DateTime64(3, 'UTC') DEFAULT now64() CODEC(DoubleDelta),\r\n    `comment` String,\r\n    `hidden` Int8\r\n)\r\nENGINE = ReplacingMergeTree\r\nPARTITION BY toYYYYMM(time)\r\nPRIMARY KEY (tagID, time)\r\nORDER BY (tagID, time, valInt, valFloat, valStr, status, comment, hidden)\r\nTTL toDateTime(time) + toIntervalDay(3650)\r\nSETTINGS index_granularity = 8192\r\n\r\n1 row in set. Elapsed: 0.005 sec. \r\n\r\nclickhouse :) select count(*) from tseries\r\n\r\n\u250c\u2500\u2500\u2500\u2500\u2500count()\u2500\u2510\r\n\u2502 41931009054 \u2502 -- 41.93 billion\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n\r\n1 row in set. Elapsed: 0.015 sec. \r\n```\r\n\r\nI'm trying to delete the record using 24.2\r\n\r\n```\r\nClickHouse client version 24.2.3.70 (official build).\r\nConnecting to localhost:9000 as user default.\r\nConnected to ClickHouse server version 24.2.3.\r\n\r\nclickhouse :) select * from tseries where tagID=329295 and time='2024-07-23T06:57:05'\r\n\r\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500time\u2500\u252c\u2500\u2500tagID\u2500\u252c\u2500valInt\u2500\u252c\u2500valFloat\u2500\u252c\u2500valStr\u2500\u252c\u2500status\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500preparedAt\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500savedAt\u2500\u252c\u2500comment\u2500\u252c\u2500hidden\u2500\u2510\r\n\u2502 2024-07-23 06:57:05.000 \u2502 329295 \u2502      0 \u2502       51 \u2502        \u2502    448 \u2502 2024-07-23 12:46:36.194 \u2502 2024-07-23 12:46:36.223 \u2502         \u2502      0 \u2502\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n\r\n1 row in set. Elapsed: 0.038 sec. Processed 57.34 thousand rows, 737.34 KB (1.51 million rows/s., 19.37 MB/s.)\r\nPeak memory usage: 81.67 KiB.\r\n\r\nclickhouse :) alter table tseries delete where tagID=329295 and time='2024-07-23T06:57:05'\r\n\r\n0 rows in set. Elapsed: 0.008 sec. \r\n\r\nclickhouse :) select * from system.mutations where is_done = 0\r\n\r\n0 rows in set. Elapsed: 0.024 sec. \r\n\r\nclickhouse :) select * from tseries where tagID=329295 and time='2024-07-23T06:57:05'\r\n\r\n0 rows in set. Elapsed: 0.011 sec. Processed 57.34 thousand rows, 458.75 KB (5.07 million rows/s., 40.56 MB/s.)\r\nPeak memory usage: 122.07 KiB.\r\n```\r\n\r\nGreat - the record was deleted after a couple of seconds\r\n\r\nUpgrade Clickhouse to 24.6  and try to delete the next record.\r\n\r\n```\r\nClickHouse client version 24.6.2.17 (official build).\r\nConnecting to localhost:9000 as user default.\r\nConnected to ClickHouse server version 24.6.2.\r\n\r\nclickhouse :) select * from tseries where tagID=329295 and time='2024-07-23T06:57:06'\r\n   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500time\u2500\u252c\u2500\u2500tagID\u2500\u252c\u2500valInt\u2500\u252c\u2500valFloat\u2500\u252c\u2500valStr\u2500\u252c\u2500status\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500preparedAt\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500savedAt\u2500\u252c\u2500comment\u2500\u252c\u2500hidden\u2500\u2510\r\n1. \u2502 2024-07-23 06:57:06.000 \u2502 329295 \u2502      0 \u2502       52 \u2502        \u2502    448 \u2502 2024-07-23 12:55:33.141 \u2502 2024-07-23 12:55:33.177 \u2502         \u2502      0 \u2502\r\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n\r\n1 row in set. Elapsed: 0.017 sec. Processed 65.54 thousand rows, 802.88 KB (3.96 million rows/s., 48.56 MB/s.)\r\nPeak memory usage: 87.12 KiB.\r\n\r\nclickhouse :) alter table tseries delete where tagID=329295 and time='2024-07-23T06:57:06'\r\n\r\n0 rows in set. Elapsed: 0.013 sec. \r\n\r\nclickhouse :) select * from tseries where tagID=329295 and time='2024-07-23T06:57:06'\r\n   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500time\u2500\u252c\u2500\u2500tagID\u2500\u252c\u2500valInt\u2500\u252c\u2500valFloat\u2500\u252c\u2500valStr\u2500\u252c\u2500status\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500preparedAt\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500savedAt\u2500\u252c\u2500comment\u2500\u252c\u2500hidden\u2500\u2510\r\n1. \u2502 2024-07-23 06:57:06.000 \u2502 329295 \u2502      0 \u2502       52 \u2502        \u2502    448 \u2502 2024-07-23 12:55:33.141 \u2502 2024-07-23 12:55:33.177 \u2502         \u2502      0 \u2502\r\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n\r\n1 row in set. Elapsed: 0.029 sec. Processed 57.34 thousand rows, 737.34 KB (1.98 million rows/s., 25.50 MB/s.)\r\nPeak memory usage: 87.99 KiB.\r\n\r\nclickhouse :) select * from system.mutations where is_done = 0\r\n   \u250c\u2500database\u2500\u252c\u2500table\u2500\u2500\u2500\u252c\u2500mutation_id\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500command\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500create_time\u2500\u252c\u2500block_numbers.partition_id\u2500\u252c\u2500block_numbers.number\u2500\u252c\u2500parts_to_do_names\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500parts_to_do\u2500\u252c\u2500is_done\u2500\u252c\u2500is_killed\u2500\u252c\u2500latest_failed_part\u2500\u252c\u2500\u2500\u2500\u2500latest_fail_time\u2500\u252c\u2500latest_fail_reason\u2500\u2510\r\n1. \u2502 datalake \u2502 tseries \u2502 mutation_154834942.txt \u2502 DELETE WHERE (tagID = 329295) AND (time = '2024-07-23T06:57:06') \u2502 2024-07-23 13:02:21 \u2502 ['']                       \u2502 [154834942]          \u2502 ['202404_93072922_93862270_834_154834193','202406_137059832_137084096_462_154834193','202406_137034606_137059831_446_154834193','202406_137013587_137034605_394_154834193','202406_136946954_137013586_408_154834193','202407_154833821_154834932_271_154834193','202407_154828008_154833820_307_154834193','202407_154820230_154828007_300_154834193','202407_154796099_154820229_437_154834193','202308_35_90766563_4_154834193','202309_142_512_6_154834193','202407_154760472_154796098_463_154834193','202311_6593_86242550_14912_154834193','202312_21769848_31293026_702_154834193','202312_31293027_44411087_780_154834193','202312_44411088_54680789_636_154834193','202312_54680790_56244628_570_154834193','202312_56244629_56290644_530_154834193','202407_154725351_154760471_444_154834193','202407_154624752_154725350_481_154834193','202407_154520282_154624751_472_154834193','202407_154478067_154520281_494_154834193','202407_154139165_154478066_516_154834193','202407_137094956_154139164_1031_154834193','202401_56347023_73985304_110981_154834193','202406_137095206_137095410_1_154834193','202402_65896140_68934012_1418_154834193','202402_68934013_72276641_334_154834193','202402_72276642_72811657_321_154834193','202402_72811658_73513961_315_154834193','202402_73513962_73877862_325_154834193','202402_73877863_74322796_310_154834193','202402_74322797_74371614_338_154834193','202402_74371615_74474152_322_154834193','202402_74474153_74592461_329_154834193','202402_74592462_74675502_314_154834193','202406_137093532_137095155_380_154834193','202406_137091141_137093531_408_154834193','202402_74679371_74679506_39_154834193','202403_74679499_77887308_327_154834193','202403_77887309_81016579_350_154834193','202403_81016580_81526652_339_154834193','202403_81526653_82279489_314_154834193','202403_82279490_82877440_339_154834193','202403_82877441_83040022_331_154834193','202403_83040023_83233048_324_154834193','202403_83233049_83360105_339_154834193','202403_83360106_83391775_276_154834193','202403_83391776_83415281_291_154834193','202403_83415282_83421240_239_154834193','202403_83421241_83427076_264_154834193','202403_83427077_83427805_189_154834193','202403_83427806_83834581_70_154834193','202403_83834582_83837703_2_154834193','202404_83428017_87088536_353_154834193','202404_87088537_91664846_460_154834193','202404_91664847_92475245_435_154834193','202404_92475246_92807018_284_154834193','202404_92807019_92808417_40_154834193','202404_92808418_93072921_575_154834193','202406_137084097_137091140_432_154834193','202404_93862271_94663804_350_154834193','202404_94663805_95435735_351_154834193','202404_95435736_95564731_326_154834193','202404_95564732_95602877_309_154834193','202404_95602878_95650194_323_154834193','202404_95650195_95658662_277_154834193','202404_95658663_95666322_303_154834193','202404_95666323_95668819_293_154834193','202404_95668820_110769704_427538_154834193','202404_110769779_110769779_0_154834193','202405_95668982_99543505_328_154834193','202405_99543506_103638174_402_154834193','202405_103638175_107971331_373_154834193','202405_107971332_109047078_388_154834193','202405_109047079_110285990_399_154834193','202405_110285991_110601754_372_154834193','202405_110601755_110850953_365_154834193','202405_110850954_111064537_371_154834193','202405_111064538_111131640_346_154834193','202405_111131641_111190300_362_154834193','202405_111190301_111211388_356_154834193','202405_111211389_111259401_386_154834193','202405_111259402_111262178_341_154834193','202405_111262179_142961577_1072835_154834193','202405_142961595_143110958_1337_154834193','202405_143111092_143111092_0_154834193','202406_111264806_117518154_375_154834193','202406_117518155_124369321_512_154834193','202406_124369322_131224904_663_154834193','202406_131224905_132907058_503_154834193','202406_132907059_134476331_518_154834193','202406_134476332_136068274_502_154834193','202406_136068275_136468265_459_154834193','202406_136468266_136868453_474_154834193','202406_136868454_136946953_421_154834193','202407_154834933_154834938_1','202407_154834939_154834939_0','202407_154834940_154834940_0','202407_154834941_154834941_0'] \u2502         100 \u2502       0 \u2502         0 \u2502                    \u2502 1970-01-01 00:00:00 \u2502                    \u2502\r\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n\r\n1 row in set. Elapsed: 0.042 sec. \r\n```\r\nDeleting was completed after about 15 minutes and all this time the table was locked for writing.\r\n\nI think that large parts_to_do_names hints at this case to some kind of problem\r\n\r\n\n> I think that large parts_to_do_names hints at this case to some kind of problem\r\n\r\n`parts_to_do_names` always lists all active parts in the table. ClickHouse analyzes every part and decides if it needs to be mutated or not.\r\nCould you check what was happening during the mutation in `system.part_log`?\n```\r\nClickHouse client version 24.6.2.17 (official build).\r\nConnecting to localhost:9000 as user default.\r\nConnected to ClickHouse server version 24.6.2.\r\n\r\nclickhouse :) use datalake\r\n\r\nUSE datalake\r\n\r\nQuery id: 91599ce2-f6e4-4904-8c56-1d06aaff2ace\r\n\r\nOk.\r\n\r\n0 rows in set. Elapsed: 0.003 sec. \r\n\r\nclickhouse :) select * from tseries where tagID=329295 order by time,savedAt\r\n\r\n\r\nSELECT *\r\nFROM tseries\r\nWHERE tagID = 329295\r\nORDER BY\r\n    time ASC,\r\n    savedAt ASC\r\n\r\nQuery id: 02af86d0-efab-4bbc-a6ea-3292511564b3\r\n\r\n   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500time\u2500\u252c\u2500\u2500tagID\u2500\u252c\u2500valInt\u2500\u252c\u2500valFloat\u2500\u252c\u2500valStr\u2500\u252c\u2500status\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500preparedAt\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500savedAt\u2500\u252c\u2500comment\u2500\u252c\u2500hidden\u2500\u2510\r\n1. \u2502 2024-07-23 06:58:02.000 \u2502 329295 \u2502      0 \u2502        2 \u2502        \u2502    448 \u2502 2024-07-25 08:06:43.024 \u2502 2024-07-25 08:06:43.059 \u2502         \u2502      0 \u2502\r\n2. \u2502 2024-07-23 06:58:03.000 \u2502 329295 \u2502      0 \u2502        3 \u2502        \u2502    448 \u2502 2024-07-25 08:06:43.024 \u2502 2024-07-25 08:06:43.059 \u2502         \u2502      0 \u2502\r\n3. \u2502 2024-07-23 06:58:04.000 \u2502 329295 \u2502      0 \u2502        4 \u2502        \u2502    448 \u2502 2024-07-25 08:06:43.024 \u2502 2024-07-25 08:06:43.059 \u2502         \u2502      0 \u2502\r\n4. \u2502 2024-07-23 06:58:05.000 \u2502 329295 \u2502      0 \u2502        5 \u2502        \u2502    448 \u2502 2024-07-25 08:06:43.024 \u2502 2024-07-25 08:06:43.059 \u2502         \u2502      0 \u2502\r\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n\r\n4 rows in set. Elapsed: 0.069 sec. Processed 778.24 thousand rows, 6.50 MB (11.28 million rows/s., 94.29 MB/s.)\r\nPeak memory usage: 420.26 KiB.\r\n\r\nclickhouse :) select now()\r\n\r\nSELECT now()\r\n\r\nQuery id: b69de055-9a5f-411f-9f62-c5ba0f6697a9\r\n\r\n   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500now()\u2500\u2510\r\n1. \u2502 2024-07-25 08:21:10 \u2502\r\n   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n\r\n1 row in set. Elapsed: 0.002 sec. \r\n\r\nclickhouse :) alter table tseries delete where tagID=329295 and time='2024-07-23 06:58:02.000'\r\n\r\n\r\nALTER TABLE tseries\r\n    (DELETE WHERE (tagID = 329295) AND (time = '2024-07-23 06:58:02.000'))\r\n\r\nQuery id: f1589468-d1c0-4451-b7d8-d67055ed2746\r\n\r\nOk.\r\n\r\n0 rows in set. Elapsed: 0.014 sec. \r\n\r\nclickhouse :) SELECT * FROM system.part_log where event_time>'2024-07-25 08:21:10' and database='datalake' and table='tseries'\r\n\r\nSELECT *\r\nFROM system.part_log\r\nWHERE (event_time > '2024-07-25 08:21:10') AND (database = 'datalake') AND (`table` = 'tseries')\r\n\r\nQuery id: 0f178772-b7b8-42df-90fb-420e8eca583d\r\n\r\n    \u250c\u2500hostname\u2500\u2500\u2500\u252c\u2500query_id\u2500\u252c\u2500event_type\u2500\u252c\u2500merge_reason\u2500\u252c\u2500merge_algorithm\u2500\u252c\u2500event_date\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500event_time\u2500\u252c\u2500\u2500\u2500\u2500event_time_microseconds\u2500\u252c\u2500duration_ms\u2500\u252c\u2500database\u2500\u252c\u2500table\u2500\u2500\u2500\u252c\u2500table_uuid\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500part_name\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500partition_id\u2500\u252c\u2500partition\u2500\u252c\u2500part_type\u2500\u252c\u2500disk_name\u2500\u252c\u2500path_on_disk\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500rows\u2500\u252c\u2500size_in_bytes\u2500\u252c\u2500merged_from\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500bytes_uncompressed\u2500\u252c\u2500read_rows\u2500\u252c\u2500read_bytes\u2500\u252c\u2500peak_memory_usage\u2500\u252c\u2500error\u2500\u252c\u2500exception\u2500\u252c\u2500ProfileEvents\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n 1. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:11 \u2502 2024-07-25 08:21:11.932978 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264332_156264584_80 \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502 47035 \u2502        559065 \u2502 []                               \u2502            1981993 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n 2. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:11 \u2502 2024-07-25 08:21:11.932978 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264332_156264590_81 \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502 48144 \u2502        569170 \u2502 []                               \u2502            2028571 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n 3. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:11 \u2502 2024-07-25 08:21:11.932978 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264587_156264587_0  \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502     1 \u2502          1296 \u2502 []                               \u2502                446 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n 4. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:11 \u2502 2024-07-25 08:21:11.932978 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264588_156264588_0  \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502   100 \u2502          2685 \u2502 []                               \u2502               4604 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n 5. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:11 \u2502 2024-07-25 08:21:11.932978 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264589_156264589_0  \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502     2 \u2502          1336 \u2502 []                               \u2502                488 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n 6. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:11 \u2502 2024-07-25 08:21:11.932978 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264590_156264590_0  \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502   999 \u2502         12629 \u2502 []                               \u2502              42362 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n 7. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:11 \u2502 2024-07-25 08:21:11.932978 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264591_156264591_0  \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502     2 \u2502          1345 \u2502 []                               \u2502                488 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n 8. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:11 \u2502 2024-07-25 08:21:11.932978 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264592_156264592_0  \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502     2 \u2502          1336 \u2502 []                               \u2502                488 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n 9. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:11 \u2502 2024-07-25 08:21:11.932978 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264593_156264593_0  \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502   443 \u2502          6975 \u2502 []                               \u2502              19090 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n10. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:11 \u2502 2024-07-25 08:21:11.932978 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264594_156264594_0  \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502    25 \u2502          1472 \u2502 []                               \u2502               1454 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n11. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:11 \u2502 2024-07-25 08:21:11.932978 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264595_156264595_0  \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502   187 \u2502          2672 \u2502 []                               \u2502               8348 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n12. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:11 \u2502 2024-07-25 08:21:11.932978 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264596_156264596_0  \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502   170 \u2502          2672 \u2502 []                               \u2502               7634 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n13. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:11 \u2502 2024-07-25 08:21:11.932978 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264597_156264597_0  \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502     6 \u2502          1411 \u2502 []                               \u2502                656 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n14. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:11 \u2502 2024-07-25 08:21:11.932978 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264598_156264598_0  \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502   161 \u2502          2677 \u2502 []                               \u2502               7256 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n15. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264332_156264593_82 \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502 48591 \u2502        575950 \u2502 []                               \u2502            2047425 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n16. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264332_156264594_83 \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502 48616 \u2502        576354 \u2502 []                               \u2502            2048475 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n17. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264332_156264604_84 \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502 50685 \u2502        612230 \u2502 []                               \u2502            2135943 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n18. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264332_156264605_85 \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502 50687 \u2502        612243 \u2502 []                               \u2502            2136027 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n19. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264332_156264606_86 \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502 50687 \u2502        612155 \u2502 []                               \u2502            2136027 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n20. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264332_156264613_87 \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502 51804 \u2502        614826 \u2502 []                               \u2502            2182940 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n21. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264595_156264600_1  \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502   526 \u2502          8683 \u2502 []                               \u2502              22766 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n22. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264599_156264599_0  \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502     1 \u2502          1296 \u2502 []                               \u2502                446 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n23. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264600_156264600_0  \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502     1 \u2502          1296 \u2502 []                               \u2502                446 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n24. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264601_156264601_0  \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502     2 \u2502          1345 \u2502 []                               \u2502                488 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n25. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264602_156264602_0  \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502   100 \u2502          2676 \u2502 []                               \u2502               4604 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n26. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264603_156264603_0  \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502   999 \u2502         12622 \u2502 []                               \u2502              40373 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n27. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264604_156264604_0  \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502   443 \u2502          7430 \u2502 []                               \u2502              19090 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n28. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264605_156264605_0  \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502     2 \u2502          1336 \u2502 []                               \u2502                488 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n29. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264606_156264606_0  \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502    25 \u2502          1472 \u2502 []                               \u2502               1454 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n30. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264607_156264607_0  \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502     1 \u2502          1296 \u2502 []                               \u2502                446 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n31. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264607_156264612_1  \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502   120 \u2502          3202 \u2502 []                               \u2502               5444 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n32. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264608_156264608_0  \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502     1 \u2502          1296 \u2502 []                               \u2502                446 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n33. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264609_156264609_0  \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502   100 \u2502          2627 \u2502 []                               \u2502               4413 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n34. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264610_156264610_0  \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502     2 \u2502          1345 \u2502 []                               \u2502                488 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n35. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264611_156264611_0  \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502     7 \u2502          1400 \u2502 []                               \u2502                698 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n36. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264612_156264612_0  \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502     9 \u2502          1427 \u2502 []                               \u2502                782 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n37. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264613_156264613_0  \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502   999 \u2502         12629 \u2502 []                               \u2502              42362 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n38. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264614_156264614_0  \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502     2 \u2502          1336 \u2502 []                               \u2502                488 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n39. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264615_156264615_0  \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502     1 \u2502          1298 \u2502 []                               \u2502                453 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n40. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264616_156264616_0  \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502    25 \u2502          1472 \u2502 []                               \u2502               1454 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n41. \u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264617_156264617_0  \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                  \u2502   443 \u2502          7396 \u2502 []                               \u2502              19090 \u2502         0 \u2502          0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n42. \u2502 clickhouse \u2502          \u2502 MutatePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.649339 \u2502          94 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202212_1_1_1_156268256        \u2502 202212       \u2502           \u2502 Compact   \u2502 default   \u2502 /var/lib/clickhouse/store/46d/46dd69cf-2824-4127-925c-f4e921ea6b24/202212_1_1_1_156268256/       \u2502 18832 \u2502        124922 \u2502 ['202212_1_1_1_156263017']       \u2502             641159 \u2502     18832 \u2502     640513 \u2502           8383603 \u2502     0 \u2502           \u2502 {'QueriesWithSubqueries':1,'SelectQueriesWithSubqueries':1,'FileOpen':14,'ReadBufferFromFileDescriptorRead':5,'ReadBufferFromFileDescriptorReadBytes':123993,'WriteBufferFromFileDescriptorWrite':12,'WriteBufferFromFileDescriptorWriteBytes':125532,'ReadCompressedBytes':123993,'CompressedReadBufferBlocks':31,'CompressedReadBufferBytes':641095,'OpenedFileCacheMisses':2,'OpenedFileCacheMicroseconds':2,'IOBufferAllocs':39,'IOBufferAllocBytes':9803391,'FunctionExecute':16,'CreatedReadBufferOrdinary':2,'DiskReadElapsedMicroseconds':95,'DiskWriteElapsedMicroseconds':1348,'SelectedParts':7,'SelectedRanges':7,'SelectedMarks':7,'WaitMarksLoadMicroseconds':144,'LoadedMarksCount':40,'LoadedMarksMemoryBytes':184,'Merge':4,'MergedRows':18832,'MergedUncompressedBytes':640513,'MergesTimeMilliseconds':81,'ContextLock':54,'ContextLockWaitMicroseconds':14,'RWLockAcquiredReadLocks':1,'PartsLockHoldMicroseconds':934,'PartsLockWaitMicroseconds':822,'QueryProfilerRuns':1,'LogTrace':17,'LogDebug':8} \u2502\r\n43. \u2502 clickhouse \u2502          \u2502 MutatePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.674303 \u2502          78 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202310_6444_6592_5_156268256  \u2502 202310       \u2502           \u2502 Wide      \u2502 default   \u2502 /var/lib/clickhouse/store/46d/46dd69cf-2824-4127-925c-f4e921ea6b24/202310_6444_6592_5_156268256/ \u2502  6566 \u2502         32007 \u2502 ['202310_6444_6592_5_156263017'] \u2502             276512 \u2502      6566 \u2502     275831 \u2502          32281669 \u2502     0 \u2502           \u2502 {'QueriesWithSubqueries':1,'SelectQueriesWithSubqueries':1,'FileOpen':57,'ReadBufferFromFileDescriptorRead':19,'ReadBufferFromFileDescriptorReadBytes':30865,'WriteBufferFromFileDescriptorWrite':34,'WriteBufferFromFileDescriptorWriteBytes':33224,'ReadCompressedBytes':30865,'CompressedReadBufferBlocks':19,'CompressedReadBufferBytes':276240,'OpenedFileCacheMisses':19,'OpenedFileCacheMicroseconds':51,'IOBufferAllocs':164,'IOBufferAllocBytes':33863985,'FunctionExecute':8,'CreatedReadBufferOrdinary':19,'DiskReadElapsedMicroseconds':10788,'DiskWriteElapsedMicroseconds':1038,'SelectedParts':7,'SelectedRanges':7,'SelectedMarks':7,'WaitMarksLoadMicroseconds':9038,'LoadedMarksCount':18,'LoadedMarksMemoryBytes':912,'Merge':2,'MergedRows':6566,'MergedUncompressedBytes':275831,'MergesTimeMilliseconds':69,'ContextLock':52,'RWLockAcquiredReadLocks':1,'PartsLockHoldMicroseconds':389,'LogTrace':17,'LogDebug':8,'GWPAsanAllocateSuccess':1,'GWPAsanFree':1} \u2502\r\n    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n\r\n43 rows in set. Elapsed: 0.012 sec. Processed 2.91 thousand rows, 1.40 MB (239.89 thousand rows/s., 115.38 MB/s.)\r\nPeak memory usage: 42.87 KiB.\r\n```\r\n\r\nTypical iotop for this time\r\n\r\n\r\n```\r\n Total DISK READ:       155.66 M/s | Total DISK WRITE:       157.79 M/s\r\nCurrent DISK READ:     156.29 M/s | Current DISK WRITE:     328.51 M/s\r\n    TID  PRIO  USER     DISK READ  DISK WRITE  SWAPIN     IO>    COMMAND                                                                                                                                                                                      \r\n...\r\n 944650 be/4 systemd-    0.00 B/s 1280.85 B/s  ?unavailable?  clickhouse-server --config-file=/etc/clickhouse-server/config.xml [BgSchPool]\r\n 944685 be/4 systemd-    0.00 B/s 1280.85 B/s  ?unavailable?  clickhouse-server --config-file=/etc/clickhouse-server/config.xml [BgSchPool]\r\n 944958 be/4 systemd-    9.29 M/s    7.19 M/s  ?unavailable?  clickhouse-server --config-file=/etc/clickhouse-server/config.xml [MergeMutate]\r\n 944959 be/4 systemd-   10.20 M/s   10.32 M/s  ?unavailable?  clickhouse-server --config-file=/etc/clickhouse-server/config.xml [MergeMutate]\r\n 944960 be/4 systemd-    9.65 M/s   10.02 M/s  ?unavailable?  clickhouse-server --config-file=/etc/clickhouse-server/config.xml [MergeMutate]\r\n 944961 be/4 systemd-    8.85 M/s    9.21 M/s  ?unavailable?  clickhouse-server --config-file=/etc/clickhouse-server/config.xml [MergeMutate]\r\n 944962 be/4 systemd-    9.57 M/s   10.58 M/s  ?unavailable?  clickhouse-server --config-file=/etc/clickhouse-server/config.xml [MergeMutate]\r\n 944963 be/4 systemd-    9.45 M/s   10.63 M/s  ?unavailable?  clickhouse-server --config-file=/etc/clickhouse-server/config.xml [MergeMutate]\r\n 944964 be/4 systemd-   10.11 M/s    9.38 M/s  ?unavailable?  clickhouse-server --config-file=/etc/clickhouse-server/config.xml [MergeMutate]\r\n 944965 be/4 systemd-   10.78 M/s   11.26 M/s  ?unavailable?  clickhouse-server --config-file=/etc/clickhouse-server/config.xml [MergeMutate]\r\n 944966 be/4 systemd-   10.31 M/s   11.26 M/s  ?unavailable?  clickhouse-server --config-file=/etc/clickhouse-server/config.xml [MergeMutate]\r\n 944967 be/4 systemd-    9.91 M/s    9.69 M/s  ?unavailable?  clickhouse-server --config-file=/etc/clickhouse-server/config.xml [MergeMutate]\r\n 944969 be/4 systemd-    9.90 M/s   10.96 M/s  ?unavailable?  clickhouse-server --config-file=/etc/clickhouse-server/config.xml [MergeMutate]\r\n 944970 be/4 systemd-   10.94 M/s   10.94 M/s  ?unavailable?  clickhouse-server --config-file=/etc/clickhouse-server/config.xml [MergeMutate]\r\n 944972 be/4 systemd-    8.05 M/s    7.50 M/s  ?unavailable?  clickhouse-server --config-file=/etc/clickhouse-server/config.xml [MergeMutate]\r\n 944973 be/4 systemd-    9.40 M/s    8.76 M/s  ?unavailable?  clickhouse-server --config-file=/etc/clickhouse-server/config.xml [MergeMutate]\r\n 944974 be/4 systemd-   11.40 M/s   10.93 M/s  ?unavailable?  clickhouse-server --config-file=/etc/clickhouse-server/config.xml [MergeMutate]\r\n 944975 be/4 systemd-    7.82 M/s    7.52 M/s  ?unavailable?  clickhouse-server --config-file=/etc/clickhouse-server/config.xml [MergeMutate]\r\n 945044 be/4 systemd-    0.00 B/s 1280.85 B/s  ?unavailable?  clickhouse-server --config-file=/etc/clickhouse-server/config.xml [ThreadPool]\r\n 945114 be/4 systemd-    0.00 B/s 1280.85 B/s  ?unavailable?  clickhouse-server --config-file=/etc/clickhouse-server/config.xml [SystemLogFlush]\r\n 945814 be/4 systemd-    0.00 B/s 1280.85 B/s  ?unavailable?  clickhouse-server --config-file=/etc/clickhouse-server/config.xml [ThreadPool]\r\n 945830 be/4 systemd-    0.00 B/s 1280.85 B/s  ?unavailable?  clickhouse-server --config-file=/etc/clickhouse-server/config.xml [ThreadPool]\r\n 945925 be/4 systemd-    0.00 B/s 1280.85 B/s  ?unavailable?  clickhouse-server --config-file=/etc/clickhouse-server/config.xml [ThreadPool]\r\n 945929 be/4 systemd-    0.00 B/s 1280.85 B/s  ?unavailable?  clickhouse-server --config-file=/etc/clickhouse-server/config.xml [ThreadPool]\r\n 946088 be/4 systemd-    0.00 B/s 1280.85 B/s  ?unavailable?  clickhouse-server --config-file=/etc/clickhouse-server/config.xml [ThreadPool]\r\n 946094 be/4 systemd-    0.00 B/s 1280.85 B/s  ?unavailable?  clickhouse-server --config-file=/etc/clickhouse-server/config.xml [ThreadPool]\r\n 946213 be/4 systemd-    0.00 B/s 1280.85 B/s  ?unavailable?  clickhouse-server --config-file=/etc/clickhouse-server/config.xml [ThreadPool]\r\n 946356 be/4 systemd-    0.00 B/s 1280.85 B/s  ?unavailable?  clickhouse-server --config-file=/etc/clickhouse-server/config.xml [ThreadPool]\r\n1023972 be/4 systemd-    0.00 B/s    2.50 K/s  ?unavailable?  clickhouse-server --config-file=/etc/clickhouse-server/config.xml [TCPHandler]\r\n...\r\n```\r\n\r\n\r\nI waited more than 20 minutes with no result and returned to version 24.2. The record was immediately deleted.\r\n\r\n```\r\nClickHouse client version 24.2.3.70 (official build).\r\nConnecting to localhost:9000 as user default.\r\nConnected to ClickHouse server version 24.2.3.\r\n\r\nclickhouse :) use datalake\r\n\r\nUSE datalake\r\n\r\nQuery id: bad69e46-52b5-480f-ad58-c614b35b5e95\r\n\r\nOk.\r\n\r\n0 rows in set. Elapsed: 0.002 sec. \r\n\r\nclickhouse :) select * from tseries where tagID=329295 order by time,savedAt\r\n\r\nSELECT *\r\nFROM tseries\r\nWHERE tagID = 329295\r\nORDER BY\r\n    time ASC,\r\n    savedAt ASC\r\n\r\nQuery id: 28745ee4-802c-49b0-b01f-5f1a49254a20\r\n\r\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500time\u2500\u252c\u2500\u2500tagID\u2500\u252c\u2500valInt\u2500\u252c\u2500valFloat\u2500\u252c\u2500valStr\u2500\u252c\u2500status\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500preparedAt\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500savedAt\u2500\u252c\u2500comment\u2500\u252c\u2500hidden\u2500\u2510\r\n\u2502 2024-07-23 06:58:03.000 \u2502 329295 \u2502      0 \u2502        3 \u2502        \u2502    448 \u2502 2024-07-25 08:06:43.024 \u2502 2024-07-25 08:06:43.059 \u2502         \u2502      0 \u2502\r\n\u2502 2024-07-23 06:58:04.000 \u2502 329295 \u2502      0 \u2502        4 \u2502        \u2502    448 \u2502 2024-07-25 08:06:43.024 \u2502 2024-07-25 08:06:43.059 \u2502         \u2502      0 \u2502\r\n\u2502 2024-07-23 06:58:05.000 \u2502 329295 \u2502      0 \u2502        5 \u2502        \u2502    448 \u2502 2024-07-25 08:06:43.024 \u2502 2024-07-25 08:06:43.059 \u2502         \u2502      0 \u2502\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n\r\n3 rows in set. Elapsed: 0.083 sec. Processed 794.62 thousand rows, 6.64 MB (9.59 million rows/s., 80.09 MB/s.)\r\nPeak memory usage: 970.46 KiB.\r\n\r\nclickhouse :) SELECT * FROM system.part_log where event_time>'2024-07-25 08:21:10' and database='datalake' and table='tseries'\r\n\r\n\r\n\r\nSELECT *\r\nFROM system.part_log\r\nWHERE (event_time > '2024-07-25 08:21:10') AND (database = 'datalake') AND (`table` = 'tseries')\r\n\r\nQuery id: b56521a6-3f35-475b-be8f-4398bebe2c3c\r\n\r\n\u250c\u2500hostname\u2500\u2500\u2500\u252c\u2500query_id\u2500\u252c\u2500event_type\u2500\u252c\u2500merge_reason\u2500\u252c\u2500merge_algorithm\u2500\u252c\u2500event_date\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500event_time\u2500\u252c\u2500\u2500\u2500\u2500event_time_microseconds\u2500\u252c\u2500duration_ms\u2500\u252c\u2500database\u2500\u252c\u2500table\u2500\u2500\u2500\u252c\u2500table_uuid\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500part_name\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500partition_id\u2500\u252c\u2500partition\u2500\u252c\u2500part_type\u2500\u252c\u2500disk_name\u2500\u252c\u2500path_on_disk\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500rows\u2500\u252c\u2500size_in_bytes\u2500\u252c\u2500merged_from\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500bytes_uncompressed\u2500\u252c\u2500\u2500read_rows\u2500\u252c\u2500\u2500\u2500read_bytes\u2500\u252c\u2500peak_memory_usage\u2500\u252c\u2500error\u2500\u252c\u2500exception\u2500\u252c\u2500ProfileEvents\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:11 \u2502 2024-07-25 08:21:11.932978 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264332_156264584_80          \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502      47035 \u2502        559065 \u2502 []                                         \u2502            1981993 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:11 \u2502 2024-07-25 08:21:11.932978 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264332_156264590_81          \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502      48144 \u2502        569170 \u2502 []                                         \u2502            2028571 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:11 \u2502 2024-07-25 08:21:11.932978 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264587_156264587_0           \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502          1 \u2502          1296 \u2502 []                                         \u2502                446 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:11 \u2502 2024-07-25 08:21:11.932978 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264588_156264588_0           \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502        100 \u2502          2685 \u2502 []                                         \u2502               4604 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:11 \u2502 2024-07-25 08:21:11.932978 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264589_156264589_0           \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502          2 \u2502          1336 \u2502 []                                         \u2502                488 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:11 \u2502 2024-07-25 08:21:11.932978 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264590_156264590_0           \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502        999 \u2502         12629 \u2502 []                                         \u2502              42362 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:11 \u2502 2024-07-25 08:21:11.932978 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264591_156264591_0           \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502          2 \u2502          1345 \u2502 []                                         \u2502                488 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:11 \u2502 2024-07-25 08:21:11.932978 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264592_156264592_0           \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502          2 \u2502          1336 \u2502 []                                         \u2502                488 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:11 \u2502 2024-07-25 08:21:11.932978 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264593_156264593_0           \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502        443 \u2502          6975 \u2502 []                                         \u2502              19090 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:11 \u2502 2024-07-25 08:21:11.932978 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264594_156264594_0           \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502         25 \u2502          1472 \u2502 []                                         \u2502               1454 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:11 \u2502 2024-07-25 08:21:11.932978 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264595_156264595_0           \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502        187 \u2502          2672 \u2502 []                                         \u2502               8348 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:11 \u2502 2024-07-25 08:21:11.932978 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264596_156264596_0           \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502        170 \u2502          2672 \u2502 []                                         \u2502               7634 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:11 \u2502 2024-07-25 08:21:11.932978 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264597_156264597_0           \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502          6 \u2502          1411 \u2502 []                                         \u2502                656 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:11 \u2502 2024-07-25 08:21:11.932978 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264598_156264598_0           \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502        161 \u2502          2677 \u2502 []                                         \u2502               7256 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264332_156264593_82          \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502      48591 \u2502        575950 \u2502 []                                         \u2502            2047425 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264332_156264594_83          \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502      48616 \u2502        576354 \u2502 []                                         \u2502            2048475 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264332_156264604_84          \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502      50685 \u2502        612230 \u2502 []                                         \u2502            2135943 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264332_156264605_85          \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502      50687 \u2502        612243 \u2502 []                                         \u2502            2136027 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264332_156264606_86          \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502      50687 \u2502        612155 \u2502 []                                         \u2502            2136027 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264332_156264613_87          \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502      51804 \u2502        614826 \u2502 []                                         \u2502            2182940 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264595_156264600_1           \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502        526 \u2502          8683 \u2502 []                                         \u2502              22766 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264599_156264599_0           \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502          1 \u2502          1296 \u2502 []                                         \u2502                446 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264600_156264600_0           \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502          1 \u2502          1296 \u2502 []                                         \u2502                446 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264601_156264601_0           \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502          2 \u2502          1345 \u2502 []                                         \u2502                488 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264602_156264602_0           \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502        100 \u2502          2676 \u2502 []                                         \u2502               4604 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264603_156264603_0           \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502        999 \u2502         12622 \u2502 []                                         \u2502              40373 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264604_156264604_0           \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502        443 \u2502          7430 \u2502 []                                         \u2502              19090 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264605_156264605_0           \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502          2 \u2502          1336 \u2502 []                                         \u2502                488 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264606_156264606_0           \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502         25 \u2502          1472 \u2502 []                                         \u2502               1454 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264607_156264607_0           \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502          1 \u2502          1296 \u2502 []                                         \u2502                446 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264607_156264612_1           \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502        120 \u2502          3202 \u2502 []                                         \u2502               5444 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264608_156264608_0           \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502          1 \u2502          1296 \u2502 []                                         \u2502                446 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264609_156264609_0           \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502        100 \u2502          2627 \u2502 []                                         \u2502               4413 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264610_156264610_0           \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502          2 \u2502          1345 \u2502 []                                         \u2502                488 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264611_156264611_0           \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502          7 \u2502          1400 \u2502 []                                         \u2502                698 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264612_156264612_0           \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502          9 \u2502          1427 \u2502 []                                         \u2502                782 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264613_156264613_0           \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502        999 \u2502         12629 \u2502 []                                         \u2502              42362 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264614_156264614_0           \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502          2 \u2502          1336 \u2502 []                                         \u2502                488 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264615_156264615_0           \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502          1 \u2502          1298 \u2502 []                                         \u2502                453 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264616_156264616_0           \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502         25 \u2502          1472 \u2502 []                                         \u2502               1454 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.104934 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202407_156264617_156264617_0           \u2502 202407       \u2502           \u2502 Compact   \u2502           \u2502                                                                                                            \u2502        443 \u2502          7396 \u2502 []                                         \u2502              19090 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 MutatePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.649339 \u2502          94 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202212_1_1_1_156268256                 \u2502 202212       \u2502           \u2502 Compact   \u2502 default   \u2502 /var/lib/clickhouse/store/46d/46dd69cf-2824-4127-925c-f4e921ea6b24/202212_1_1_1_156268256/                 \u2502      18832 \u2502        124922 \u2502 ['202212_1_1_1_156263017']                 \u2502             641159 \u2502      18832 \u2502       640513 \u2502           8383603 \u2502     0 \u2502           \u2502 {'QueriesWithSubqueries':1,'SelectQueriesWithSubqueries':1,'FileOpen':14,'ReadBufferFromFileDescriptorRead':5,'ReadBufferFromFileDescriptorReadBytes':123993,'WriteBufferFromFileDescriptorWrite':12,'WriteBufferFromFileDescriptorWriteBytes':125532,'ReadCompressedBytes':123993,'CompressedReadBufferBlocks':31,'CompressedReadBufferBytes':641095,'OpenedFileCacheMisses':2,'OpenedFileCacheMicroseconds':2,'IOBufferAllocs':39,'IOBufferAllocBytes':9803391,'FunctionExecute':16,'CreatedReadBufferOrdinary':2,'DiskReadElapsedMicroseconds':95,'DiskWriteElapsedMicroseconds':1348,'SelectedParts':7,'SelectedRanges':7,'SelectedMarks':7,'WaitMarksLoadMicroseconds':144,'LoadedMarksCount':40,'LoadedMarksMemoryBytes':184,'Merge':4,'MergedRows':18832,'MergedUncompressedBytes':640513,'MergesTimeMilliseconds':81,'ContextLock':54,'ContextLockWaitMicroseconds':14,'RWLockAcquiredReadLocks':1,'PartsLockHoldMicroseconds':934,'PartsLockWaitMicroseconds':822,'QueryProfilerRuns':1,'LogTrace':17,'LogDebug':8} \u2502\r\n\u2502 clickhouse \u2502          \u2502 MutatePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:21:13 \u2502 2024-07-25 08:21:13.674303 \u2502          78 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202310_6444_6592_5_156268256           \u2502 202310       \u2502           \u2502 Wide      \u2502 default   \u2502 /var/lib/clickhouse/store/46d/46dd69cf-2824-4127-925c-f4e921ea6b24/202310_6444_6592_5_156268256/           \u2502       6566 \u2502         32007 \u2502 ['202310_6444_6592_5_156263017']           \u2502             276512 \u2502       6566 \u2502       275831 \u2502          32281669 \u2502     0 \u2502           \u2502 {'QueriesWithSubqueries':1,'SelectQueriesWithSubqueries':1,'FileOpen':57,'ReadBufferFromFileDescriptorRead':19,'ReadBufferFromFileDescriptorReadBytes':30865,'WriteBufferFromFileDescriptorWrite':34,'WriteBufferFromFileDescriptorWriteBytes':33224,'ReadCompressedBytes':30865,'CompressedReadBufferBlocks':19,'CompressedReadBufferBytes':276240,'OpenedFileCacheMisses':19,'OpenedFileCacheMicroseconds':51,'IOBufferAllocs':164,'IOBufferAllocBytes':33863985,'FunctionExecute':8,'CreatedReadBufferOrdinary':19,'DiskReadElapsedMicroseconds':10788,'DiskWriteElapsedMicroseconds':1038,'SelectedParts':7,'SelectedRanges':7,'SelectedMarks':7,'WaitMarksLoadMicroseconds':9038,'LoadedMarksCount':18,'LoadedMarksMemoryBytes':912,'Merge':2,'MergedRows':6566,'MergedUncompressedBytes':275831,'MergesTimeMilliseconds':69,'ContextLock':52,'RWLockAcquiredReadLocks':1,'PartsLockHoldMicroseconds':389,'LogTrace':17,'LogDebug':8,'GWPAsanAllocateSuccess':1,'GWPAsanFree':1} \u2502\r\n\u2502 clickhouse \u2502          \u2502 MutatePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:42:44 \u2502 2024-07-25 08:42:44.602620 \u2502     1291003 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202311_6593_86242550_14912_156268256   \u2502 202311       \u2502           \u2502 Wide      \u2502 default   \u2502 /var/lib/clickhouse/store/46d/46dd69cf-2824-4127-925c-f4e921ea6b24/202311_6593_86242550_14912_156268256/   \u2502 3807569058 \u2502   25721229382 \u2502 ['202311_6593_86242550_14912_156263017']   \u2502       160396682835 \u2502 3807569058 \u2502 160612160521 \u2502          45332147 \u2502     0 \u2502           \u2502 {'QueriesWithSubqueries':1,'SelectQueriesWithSubqueries':1,'FileOpen':57,'ReadBufferFromFileDescriptorRead':196188,'ReadBufferFromFileDescriptorReadBytes':25713098342,'WriteBufferFromFileDescriptorWrite':26539,'WriteBufferFromFileDescriptorWriteBytes':25721231247,'ReadCompressedBytes':25713098342,'CompressedReadBufferBlocks':2444374,'CompressedReadBufferBytes':160300005891,'OpenedFileCacheMisses':19,'OpenedFileCacheMicroseconds':73,'IOBufferAllocs':165,'IOBufferAllocBytes':36676617,'FunctionExecute':1859172,'CreatedReadBufferOrdinary':19,'DiskReadElapsedMicroseconds':67384290,'DiskWriteElapsedMicroseconds':71932101,'SelectedParts':7,'SelectedRanges':7,'SelectedMarks':7,'WaitMarksLoadMicroseconds':216223,'LoadedMarksCount':2788758,'LoadedMarksMemoryBytes':2555832,'Merge':464793,'MergedRows':3807569058,'MergedUncompressedBytes':160612160521,'MergesTimeMilliseconds':1062955,'ContextLock':52,'RWLockAcquiredReadLocks':1,'PartsLockHoldMicroseconds':504,'PartsLockWaitMicroseconds':2,'QueryProfilerRuns':1670,'LogTrace':17,'LogDebug':8,'GWPAsanAllocateSuccess':5652,'GWPAsanAllocateFailed':259,'GWPAsanFree':5652} \u2502\r\n\u2502 clickhouse \u2502          \u2502 MutatePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:42:53 \u2502 2024-07-25 08:42:53.097753 \u2502       83389 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202402_73877863_74322796_310_156268256 \u2502 202402       \u2502           \u2502 Wide      \u2502 default   \u2502 /var/lib/clickhouse/store/46d/46dd69cf-2824-4127-925c-f4e921ea6b24/202402_73877863_74322796_310_156268256/ \u2502  233524746 \u2502    1813005151 \u2502 ['202402_73877863_74322796_310_156263017'] \u2502         9833983376 \u2502  233524746 \u2502   9845856228 \u2502          37596985 \u2502     0 \u2502           \u2502 {'QueriesWithSubqueries':1,'SelectQueriesWithSubqueries':1,'FileOpen':50,'ReadBufferFromFileDescriptorRead':13835,'ReadBufferFromFileDescriptorReadBytes':1812383219,'WriteBufferFromFileDescriptorWrite':1878,'WriteBufferFromFileDescriptorWriteBytes':1813006863,'ReadCompressedBytes':1812383219,'CompressedReadBufferBlocks':149835,'CompressedReadBufferBytes':9823948560,'OpenedFileCacheMisses':12,'OpenedFileCacheMicroseconds':35,'IOBufferAllocs':151,'IOBufferAllocBytes':35521584,'FunctionExecute':114032,'CreatedReadBufferOrdinary':12,'DiskReadElapsedMicroseconds':3703115,'DiskWriteElapsedMicroseconds':4750609,'SelectedParts':7,'SelectedRanges':7,'SelectedMarks':7,'WaitMarksLoadMicroseconds':145,'Merge':28508,'MergedRows':233524746,'MergedUncompressedBytes':9845856228,'MergesTimeMilliseconds':70919,'ContextLock':52,'RWLockAcquiredReadLocks':1,'PartsLockHoldMicroseconds':229,'PartsLockWaitMicroseconds':2,'QueryProfilerRuns':110,'LogTrace':17,'LogDebug':8,'GWPAsanAllocateSuccess':335,'GWPAsanAllocateFailed':16,'GWPAsanFree':335} \u2502\r\n\u2502 clickhouse \u2502          \u2502 MutatePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:42:57 \u2502 2024-07-25 08:42:57.419328 \u2502        1496 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202404_95650195_95658662_277_156268256 \u2502 202404       \u2502           \u2502 Wide      \u2502 default   \u2502 /var/lib/clickhouse/store/46d/46dd69cf-2824-4127-925c-f4e921ea6b24/202404_95650195_95658662_277_156268256/ \u2502    2947065 \u2502      23077466 \u2502 ['202404_95650195_95658662_277_156263017'] \u2502          124066489 \u2502    2947065 \u2502    124215487 \u2502          34061248 \u2502     0 \u2502           \u2502 {'QueriesWithSubqueries':1,'SelectQueriesWithSubqueries':1,'FileOpen':49,'ReadBufferFromFileDescriptorRead':185,'ReadBufferFromFileDescriptorReadBytes':23067032,'WriteBufferFromFileDescriptorWrite':54,'WriteBufferFromFileDescriptorWriteBytes':23079138,'ReadCompressedBytes':23067032,'CompressedReadBufferBlocks':1897,'CompressedReadBufferBytes':123939417,'OpenedFileCacheHits':1,'OpenedFileCacheMisses':11,'OpenedFileCacheMicroseconds':37,'IOBufferAllocs':151,'IOBufferAllocBytes':34815930,'FunctionExecute':1444,'CreatedReadBufferOrdinary':12,'DiskReadElapsedMicroseconds':97315,'DiskWriteElapsedMicroseconds':67869,'SelectedParts':7,'SelectedRanges':7,'SelectedMarks':7,'WaitMarksLoadMicroseconds':147,'Merge':361,'MergedRows':2947065,'MergedUncompressedBytes':124215487,'MergesTimeMilliseconds':1302,'ContextLock':52,'RWLockAcquiredReadLocks':1,'PartsLockHoldMicroseconds':245,'QueryProfilerRuns':2,'LogTrace':17,'LogDebug':8,'GWPAsanAllocateSuccess':8,'GWPAsanFree':8} \u2502\r\n\u2502 clickhouse \u2502          \u2502 MutatePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:42:57 \u2502 2024-07-25 08:42:57.452492 \u2502        1531 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202403_83421241_83427076_264_156268256 \u2502 202403       \u2502           \u2502 Wide      \u2502 default   \u2502 /var/lib/clickhouse/store/46d/46dd69cf-2824-4127-925c-f4e921ea6b24/202403_83421241_83427076_264_156268256/ \u2502    3066879 \u2502      25004193 \u2502 ['202403_83421241_83427076_264_156263017'] \u2502          129150096 \u2502    3066879 \u2502    129305235 \u2502          34082846 \u2502     0 \u2502           \u2502 {'QueriesWithSubqueries':1,'SelectQueriesWithSubqueries':1,'FileOpen':48,'ReadBufferFromFileDescriptorRead':200,'ReadBufferFromFileDescriptorReadBytes':24993398,'WriteBufferFromFileDescriptorWrite':58,'WriteBufferFromFileDescriptorWriteBytes':25005866,'ReadCompressedBytes':24993398,'CompressedReadBufferBlocks':1977,'CompressedReadBufferBytes':129017744,'OpenedFileCacheHits':2,'OpenedFileCacheMisses':10,'OpenedFileCacheMicroseconds':40,'IOBufferAllocs':151,'IOBufferAllocBytes':34816793,'FunctionExecute':1504,'CreatedReadBufferOrdinary':12,'DiskReadElapsedMicroseconds':107462,'DiskWriteElapsedMicroseconds':79226,'SelectedParts':7,'SelectedRanges':7,'SelectedMarks':7,'WaitMarksLoadMicroseconds':583,'Merge':376,'MergedRows':3066879,'MergedUncompressedBytes':129305235,'MergesTimeMilliseconds':1322,'ContextLock':52,'RWLockAcquiredReadLocks':1,'PartsLockHoldMicroseconds':261,'PartsLockWaitMicroseconds':1267,'QueryProfilerRuns':2,'LogTrace':17,'LogDebug':8,'GWPAsanAllocateSuccess':7,'GWPAsanFree':7} \u2502\r\n\u2502 clickhouse \u2502          \u2502 RemovePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:42:58 \u2502 2024-07-25 08:42:58.064264 \u2502           0 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202312_31293027_44411087_780_156263017 \u2502 202312       \u2502           \u2502 Wide      \u2502           \u2502                                                                                                            \u2502 2225674782 \u2502   15263083194 \u2502 []                                         \u2502        98199367618 \u2502          0 \u2502            0 \u2502                 0 \u2502     0 \u2502           \u2502 {}                                                                                                                                                                                                                                                         \u2502\r\n\u2502 clickhouse \u2502          \u2502 MutatePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:43:01 \u2502 2024-07-25 08:43:01.001319 \u2502       91295 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202402_72276642_72811657_321_156268256 \u2502 202402       \u2502           \u2502 Wide      \u2502 default   \u2502 /var/lib/clickhouse/store/46d/46dd69cf-2824-4127-925c-f4e921ea6b24/202402_72276642_72811657_321_156268256/ \u2502  257382329 \u2502    1992519895 \u2502 ['202402_72276642_72811657_321_156263017'] \u2502        10838712365 \u2502  257382329 \u2502  10851846716 \u2502          37710132 \u2502     0 \u2502           \u2502 {'QueriesWithSubqueries':1,'SelectQueriesWithSubqueries':1,'FileOpen':50,'ReadBufferFromFileDescriptorRead':15205,'ReadBufferFromFileDescriptorReadBytes':1991828617,'WriteBufferFromFileDescriptorWrite':2062,'WriteBufferFromFileDescriptorWriteBytes':1992521606,'ReadCompressedBytes':1991828617,'CompressedReadBufferBlocks':165142,'CompressedReadBufferBytes':10827652525,'OpenedFileCacheMisses':12,'OpenedFileCacheMicroseconds':42,'IOBufferAllocs':151,'IOBufferAllocBytes':35517779,'FunctionExecute':125680,'CreatedReadBufferOrdinary':12,'DiskReadElapsedMicroseconds':5212167,'DiskWriteElapsedMicroseconds':5247871,'SelectedParts':7,'SelectedRanges':7,'SelectedMarks':7,'WaitMarksLoadMicroseconds':165,'Merge':31420,'MergedRows':257382329,'MergedUncompressedBytes':10851846716,'MergesTimeMilliseconds':77123,'ContextLock':52,'RWLockAcquiredReadLocks':1,'PartsLockHoldMicroseconds':264,'QueryProfilerRuns':138,'LogTrace':17,'LogDebug':8,'GWPAsanAllocateSuccess':387,'GWPAsanAllocateFailed':21,'GWPAsanFree':387} \u2502\r\n\u2502 clickhouse \u2502          \u2502 MutatePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:43:07 \u2502 2024-07-25 08:43:07.874426 \u2502        6545 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202403_83391776_83415281_291_156268256 \u2502 202403       \u2502           \u2502 Wide      \u2502 default   \u2502 /var/lib/clickhouse/store/46d/46dd69cf-2824-4127-925c-f4e921ea6b24/202403_83391776_83415281_291_156268256/ \u2502   12356411 \u2502      98971038 \u2502 ['202403_83391776_83415281_291_156263017'] \u2502          520341692 \u2502   12356411 \u2502    520968276 \u2502          34345248 \u2502     0 \u2502           \u2502 {'QueriesWithSubqueries':1,'SelectQueriesWithSubqueries':1,'FileOpen':50,'ReadBufferFromFileDescriptorRead':765,'ReadBufferFromFileDescriptorReadBytes':98934060,'WriteBufferFromFileDescriptorWrite':129,'WriteBufferFromFileDescriptorWriteBytes':98972727,'ReadCompressedBytes':98934060,'CompressedReadBufferBlocks':7935,'CompressedReadBufferBytes':519810172,'OpenedFileCacheMisses':12,'OpenedFileCacheMicroseconds':34,'IOBufferAllocs':151,'IOBufferAllocBytes':35017803,'FunctionExecute':6040,'CreatedReadBufferOrdinary':12,'DiskReadElapsedMicroseconds':762451,'DiskWriteElapsedMicroseconds':393881,'SelectedParts':7,'SelectedRanges':7,'SelectedMarks':7,'WaitMarksLoadMicroseconds':126,'Merge':1510,'MergedRows':12356411,'MergedUncompressedBytes':520968276,'MergesTimeMilliseconds':5809,'ContextLock':52,'RWLockAcquiredReadLocks':1,'PartsLockHoldMicroseconds':702,'PartsLockWaitMicroseconds':3,'QueryProfilerRuns':7,'LogTrace':17,'LogDebug':8,'GWPAsanAllocateSuccess':17,'GWPAsanAllocateFailed':1,'GWPAsanFree':17} \u2502\r\n\u2502 clickhouse \u2502          \u2502 MutatePart \u2502 NotAMerge    \u2502 Undecided       \u2502 2024-07-25 \u2502 2024-07-25 08:43:18 \u2502 2024-07-25 08:43:18.511109 \u2502       22603 \u2502 datalake \u2502 tseries \u2502 46dd69cf-2824-4127-925c-f4e921ea6b24 \u2502 202402_74592462_74675502_314_156268256 \u2502 202402       \u2502           \u2502 Wide      \u2502 default   \u2502 /var/lib/clickhouse/store/46d/46dd69cf-2824-4127-925c-f4e921ea6b24/202402_74592462_74675502_314_156268256/ \u2502   43626619 \u2502     340613455 \u2502 ['202402_74592462_74675502_314_156263017'] \u2502         1837163502 \u2502   43626619 \u2502   1839379748 \u2502          36712015 \u2502     0 \u2502           \u2502 {'QueriesWithSubqueries':1,'SelectQueriesWithSubqueries':1,'FileOpen':49,'ReadBufferFromFileDescriptorRead':2607,'ReadBufferFromFileDescriptorReadBytes':340492346,'WriteBufferFromFileDescriptorWrite':376,'WriteBufferFromFileDescriptorWriteBytes':340615151,'ReadCompressedBytes':340492346,'CompressedReadBufferBlocks':27993,'CompressedReadBufferBytes':1835288398,'OpenedFileCacheHits':1,'OpenedFileCacheMisses':11,'OpenedFileCacheMicroseconds':50,'IOBufferAllocs':151,'IOBufferAllocBytes':35269561,'FunctionExecute':21308,'CreatedReadBufferOrdinary':12,'DiskReadElapsedMicroseconds':2357324,'DiskWriteElapsedMicroseconds':1214681,'SelectedParts':7,'SelectedRanges':7,'SelectedMarks':7,'WaitMarksLoadMicroseconds':219,'Merge':5327,'MergedRows':43626619,'MergedUncompressedBytes':1839379748,'MergesTimeMilliseconds':20010,'ContextLock':52,'RWLockAcquiredReadLocks':1,'PartsLockHoldMicroseconds':324,'QueryProfilerRuns':35,'LogTrace':17,'LogDebug':8,'GWPAsanAllocateSuccess':84,'GWPAsanFree':84} \u2502\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n\r\n51 rows in set. Elapsed: 0.024 sec. Processed 2.92 thousand rows, 1.41 MB (124.03 thousand rows/s., 60.03 MB/s.)\r\nPeak memory usage: 56.76 KiB.\r\n```\nmaybe related? \r\n* https://github.com/ClickHouse/ClickHouse/issues/65299\r\n\nCould you check what was happening during the mutation in `system.part_log`?\n@SaltTan I am going to try to setup a reproducible example I think. This is a serious issue for us as we rely on this type of query. Also it is [used in dbt clickhouse](https://github.com/ClickHouse/dbt-clickhouse/blob/main/dbt/include/clickhouse/macros/materializations/incremental/incremental.sql#L228C99-L229) which is also a concern for us. ",
  "created_at": "2024-08-08T16:14:31Z"
}