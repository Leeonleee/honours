diff --git a/tests/queries/0_stateless/02475_analyzer_array_join_with_join.reference b/tests/queries/0_stateless/02475_analyzer_array_join_with_join.reference
new file mode 100644
index 000000000000..d679934d4e68
--- /dev/null
+++ b/tests/queries/0_stateless/02475_analyzer_array_join_with_join.reference
@@ -0,0 +1,28 @@
+0
+0
+--
+0
+--
+--
+--
+1
+--
+0	Value_0
+--
+1	Value_1
+--
+0	Value_0
+--
+1	Value_1
+--
+[0]	Value_0
+--
+[1]	Value_1
+--
+[0]	Value_0
+--
+[0]	Value_1
+--
+[5]	Value_0
+--
+[5]	Value_1
diff --git a/tests/queries/0_stateless/02476_analyzer_join_with_unused_columns.reference b/tests/queries/0_stateless/02476_analyzer_join_with_unused_columns.reference
new file mode 100644
index 000000000000..c6240227a2e9
--- /dev/null
+++ b/tests/queries/0_stateless/02476_analyzer_join_with_unused_columns.reference
@@ -0,0 +1,9 @@
+1	3
+--
+2	4
+--
+1	3
+--
+2	4
+--
+1	2	3	4
diff --git a/tests/queries/0_stateless/02476_analyzer_join_with_unused_columns.sql b/tests/queries/0_stateless/02476_analyzer_join_with_unused_columns.sql
new file mode 100644
index 000000000000..ca937e012380
--- /dev/null
+++ b/tests/queries/0_stateless/02476_analyzer_join_with_unused_columns.sql
@@ -0,0 +1,19 @@
+SET allow_experimental_analyzer = 1;
+
+SELECT subquery_1.id, subquery_2.id FROM (SELECT 1 AS id, 2 AS value) AS subquery_1, (SELECT 3 AS id, 4 AS value) AS subquery_2;
+
+SELECT '--';
+
+SELECT subquery_1.value, subquery_2.value FROM (SELECT 1 AS id, 2 AS value) AS subquery_1, (SELECT 3 AS id, 4 AS value) AS subquery_2;
+
+SELECT '--';
+
+SELECT COLUMNS('id') FROM (SELECT 1 AS id, 2 AS value) AS subquery_1, (SELECT 3 AS id, 4 AS value) AS subquery_2;
+
+SELECT '--';
+
+SELECT COLUMNS('value') FROM (SELECT 1 AS id, 2 AS value) AS subquery_1, (SELECT 3 AS id, 4 AS value) AS subquery_2;
+
+SELECT '--';
+
+SELECT * FROM (SELECT 1 AS id, 2 AS value) AS subquery_1, (SELECT 3 AS id, 4 AS value) AS subquery_2;
diff --git a/tests/queries/0_stateless/02477_analyzer_array_join_with_join.reference b/tests/queries/0_stateless/02477_analyzer_array_join_with_join.reference
new file mode 100644
index 000000000000..f7084c4617c0
--- /dev/null
+++ b/tests/queries/0_stateless/02477_analyzer_array_join_with_join.reference
@@ -0,0 +1,128 @@
+-- { echoOn }
+
+SELECT * FROM test_table ARRAY JOIN value_array;
+0	Value_0	1
+0	Value_0	2
+0	Value_0	3
+SELECT '--';
+--
+SELECT *, value_array_element FROM test_table ARRAY JOIN value_array AS value_array_element;
+0	Value_0	[1,2,3]	1
+0	Value_0	[1,2,3]	2
+0	Value_0	[1,2,3]	3
+SELECT '--';
+--
+SELECT *, value_array FROM test_table ARRAY JOIN value_array AS value_array;
+0	Value_0	[1,2,3]	1
+0	Value_0	[1,2,3]	2
+0	Value_0	[1,2,3]	3
+SELECT '--';
+--
+SELECT *, value_array FROM test_table ARRAY JOIN [4,5,6] AS value_array;
+0	Value_0	[1,2,3]	4
+0	Value_0	[1,2,3]	5
+0	Value_0	[1,2,3]	6
+SELECT '--';
+--
+SELECT *, value_array, value_element FROM test_table ARRAY JOIN value_array, [4,5,6] AS value_element;
+0	Value_0	1	1	4
+0	Value_0	2	2	5
+0	Value_0	3	3	6
+SELECT '--';
+--
+SELECT * FROM (SELECT [dummy, dummy] AS dummy FROM system.one) AS subquery ARRAY JOIN dummy INNER JOIN system.one USING (dummy);
+0
+0
+SELECT '--';
+--
+SELECT * FROM (SELECT [0] AS id) AS subquery_1 ARRAY JOIN id INNER JOIN (SELECT 0 AS id) AS subquery_2 USING (id);
+0
+SELECT '--';
+--
+SELECT * FROM (SELECT [1] AS id) AS subquery_1 ARRAY JOIN id INNER JOIN (SELECT 0 AS id) AS subquery_2 USING (id);
+SELECT '--';
+--
+SELECT * FROM (SELECT [0] AS id) AS subquery_1 ARRAY JOIN id INNER JOIN (SELECT 1 AS id) AS subquery_2 USING (id);
+SELECT '--';
+--
+SELECT * FROM (SELECT [1] AS id) AS subquery_1 ARRAY JOIN id INNER JOIN (SELECT 1 AS id) AS subquery_2 USING (id);
+1
+SELECT '--';
+--
+SELECT * FROM (SELECT [5] AS id) AS subquery_1 ARRAY JOIN [1,2,3] AS id INNER JOIN (SELECT 1 AS id) AS subquery_2 USING (id);
+[5]
+SELECT '--';
+--
+SELECT * FROM (SELECT [0] AS id) AS subquery ARRAY JOIN id INNER JOIN test_table USING (id);
+0	Value_0	[1,2,3]
+SELECT '--';
+--
+SELECT * FROM (SELECT [1] AS id) AS subquery ARRAY JOIN id INNER JOIN test_table USING (id);
+SELECT '--';
+--
+SELECT * FROM (SELECT [0] AS id) AS subquery ARRAY JOIN id AS id INNER JOIN test_table USING (id);
+[0]	Value_0	[1,2,3]
+SELECT '--';
+--
+SELECT * FROM (SELECT [1] AS id) AS subquery ARRAY JOIN id AS id INNER JOIN test_table USING (id);
+SELECT '--';
+--
+SELECT *, id FROM (SELECT [0] AS id) AS subquery ARRAY JOIN id AS id INNER JOIN test_table USING (id);
+[0]	Value_0	[1,2,3]	0
+SELECT '--';
+--
+SELECT *, id FROM (SELECT [1] AS id) AS subquery ARRAY JOIN id AS id INNER JOIN test_table USING (id);
+SELECT '--';
+--
+SELECT * FROM (SELECT [0] AS value) AS subquery ARRAY JOIN value AS id INNER JOIN test_table USING (id);
+[0]	Value_0	[1,2,3]
+SELECT '--';
+--
+SELECT * FROM (SELECT [1] AS value) AS subquery ARRAY JOIN value AS id INNER JOIN test_table USING (id);
+SELECT '--';
+--
+SELECT *, id FROM (SELECT [0] AS value) AS subquery ARRAY JOIN value AS id INNER JOIN test_table USING (id);
+[0]	Value_0	[1,2,3]	0
+SELECT '--';
+--
+SELECT *, id FROM (SELECT [1] AS value) AS subquery ARRAY JOIN value AS id INNER JOIN test_table USING (id);
+SELECT '--';
+--
+SELECT * FROM (SELECT [0] AS id) AS subquery ARRAY JOIN [0] AS id INNER JOIN test_table USING (id);
+[0]	Value_0	[1,2,3]
+SELECT '--';
+--
+SELECT * FROM (SELECT [0] AS id) AS subquery ARRAY JOIN [1] AS id INNER JOIN test_table USING (id);
+SELECT '--';
+--
+SELECT *, id FROM (SELECT [0] AS id) AS subquery ARRAY JOIN [0] AS id INNER JOIN test_table USING (id);
+[0]	Value_0	[1,2,3]	0
+SELECT '--';
+--
+SELECT *, id FROM (SELECT [0] AS id) AS subquery ARRAY JOIN [1] AS id INNER JOIN test_table USING (id);
+SELECT '--';
+--
+SELECT * FROM (SELECT [5] AS id) AS subquery ARRAY JOIN [0] AS id INNER JOIN test_table USING (id);
+[5]	Value_0	[1,2,3]
+SELECT '--';
+--
+SELECT * FROM (SELECT [5] AS id) AS subquery ARRAY JOIN [1] AS id INNER JOIN test_table USING (id);
+SELECT '--';
+--
+SELECT *, id FROM (SELECT [5] AS id) AS subquery ARRAY JOIN [0] AS id INNER JOIN test_table USING (id);
+[5]	Value_0	[1,2,3]	0
+SELECT '--';
+--
+SELECT *, id FROM (SELECT [5] AS id) AS subquery ARRAY JOIN [1] AS id INNER JOIN test_table USING (id);
+SELECT '--';
+--
+SELECT * FROM (SELECT [5] AS id_array) AS subquery ARRAY JOIN id_array, [0] AS id INNER JOIN test_table USING (id);
+5	Value_0	[1,2,3]
+SELECT '--';
+--
+SELECT * FROM (SELECT [[0]] AS id) AS subquery ARRAY JOIN id AS id_nested_array ARRAY JOIN id_nested_array AS id INNER JOIN test_table USING (id);
+[[0]]	Value_0	[1,2,3]
+SELECT '--';
+--
+SELECT *, id FROM (SELECT [[0]] AS id) AS subquery ARRAY JOIN id AS id_nested_array ARRAY JOIN id_nested_array AS id INNER JOIN test_table USING (id);
+[[0]]	Value_0	[1,2,3]	0
diff --git a/tests/queries/0_stateless/02477_analyzer_array_join_with_join.sql b/tests/queries/0_stateless/02477_analyzer_array_join_with_join.sql
new file mode 100644
index 000000000000..7e4ecb98ae8e
--- /dev/null
+++ b/tests/queries/0_stateless/02477_analyzer_array_join_with_join.sql
@@ -0,0 +1,143 @@
+SET allow_experimental_analyzer = 1;
+
+DROP TABLE IF EXISTS test_table;
+CREATE TABLE test_table
+(
+    id UInt64,
+    value String,
+    value_array Array(UInt64)
+) ENGINE=MergeTree ORDER BY id;
+
+INSERT INTO test_table VALUES (0, 'Value_0', [1,2,3]);
+
+-- { echoOn }
+
+SELECT * FROM test_table ARRAY JOIN value_array;
+
+SELECT '--';
+
+SELECT *, value_array_element FROM test_table ARRAY JOIN value_array AS value_array_element;
+
+SELECT '--';
+
+SELECT *, value_array FROM test_table ARRAY JOIN value_array AS value_array;
+
+SELECT '--';
+
+SELECT *, value_array FROM test_table ARRAY JOIN [4,5,6] AS value_array;
+
+SELECT '--';
+
+SELECT *, value_array, value_element FROM test_table ARRAY JOIN value_array, [4,5,6] AS value_element;
+
+SELECT '--';
+
+SELECT * FROM (SELECT [dummy, dummy] AS dummy FROM system.one) AS subquery ARRAY JOIN dummy INNER JOIN system.one USING (dummy);
+
+SELECT '--';
+
+SELECT * FROM (SELECT [0] AS id) AS subquery_1 ARRAY JOIN id INNER JOIN (SELECT 0 AS id) AS subquery_2 USING (id);
+
+SELECT '--';
+
+SELECT * FROM (SELECT [1] AS id) AS subquery_1 ARRAY JOIN id INNER JOIN (SELECT 0 AS id) AS subquery_2 USING (id);
+
+SELECT '--';
+
+SELECT * FROM (SELECT [0] AS id) AS subquery_1 ARRAY JOIN id INNER JOIN (SELECT 1 AS id) AS subquery_2 USING (id);
+
+SELECT '--';
+
+SELECT * FROM (SELECT [1] AS id) AS subquery_1 ARRAY JOIN id INNER JOIN (SELECT 1 AS id) AS subquery_2 USING (id);
+
+SELECT '--';
+
+SELECT * FROM (SELECT [5] AS id) AS subquery_1 ARRAY JOIN [1,2,3] AS id INNER JOIN (SELECT 1 AS id) AS subquery_2 USING (id);
+
+SELECT '--';
+
+SELECT * FROM (SELECT [0] AS id) AS subquery ARRAY JOIN id INNER JOIN test_table USING (id);
+
+SELECT '--';
+
+SELECT * FROM (SELECT [1] AS id) AS subquery ARRAY JOIN id INNER JOIN test_table USING (id);
+
+SELECT '--';
+
+SELECT * FROM (SELECT [0] AS id) AS subquery ARRAY JOIN id AS id INNER JOIN test_table USING (id);
+
+SELECT '--';
+
+SELECT * FROM (SELECT [1] AS id) AS subquery ARRAY JOIN id AS id INNER JOIN test_table USING (id);
+
+SELECT '--';
+
+SELECT *, id FROM (SELECT [0] AS id) AS subquery ARRAY JOIN id AS id INNER JOIN test_table USING (id);
+
+SELECT '--';
+
+SELECT *, id FROM (SELECT [1] AS id) AS subquery ARRAY JOIN id AS id INNER JOIN test_table USING (id);
+
+SELECT '--';
+
+SELECT * FROM (SELECT [0] AS value) AS subquery ARRAY JOIN value AS id INNER JOIN test_table USING (id);
+
+SELECT '--';
+
+SELECT * FROM (SELECT [1] AS value) AS subquery ARRAY JOIN value AS id INNER JOIN test_table USING (id);
+
+SELECT '--';
+
+SELECT *, id FROM (SELECT [0] AS value) AS subquery ARRAY JOIN value AS id INNER JOIN test_table USING (id);
+
+SELECT '--';
+
+SELECT *, id FROM (SELECT [1] AS value) AS subquery ARRAY JOIN value AS id INNER JOIN test_table USING (id);
+
+SELECT '--';
+
+SELECT * FROM (SELECT [0] AS id) AS subquery ARRAY JOIN [0] AS id INNER JOIN test_table USING (id);
+
+SELECT '--';
+
+SELECT * FROM (SELECT [0] AS id) AS subquery ARRAY JOIN [1] AS id INNER JOIN test_table USING (id);
+
+SELECT '--';
+
+SELECT *, id FROM (SELECT [0] AS id) AS subquery ARRAY JOIN [0] AS id INNER JOIN test_table USING (id);
+
+SELECT '--';
+
+SELECT *, id FROM (SELECT [0] AS id) AS subquery ARRAY JOIN [1] AS id INNER JOIN test_table USING (id);
+
+SELECT '--';
+
+SELECT * FROM (SELECT [5] AS id) AS subquery ARRAY JOIN [0] AS id INNER JOIN test_table USING (id);
+
+SELECT '--';
+
+SELECT * FROM (SELECT [5] AS id) AS subquery ARRAY JOIN [1] AS id INNER JOIN test_table USING (id);
+
+SELECT '--';
+
+SELECT *, id FROM (SELECT [5] AS id) AS subquery ARRAY JOIN [0] AS id INNER JOIN test_table USING (id);
+
+SELECT '--';
+
+SELECT *, id FROM (SELECT [5] AS id) AS subquery ARRAY JOIN [1] AS id INNER JOIN test_table USING (id);
+
+SELECT '--';
+
+SELECT * FROM (SELECT [5] AS id_array) AS subquery ARRAY JOIN id_array, [0] AS id INNER JOIN test_table USING (id);
+
+SELECT '--';
+
+SELECT * FROM (SELECT [[0]] AS id) AS subquery ARRAY JOIN id AS id_nested_array ARRAY JOIN id_nested_array AS id INNER JOIN test_table USING (id);
+
+SELECT '--';
+
+SELECT *, id FROM (SELECT [[0]] AS id) AS subquery ARRAY JOIN id AS id_nested_array ARRAY JOIN id_nested_array AS id INNER JOIN test_table USING (id);
+
+-- { echoOff }
+
+DROP TABLE test_table;
