diff --git a/src/Storages/MergeTree/MergeTreeIndexSet.cpp b/src/Storages/MergeTree/MergeTreeIndexSet.cpp
index 831856f80852..3a3d77644e30 100644
--- a/src/Storages/MergeTree/MergeTreeIndexSet.cpp
+++ b/src/Storages/MergeTree/MergeTreeIndexSet.cpp
@@ -13,6 +13,7 @@
 #include <Planner/PlannerActionsVisitor.h>
 
 #include <Storages/MergeTree/MergeTreeIndexUtils.h>
+#include "DataTypes/IDataType.h"
 
 namespace DB
 {
@@ -490,7 +491,8 @@ bool MergeTreeIndexConditionSet::checkDAGUseless(const ActionsDAG::Node & node,
     RPNBuilderTreeContext tree_context(context);
     RPNBuilderTreeNode tree_node(node_to_check, tree_context);
 
-    if (node.column && isColumnConst(*node.column))
+    if (node.column && isColumnConst(*node.column)
+        && !WhichDataType(node.result_type).isSet())
     {
         Field literal;
         node.column->get(0, literal);
