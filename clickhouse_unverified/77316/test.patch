diff --git a/tests/queries/0_stateless/03371_analyzer_filter_pushdown_distributed.reference b/tests/queries/0_stateless/03371_analyzer_filter_pushdown_distributed.reference
new file mode 100644
index 000000000000..e69de29bb2d1
diff --git a/tests/queries/0_stateless/03371_analyzer_filter_pushdown_distributed.sql b/tests/queries/0_stateless/03371_analyzer_filter_pushdown_distributed.sql
new file mode 100644
index 000000000000..6dd0a16574a1
--- /dev/null
+++ b/tests/queries/0_stateless/03371_analyzer_filter_pushdown_distributed.sql
@@ -0,0 +1,42 @@
+set enable_analyzer=1;
+
+CREATE TABLE bug_table
+(
+    `date_column` Date,
+    `c1` String,
+    `c2` String
+)
+ENGINE =  MergeTree
+PARTITION BY toYYYYMM(date_column)
+ORDER BY (c1, c2);
+
+INSERT INTO bug_table values
+    (toDate(now()),hex(rand()),hex(now())),
+    (toDate(now()),hex(rand()),hex(now())),
+    (toDate(now()),hex(rand()),hex(now())),
+    (toDate(now()),hex(rand()),hex(now())),
+    (toDate(now()),hex(rand()),hex(now()));
+
+CREATE TABLE distributed_bug_table
+(
+date_column Date,
+c1 String,
+c2 String
+)
+ENGINE = Distributed('test_cluster_two_shards', currentDatabase(), 'bug_table', cityHash64(c1));
+
+set distributed_product_mode = 'allow';
+
+set prefer_localhost_replica=1;
+
+WITH alias_1 AS
+   (SELECT c1,c2 FROM distributed_bug_table)
+SELECT c1 from alias_1 where c2 IN (SELECT DISTINCT c2 from alias_1)
+FORMAT Null;
+
+set prefer_localhost_replica=0;
+
+WITH alias_1 AS
+   (SELECT c1,c2 FROM distributed_bug_table)
+SELECT c1 from alias_1 where c2 IN (SELECT DISTINCT c2 from alias_1)
+FORMAT Null;
diff --git a/tests/queries/0_stateless/03519_cte_allow_push_predicate_ast_for_distributed_subqueries_bug.reference b/tests/queries/0_stateless/03519_cte_allow_push_predicate_ast_for_distributed_subqueries_bug.reference
new file mode 100644
index 000000000000..b00d02e650c6
--- /dev/null
+++ b/tests/queries/0_stateless/03519_cte_allow_push_predicate_ast_for_distributed_subqueries_bug.reference
@@ -0,0 +1,5 @@
+0
+0
+-
+0
+0
diff --git a/tests/queries/0_stateless/03519_cte_allow_push_predicate_ast_for_distributed_subqueries_bug.sql b/tests/queries/0_stateless/03519_cte_allow_push_predicate_ast_for_distributed_subqueries_bug.sql
new file mode 100644
index 000000000000..79f74823a338
--- /dev/null
+++ b/tests/queries/0_stateless/03519_cte_allow_push_predicate_ast_for_distributed_subqueries_bug.sql
@@ -0,0 +1,4 @@
+-- Tags: no-parallel-replicas
+with sub as (select number from numbers(1)) select x from (select number as x from remote('127.0.0.{1,2}', numbers(2))) where x in sub settings allow_push_predicate_ast_for_distributed_subqueries = 1, enable_analyzer=1;
+select '-';
+with sub as (select number from numbers(1)) select x from (select number as x from remote('127.0.0.{1,2}', numbers(2))) where x global in sub settings allow_push_predicate_ast_for_distributed_subqueries = 1, enable_analyzer=1;
