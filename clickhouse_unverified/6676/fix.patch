diff --git a/dbms/src/Storages/transformQueryForExternalDatabase.cpp b/dbms/src/Storages/transformQueryForExternalDatabase.cpp
index 55a0ef95200c..b6e48836efa3 100644
--- a/dbms/src/Storages/transformQueryForExternalDatabase.cpp
+++ b/dbms/src/Storages/transformQueryForExternalDatabase.cpp
@@ -141,19 +141,17 @@ String transformQueryForExternalDatabase(
             if (function->name == "and")
             {
                 bool compatible_found = false;
-                auto new_function_and = std::make_shared<ASTFunction>();
-                auto new_function_and_arguments = std::make_shared<ASTExpressionList>();
-                new_function_and->arguments = new_function_and_arguments;
-                new_function_and->children.push_back(new_function_and_arguments);
-
+                auto new_function_and = makeASTFunction("and");
                 for (const auto & elem : function->arguments->children)
                 {
                     if (isCompatible(*elem))
                     {
-                        new_function_and_arguments->children.push_back(elem);
+                        new_function_and->arguments->children.push_back(elem);
                         compatible_found = true;
                     }
                 }
+                if (new_function_and->arguments->children.size() == 1)
+                    new_function_and->name = "";
 
                 if (compatible_found)
                     select->setExpression(ASTSelectQuery::Expression::WHERE, std::move(new_function_and));
