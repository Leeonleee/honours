You will be provided with a partial code base and an issue statement explaining a problem to resolve.

<issue>
Wrong query result with `query_plan_remove_redundant_sorting`
https://fiddle.clickhouse.com/e96a52c8-9b56-42f9-98de-b5b46dfc3289
</issue>

I need you to solve the provided issue by generating a code fix that can be applied directly to the repository

Respond below:
