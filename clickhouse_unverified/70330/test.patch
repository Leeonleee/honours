diff --git a/tests/queries/0_stateless/03247_create-same-table-concurrently-with-atomic-engine.reference b/tests/queries/0_stateless/03247_create-same-table-concurrently-with-atomic-engine.reference
new file mode 100644
index 000000000000..e69de29bb2d1
diff --git a/tests/queries/0_stateless/03247_create-same-table-concurrently-with-atomic-engine.sh b/tests/queries/0_stateless/03247_create-same-table-concurrently-with-atomic-engine.sh
new file mode 100755
index 000000000000..1a05d5bf8907
--- /dev/null
+++ b/tests/queries/0_stateless/03247_create-same-table-concurrently-with-atomic-engine.sh
@@ -0,0 +1,24 @@
+#!/usr/bin/env bash
+
+CUR_DIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
+# shellcheck source=../shell_config.sh
+. "$CUR_DIR"/../shell_config.sh
+
+# with Atomic engine
+$CLICKHOUSE_CLIENT --query "CREATE DATABASE IF NOT EXISTS ${CLICKHOUSE_DATABASE}_db ENGINE=Atomic"
+
+function create_or_replace_table_thread
+{
+    for _ in {1..20}; do
+        $CLICKHOUSE_CLIENT --query "CREATE OR REPLACE TABLE ${CLICKHOUSE_DATABASE}_db.test_table (x Int) ENGINE=Memory" > /dev/null
+    done
+}
+export -f create_or_replace_table_thread;
+
+for _ in {1..20}; do
+    bash -c create_or_replace_table_thread &
+done
+
+wait
+
+$CLICKHOUSE_CLIENT --query "DROP DATABASE IF EXISTS ${CLICKHOUSE_DATABASE}_db SYNC";
\ No newline at end of file
diff --git a/tests/queries/0_stateless/03248_create-same-table-concurrently-with-replicated-engine.reference b/tests/queries/0_stateless/03248_create-same-table-concurrently-with-replicated-engine.reference
new file mode 100644
index 000000000000..e69de29bb2d1
diff --git a/tests/queries/0_stateless/03248_create-same-table-concurrently-with-replicated-engine.sh b/tests/queries/0_stateless/03248_create-same-table-concurrently-with-replicated-engine.sh
new file mode 100755
index 000000000000..27bb65ff2db0
--- /dev/null
+++ b/tests/queries/0_stateless/03248_create-same-table-concurrently-with-replicated-engine.sh
@@ -0,0 +1,25 @@
+#!/usr/bin/env bash
+# Tags: long
+
+CUR_DIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
+# shellcheck source=../shell_config.sh
+. "$CUR_DIR"/../shell_config.sh
+
+# with Replicated engine
+$CLICKHOUSE_CLIENT --query "CREATE DATABASE IF NOT EXISTS ${CLICKHOUSE_DATABASE}_db ENGINE=Replicated('/test/clickhouse/db/${CLICKHOUSE_DATABASE}_db', 's1', 'r1')"
+
+function create_or_replace_table_thread
+{
+    for _ in {1..15}; do
+        $CLICKHOUSE_CLIENT --query "CREATE OR REPLACE TABLE ${CLICKHOUSE_DATABASE}_db.test_table (x Int) ENGINE=Memory" > /dev/null
+    done
+}
+export -f create_or_replace_table_thread;
+
+for _ in {1..15}; do
+    bash -c create_or_replace_table_thread &
+done
+
+wait
+
+$CLICKHOUSE_CLIENT --query "DROP DATABASE IF EXISTS ${CLICKHOUSE_DATABASE}_db SYNC";
\ No newline at end of file
