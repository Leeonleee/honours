diff --git a/tests/integration/test_part_moves_between_shards/test.py b/tests/integration/test_part_moves_between_shards/test.py
index ed7640e5f9ed..6009a9d2a44e 100644
--- a/tests/integration/test_part_moves_between_shards/test.py
+++ b/tests/integration/test_part_moves_between_shards/test.py
@@ -133,6 +133,17 @@ def deduplication_invariant_test():
                     settings={"allow_experimental_query_deduplication": 1})
         ) == TSV(expected)
 
+        # https://github.com/ClickHouse/ClickHouse/issues/34089
+        assert TSV(
+            n.query("SELECT count() FROM test_deduplication_d",
+                    settings={"allow_experimental_query_deduplication": 1})
+        ) == TSV("2")
+
+        assert TSV(
+            n.query("SELECT count() FROM test_deduplication_d",
+                    settings={"allow_experimental_query_deduplication": 1, "allow_experimental_projection_optimization": 1})
+        ) == TSV("2")
+
     deduplication_invariant = ConcurrentInvariant(deduplication_invariant_test)
     deduplication_invariant.start()
 
