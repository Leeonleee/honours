You will be provided with a partial code base and an issue statement explaining a problem to resolve.

<issue>
Create part with level 1 if `optimize_on_insert` is enabled
**Use case**

Use optimizations of merges and queries with `FINAL` that have an assumption that keys are unique in parts with levels >= 1 (e.g. `split_parts_ranges_into_intersecting_and_non_intersecting_final`).

**Describe the solution you'd like**

If `optimize_on_insert` is enabled write part with level 1 instead of 0 because it doesn't contain duplicates. Otherwise the work for optimizing data which is done on insert is kind of useless.
</issue>

I need you to solve the provided issue by generating a code fix that can be applied directly to the repository

Respond below:
