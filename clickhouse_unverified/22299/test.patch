diff --git a/tests/queries/1_stateful/00163_column_oriented_formats.reference b/tests/queries/1_stateful/00163_column_oriented_formats.reference
new file mode 100644
index 000000000000..cb20aca43925
--- /dev/null
+++ b/tests/queries/1_stateful/00163_column_oriented_formats.reference
@@ -0,0 +1,12 @@
+Parquet
+6b397d4643bc1f920f3eb8aa87ee180c  -
+7fe6d8c57ddc5fe37bbdcb7f73c5fa78  -
+d8746733270cbeff7ab3550c9b944fb6  -
+Arrow
+6b397d4643bc1f920f3eb8aa87ee180c  -
+7fe6d8c57ddc5fe37bbdcb7f73c5fa78  -
+d8746733270cbeff7ab3550c9b944fb6  -
+ORC
+6b397d4643bc1f920f3eb8aa87ee180c  -
+7fe6d8c57ddc5fe37bbdcb7f73c5fa78  -
+d8746733270cbeff7ab3550c9b944fb6  -
diff --git a/tests/queries/1_stateful/00163_column_oriented_formats.sh b/tests/queries/1_stateful/00163_column_oriented_formats.sh
new file mode 100755
index 000000000000..1363ccf3c00c
--- /dev/null
+++ b/tests/queries/1_stateful/00163_column_oriented_formats.sh
@@ -0,0 +1,20 @@
+#!/usr/bin/env bash
+
+CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
+# shellcheck source=../shell_config.sh
+. "$CURDIR"/../shell_config.sh
+
+
+FORMATS=('Parquet' 'Arrow' 'ORC')
+
+for format in "${FORMATS[@]}"
+do
+    echo $format
+    $CLICKHOUSE_CLIENT -q "DROP TABLE IF EXISTS 00163_column_oriented SYNC"
+    $CLICKHOUSE_CLIENT -q "CREATE TABLE 00163_column_oriented(ClientEventTime DateTime, MobilePhoneModel String, ClientIP6 FixedString(16)) ENGINE=File($format)"
+    $CLICKHOUSE_CLIENT -q "INSERT INTO 00163_column_oriented SELECT ClientEventTime, MobilePhoneModel, ClientIP6 FROM test.hits ORDER BY ClientEventTime, MobilePhoneModel, ClientIP6 LIMIT 100"
+    $CLICKHOUSE_CLIENT -q "SELECT ClientEventTime from 00163_column_oriented" | md5sum
+    $CLICKHOUSE_CLIENT -q "SELECT MobilePhoneModel from 00163_column_oriented" | md5sum
+    $CLICKHOUSE_CLIENT -q "SELECT ClientIP6 from 00163_column_oriented" | md5sum
+    $CLICKHOUSE_CLIENT -q "DROP TABLE IF EXISTS 00163_column_oriented SYNC"
+done
