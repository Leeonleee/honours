diff --git a/programs/client/Client.cpp b/programs/client/Client.cpp
index 1aec3677b414..3917d775cbc4 100644
--- a/programs/client/Client.cpp
+++ b/programs/client/Client.cpp
@@ -2252,30 +2252,27 @@ class Client : public Poco::Util::Application
             return;
 
         processed_rows += block.rows();
+
+        /// Even if all blocks are empty, we still need to initialize the output stream to write empty resultset.
         initBlockOutputStream(block);
 
         /// The header block containing zero rows was used to initialize
         /// block_out_stream, do not output it.
         /// Also do not output too much data if we're fuzzing.
-        if (block.rows() != 0
-            && (query_fuzzer_runs == 0 || processed_rows < 100))
-        {
-            block_out_stream->write(block);
-            written_first_block = true;
-        }
+        if (block.rows() == 0 || (query_fuzzer_runs != 0 && processed_rows >= 100))
+            return;
 
-        bool clear_progress = false;
         if (need_render_progress)
-            clear_progress = std_out.offset() > 0;
-
-        if (clear_progress)
             clearProgress();
 
+        block_out_stream->write(block);
+        written_first_block = true;
+
         /// Received data block is immediately displayed to the user.
         block_out_stream->flush();
 
         /// Restore progress bar after data block.
-        if (clear_progress)
+        if (need_render_progress)
             writeProgress();
     }
 
