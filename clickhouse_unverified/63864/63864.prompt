You will be provided with a partial code base and an issue statement explaining a problem to resolve.

<issue>
arrayFilter, arrayReduce, arrayExists no longer work with distributed tables if expression contains table column
functions like arrayFilter, arrayReduce,arrayExists give error code 81, (database name empty) when their expression contain a table column, it only happens on distributed table and not on local tables, it used to work fine on older version of clickhouse  ~23.3.22

for example

```
select 
    'current' AS period,
    date(event_time) AS label
FROM orders
WHERE length(arrayFilter(x -> dateDiff('day', event_time, toDate(parseDateTime64BestEffortOrZero(JSONExtractString(x, 'event_time')))) >= 0 and dateDiff('day', event_time, toDate(parseDateTime64BestEffortOrZero(JSONExtractString(x, 'event_time')))) < 14, workflows)) > 0
AND ((toDate(event_time, 'America/Los_Angeles') >= '2024-04-07') AND (toDate(event_time, 'America/Los_Angeles') <= '2024-05-07'))
LIMIT 20
```

or just simply
```
select arrayFilter(x -> toUnixTimestamp(parseDateTime64BestEffortOrZero(JSONExtractString(x,'event_time'))) > toUnixTimestamp(orders.event_time),workflows) from orders limit 10
```
gives error code 81 Database name is empty

**Expected behavior**
query to run fine as it was working on 23.3.22

**Actual behaviour**
gives error
`Code: 81. DB::Exception: Received from xx.xx.xx.xxx:9000. DB::Exception: Database name is empty. (UNKNOWN_DATABASE)`


Error message
```
Received exception from server (version 24.3.3):
Code: 81. DB::Exception: Received from xx.xx.xx.xxx:9000. DB::Exception: Database name is empty. (UNKNOWN_DATABASE)
```
it only happens on distributed tables, and when we remove any traces of event_time column from lambda expressions of arrayFilter, queryworks.
</issue>

I need you to solve the provided issue by generating a code fix that can be applied directly to the repository

Respond below:
