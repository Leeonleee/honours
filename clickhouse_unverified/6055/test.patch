diff --git a/dbms/tests/queries/0_stateless/00301_csv.reference b/dbms/tests/queries/0_stateless/00301_csv.reference
index 69debccade9a..92cb50c0727b 100644
--- a/dbms/tests/queries/0_stateless/00301_csv.reference
+++ b/dbms/tests/queries/0_stateless/00301_csv.reference
@@ -4,7 +4,14 @@ Hello "world"	789	2016-01-03
 Hello
 world	100	2016-01-04
 default	1	2019-06-19
 default-eof	1	2019-06-19
+0	1	42	2019-07-22
+1	world	3	2019-07-23
+2	Hello	123	2019-06-19
+3	Hello	42	2019-06-19
 2016-01-01 01:02:03	1
 2016-01-02 01:02:03	2
 2017-08-15 13:15:01	3
 1970-01-02 06:46:39	4
+2016-01-01 01:02:03	NUL
+2016-01-02 01:02:03	Nhello
+\N	\N
diff --git a/dbms/tests/queries/0_stateless/00301_csv.sh b/dbms/tests/queries/0_stateless/00301_csv.sh
index c7ee476ab406..3ecc87e5bc1a 100755
--- a/dbms/tests/queries/0_stateless/00301_csv.sh
+++ b/dbms/tests/queries/0_stateless/00301_csv.sh
@@ -17,6 +17,17 @@ Hello "world", 789 ,2016-01-03
 $CLICKHOUSE_CLIENT --query="SELECT * FROM csv ORDER BY d";
 $CLICKHOUSE_CLIENT --query="DROP TABLE csv";
 
+
+$CLICKHOUSE_CLIENT --query="CREATE TABLE csv (i Int8, s String DEFAULT 'Hello', n UInt64 DEFAULT 42, d Date DEFAULT '2019-06-19') ENGINE = Memory";
+echo '\N, 1, \N, "2019-07-22"
+1, world, 3, "2019-07-23"
+2, \N, 123, \N
+3, \N, \N, \N' | $CLICKHOUSE_CLIENT --input_format_null_as_default=1 --query="INSERT INTO csv FORMAT CSV";
+
+$CLICKHOUSE_CLIENT --query="SELECT * FROM csv ORDER BY i";
+$CLICKHOUSE_CLIENT --query="DROP TABLE csv";
+
+
 $CLICKHOUSE_CLIENT --query="CREATE TABLE csv (t DateTime('Europe/Moscow'), s String) ENGINE = Memory";
 
 echo '"2016-01-01 01:02:03","1"
@@ -26,3 +37,13 @@ echo '"2016-01-01 01:02:03","1"
 
 $CLICKHOUSE_CLIENT --query="SELECT * FROM csv ORDER BY s";
 $CLICKHOUSE_CLIENT --query="DROP TABLE csv";
+
+
+$CLICKHOUSE_CLIENT --query="CREATE TABLE csv (t Nullable(DateTime('Europe/Moscow')), s Nullable(String)) ENGINE = Memory";
+
+echo 'NULL, NULL
+"2016-01-01 01:02:03",NUL
+"2016-01-02 01:02:03",Nhello' | $CLICKHOUSE_CLIENT --input_format_csv_unquoted_null_literal_as_null=1 --query="INSERT INTO csv FORMAT CSV";
+
+$CLICKHOUSE_CLIENT --query="SELECT * FROM csv ORDER BY s NULLS LAST";
+$CLICKHOUSE_CLIENT --query="DROP TABLE csv";
