diff --git a/tests/queries/0_stateless/00416_pocopatch_progress_in_http_headers.sh b/tests/queries/0_stateless/00416_pocopatch_progress_in_http_headers.sh
index 6e9814cbca8c..b2189ab0cc2a 100755
--- a/tests/queries/0_stateless/00416_pocopatch_progress_in_http_headers.sh
+++ b/tests/queries/0_stateless/00416_pocopatch_progress_in_http_headers.sh
@@ -5,7 +5,6 @@ CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
 . "$CURDIR"/../shell_config.sh
 
 ${CLICKHOUSE_CURL} -vsS "${CLICKHOUSE_URL}&max_block_size=5&send_progress_in_http_headers=1&http_headers_progress_interval_ms=0" -d 'SELECT max(number) FROM numbers(10)' 2>&1 | grep -E 'Content-Encoding|X-ClickHouse-Progress|^[0-9]'
-# This test will fail with external poco (progress not supported)
 
 ${CLICKHOUSE_CURL} -vsS "${CLICKHOUSE_URL}&max_block_size=1&send_progress_in_http_headers=1&http_headers_progress_interval_ms=0&output_format_parallel_formatting=0" -d 'SELECT number FROM numbers(10)' 2>&1 | grep -E 'Content-Encoding|X-ClickHouse-Progress|^[0-9]'
 ${CLICKHOUSE_CURL} -sS "${CLICKHOUSE_URL}&max_block_size=1&send_progress_in_http_headers=1&http_headers_progress_interval_ms=0&enable_http_compression=1" -H 'Accept-Encoding: gzip' -d 'SELECT number FROM system.numbers LIMIT 10' | gzip -d
diff --git a/tests/queries/0_stateless/02539_generate_random_map.reference b/tests/queries/0_stateless/02539_generate_random_map.reference
index c0dc175c3cd0..25e7f55667e0 100644
--- a/tests/queries/0_stateless/02539_generate_random_map.reference
+++ b/tests/queries/0_stateless/02539_generate_random_map.reference
@@ -1,2 +1,2 @@
-1
-20
+0
+10
diff --git a/tests/queries/0_stateless/02586_generate_random_structure.reference b/tests/queries/0_stateless/02586_generate_random_structure.reference
index d2929fb4564a..abe168c59e89 100644
--- a/tests/queries/0_stateless/02586_generate_random_structure.reference
+++ b/tests/queries/0_stateless/02586_generate_random_structure.reference
@@ -13,7 +13,7 @@ c3.e6	Array(Int256)
 c4	FixedString(183)					
 c5	IPv4					
 c6	UInt256					
-Tb�#yV��[>�M��*ܨ��(�O�R8V1n���)���H�}C�������\'����I7�t���qn�V)䳆��qL��P�o�R�g<�{���3�i����H_m��!q���\'G���	127.48.9.45	['e1V10','e1V0','e1V10','e1V14','e1V10','e1V14']	[{-13:777622572,102:-1122882357,62:1647813163,-94:2094022166},{-32:1448633509},{},{},{34:1536340393,19:-2049677851,74:65643868,-46:-1990799930,97:-531041081,46:-2634833,14:1581632600,89:-771229823,-105:1238603584},{47:1458809010,109:1640682510,86:1945730198,85:1505847247,35:-35189402}]	[153363749503.3642648494826450951141750747382772821825909005880434540971999557,79828591186.7378041015337066268618633118713347614941338787453473118807106292,81672688565.9633830721322966111551266731935181670389237071708068971548883315,573768486971.1812413548839655834002608768736215115033958693122764224003897029,-393925092368.4893467278351090742501814120269109477445490969167853713051140487,46027399426.0865278566391382610843315130162915324295037009704113636499519839]	[755855942,1804001770,-78103159,-866181765,731736602,-79599206]	[5253556148991564114,4681434929596395351,-7302160004580855709,-3686747220178471318,6288582051009949273,646864891160092871]	[17035203905051045016266537043565487029724162173062647021612805252288722534904,-42105881403933504641593145676742477006499618886131028341247993701618141933523,45346626822580305846120377917274679004279343244238782744860626882886217433843,-3660165069803677989574889324494857545543653453780976182221584349306428201647,-23316760935816288837287058499520670431785615691220162210524162590241529297823,6184785563808848524970564618169964412151721224362412457508264894603779018817]	�ڡ|�A"�x���>����r�wz�Z�:��j�8tZ��D"Tu��2h�!���W�I��y��tP��a|�\'�y��o�����f�F�O\0��Ֆ6\fIr�E�Sac�W<~�e �l��T>P3})��w%�4@_2�N"ІXp$^Ҙ���Ͱ\04�@��n\b���\r�4�H�	16.177.117.209	7882774382721411359365561736453116698030365959050344381263687375357052837130
-Tb�#yV��[>�M��*ܨ��(�O�R8V1n���)���H�}C�������\'����I7�t���qn�V)䳆��qL��P�o�R�g<�{���3�i����H_m��!q���\'G���	127.48.9.45	['e1V10','e1V0','e1V10','e1V14','e1V10','e1V14']	[{-13:777622572,102:-1122882357,62:1647813163,-94:2094022166},{-32:1448633509},{},{},{34:1536340393,19:-2049677851,74:65643868,-46:-1990799930,97:-531041081,46:-2634833,14:1581632600,89:-771229823,-105:1238603584},{47:1458809010,109:1640682510,86:1945730198,85:1505847247,35:-35189402}]	[153363749503.3642648494826450951141750747382772821825909005880434540971999557,79828591186.7378041015337066268618633118713347614941338787453473118807106292,81672688565.9633830721322966111551266731935181670389237071708068971548883315,573768486971.1812413548839655834002608768736215115033958693122764224003897029,-393925092368.4893467278351090742501814120269109477445490969167853713051140487,46027399426.0865278566391382610843315130162915324295037009704113636499519839]	[755855942,1804001770,-78103159,-866181765,731736602,-79599206]	[5253556148991564114,4681434929596395351,-7302160004580855709,-3686747220178471318,6288582051009949273,646864891160092871]	[17035203905051045016266537043565487029724162173062647021612805252288722534904,-42105881403933504641593145676742477006499618886131028341247993701618141933523,45346626822580305846120377917274679004279343244238782744860626882886217433843,-3660165069803677989574889324494857545543653453780976182221584349306428201647,-23316760935816288837287058499520670431785615691220162210524162590241529297823,6184785563808848524970564618169964412151721224362412457508264894603779018817]	�ڡ|�A"�x���>����r�wz�Z�:��j�8tZ��D"Tu��2h�!���W�I��y��tP��a|�\'�y��o�����f�F�O\0��Ֆ6\fIr�E�Sac�W<~�e �l��T>P3})��w%�4@_2�N"ІXp$^Ҙ���Ͱ\04�@��n\b���\r�4�H�	16.177.117.209	7882774382721411359365561736453116698030365959050344381263687375357052837130
+Tb�#yV��[>�M��*ܨ��(�O�R8V1n���)���H�}C�������\'����I7�t���qn�V)䳆��qL��P�o�R�g<�{���3�i����H_m��!q���\'G���	127.48.9.45	['e1V10','e1V0','e1V10','e1V14','e1V10','e1V14']	[{-13:237920722},{102:1831835481},{},{},{62:-1960618666,-94:-1219892650},{-32:777622572}]	[-431683920736.2529974565693898437068698973660186760023819586689844248966618581,59756148020.9162673945900094878560562068677573399624031604279613893604002735,586508082308.9120376291637372686770291666437007489038136467093669000000245094,-542964250950.8072472621084212227729061994250148872708538789242780170470779236,102348230986.0528243362965635624540408239649901816289081513971979913007157412,856260707339.0308016734722383288485766011293159337170215574648625303012038641]	[700742145,583743175,-694731143,205377506,-47073316,524775483]	[-1523104801326101990,-3813742700509249040,-198797568561120929,1360848130483946585,-2034445041726915230,6445693522245970031]	[-42294009754395695750286152418877456026522055877244789929409825751148328749462,-30114637036117781224059264373564439361653611308928312514969460679379590706382,50790691897328530213645537587874962516097580703236937570724165115560305762147,-53982023979693597997184389721196431225054557132927198244547868871851761566844,-4746897427675718862552189488292169089453556841811840545196357111533622948298,-12014200750706123405006110782843469166121588186681927916239818910819762049960]	�ڡ|�A"�x���>����r�wz�Z�:��j�8tZ��D"Tu��2h�!���W�I��y��tP��a|�\'�y��o�����f�F�O\0��Ֆ6\fIr�E�Sac�W<~�e �l��T>P3})��w%�4@_2�N"ІXp$^Ҙ���Ͱ\04�@��n\b���\r�4�H�	16.177.117.209	7882774382721411359365561736453116698030365959050344381263687375357052837130
+Tb�#yV��[>�M��*ܨ��(�O�R8V1n���)���H�}C�������\'����I7�t���qn�V)䳆��qL��P�o�R�g<�{���3�i����H_m��!q���\'G���	127.48.9.45	['e1V10','e1V0','e1V10','e1V14','e1V10','e1V14']	[{-13:237920722},{102:1831835481},{},{},{62:-1960618666,-94:-1219892650},{-32:777622572}]	[-431683920736.2529974565693898437068698973660186760023819586689844248966618581,59756148020.9162673945900094878560562068677573399624031604279613893604002735,586508082308.9120376291637372686770291666437007489038136467093669000000245094,-542964250950.8072472621084212227729061994250148872708538789242780170470779236,102348230986.0528243362965635624540408239649901816289081513971979913007157412,856260707339.0308016734722383288485766011293159337170215574648625303012038641]	[700742145,583743175,-694731143,205377506,-47073316,524775483]	[-1523104801326101990,-3813742700509249040,-198797568561120929,1360848130483946585,-2034445041726915230,6445693522245970031]	[-42294009754395695750286152418877456026522055877244789929409825751148328749462,-30114637036117781224059264373564439361653611308928312514969460679379590706382,50790691897328530213645537587874962516097580703236937570724165115560305762147,-53982023979693597997184389721196431225054557132927198244547868871851761566844,-4746897427675718862552189488292169089453556841811840545196357111533622948298,-12014200750706123405006110782843469166121588186681927916239818910819762049960]	�ڡ|�A"�x���>����r�wz�Z�:��j�8tZ��D"Tu��2h�!���W�I��y��tP��a|�\'�y��o�����f�F�O\0��Ֆ6\fIr�E�Sac�W<~�e �l��T>P3})��w%�4@_2�N"ІXp$^Ҙ���Ͱ\04�@��n\b���\r�4�H�	16.177.117.209	7882774382721411359365561736453116698030365959050344381263687375357052837130
 Tb�#yV��[>�M��*ܨ��(�O�R8V1n���)���H�}C�������\'����I7�t���qn�V)䳆��qL��P�o�R�g<�{���3�i����H_m��!q���\'G���	127.48.9.45	['e1V10']	[{}]	[825002272867.1157788721157301271303736024856710948164507982705676578804195475]	[1865150610]	[7514464811443271056]	[33504961604882608369857530219353040639899064613284394558131808339620328539033]	�ڡ|�A"�x���>����r�wz�Z�:��j�8tZ��D"Tu��2h�!���W�I��y��tP��a|�\'�y��o�����f�F�O\0��Ֆ6\fIr�E�Sac�W<~�e �l��T>P3})��w%�4@_2�N"ІXp$^Ҙ���Ͱ\04�@��n\b���\r�4�H�	16.177.117.209	7882774382721411359365561736453116698030365959050344381263687375357052837130
 c1 LowCardinality(Nullable(UInt64)), c2 Date32, c3 LowCardinality(Nullable(Float64)), c4 Int256, c5 Date32
