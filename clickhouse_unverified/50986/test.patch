diff --git a/tests/integration/test_config_decryption/__init__.py b/tests/integration/test_config_decryption/__init__.py
new file mode 100644
index 000000000000..e69de29bb2d1
diff --git a/tests/integration/test_config_decryption/configs/config.xml b/tests/integration/test_config_decryption/configs/config.xml
new file mode 100644
index 000000000000..5c274128e39d
--- /dev/null
+++ b/tests/integration/test_config_decryption/configs/config.xml
@@ -0,0 +1,12 @@
+<clickhouse>
+    <encryption_codecs>
+        <aes_128_gcm_siv>
+            <key_hex>00112233445566778899aabbccddeeff</key_hex>
+        </aes_128_gcm_siv>
+        <aes_256_gcm_siv>
+            <key_hex>00112233445566778899aabbccddeeff00112233445566778899aabbccddeeff</key_hex>
+        </aes_256_gcm_siv>
+    </encryption_codecs>
+    <max_table_size_to_drop encryption_codec="AES_128_GCM_SIV">96260000000B0000000000E8FE3C087CED2205A5071078B29FD5C3B97F824911DED3217E980C</max_table_size_to_drop>
+    <max_partition_size_to_drop encryption_codec="AES_256_GCM_SIV">97260000000B0000000000BFFF70C4DA718754C1DA0E2F25FF9246D4783F7FFEC4089EC1CC14</max_partition_size_to_drop>
+</clickhouse>
diff --git a/tests/integration/test_config_decryption/configs/config.yaml b/tests/integration/test_config_decryption/configs/config.yaml
new file mode 100644
index 000000000000..ab4391be3c53
--- /dev/null
+++ b/tests/integration/test_config_decryption/configs/config.yaml
@@ -0,0 +1,11 @@
+encryption_codecs:
+  aes_128_gcm_siv:
+    key_hex: 00112233445566778899aabbccddeeff
+  aes_256_gcm_siv:
+    key_hex: 00112233445566778899aabbccddeeff00112233445566778899aabbccddeeff
+max_table_size_to_drop:
+  '#text': 96260000000B0000000000E8FE3C087CED2205A5071078B29FD5C3B97F824911DED3217E980C
+  '@encryption_codec': AES_128_GCM_SIV
+max_partition_size_to_drop:
+  '@encryption_codec': AES_256_GCM_SIV
+  '#text': 97260000000B0000000000BFFF70C4DA718754C1DA0E2F25FF9246D4783F7FFEC4089EC1CC14
diff --git a/tests/integration/test_config_decryption/configs/config_invalid_chars.xml b/tests/integration/test_config_decryption/configs/config_invalid_chars.xml
new file mode 100644
index 000000000000..49bf51b5bad5
--- /dev/null
+++ b/tests/integration/test_config_decryption/configs/config_invalid_chars.xml
@@ -0,0 +1,12 @@
+<clickhouse>
+    <encryption_codecs>
+        <aes_128_gcm_siv>
+            <key_hex>00112233445566778899aabbccddeeff</key_hex>
+        </aes_128_gcm_siv>
+        <aes_256_gcm_siv>
+            <key_hex>00112233445566778899aabbccddeeff00112233445566778899aabbccddeeff</key_hex>
+        </aes_256_gcm_siv>
+    </encryption_codecs>
+    <max_table_size_to_drop encryption_codec="AES_128_GCM_SIV">--96260000000B0000000000E8FE3C087CED2205A5071078B29FD5C3B97F824911DED3217E980C</max_table_size_to_drop>
+    <max_partition_size_to_drop encryption_codec="AES_256_GCM_SIV">97260000000B0000000000BFFF70C4DA718754C1DA0E2F25FF9246D4783F7FFEC4089EC1CC14</max_partition_size_to_drop>
+</clickhouse>
diff --git a/tests/integration/test_config_decryption/configs/config_no_encryption_key.xml b/tests/integration/test_config_decryption/configs/config_no_encryption_key.xml
new file mode 100644
index 000000000000..5f7769f74031
--- /dev/null
+++ b/tests/integration/test_config_decryption/configs/config_no_encryption_key.xml
@@ -0,0 +1,3 @@
+<clickhouse>
+    <max_table_size_to_drop encryption_codec="AES_128_GCM_SIV">96260000000B0000000000E8FE3C087CED2205A5071078B29FD5C3B97F824911DED3217E980C</max_table_size_to_drop>
+</clickhouse>
diff --git a/tests/integration/test_config_decryption/configs/config_subnodes.xml b/tests/integration/test_config_decryption/configs/config_subnodes.xml
new file mode 100644
index 000000000000..b0e519ff546f
--- /dev/null
+++ b/tests/integration/test_config_decryption/configs/config_subnodes.xml
@@ -0,0 +1,10 @@
+<clickhouse>
+    <encryption_codecs>
+        <aes_128_gcm_siv>
+            <key_hex>00112233445566778899aabbccddeeff</key_hex>
+        </aes_128_gcm_siv>
+    </encryption_codecs>
+    <interserver_http_credentials encryption_codec="AES_128_GCM_SIV">
+        <password>96260000000B0000000000E8FE3C087CED2205A5071078B29FD5C3B97F824911DED3217E980C</password>
+    </interserver_http_credentials>
+</clickhouse>
diff --git a/tests/integration/test_config_decryption/configs/config_wrong_method.xml b/tests/integration/test_config_decryption/configs/config_wrong_method.xml
new file mode 100644
index 000000000000..b452ce6374c3
--- /dev/null
+++ b/tests/integration/test_config_decryption/configs/config_wrong_method.xml
@@ -0,0 +1,12 @@
+<clickhouse>
+    <encryption_codecs>
+        <aes_128_gcm_siv>
+            <key_hex>00112233445566778899aabbccddeeff</key_hex>
+        </aes_128_gcm_siv>
+        <aes_256_gcm_siv>
+            <key_hex>00112233445566778899aabbccddeeff00112233445566778899aabbccddeeff</key_hex>
+        </aes_256_gcm_siv>
+    </encryption_codecs>
+    <max_table_size_to_drop encryption_codec="AES_128_GCM_SIV">96260000000B0000000000E8FE3C087CED2205A5071078B29FD5C3B97F824911DED3217E980C</max_table_size_to_drop>
+    <max_partition_size_to_drop encryption_codec="WRONG">97260000000B0000000000BFFF70C4DA718754C1DA0E2F25FF9246D4783F7FFEC4089EC1CC14</max_partition_size_to_drop>
+</clickhouse>
diff --git a/tests/integration/test_config_decryption/test.py b/tests/integration/test_config_decryption/test.py
new file mode 100644
index 000000000000..dd8cdc2e4e15
--- /dev/null
+++ b/tests/integration/test_config_decryption/test.py
@@ -0,0 +1,40 @@
+import pytest
+import os
+from helpers.cluster import ClickHouseCluster
+
+cluster = ClickHouseCluster(__file__)
+node1 = cluster.add_instance("node1", main_configs=["configs/config.xml"])
+node2 = cluster.add_instance("node2", main_configs=["configs/config.yaml"])
+
+
+@pytest.fixture(scope="module")
+def started_cluster():
+    try:
+        cluster.start()
+        yield cluster
+
+    finally:
+        cluster.shutdown()
+
+
+def check_node(started_cluster, node):
+    assert (
+        node.query(
+            "select value from system.server_settings where name ='max_table_size_to_drop'"
+        )
+        == "60000000000
"
+    )
+    assert (
+        node.query(
+            "select value from system.server_settings where name ='max_partition_size_to_drop'"
+        )
+        == "40000000000
"
+    )
+
+
+def test_successful_decryption_xml(started_cluster):
+    check_node(started_cluster, node1)
+
+
+def test_successful_decryption_yaml(started_cluster):
+    check_node(started_cluster, node2)
diff --git a/tests/integration/test_config_decryption/test_wrong_settings.py b/tests/integration/test_config_decryption/test_wrong_settings.py
new file mode 100644
index 000000000000..b148f9a051aa
--- /dev/null
+++ b/tests/integration/test_config_decryption/test_wrong_settings.py
@@ -0,0 +1,37 @@
+import pytest
+from helpers.cluster import ClickHouseCluster
+
+
+def start_clickhouse(config, err_msg):
+    cluster = ClickHouseCluster(__file__)
+    node = cluster.add_instance("node", main_configs=[config])
+    caught_exception = ""
+    try:
+        cluster.start()
+    except Exception as e:
+        caught_exception = str(e)
+    assert err_msg in caught_exception
+
+
+def test_wrong_method():
+    start_clickhouse(
+        "configs/config_wrong_method.xml", "Wrong encryption method. Got WRONG"
+    )
+
+
+def test_invalid_chars():
+    start_clickhouse(
+        "configs/config_invalid_chars.xml",
+        "Cannot read encrypted text, check for valid characters",
+    )
+
+
+def test_no_encryption_key():
+    start_clickhouse(
+        "configs/config_no_encryption_key.xml",
+        "There is no key 0 in config for AES_128_GCM_SIV encryption codec",
+    )
+
+
+def test_subnodes():
+    start_clickhouse("configs/config_subnodes.xml", "cannot contain nested elements")
