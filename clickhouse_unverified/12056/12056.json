{
  "repo": "ClickHouse/ClickHouse",
  "pull_number": 12056,
  "instance_id": "ClickHouse__ClickHouse-12056",
  "issue_numbers": [
    "11808"
  ],
  "base_commit": "8b2a5d81df73cc32453fb7a7d5c53876dfbc20b9",
  "patch": "diff --git a/src/Functions/defaultValueOfArgumentType.cpp b/src/Functions/defaultValueOfArgumentType.cpp\nindex 85da76ce6943..b07a92bd6777 100644\n--- a/src/Functions/defaultValueOfArgumentType.cpp\n+++ b/src/Functions/defaultValueOfArgumentType.cpp\n@@ -22,6 +22,7 @@ class FunctionDefaultValueOfArgumentType : public IFunction\n     }\n \n     bool useDefaultImplementationForNulls() const override { return false; }\n+    bool useDefaultImplementationForLowCardinalityColumns() const override { return false; }\n \n     size_t getNumberOfArguments() const override\n     {\n",
  "test_patch": "diff --git a/tests/queries/0_stateless/01355_defaultValueOfArgumentType_bug.reference b/tests/queries/0_stateless/01355_defaultValueOfArgumentType_bug.reference\nnew file mode 100644\nindex 000000000000..4165503c4b59\n--- /dev/null\n+++ b/tests/queries/0_stateless/01355_defaultValueOfArgumentType_bug.reference\n@@ -0,0 +1,1 @@\n+\tLowCardinality(String)\ndiff --git a/tests/queries/0_stateless/01355_defaultValueOfArgumentType_bug.sql b/tests/queries/0_stateless/01355_defaultValueOfArgumentType_bug.sql\nnew file mode 100644\nindex 000000000000..e3168eb09a06\n--- /dev/null\n+++ b/tests/queries/0_stateless/01355_defaultValueOfArgumentType_bug.sql\n@@ -0,0 +1,4 @@\n+SELECT \n+    materialize(toLowCardinality('')) AS lc,\n+    toTypeName(lc)\n+WHERE lc = defaultValueOfArgumentType(lc)\n",
  "problem_statement": "defaultValueOfArgumentType cannot be used in equations for LowCardinality columns\nI have checked 19.16, 20.3 and 20.4\r\n\r\n**How to reproduce**\r\n```\r\nSELECT\r\n    toLowCardinality('') AS lc,\r\n    toTypeName(lc)\r\nWHERE lc = defaultValueOfArgumentType(lc)\r\n\r\n\u250c\u2500lc\u2500\u252c\u2500toTypeName(toLowCardinality(''))\u2500\u2510\r\n\u2502    \u2502 LowCardinality(String)           \u2502\r\n\u2514\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n\r\n\r\nSELECT\r\n    materialize(toLowCardinality('')) AS lc,\r\n    toTypeName(lc)\r\nWHERE lc = defaultValueOfArgumentType(lc)\r\n\r\nReceived exception from server (version 20.4.4):\r\nCode: 49. DB::Exception: Received from localhost:9000. DB::Exception: Expected single dictionary argument for function..\r\n```\r\n\n",
  "hints_text": "",
  "created_at": "2020-06-30T11:38:23Z"
}