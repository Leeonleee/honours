diff --git a/tests/queries/0_stateless/02707_clickhouse_local_implicit_file_table_function.reference b/tests/queries/0_stateless/02707_clickhouse_local_implicit_file_table_function.reference
index ccc02ad4f345..60464757bdd5 100644
--- a/tests/queries/0_stateless/02707_clickhouse_local_implicit_file_table_function.reference
+++ b/tests/queries/0_stateless/02707_clickhouse_local_implicit_file_table_function.reference
@@ -5,5 +5,11 @@ implicit:
 4
 Test 2: check Filesystem database
 4
+30
+10
+4
+3
+2
+1
 Test 3: check show database with Filesystem
 test02707
diff --git a/tests/queries/0_stateless/02707_clickhouse_local_implicit_file_table_function.sh b/tests/queries/0_stateless/02707_clickhouse_local_implicit_file_table_function.sh
index 7c9095b3d8b3..dabea8a373a2 100755
--- a/tests/queries/0_stateless/02707_clickhouse_local_implicit_file_table_function.sh
+++ b/tests/queries/0_stateless/02707_clickhouse_local_implicit_file_table_function.sh
@@ -15,6 +15,23 @@ echo '2,"def",456,"bacabaa"' >> $dir/tmp.csv
 echo '3,"story",78912,"acabaab"' >> $dir/tmp.csv
 echo '4,"history",21321321,"cabaaba"' >> $dir/tmp.csv
 
+$CLICKHOUSE_LOCAL -q "insert into function file('$dir/tmp_numbers_1.csv') select * from numbers(1, 10)"
+$CLICKHOUSE_LOCAL -q "insert into function file('$dir/tmp_numbers_2.csv') select * from numbers(11, 10)"
+$CLICKHOUSE_LOCAL -q "insert into function file('$dir/tmp_numbers_30.csv') select * from numbers(21, 10)"
+
+readonly nested_dir=$dir/nested
+[[ -d $nested_dir ]] && rm -rd $nested_dir
+mkdir $nested_dir
+mkdir $nested_dir/subnested
+
+cp ${dir}/tmp_numbers_1.csv ${nested_dir}/nested_tmp_numbers_1.csv
+cp ${dir}/tmp_numbers_1.csv ${nested_dir}/subnested/subnested_tmp_numbers_1.csv
+
+readonly other_nested_dir=$dir/other_nested
+[[ -d $other_nested_dir ]] && rm -rd $other_nested_dir
+mkdir $other_nested_dir
+cp ${dir}/tmp_numbers_1.csv ${other_nested_dir}/tmp_numbers_1.csv
+
 #################
 echo "Test 1: check explicit and implicit call of the file table function"
 
@@ -29,6 +46,12 @@ $CLICKHOUSE_LOCAL --multiline --multiquery -q """
 DROP DATABASE IF EXISTS test;
 CREATE DATABASE test ENGINE = Filesystem('${dir}');
 SELECT COUNT(*) FROM test.\`tmp.csv\`;
+SELECT COUNT(*) FROM test.\`tmp_numbers_*.csv\`;
+SELECT COUNT(*) FROM test.\`nested/nested_tmp_numbers_1*.csv\`;
+SELECT count(DISTINCT _path) FROM test.\`*.csv\`;
+SELECT count(DISTINCT _path) FROM test.\`**/*.csv\`;
+SELECT count(DISTINCT _path) FROM test.\`**/*.csv\` WHERE position(_path, '${nested_dir}') > 0;
+SELECT count(DISTINCT _path) FROM test.\`**/*.csv\` WHERE position(_path, '${nested_dir}') = 0;
 DROP DATABASE test;
 """
 
diff --git a/tests/queries/0_stateless/02722_database_filesystem.reference b/tests/queries/0_stateless/02722_database_filesystem.reference
index c65dda7933a5..17f84cfc49ce 100644
--- a/tests/queries/0_stateless/02722_database_filesystem.reference
+++ b/tests/queries/0_stateless/02722_database_filesystem.reference
@@ -3,6 +3,14 @@ Test 1: create filesystem database and check implicit calls
 test1
 4
 4
+30
+10
+10
+4
+0
+2
+0
+OK
 4
 Test 2: check DatabaseFilesystem access rights and errors handling on server
 OK
@@ -13,3 +21,6 @@ OK
 OK
 OK
 OK
+OK
+OK
+OK
diff --git a/tests/queries/0_stateless/02722_database_filesystem.sh b/tests/queries/0_stateless/02722_database_filesystem.sh
index 99f2191c9915..c21b1af2ff40 100755
--- a/tests/queries/0_stateless/02722_database_filesystem.sh
+++ b/tests/queries/0_stateless/02722_database_filesystem.sh
@@ -19,11 +19,17 @@ echo '3,"story",78912,"acabaab"' >> ${user_files_tmp_dir}/tmp.csv
 echo '4,"history",21321321,"cabaaba"' >> ${user_files_tmp_dir}/tmp.csv
 
 tmp_dir=${CLICKHOUSE_TEST_UNIQUE_NAME}
+
+$CLICKHOUSE_LOCAL -q "insert into function file('$user_files_tmp_dir/tmp_numbers_1.csv') select * from numbers(1, 10)"
+$CLICKHOUSE_LOCAL -q "insert into function file('$user_files_tmp_dir/tmp_numbers_2.csv') select * from numbers(11, 10)"
+$CLICKHOUSE_LOCAL -q "insert into function file('$user_files_tmp_dir/tmp_numbers_30.csv') select * from numbers(21, 10)"
+
 [[ -d $tmp_dir ]] && rm -rd $tmp_dir
 mkdir $tmp_dir
 cp ${user_files_tmp_dir}/tmp.csv ${tmp_dir}/tmp.csv
 cp ${user_files_tmp_dir}/tmp.csv ${user_files_tmp_dir}/tmp/tmp.csv
 cp ${user_files_tmp_dir}/tmp.csv ${user_files_tmp_dir}/tmp.myext
+cp ${user_files_tmp_dir}/tmp_numbers_1.csv ${user_files_tmp_dir}/tmp/tmp_numbers_1.csv
 
 #################
 echo "Test 1: create filesystem database and check implicit calls"
@@ -35,6 +41,15 @@ echo $?
 ${CLICKHOUSE_CLIENT} --query "SHOW DATABASES" | grep "test1"
 ${CLICKHOUSE_CLIENT} --query "SELECT COUNT(*) FROM test1.\`${unique_name}/tmp.csv\`;"
 ${CLICKHOUSE_CLIENT} --query "SELECT COUNT(*) FROM test1.\`${unique_name}/tmp/tmp.csv\`;"
+${CLICKHOUSE_CLIENT} --query "SELECT COUNT(*) FROM test1.\`${unique_name}/tmp_numbers_*.csv\`;"
+${CLICKHOUSE_CLIENT} --query "SELECT COUNT(*) FROM test1.\`${unique_name}/tmp/*tmp_numbers_*.csv\`;"
+${CLICKHOUSE_CLIENT} --query "SELECT COUNT(*) FROM test1.\`${unique_name}/*/*tmp_numbers_*.csv\`;"
+${CLICKHOUSE_CLIENT} --query "SELECT count(DISTINCT _path) FROM test1.\`${unique_name}/*.csv\` WHERE startsWith(_path, '${user_files_tmp_dir}')";
+${CLICKHOUSE_CLIENT} --query "SELECT count(DISTINCT _path) FROM test1.\`${unique_name}/*.csv\` WHERE not startsWith(_path, '${user_files_tmp_dir}')";
+# **/* does not search in the current directory but searches recursively in nested directories.
+${CLICKHOUSE_CLIENT} --query "SELECT count(DISTINCT _path) FROM test1.\`${unique_name}/**/*.csv\` WHERE startsWith(_path, '${user_files_tmp_dir}')";
+${CLICKHOUSE_CLIENT} --query "SELECT count(DISTINCT _path) FROM test1.\`${unique_name}/**/*.csv\` WHERE not startsWith(_path, '${user_files_tmp_dir}')";
+${CLICKHOUSE_CLIENT} --query "SELECT COUNT(*) FROM test1.\`tmp_numbers_*.csv\`;" 2>&1 | tr '
' ' ' | grep -oF "CANNOT_EXTRACT_TABLE_STRUCTURE" > /dev/null && echo "OK" || echo 'FAIL' ||:
 ${CLICKHOUSE_LOCAL} -q "SELECT COUNT(*) FROM \"${tmp_dir}/tmp.csv\""
 
 #################
@@ -42,6 +57,9 @@ echo "Test 2: check DatabaseFilesystem access rights and errors handling on serv
 # DATABASE_ACCESS_DENIED: Allows list files only inside user_files
 ${CLICKHOUSE_CLIENT} --query "SELECT COUNT(*) FROM test1.\`../tmp.csv\`;" 2>&1 | tr '
' ' ' | grep -oF "PATH_ACCESS_DENIED" > /dev/null && echo "OK" || echo 'FAIL' ||:
 ${CLICKHOUSE_CLIENT} --query "SELECT COUNT(*) FROM test1.\`/tmp/tmp.csv\`;" 2>&1 | tr '
' ' ' | grep -oF "PATH_ACCESS_DENIED" > /dev/null && echo "OK" || echo 'FAIL' ||:
+${CLICKHOUSE_CLIENT} --query "SELECT COUNT(*) FROM test1.\`../*/tmp_numbers_*.csv\`;" 2>&1 | tr '
' ' ' | grep -oF "PATH_ACCESS_DENIED" > /dev/null && echo "OK" || echo 'FAIL' ||:
+${CLICKHOUSE_CLIENT} --query "SELECT COUNT(*) FROM test1.\`../tmp_numbers_*.csv\`;" 2>&1 | tr '
' ' ' | grep -oF "PATH_ACCESS_DENIED" > /dev/null && echo "OK" || echo 'FAIL' ||:
+${CLICKHOUSE_CLIENT} --query "SELECT COUNT(*) FROM test1.\`../*.csv\`;" 2>&1 | tr '
' ' ' | grep -oF "PATH_ACCESS_DENIED" > /dev/null && echo "OK" || echo 'FAIL' ||:
 ${CLICKHOUSE_CLIENT} --multiline --multiquery --query """
 USE test1;
 SELECT COUNT(*) FROM \"../${tmp_dir}/tmp.csv\";
diff --git a/tests/queries/0_stateless/02816_clickhouse_local_table_name_expressions.reference b/tests/queries/0_stateless/02816_clickhouse_local_table_name_expressions.reference
index 1e3b82ac1363..8f2c820522c0 100644
--- a/tests/queries/0_stateless/02816_clickhouse_local_table_name_expressions.reference
+++ b/tests/queries/0_stateless/02816_clickhouse_local_table_name_expressions.reference
@@ -25,3 +25,37 @@ Test 3a: check literal no parsing overflow
 1
 Test 3b: check literal empty
 1
+Test 4: select using * wildcard
+30
+30
+30
+30
+30
+10
+30
+10
+Test 4b: select using ? wildcard
+20
+10
+20
+10
+20
+Test 4c: select using '{' + '}'  wildcards
+20
+20
+1
+Test 4d: select using ? and * wildcards
+30
+30
+30
+1
+30
+30
+Test 4e: select using ?, * and '{' + '}' wildcards
+10
+20
+20
+20
+Test 4f: recursive search
+2
+1
diff --git a/tests/queries/0_stateless/02816_clickhouse_local_table_name_expressions.sh b/tests/queries/0_stateless/02816_clickhouse_local_table_name_expressions.sh
index 5cf3b1c88fd4..40b936481e7e 100755
--- a/tests/queries/0_stateless/02816_clickhouse_local_table_name_expressions.sh
+++ b/tests/queries/0_stateless/02816_clickhouse_local_table_name_expressions.sh
@@ -7,6 +7,8 @@ CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
 dir=${CLICKHOUSE_TEST_UNIQUE_NAME}
 [[ -d $dir ]] && rm -rd $dir
 mkdir $dir
+mkdir $dir/nested
+mkdir $dir/nested/nested
 
 # Create temporary csv file for tests
 echo '"id","str","int","text"' > $dir/tmp.csv
@@ -15,6 +17,14 @@ echo '2,"def",456,"bacabaa"' >> $dir/tmp.csv
 echo '3,"story",78912,"acabaab"' >> $dir/tmp.csv
 echo '4,"history",21321321,"cabaaba"' >> $dir/tmp.csv
 
+$CLICKHOUSE_LOCAL -q "insert into function file('$dir/tmp_numbers_1.jsonl') select * from numbers(1, 10)"
+$CLICKHOUSE_LOCAL -q "insert into function file('$dir/tmp_numbers_2.jsonl') select * from numbers(11, 10)"
+
+$CLICKHOUSE_LOCAL -q "insert into function file('$dir/tmp_numbers_30.jsonl') select * from numbers(21, 10)"
+
+$CLICKHOUSE_LOCAL -q "insert into function file('$dir/nested/nested_numbers.jsonl') select * from numbers(1)"
+$CLICKHOUSE_LOCAL -q "insert into function file('$dir/nested/nested/nested_nested_numbers.jsonl') select * from numbers(1)"
+
 #################
 echo "Test 1: check double quotes"
 
@@ -52,5 +62,48 @@ echo "Test 3b: check literal empty"
 
 $CLICKHOUSE_LOCAL -q "SELECT * FROM ''" 2>&1 | grep -c "SYNTAX_ERROR"
 
+echo "Test 4: select using * wildcard"
+# Extension is required for auto table structure detection
+$CLICKHOUSE_LOCAL -q "SELECT count(*) FROM '$dir/tmp_numbers_*.jsonl'"
+$CLICKHOUSE_LOCAL -q "SELECT count(*) FROM '$dir/**.jsonl'"
+$CLICKHOUSE_LOCAL -q "SELECT count(*) FROM '$dir/**********************.jsonl'"
+$CLICKHOUSE_LOCAL -q "SELECT count(*) FROM '$dir/*_numbers_*.jsonl'"
+$CLICKHOUSE_LOCAL -q "SELECT count(*) FROM '$dir/*_nu*ers_*.jsonl'"
+$CLICKHOUSE_LOCAL -q "SELECT count(*) FROM '$dir/*_nu*ers_2.jsonl'"
+$CLICKHOUSE_LOCAL -q "SELECT count(*) FROM '$dir/*tmp_numbers_*.jsonl'"
+$CLICKHOUSE_LOCAL -q "SELECT count(*) FROM '$dir/*tmp_numbers_1*.jsonl'"
+
+echo "Test 4b: select using ? wildcard"
+$CLICKHOUSE_LOCAL -q "SELECT count(*) FROM '$dir/tmp_numbers_?.jsonl'"
+$CLICKHOUSE_LOCAL -q "SELECT count(*) FROM '$dir/tmp_numbers_??.jsonl'"
+$CLICKHOUSE_LOCAL -q "SELECT count(*) FROM '$dir/??p_numbers??.jsonl'"
+$CLICKHOUSE_LOCAL -q "SELECT count(*) FROM '$dir/tmp_n?mbers_1.jsonl'"
+$CLICKHOUSE_LOCAL -q "SELECT count(*) FROM '$dir/t?p_n?mbers_?.jsonl'"
+
+echo "Test 4c: select using '{' + '}'  wildcards"
+$CLICKHOUSE_LOCAL -q "SELECT count(*) FROM '$dir/tmp_numbers_{1..3}.jsonl'"
+$CLICKHOUSE_LOCAL -q "SELECT count(*) FROM '$dir/tmp_numbers_{1,2}.jsonl'"
+$CLICKHOUSE_LOCAL -q "SELECT count(*) FROM '$dir/tmp_numbers__{1,2}.jsonl'" 2>&1 | grep -c "CANNOT_EXTRACT_TABLE_STRUCTURE"
+
+echo "Test 4d: select using ? and * wildcards"
+$CLICKHOUSE_LOCAL -q "SELECT count(*) FROM '$dir/*?.jsonl'"
+$CLICKHOUSE_LOCAL -q "SELECT count(*) FROM '$dir/?*.jsonl'"
+$CLICKHOUSE_LOCAL -q "SELECT count(*) FROM '$dir/?*????.jsonl'"
+$CLICKHOUSE_LOCAL -q "SELECT count(*) FROM '$dir/?*?***_.jsonl'" 2>&1 | grep -c "CANNOT_EXTRACT_TABLE_STRUCTURE"
+$CLICKHOUSE_LOCAL -q "SELECT count(*) FROM '$dir/?*????_*.jsonl'"
+$CLICKHOUSE_LOCAL -q "SELECT count(*) FROM '$dir/*?*_num*e?s_*.jsonl'"
+
+echo "Test 4e: select using ?, * and '{' + '}' wildcards"
+$CLICKHOUSE_LOCAL -q "SELECT count(*) FROM '$dir/*?{1,3}.jsonl'"
+$CLICKHOUSE_LOCAL -q "SELECT count(*) FROM '$dir/*?{1..3}.jsonl'"
+$CLICKHOUSE_LOCAL -q "SELECT count(*) FROM '$dir/*?*_num*e?s_{1..3}.jsonl'"
+$CLICKHOUSE_LOCAL -q "SELECT count(*) FROM '$dir/*?*_num*e?s_{1,2}.jsonl'"
+
+echo "Test 4f: recursive search"
+# /**/* pattern does not look in current directory
+$CLICKHOUSE_LOCAL -q "SELECT count(*) FROM '$dir/**/*.jsonl'"
+$CLICKHOUSE_LOCAL -q "SELECT count(*) FROM '$dir/nested/**/*.jsonl'"
+
+
 # Remove temporary dir with files
 rm -rd $dir
