diff --git a/tests/queries/0_stateless/02499_quantile_nan_ubsan_msan.reference b/tests/queries/0_stateless/02499_quantile_nan_ubsan_msan.reference
new file mode 100644
index 000000000000..7f49bc212e6e
--- /dev/null
+++ b/tests/queries/0_stateless/02499_quantile_nan_ubsan_msan.reference
@@ -0,0 +1,25 @@
+['1970-01-01 00:00:00']
+['1970-01-01 00:00:00']
+
+['1970-01-01 00:00:00']
+['1970-01-01 00:00:00']
+['1970-01-01 00:00:00','1970-01-01 00:00:00','1970-01-01 00:00:00','1970-01-01 00:00:00','1970-01-01 00:00:00','1970-01-01 00:00:00','1970-01-01 00:00:00','1970-01-01 00:00:00','1970-01-01 00:00:00']
+
+['1970-01-01 00:00:00','1970-01-01 00:00:00','1970-01-01 00:00:00','1970-01-01 00:00:00','1970-01-01 00:00:00','1970-01-01 00:00:00','1970-01-01 00:00:00','1970-01-01 00:00:00','1970-01-01 00:00:00']
+['1970-01-01 00:00:00']
+['1970-01-01 00:00:00','1970-01-01 00:00:00','1970-01-01 00:00:00','1970-01-01 00:00:00']
+[18446744073709552000]
+['1970-01-01 00:00:00']
+['1970-01-01 00:00:00','1970-01-01 00:00:00','1970-01-01 00:00:00','1970-01-01 00:00:00']
+[1.157920892373162e77]
+[nan]
+1970-01-01 00:00:00
+1970-01-01 00:00:00
+
+1970-01-01 00:00:00
+1970-01-01 00:00:00
+1970-01-01 00:00:00
+18446744073709552000
+1970-01-01 00:00:00
+1.157920892373162e77
+nan
diff --git a/tests/queries/0_stateless/02499_quantile_nan_ubsan_msan.sql b/tests/queries/0_stateless/02499_quantile_nan_ubsan_msan.sql
new file mode 100644
index 000000000000..d8a8a040a7cb
--- /dev/null
+++ b/tests/queries/0_stateless/02499_quantile_nan_ubsan_msan.sql
@@ -0,0 +1,22 @@
+SELECT quantiles(0.5)(now()::DateTime('UTC')) WHERE 0;
+SELECT quantiles(0.5)(now()::DateTime('UTC')) WHERE 0 WITH TOTALS;
+SELECT arrayReduce('quantiles(0.5)', []::Array(DateTime('UTC')));
+SELECT quantiles(0.5, 1.1754943508222875e-38, 0.0001, -0., 0.0001, -0., 0.0001, 0., 0.5)(now()::DateTime('UTC')) WHERE 0 WITH TOTALS;
+
+SELECT DISTINCT arrayReduce('quantiles(0.5)', materialize([]::Array(DateTime('UTC')))) FROM numbers(1000) LIMIT 10;
+SELECT DISTINCT arrayReduce('quantiles(0, 0.5, 0.9, 1)', materialize([]::Array(DateTime('UTC')))) FROM numbers(1000) LIMIT 10;
+SELECT DISTINCT arrayReduce('quantiles(0.5)', [0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFE]) FROM numbers(1000) LIMIT 10;
+SELECT DISTINCT arrayReduce('quantilesDeterministic(0.5)', materialize([]::Array(DateTime('UTC'))), []::Array(UInt64)) FROM numbers(1000) LIMIT 10;
+SELECT DISTINCT arrayReduce('quantilesDeterministic(0, 0.5, 0.9, 1)', materialize([]::Array(DateTime('UTC'))), []::Array(UInt64)) FROM numbers(1000) LIMIT 10;
+SELECT DISTINCT arrayReduce('quantiles(0.5)', [CAST(-1, 'UInt256'), CAST(-2, 'UInt256')]) FROM numbers(1000) LIMIT 10;
+SELECT DISTINCT arrayReduce('quantiles(0.5)', []::Array(Float64)) FROM numbers(1000) LIMIT 10;
+
+SELECT quantile(0.5)(now()::DateTime('UTC')) WHERE 0;
+SELECT quantile(0.5)(now()::DateTime('UTC')) WHERE 0 WITH TOTALS;
+SELECT arrayReduce('quantile(0.5)', []::Array(DateTime('UTC')));
+
+SELECT DISTINCT arrayReduce('quantile(0.5)', materialize([]::Array(DateTime('UTC')))) FROM numbers(1000) LIMIT 10;
+SELECT DISTINCT arrayReduce('quantile(0.5)', [0xFFFFFFFFFFFFFFFF, 0xFFFFFFFFFFFFFFFE]) FROM numbers(1000) LIMIT 10;
+SELECT DISTINCT arrayReduce('quantileDeterministic(0.5)', materialize([]::Array(DateTime('UTC'))), []::Array(UInt64)) FROM numbers(1000) LIMIT 10;
+SELECT DISTINCT arrayReduce('quantile(0.5)', [CAST(-1, 'UInt256'), CAST(-2, 'UInt256')]) FROM numbers(1000) LIMIT 10;
+SELECT DISTINCT arrayReduce('quantile(0.5)', []::Array(Float64)) FROM numbers(1000) LIMIT 10;
