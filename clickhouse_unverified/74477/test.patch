diff --git a/tests/queries/0_stateless/01547_query_log_current_database.sql b/tests/queries/0_stateless/01547_query_log_current_database.sql
index 5eec8a81cccc..7ed0f389f39f 100644
--- a/tests/queries/0_stateless/01547_query_log_current_database.sql
+++ b/tests/queries/0_stateless/01547_query_log_current_database.sql
@@ -1,5 +1,5 @@
 --
--- This is more cleaner approach for writing a test that relies on system.query_log/query_thread_log.
+-- This is a cleaner approach for writing a test that relies on system.query_log/query_thread_log.
 --
 -- It uses current database, and since clickhouse-test will generate random for
 -- each run you can run the test multiple times without worrying about
@@ -30,6 +30,6 @@ where
 select count() == 2
 from system.query_thread_log
 where
-    query like 'select \'01547_query_log_current_database%'
+    query like 'select \'01547\_query\_log\_current\_database%'
     and current_database = currentDatabase()
     and event_date >= yesterday()
diff --git a/tests/queries/0_stateless/03312_line_numbers.reference b/tests/queries/0_stateless/03312_line_numbers.reference
new file mode 100644
index 000000000000..168ed4fcaa00
--- /dev/null
+++ b/tests/queries/0_stateless/03312_line_numbers.reference
@@ -0,0 +1,8 @@
+This is the first query, and it is located on line 4	1	2	3
+This is the second query, and it is located on line 8
+QueryStart	1	4	SELECT \'This is the first query, and it is located on line 4\',
1, -- Just random stuff to ensure proper counting of lines.
2, 3;
+QueryFinish	1	4	SELECT \'This is the first query, and it is located on line 4\',
1, -- Just random stuff to ensure proper counting of lines.
2, 3;
+QueryStart	2	8	SELECT \'This is the second query, and it is located on line 8\';
+QueryFinish	2	8	SELECT \'This is the second query, and it is located on line 8\';
+Ok
+Ok
diff --git a/tests/queries/0_stateless/03312_line_numbers.sql b/tests/queries/0_stateless/03312_line_numbers.sql
new file mode 100644
index 000000000000..d5616e76b568
--- /dev/null
+++ b/tests/queries/0_stateless/03312_line_numbers.sql
@@ -0,0 +1,14 @@
+-- Tags: no-fasttest
+-- ^ due to the usage of system logs
+
+SELECT 'This is the first query, and it is located on line 4',
+1, -- Just random stuff to ensure proper counting of lines.
+2, 3;
+
+SELECT 'This is the second query, and it is located on line 8';
+
+SYSTEM FLUSH LOGS;
+SELECT type, script_query_number, script_line_number, query FROM system.query_log WHERE current_database = currentDatabase() AND event_date >= yesterday() ORDER BY event_time_microseconds, type;
+
+SELECT 'Ok' FROM system.text_log WHERE event_date >= yesterday() AND message LIKE '%(query 1, line 4)%' AND message LIKE '%This is the first query%' LIMIT 1;
+SELECT 'Ok' FROM system.text_log WHERE event_date >= yesterday() AND message LIKE '%(query 2, line 8)%' AND message LIKE '%This is the second query%' LIMIT 1;
