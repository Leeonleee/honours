diff --git a/src/Processors/QueryPipeline.cpp b/src/Processors/QueryPipeline.cpp
index ff086fd5b115..97d753bf5fb1 100644
--- a/src/Processors/QueryPipeline.cpp
+++ b/src/Processors/QueryPipeline.cpp
@@ -182,8 +182,11 @@ void QueryPipeline::addExtremesTransform()
 {
     checkInitializedAndNotCompleted();
 
+    /// It is possible that pipeline already have extremes.
+    /// For example, it may be added from VIEW subquery.
+    /// In this case, recalculate extremes again - they should be calculated for different rows.
     if (pipe.getExtremesPort())
-        throw Exception("Extremes transform was already added to pipeline.", ErrorCodes::LOGICAL_ERROR);
+        pipe.dropExtremes();
 
     resize(1);
     auto transform = std::make_shared<ExtremesTransform>(getHeader());
