diff --git a/tests/queries/0_stateless/02346_to_hour_monotonicity_fix_2.reference b/tests/queries/0_stateless/02346_to_hour_monotonicity_fix_2.reference
new file mode 100644
index 000000000000..323c900b1c71
--- /dev/null
+++ b/tests/queries/0_stateless/02346_to_hour_monotonicity_fix_2.reference
@@ -0,0 +1,2 @@
+60
+60
diff --git a/tests/queries/0_stateless/02346_to_hour_monotonicity_fix_2.sql b/tests/queries/0_stateless/02346_to_hour_monotonicity_fix_2.sql
new file mode 100644
index 000000000000..5d1452b43c9b
--- /dev/null
+++ b/tests/queries/0_stateless/02346_to_hour_monotonicity_fix_2.sql
@@ -0,0 +1,13 @@
+DROP TABLE IF EXISTS test;
+
+CREATE TABLE test (stamp DateTime('UTC')) ENGINE = MergeTree PARTITION BY toDate(stamp) ORDER BY tuple() as select toDateTime('2020-01-01', 'UTC')+number*60 from numbers(1e3);
+
+SELECT count() result FROM test WHERE toHour(stamp, 'America/Montreal') = 7;
+
+DROP TABLE test;
+
+CREATE TABLE test (stamp Nullable(DateTime('UTC'))) ENGINE = MergeTree PARTITION BY toDate(stamp) ORDER BY tuple() SETTINGS allow_nullable_key = 1 as select toDateTime('2020-01-01', 'UTC')+number*60 from numbers(1e3);
+
+SELECT count() result FROM test WHERE toHour(stamp, 'America/Montreal') = 7;
+
+DROP TABLE test;
