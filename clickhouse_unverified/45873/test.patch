diff --git a/tests/queries/0_stateless/02542_table_function_format.reference b/tests/queries/0_stateless/02542_table_function_format.reference
new file mode 100644
index 000000000000..c84889671449
--- /dev/null
+++ b/tests/queries/0_stateless/02542_table_function_format.reference
@@ -0,0 +1,22 @@
+a	Nullable(String)					
+b	Nullable(Int64)					
+a	String					
+b	Int64					
+Hello	111
+World	123
+Hello	111
+World	123
+c1	Nullable(Int64)					
+c2	Nullable(Int64)					
+c3	Array(Nullable(Int64))					
+c4	Array(Array(Nullable(String)))					
+a1	Int32					
+a2	UInt64					
+a3	Array(Int32)					
+a4	Array(Array(String))					
+1	2	[1,2,3]	[['abc'],[],['d','e']]
+1	2	[1,2,3]	[['abc'],[],['d','e']]
+20210129005809043707
+123456789
+987654321
+cust_id	UInt128					
diff --git a/tests/queries/0_stateless/02542_table_function_format.sql b/tests/queries/0_stateless/02542_table_function_format.sql
new file mode 100644
index 000000000000..e32e9001b9fb
--- /dev/null
+++ b/tests/queries/0_stateless/02542_table_function_format.sql
@@ -0,0 +1,36 @@
+desc format(JSONEachRow, 
+$$
+{"a": "Hello", "b": 111}
+{"a": "World", "b": 123}
+{"a": "Hello", "b": 111}
+{"a": "World", "b": 123}
+$$);
+
+desc format(JSONEachRow, 'a String, b Int64',
+$$
+{"a": "Hello", "b": 111}
+{"a": "World", "b": 123}
+{"a": "Hello", "b": 111}
+{"a": "World", "b": 123}
+$$);
+
+select * from format(JSONEachRow, 'a String, b Int64',
+$$
+{"a": "Hello", "b": 111}
+{"a": "World", "b": 123}
+{"a": "Hello", "b": 111}
+{"a": "World", "b": 123}
+$$);
+
+desc format(CSV, '1,2,"[1,2,3]","[[\'abc\'], [], [\'d\', \'e\']]"');
+desc format(CSV, 'a1 Int32, a2 UInt64, a3 Array(Int32), a4 Array(Array(String))', '1,2,"[1,2,3]","[[\'abc\'], [], [\'d\', \'e\']]"');
+select * from format(CSV, '1,2,"[1,2,3]","[[\'abc\'], [], [\'d\', \'e\']]"');
+select * from format(CSV, 'a1 Int32, a2 UInt64, a3 Array(Int32), a4 Array(Array(String))', '1,2,"[1,2,3]","[[\'abc\'], [], [\'d\', \'e\']]"');
+
+drop table if exists test;
+
+create table test as format(TSV, 'cust_id UInt128', '20210129005809043707
123456789
987654321');
+
+select * from test;
+desc table test;
+drop table test;
