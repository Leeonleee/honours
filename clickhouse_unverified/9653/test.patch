diff --git a/dbms/tests/integration/test_distributed_format/test.py b/dbms/tests/integration/test_distributed_format/test.py
index eb296463376a..3f139c8a6eb8 100644
--- a/dbms/tests/integration/test_distributed_format/test.py
+++ b/dbms/tests/integration/test_distributed_format/test.py
@@ -22,9 +22,9 @@ def started_cluster():
         cluster.shutdown()
 
 
-def test_single_file(started_cluster):
+def test_single_file_new(started_cluster):
     node.query("create table distr_1 (x UInt64, s String) engine = Distributed('test_cluster', database, table)")
-    node.query("insert into distr_1 values (1, 'a'), (2, 'bb'), (3, 'ccc')")
+    node.query("insert into distr_1 values (1, 'a'), (2, 'bb'), (3, 'ccc')", settings={"use_compact_format_in_distributed_parts_names": "1"})
 
     query = "select * from file('/var/lib/clickhouse/data/default/distr_1/shard1_replica1/1.bin', 'Distributed')"
     out = node.exec_in_container(['/usr/bin/clickhouse', 'local', '--stacktrace', '-q', query])
@@ -42,8 +42,8 @@ def test_single_file(started_cluster):
 
 def test_two_files(started_cluster):
     node.query("create table distr_2 (x UInt64, s String) engine = Distributed('test_cluster', database, table)")
-    node.query("insert into distr_2 values (0, '_'), (1, 'a')")
-    node.query("insert into distr_2 values (2, 'bb'), (3, 'ccc')")
+    node.query("insert into distr_2 values (0, '_'), (1, 'a')", settings={"use_compact_format_in_distributed_parts_names": "1"})
+    node.query("insert into distr_2 values (2, 'bb'), (3, 'ccc')", settings={"use_compact_format_in_distributed_parts_names": "1"})
 
     query = "select * from file('/var/lib/clickhouse/data/default/distr_2/shard1_replica1/{1,2,3,4}.bin', 'Distributed') order by x"
     out = node.exec_in_container(['/usr/bin/clickhouse', 'local', '--stacktrace', '-q', query])
@@ -57,3 +57,21 @@ def test_two_files(started_cluster):
     assert out == '0\t_
1\ta
2\tbb
3\tccc
'
 
     node.query("drop table distr_2")
+
+
+def test_single_file_old(started_cluster):
+    node.query("create table distr_3 (x UInt64, s String) engine = Distributed('test_cluster', database, table)")
+    node.query("insert into distr_3 values (1, 'a'), (2, 'bb'), (3, 'ccc')")
+
+    query = "select * from file('/var/lib/clickhouse/data/default/distr_3/default@not_existing:9000/1.bin', 'Distributed')"
+    out = node.exec_in_container(['/usr/bin/clickhouse', 'local', '--stacktrace', '-q', query])
+
+    assert out == '1\ta
2\tbb
3\tccc
'
+
+    query = "create table t (dummy UInt32) engine = File('Distributed', '/var/lib/clickhouse/data/default/distr_3/default@not_existing:9000/1.bin');" \
+            "select * from t"
+    out = node.exec_in_container(['/usr/bin/clickhouse', 'local', '--stacktrace', '-q', query])
+
+    assert out == '1\ta
2\tbb
3\tccc
'
+
+    node.query("drop table distr_3")
diff --git a/dbms/tests/integration/test_distributed_storage_configuration/test.py b/dbms/tests/integration/test_distributed_storage_configuration/test.py
index ad20e28271ab..a7c33b059c33 100644
--- a/dbms/tests/integration/test_distributed_storage_configuration/test.py
+++ b/dbms/tests/integration/test_distributed_storage_configuration/test.py
@@ -25,7 +25,7 @@ def _files_in_dist_mon(node, root, table):
         'bash',
         '-c',
         # `-maxdepth 1` to avoid /tmp/ subdirectory
-        'find /{root}/data/default/{table}/shard2_replica1 -maxdepth 1 -type f | wc -l'.format(root=root, table=table)
+        'find /{root}/data/default/{table}/default@127%2E0%2E0%2E2:9000 -maxdepth 1 -type f | wc -l'.format(root=root, table=table)
     ]).split('
')[0])
 
 def test_different_versions(start_cluster):
