diff --git a/dbms/tests/queries/0_stateless/00988_parallel_parts_removal.reference b/dbms/tests/queries/0_stateless/00988_parallel_parts_removal.reference
new file mode 100644
index 000000000000..aa6663eb9c78
--- /dev/null
+++ b/dbms/tests/queries/0_stateless/00988_parallel_parts_removal.reference
@@ -0,0 +1,2 @@
+1000	499500
+1000	499500
diff --git a/dbms/tests/queries/0_stateless/00988_parallel_parts_removal.sql b/dbms/tests/queries/0_stateless/00988_parallel_parts_removal.sql
new file mode 100644
index 000000000000..0dccd3df0485
--- /dev/null
+++ b/dbms/tests/queries/0_stateless/00988_parallel_parts_removal.sql
@@ -0,0 +1,18 @@
+DROP TABLE IF EXISTS mt;
+
+CREATE TABLE mt (x UInt64) ENGINE = MergeTree ORDER BY x SETTINGS max_part_removal_threads = 16, cleanup_delay_period = 1, cleanup_delay_period_random_add = 0, old_parts_lifetime = 1, parts_to_delay_insert = 100000, parts_to_throw_insert = 100000;
+
+SYSTEM STOP MERGES;
+
+SET max_block_size = 1, min_insert_block_size_rows = 0, min_insert_block_size_bytes = 0;
+INSERT INTO mt SELECT * FROM numbers(1000);
+SET max_block_size = 65536;
+
+SELECT count(), sum(x) FROM mt;
+
+SYSTEM START MERGES;
+OPTIMIZE TABLE mt FINAL;
+
+SELECT count(), sum(x) FROM mt;
+
+DROP TABLE mt;
diff --git a/dbms/tests/queries/0_stateless/00989_parallel_parts_loading.reference b/dbms/tests/queries/0_stateless/00989_parallel_parts_loading.reference
new file mode 100644
index 000000000000..aa6663eb9c78
--- /dev/null
+++ b/dbms/tests/queries/0_stateless/00989_parallel_parts_loading.reference
@@ -0,0 +1,2 @@
+1000	499500
+1000	499500
diff --git a/dbms/tests/queries/0_stateless/00989_parallel_parts_loading.sql b/dbms/tests/queries/0_stateless/00989_parallel_parts_loading.sql
new file mode 100644
index 000000000000..5e0011483b3c
--- /dev/null
+++ b/dbms/tests/queries/0_stateless/00989_parallel_parts_loading.sql
@@ -0,0 +1,19 @@
+DROP TABLE IF EXISTS mt;
+
+CREATE TABLE mt (x UInt64) ENGINE = MergeTree ORDER BY x SETTINGS max_part_loading_threads = 16, parts_to_delay_insert = 100000, parts_to_throw_insert = 100000;
+
+SYSTEM STOP MERGES;
+
+SET max_block_size = 1, min_insert_block_size_rows = 0, min_insert_block_size_bytes = 0;
+INSERT INTO mt SELECT * FROM numbers(1000);
+SET max_block_size = 65536;
+
+SELECT count(), sum(x) FROM mt;
+
+DETACH TABLE mt;
+ATTACH TABLE mt;
+
+SELECT count(), sum(x) FROM mt;
+
+SYSTEM START MERGES;
+DROP TABLE mt;
