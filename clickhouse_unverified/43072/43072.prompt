You will be provided with a partial code base and an issue statement explaining a problem to resolve.

<issue>
`uniqExact` (= `distinct count`) is slow
I'm comparing ClickHouse with a commercial columnar database. It's amazing that in some cases ClickHouse beats the commercial product even with less resources(4 cores vs. 20 cores in my case). However, I noticed uniqExact(or distinct count) is unreasonably slow.

Here is my findings(using dockerized ClickHouse 19.3.4) and hopefully they can be of use:
* assume we have a table with a few hundred millions rows(mine: ~600,000,000 rows) like below
```sql
create table test_distinct_count(a String, b String, b Int32, d String, ...)
Engine=MergeTree() order by (a, b, c, d) settings index_granularity = 8192;
```

* we'll likely get the following test results on a VM with 4 cores(max_threads=4)
```sql
select a from test_distinct_count group by a -- 1,100+ rows returned in 5.252s
select distinct a from test_distinct_count -- 1,100+ rows returned in 5.912s
select uniq(a) from test_distinct_count -- 1 row returned in 7.483s
select uniqExact(a) from test_distinct_count -- 1 row returned in 12.308s
select count(1) from (select distinct a from test_distinct_count) x -- 1 row returned in 5.821s
select count(1) from (select a from test_distinct_count group by a) x -- 1 row returned in 4.937s
```

It looks like using `group by` and avoiding `distinct` bring us better performance, but it's really inconvenient to replace all `distinct count` with the trick...

Update: same issue on 19.3.5
</issue>

I need you to solve the provided issue by generating a code fix that can be applied directly to the repository

Respond below:
