{
  "repo": "ClickHouse/ClickHouse",
  "pull_number": 22042,
  "instance_id": "ClickHouse__ClickHouse-22042",
  "issue_numbers": [
    "22028"
  ],
  "base_commit": "771493f03a1bb23a571a653cf3328d7cb2de22a0",
  "patch": "diff --git a/src/Functions/connectionID.cpp b/src/Functions/connectionID.cpp\nindex 8e9c81aed6c2..0f45d5cb1849 100644\n--- a/src/Functions/connectionID.cpp\n+++ b/src/Functions/connectionID.cpp\n@@ -34,8 +34,8 @@ class FunctionConnectionID : public IFunction\n \n void registerFunctionConnectionID(FunctionFactory & factory)\n {\n-    factory.registerFunction<FunctionConnectionID>();\n-    factory.registerAlias(\"connection_id\", \"connectionID\");\n+    factory.registerFunction<FunctionConnectionID>(FunctionFactory::CaseInsensitive);\n+    factory.registerAlias(\"connection_id\", \"connectionID\", FunctionFactory::CaseInsensitive);\n }\n \n }\ndiff --git a/src/Functions/version.cpp b/src/Functions/version.cpp\nindex 404c03223ad5..37f9c7b1e985 100644\n--- a/src/Functions/version.cpp\n+++ b/src/Functions/version.cpp\n@@ -49,7 +49,7 @@ class FunctionVersion : public IFunction\n \n void registerFunctionVersion(FunctionFactory & factory)\n {\n-    factory.registerFunction<FunctionVersion>();\n+    factory.registerFunction<FunctionVersion>(FunctionFactory::CaseInsensitive);\n }\n \n }\n",
  "test_patch": "diff --git a/tests/queries/0_stateless/01773_case_sensitive_version.reference b/tests/queries/0_stateless/01773_case_sensitive_version.reference\nnew file mode 100644\nindex 000000000000..72749c905a31\n--- /dev/null\n+++ b/tests/queries/0_stateless/01773_case_sensitive_version.reference\n@@ -0,0 +1,1 @@\n+1\t1\t1\ndiff --git a/tests/queries/0_stateless/01773_case_sensitive_version.sql b/tests/queries/0_stateless/01773_case_sensitive_version.sql\nnew file mode 100644\nindex 000000000000..27fa1c27b2ac\n--- /dev/null\n+++ b/tests/queries/0_stateless/01773_case_sensitive_version.sql\n@@ -0,0 +1,1 @@\n+SELECT version()=Version(), VERSION()=Version(), vErSiOn()=VeRsIoN();\ndiff --git a/tests/queries/0_stateless/01774_case_sensitive_connection_id.reference b/tests/queries/0_stateless/01774_case_sensitive_connection_id.reference\nnew file mode 100644\nindex 000000000000..95bea1a178ce\n--- /dev/null\n+++ b/tests/queries/0_stateless/01774_case_sensitive_connection_id.reference\n@@ -0,0 +1,1 @@\n+0\t0\t0\t0\t0\t0\ndiff --git a/tests/queries/0_stateless/01774_case_sensitive_connection_id.sql b/tests/queries/0_stateless/01774_case_sensitive_connection_id.sql\nnew file mode 100644\nindex 000000000000..5a4f2b5853a0\n--- /dev/null\n+++ b/tests/queries/0_stateless/01774_case_sensitive_connection_id.sql\n@@ -0,0 +1,1 @@\n+SELECT connection_id(), CONNECTION_ID(), CoNnEcTiOn_Id(), connectionid(), CONNECTIONID(), CoNnEcTiOnId();\n",
  "problem_statement": "why connection_id() and version() aliases exists, but CONNECTION_ID() and VERSION() is not? ;)\n**Describe the bug**\r\nAccording to https://jira.percona.com/browse/PT-1945 and https://github.com/ClickHouse/ClickHouse/pull/21367\r\n\r\n**Does it reproduce on a recent release?**\r\nyep\r\n\r\n**How to reproduce**\r\n- define `mysql_port`\r\n- run following SQL queries via MySQL client\r\n```\r\nmysql> SELECT DATABASE(), CONNECTION_ID(), VERSION()/*!50038 , @@hostname*/;\r\nERROR 46 (00000): Code: 46, e.displayText() = DB::Exception: Unknown function CONNECTION_ID. Maybe you meant: ['connection_id','connectionID']: While processing DATABASE(), CONNECTION_ID(), VERSION() (version 21.3.2.5 (official build))\r\nmysql> SELECT DATABASE(), connection_id(), VERSION()/*!50038 , @@hostname*/;\r\nERROR 46 (00000): Code: 46, e.displayText() = DB::Exception: Unknown function VERSION. Maybe you meant: ['version']: While processing DATABASE(), connection_id(), VERSION() (version 21.3.2.5 (official build))\r\nmysql> SELECT DATABASE(), connection_id(), version()/*!50038 , @@hostname*/;\r\n+------------+-----------------+-----------+\r\n| DATABASE() | connection_id() | version() |\r\n+------------+-----------------+-----------+\r\n| default    |               0 | 21.3.3.14  |\r\n+------------+-----------------+-----------+\r\n```\r\n\r\n**Expected behavior**\r\nVERSION() and CONNECTION_ID() aliases should work ;)\r\n\n",
  "hints_text": "",
  "created_at": "2021-03-23T14:34:10Z"
}