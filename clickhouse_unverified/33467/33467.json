{
  "repo": "ClickHouse/ClickHouse",
  "pull_number": 33467,
  "instance_id": "ClickHouse__ClickHouse-33467",
  "issue_numbers": [
    "26211"
  ],
  "base_commit": "107246e21439ae5045c07aec9abe0578e3e58c70",
  "patch": "diff --git a/docs/en/operations/optimizing-performance/sampling-query-profiler.md b/docs/en/operations/optimizing-performance/sampling-query-profiler.md\nindex 9244592d515d..72cfa59b8b21 100644\n--- a/docs/en/operations/optimizing-performance/sampling-query-profiler.md\n+++ b/docs/en/operations/optimizing-performance/sampling-query-profiler.md\n@@ -27,7 +27,7 @@ To analyze the `trace_log` system table:\n \n     For security reasons, introspection functions are disabled by default.\n \n--   Use the `addressToLine`, `addressToSymbol` and `demangle` [introspection functions](../../sql-reference/functions/introspection.md) to get function names and their positions in ClickHouse code. To get a profile for some query, you need to aggregate data from the `trace_log` table. You can aggregate data by individual functions or by the whole stack traces.\n+-   Use the `addressToLine`, `addressToLineWithInlines`, `addressToSymbol` and `demangle` [introspection functions](../../sql-reference/functions/introspection.md) to get function names and their positions in ClickHouse code. To get a profile for some query, you need to aggregate data from the `trace_log` table. You can aggregate data by individual functions or by the whole stack traces.\n \n If you need to visualize `trace_log` info, try [flamegraph](../../interfaces/third-party/gui/#clickhouse-flamegraph) and [speedscope](https://github.com/laplab/clickhouse-speedscope).\n \ndiff --git a/docs/en/operations/system-tables/stack_trace.md b/docs/en/operations/system-tables/stack_trace.md\nindex eb1824a6f666..e2135e4beb6d 100644\n--- a/docs/en/operations/system-tables/stack_trace.md\n+++ b/docs/en/operations/system-tables/stack_trace.md\n@@ -2,7 +2,7 @@\n \n Contains stack traces of all server threads. Allows developers to introspect the server state.\n \n-To analyze stack frames, use the `addressToLine`, `addressToSymbol` and `demangle` [introspection functions](../../sql-reference/functions/introspection.md).\n+To analyze stack frames, use the `addressToLine`, `addressToLineWithInlines`, `addressToSymbol` and `demangle` [introspection functions](../../sql-reference/functions/introspection.md).\n \n Columns:\n \ndiff --git a/docs/en/operations/system-tables/trace_log.md b/docs/en/operations/system-tables/trace_log.md\nindex 4902b09004d6..ab08ef7415c8 100644\n--- a/docs/en/operations/system-tables/trace_log.md\n+++ b/docs/en/operations/system-tables/trace_log.md\n@@ -4,7 +4,7 @@ Contains stack traces collected by the sampling query profiler.\n \n ClickHouse creates this table when the [trace_log](../../operations/server-configuration-parameters/settings.md#server_configuration_parameters-trace_log) server configuration section is set. Also the [query_profiler_real_time_period_ns](../../operations/settings/settings.md#query_profiler_real_time_period_ns) and [query_profiler_cpu_time_period_ns](../../operations/settings/settings.md#query_profiler_cpu_time_period_ns) settings should be set.\n \n-To analyze logs, use the `addressToLine`, `addressToSymbol` and `demangle` introspection functions.\n+To analyze logs, use the `addressToLine`, `addressToLineWithInlines`, `addressToSymbol` and `demangle` introspection functions.\n \n Columns:\n \ndiff --git a/docs/en/sql-reference/functions/introspection.md b/docs/en/sql-reference/functions/introspection.md\nindex 21b570c65d4e..1be68c6bdd42 100644\n--- a/docs/en/sql-reference/functions/introspection.md\n+++ b/docs/en/sql-reference/functions/introspection.md\n@@ -113,6 +113,111 @@ trace_source_code_lines: /lib/x86_64-linux-gnu/libpthread-2.27.so\n /build/glibc-OTsEL5/glibc-2.27/misc/../sysdeps/unix/sysv/linux/x86_64/clone.S:97\n ```\n \n+## addressToLineWithInlines {#addresstolinewithinlines}\n+\n+Similar to `addressToLine`, but it will return an Array with all inline functions, and will be much slower as a price.\n+\n+If you use official ClickHouse packages, you need to install the `clickhouse-common-static-dbg` package.\n+\n+**Syntax**\n+\n+``` sql\n+addressToLineWithInlines(address_of_binary_instruction)\n+```\n+\n+**Arguments**\n+\n+-   `address_of_binary_instruction` ([UInt64](../../sql-reference/data-types/int-uint.md)) \u2014 Address of instruction in a running process.\n+\n+**Returned value**\n+\n+-   Array which first element is source code filename and the line number in this file delimited by colon. And from second element, inline functions' source code filename and line number and function name are listed.\n+\n+-   Array with single element which is name of a binary, if the function couldn\u2019t find the debug information.\n+\n+-   Empty array, if the address is not valid.\n+\n+Type: [Array(String)](../../sql-reference/data-types/array.md).\n+\n+**Example**\n+\n+Enabling introspection functions:\n+\n+``` sql\n+SET allow_introspection_functions=1;\n+```\n+\n+Applying the function to address.\n+\n+```sql\n+SELECT addressToLineWithInlines(531055181::UInt64);\n+```\n+\n+``` text\n+\u250c\u2500addressToLineWithInlines(CAST('531055181', 'UInt64'))\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n+\u2502 ['./src/Functions/addressToLineWithInlines.cpp:98','./build_normal_debug/./src/Functions/addressToLineWithInlines.cpp:176:DB::(anonymous namespace)::FunctionAddressToLineWithInlines::implCached(unsigned long) const'] \u2502\n+\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n+```\n+\n+Applying the function to the whole stack trace:\n+\n+``` sql\n+SELECT\n+    ta, addressToLineWithInlines(arrayJoin(trace) as ta)\n+FROM system.trace_log\n+WHERE\n+    query_id = '5e173544-2020-45de-b645-5deebe2aae54';\n+```\n+\n+The [arrayJoin](../../sql-reference/functions/array-functions.md#array-functions-join) functions will split array to rows.\n+\n+``` text\n+\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500ta\u2500\u252c\u2500addressToLineWithInlines(arrayJoin(trace))\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n+\u2502 365497529 \u2502 ['./build_normal_debug/./contrib/libcxx/include/string_view:252']                                                                                                                                                        \u2502\n+\u2502 365593602 \u2502 ['./build_normal_debug/./src/Common/Dwarf.cpp:191']                                                                                                                                                                      \u2502\n+\u2502 365593866 \u2502 ['./build_normal_debug/./src/Common/Dwarf.cpp:0']                                                                                                                                                                        \u2502\n+\u2502 365592528 \u2502 ['./build_normal_debug/./src/Common/Dwarf.cpp:0']                                                                                                                                                                        \u2502\n+\u2502 365591003 \u2502 ['./build_normal_debug/./src/Common/Dwarf.cpp:477']                                                                                                                                                                      \u2502\n+\u2502 365590479 \u2502 ['./build_normal_debug/./src/Common/Dwarf.cpp:442']                                                                                                                                                                      \u2502\n+\u2502 365590600 \u2502 ['./build_normal_debug/./src/Common/Dwarf.cpp:457']                                                                                                                                                                      \u2502\n+\u2502 365598941 \u2502 ['./build_normal_debug/./src/Common/Dwarf.cpp:0']                                                                                                                                                                        \u2502\n+\u2502 365607098 \u2502 ['./build_normal_debug/./src/Common/Dwarf.cpp:0']                                                                                                                                                                        \u2502\n+\u2502 365590571 \u2502 ['./build_normal_debug/./src/Common/Dwarf.cpp:451']                                                                                                                                                                      \u2502\n+\u2502 365598941 \u2502 ['./build_normal_debug/./src/Common/Dwarf.cpp:0']                                                                                                                                                                        \u2502\n+\u2502 365607098 \u2502 ['./build_normal_debug/./src/Common/Dwarf.cpp:0']                                                                                                                                                                        \u2502\n+\u2502 365590571 \u2502 ['./build_normal_debug/./src/Common/Dwarf.cpp:451']                                                                                                                                                                      \u2502\n+\u2502 365598941 \u2502 ['./build_normal_debug/./src/Common/Dwarf.cpp:0']                                                                                                                                                                        \u2502\n+\u2502 365607098 \u2502 ['./build_normal_debug/./src/Common/Dwarf.cpp:0']                                                                                                                                                                        \u2502\n+\u2502 365590571 \u2502 ['./build_normal_debug/./src/Common/Dwarf.cpp:451']                                                                                                                                                                      \u2502\n+\u2502 365598941 \u2502 ['./build_normal_debug/./src/Common/Dwarf.cpp:0']                                                                                                                                                                        \u2502\n+\u2502 365597289 \u2502 ['./build_normal_debug/./src/Common/Dwarf.cpp:807']                                                                                                                                                                      \u2502\n+\u2502 365599840 \u2502 ['./build_normal_debug/./src/Common/Dwarf.cpp:1118']                                                                                                                                                                     \u2502\n+\u2502 531058145 \u2502 ['./build_normal_debug/./src/Functions/addressToLineWithInlines.cpp:152']                                                                                                                                                \u2502\n+\u2502 531055181 \u2502 ['./src/Functions/addressToLineWithInlines.cpp:98','./build_normal_debug/./src/Functions/addressToLineWithInlines.cpp:176:DB::(anonymous namespace)::FunctionAddressToLineWithInlines::implCached(unsigned long) const'] \u2502\n+\u2502 422333613 \u2502 ['./build_normal_debug/./src/Functions/IFunctionAdaptors.h:21']                                                                                                                                                          \u2502\n+\u2502 586866022 \u2502 ['./build_normal_debug/./src/Functions/IFunction.cpp:216']                                                                                                                                                               \u2502\n+\u2502 586869053 \u2502 ['./build_normal_debug/./src/Functions/IFunction.cpp:264']                                                                                                                                                               \u2502\n+\u2502 586873237 \u2502 ['./build_normal_debug/./src/Functions/IFunction.cpp:334']                                                                                                                                                               \u2502\n+\u2502 597901620 \u2502 ['./build_normal_debug/./src/Interpreters/ExpressionActions.cpp:601']                                                                                                                                                    \u2502\n+\u2502 597898534 \u2502 ['./build_normal_debug/./src/Interpreters/ExpressionActions.cpp:718']                                                                                                                                                    \u2502\n+\u2502 630442912 \u2502 ['./build_normal_debug/./src/Processors/Transforms/ExpressionTransform.cpp:23']                                                                                                                                          \u2502\n+\u2502 546354050 \u2502 ['./build_normal_debug/./src/Processors/ISimpleTransform.h:38']                                                                                                                                                          \u2502\n+\u2502 626026993 \u2502 ['./build_normal_debug/./src/Processors/ISimpleTransform.cpp:89']                                                                                                                                                        \u2502\n+\u2502 626294022 \u2502 ['./build_normal_debug/./src/Processors/Executors/ExecutionThreadContext.cpp:45']                                                                                                                                        \u2502\n+\u2502 626293730 \u2502 ['./build_normal_debug/./src/Processors/Executors/ExecutionThreadContext.cpp:63']                                                                                                                                        \u2502\n+\u2502 626169525 \u2502 ['./build_normal_debug/./src/Processors/Executors/PipelineExecutor.cpp:213']                                                                                                                                             \u2502\n+\u2502 626170308 \u2502 ['./build_normal_debug/./src/Processors/Executors/PipelineExecutor.cpp:178']                                                                                                                                             \u2502\n+\u2502 626166348 \u2502 ['./build_normal_debug/./src/Processors/Executors/PipelineExecutor.cpp:329']                                                                                                                                             \u2502\n+\u2502 626163461 \u2502 ['./build_normal_debug/./src/Processors/Executors/PipelineExecutor.cpp:84']                                                                                                                                              \u2502\n+\u2502 626323536 \u2502 ['./build_normal_debug/./src/Processors/Executors/PullingAsyncPipelineExecutor.cpp:85']                                                                                                                                  \u2502\n+\u2502 626323277 \u2502 ['./build_normal_debug/./src/Processors/Executors/PullingAsyncPipelineExecutor.cpp:112']                                                                                                                                 \u2502\n+\u2502 626323133 \u2502 ['./build_normal_debug/./contrib/libcxx/include/type_traits:3682']                                                                                                                                                       \u2502\n+\u2502 626323041 \u2502 ['./build_normal_debug/./contrib/libcxx/include/tuple:1415']                                                                                                                                                             \u2502\n+\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n+\n+```\n+\n+\n ## addressToSymbol {#addresstosymbol}\n \n Converts virtual memory address inside ClickHouse server process to the symbol from ClickHouse object files.\ndiff --git a/docs/en/sql-reference/statements/grant.md b/docs/en/sql-reference/statements/grant.md\nindex 2b1262f7d3c9..1b2b63ba0e79 100644\n--- a/docs/en/sql-reference/statements/grant.md\n+++ b/docs/en/sql-reference/statements/grant.md\n@@ -172,6 +172,7 @@ Hierarchy of privileges:\n         -   `SYSTEM FLUSH LOGS`\n -   [INTROSPECTION](#grant-introspection)\n     -   `addressToLine`\n+    -   `addressToLineWithInlines`\n     -   `addressToSymbol`\n     -   `demangle`\n -   [SOURCES](#grant-sources)\n@@ -430,6 +431,7 @@ Allows using [introspection](../../operations/optimizing-performance/sampling-qu\n \n -   `INTROSPECTION`. Level: `GROUP`. Aliases: `INTROSPECTION FUNCTIONS`\n     -   `addressToLine`. Level: `GLOBAL`\n+    -   `addressToLineWithInlines`. Level: `GLOBAL`\n     -   `addressToSymbol`. Level: `GLOBAL`\n     -   `demangle`. Level: `GLOBAL`\n \ndiff --git a/src/Access/Common/AccessType.h b/src/Access/Common/AccessType.h\nindex 0ccf5e85624e..55b8359d3853 100644\n--- a/src/Access/Common/AccessType.h\n+++ b/src/Access/Common/AccessType.h\n@@ -166,6 +166,7 @@ enum class AccessType\n     M(dictGet, \"dictHas, dictGetHierarchy, dictIsIn\", DICTIONARY, ALL) /* allows to execute functions dictGet(), dictHas(), dictGetHierarchy(), dictIsIn() */\\\n     \\\n     M(addressToLine, \"\", GLOBAL, INTROSPECTION) /* allows to execute function addressToLine() */\\\n+    M(addressToLineWithInlines, \"\", GLOBAL, INTROSPECTION) /* allows to execute function addressToLineWithInlines() */\\\n     M(addressToSymbol, \"\", GLOBAL, INTROSPECTION) /* allows to execute function addressToSymbol() */\\\n     M(demangle, \"\", GLOBAL, INTROSPECTION) /* allows to execute function demangle() */\\\n     M(INTROSPECTION, \"INTROSPECTION FUNCTIONS\", GROUP, ALL) /* allows to execute functions addressToLine(), addressToSymbol(), demangle()*/\\\ndiff --git a/src/Functions/addressToLine.cpp b/src/Functions/addressToLine.cpp\nindex c3e48913e97e..6c9eba160cfd 100644\n--- a/src/Functions/addressToLine.cpp\n+++ b/src/Functions/addressToLine.cpp\n@@ -1,153 +1,58 @@\n #if defined(__ELF__) && !defined(__FreeBSD__)\n \n #include <Common/Dwarf.h>\n-#include <Common/SymbolIndex.h>\n-#include <Common/HashTable/HashMap.h>\n-#include <Common/Arena.h>\n #include <Columns/ColumnString.h>\n-#include <Columns/ColumnsNumber.h>\n #include <DataTypes/DataTypeString.h>\n-#include <Functions/IFunction.h>\n #include <Functions/FunctionFactory.h>\n #include <IO/WriteBufferFromArena.h>\n #include <IO/WriteHelpers.h>\n #include <Access/Common/AccessFlags.h>\n-#include <Interpreters/Context.h>\n \n-#include <mutex>\n-#include <filesystem>\n-#include <unordered_map>\n+#include <Functions/addressToLine.h>\n \n \n namespace DB\n {\n \n-namespace ErrorCodes\n-{\n-    extern const int ILLEGAL_COLUMN;\n-    extern const int ILLEGAL_TYPE_OF_ARGUMENT;\n-    extern const int NUMBER_OF_ARGUMENTS_DOESNT_MATCH;\n-}\n-\n namespace\n {\n \n-class FunctionAddressToLine : public IFunction\n+class FunctionAddressToLine: public FunctionAddressToLineBase<StringRef, Dwarf::LocationInfoMode::FAST>\n {\n public:\n     static constexpr auto name = \"addressToLine\";\n+    String getName() const override { return name; }\n     static FunctionPtr create(ContextPtr context)\n     {\n         context->checkAccess(AccessType::addressToLine);\n         return std::make_shared<FunctionAddressToLine>();\n     }\n-\n-    String getName() const override\n-    {\n-        return name;\n-    }\n-\n-    size_t getNumberOfArguments() const override\n-    {\n-        return 1;\n-    }\n-\n-    bool isSuitableForShortCircuitArgumentsExecution(const DataTypesWithConstInfo & /*arguments*/) const override { return true; }\n-\n-    DataTypePtr getReturnTypeImpl(const ColumnsWithTypeAndName & arguments) const override\n+protected:\n+    DataTypePtr getDataType() const override\n     {\n-        if (arguments.size() != 1)\n-            throw Exception(\"Function \" + getName() + \" needs exactly one argument; passed \"\n-                + toString(arguments.size()) + \".\", ErrorCodes::NUMBER_OF_ARGUMENTS_DOESNT_MATCH);\n-\n-        const auto & type = arguments[0].type;\n-\n-        if (!WhichDataType(type.get()).isUInt64())\n-            throw Exception(\"The only argument for function \" + getName() + \" must be UInt64. Found \"\n-                + type->getName() + \" instead.\", ErrorCodes::ILLEGAL_TYPE_OF_ARGUMENT);\n-\n         return std::make_shared<DataTypeString>();\n     }\n-\n-    bool useDefaultImplementationForConstants() const override\n-    {\n-        return true;\n-    }\n-\n-    ColumnPtr executeImpl(const ColumnsWithTypeAndName & arguments, const DataTypePtr &, size_t input_rows_count) const override\n+    ColumnPtr getResultColumn(const typename ColumnVector<UInt64>::Container & data, size_t input_rows_count) const override\n     {\n-        const ColumnPtr & column = arguments[0].column;\n-        const ColumnUInt64 * column_concrete = checkAndGetColumn<ColumnUInt64>(column.get());\n-\n-        if (!column_concrete)\n-            throw Exception(\"Illegal column \" + column->getName() + \" of argument of function \" + getName(), ErrorCodes::ILLEGAL_COLUMN);\n-\n-        const typename ColumnVector<UInt64>::Container & data = column_concrete->getData();\n         auto result_column = ColumnString::create();\n-\n         for (size_t i = 0; i < input_rows_count; ++i)\n         {\n             StringRef res_str = implCached(data[i]);\n             result_column->insertData(res_str.data, res_str.size);\n         }\n-\n         return result_column;\n     }\n \n-private:\n-    struct Cache\n-    {\n-        std::mutex mutex;\n-        Arena arena;\n-        using Map = HashMap<uintptr_t, StringRef>;\n-        Map map;\n-        std::unordered_map<std::string, Dwarf> dwarfs;\n-    };\n-\n-    mutable Cache cache;\n-\n-    StringRef impl(uintptr_t addr) const\n+    void setResult(StringRef & result, const Dwarf::LocationInfo & location, const std::vector<Dwarf::SymbolizedFrame> &) const override\n     {\n-        auto symbol_index_ptr = SymbolIndex::instance();\n-        const SymbolIndex & symbol_index = *symbol_index_ptr;\n-\n-        if (const auto * object = symbol_index.findObject(reinterpret_cast<const void *>(addr)))\n-        {\n-            auto dwarf_it = cache.dwarfs.try_emplace(object->name, object->elf).first;\n-            if (!std::filesystem::exists(object->name))\n-                return {};\n-\n-            Dwarf::LocationInfo location;\n-            std::vector<Dwarf::SymbolizedFrame> frames;  // NOTE: not used in FAST mode.\n-            if (dwarf_it->second.findAddress(addr - uintptr_t(object->address_begin), location, Dwarf::LocationInfoMode::FAST, frames))\n-            {\n-                const char * arena_begin = nullptr;\n-                WriteBufferFromArena out(cache.arena, arena_begin);\n+        const char * arena_begin = nullptr;\n+        WriteBufferFromArena out(cache.arena, arena_begin);\n \n-                writeString(location.file.toString(), out);\n-                writeChar(':', out);\n-                writeIntText(location.line, out);\n+        writeString(location.file.toString(), out);\n+        writeChar(':', out);\n+        writeIntText(location.line, out);\n \n-                return out.complete();\n-            }\n-            else\n-            {\n-                return object->name;\n-            }\n-        }\n-        else\n-            return {};\n-    }\n-\n-    StringRef implCached(uintptr_t addr) const\n-    {\n-        Cache::Map::LookupResult it;\n-        bool inserted;\n-        std::lock_guard lock(cache.mutex);\n-        cache.map.emplace(addr, it, inserted);\n-        if (inserted)\n-            it->getMapped() = impl(addr);\n-        return it->getMapped();\n+        result = out.complete();\n     }\n };\n \ndiff --git a/src/Functions/addressToLine.h b/src/Functions/addressToLine.h\nnew file mode 100644\nindex 000000000000..8216f114b2ee\n--- /dev/null\n+++ b/src/Functions/addressToLine.h\n@@ -0,0 +1,133 @@\n+#pragma once\n+#if defined(__ELF__) && !defined(__FreeBSD__)\n+\n+#include <Common/Dwarf.h>\n+#include <Common/SymbolIndex.h>\n+#include <Common/HashTable/HashMap.h>\n+#include <Common/Arena.h>\n+#include <Columns/ColumnString.h>\n+#include <Columns/ColumnArray.h>\n+#include <Columns/ColumnsNumber.h>\n+#include <DataTypes/DataTypeString.h>\n+#include <DataTypes/DataTypeArray.h>\n+#include <Functions/IFunction.h>\n+#include <Functions/FunctionFactory.h>\n+#include <IO/WriteBufferFromArena.h>\n+#include <IO/WriteHelpers.h>\n+#include <Access/Common/AccessFlags.h>\n+#include <Interpreters/Context.h>\n+\n+#include <mutex>\n+#include <filesystem>\n+#include <unordered_map>\n+\n+\n+namespace DB\n+{\n+\n+namespace ErrorCodes\n+{\n+    extern const int ILLEGAL_COLUMN;\n+    extern const int ILLEGAL_TYPE_OF_ARGUMENT;\n+    extern const int NUMBER_OF_ARGUMENTS_DOESNT_MATCH;\n+}\n+\n+template <typename ResultT, Dwarf::LocationInfoMode locationInfoMode>\n+class FunctionAddressToLineBase : public IFunction\n+{\n+public:\n+\n+    size_t getNumberOfArguments() const override { return 1; }\n+\n+    bool isSuitableForShortCircuitArgumentsExecution(const DataTypesWithConstInfo & /*arguments*/) const override { return true; }\n+\n+    DataTypePtr getReturnTypeImpl(const ColumnsWithTypeAndName & arguments) const override\n+    {\n+        if (arguments.size() != 1)\n+            throw Exception(\n+                \"Function \" + getName() + \" needs exactly one argument; passed \" + toString(arguments.size()) + \".\",\n+                ErrorCodes::NUMBER_OF_ARGUMENTS_DOESNT_MATCH);\n+\n+        const auto & type = arguments[0].type;\n+\n+        if (!WhichDataType(type.get()).isUInt64())\n+            throw Exception(\n+                \"The only argument for function \" + getName() + \" must be UInt64. Found \" + type->getName() + \" instead.\",\n+                ErrorCodes::ILLEGAL_TYPE_OF_ARGUMENT);\n+\n+        return getDataType();\n+    }\n+\n+    bool useDefaultImplementationForConstants() const override { return true; }\n+\n+    ColumnPtr executeImpl(const ColumnsWithTypeAndName & arguments, const DataTypePtr &, size_t input_rows_count) const override\n+    {\n+        const ColumnPtr & column = arguments[0].column;\n+        const ColumnUInt64 * column_concrete = checkAndGetColumn<ColumnUInt64>(column.get());\n+\n+        if (!column_concrete)\n+            throw Exception(\n+                \"Illegal column \" + column->getName() + \" of argument of function \" + getName(), ErrorCodes::ILLEGAL_COLUMN);\n+\n+        const typename ColumnVector<UInt64>::Container & data = column_concrete->getData();\n+        return getResultColumn(data, input_rows_count);\n+    }\n+\n+protected:\n+    virtual DataTypePtr getDataType() const = 0;\n+    virtual ColumnPtr getResultColumn(const typename ColumnVector<UInt64>::Container & data, size_t input_rows_count) const = 0;\n+    virtual void\n+    setResult(ResultT & result, const Dwarf::LocationInfo & location, const std::vector<Dwarf::SymbolizedFrame> & frames) const = 0;\n+\n+    struct Cache\n+    {\n+        std::mutex mutex;\n+        Arena arena;\n+        using Map = HashMap<uintptr_t, ResultT>;\n+        Map map;\n+        std::unordered_map<std::string, Dwarf> dwarfs;\n+    };\n+\n+    mutable Cache cache;\n+\n+    ResultT impl(uintptr_t addr) const\n+    {\n+        auto symbol_index_ptr = SymbolIndex::instance();\n+        const SymbolIndex & symbol_index = *symbol_index_ptr;\n+\n+        if (const auto * object = symbol_index.findObject(reinterpret_cast<const void *>(addr)))\n+        {\n+            auto dwarf_it = cache.dwarfs.try_emplace(object->name, object->elf).first;\n+            if (!std::filesystem::exists(object->name))\n+                return {};\n+\n+            Dwarf::LocationInfo location;\n+            std::vector<Dwarf::SymbolizedFrame> frames; // NOTE: not used in FAST mode.\n+            ResultT result;\n+            if (dwarf_it->second.findAddress(addr - uintptr_t(object->address_begin), location, locationInfoMode, frames))\n+            {\n+                setResult(result, location, frames);\n+                return result;\n+            }\n+            else\n+                return {object->name};\n+        }\n+        else\n+            return {};\n+    }\n+\n+    ResultT implCached(uintptr_t addr) const\n+    {\n+        typename Cache::Map::LookupResult it;\n+        bool inserted;\n+        std::lock_guard lock(cache.mutex);\n+        cache.map.emplace(addr, it, inserted);\n+        if (inserted)\n+            it->getMapped() = impl(addr);\n+        return it->getMapped();\n+    }\n+};\n+\n+}\n+\n+#endif\ndiff --git a/src/Functions/addressToLineWithInlines.cpp b/src/Functions/addressToLineWithInlines.cpp\nnew file mode 100644\nindex 000000000000..c3e62bd802eb\n--- /dev/null\n+++ b/src/Functions/addressToLineWithInlines.cpp\n@@ -0,0 +1,99 @@\n+#if defined(__ELF__) && !defined(__FreeBSD__)\n+\n+#include <Common/Dwarf.h>\n+#include <Columns/ColumnString.h>\n+#include <Columns/ColumnArray.h>\n+#include <DataTypes/DataTypeString.h>\n+#include <DataTypes/DataTypeArray.h>\n+#include <Functions/FunctionFactory.h>\n+#include <IO/WriteBufferFromArena.h>\n+#include <IO/WriteHelpers.h>\n+#include <Access/Common/AccessFlags.h>\n+\n+#include <Functions/addressToLine.h>\n+#include <vector>\n+\n+\n+namespace DB\n+{\n+\n+namespace\n+{\n+\n+class FunctionAddressToLineWithInlines: public FunctionAddressToLineBase<StringRefs, Dwarf::LocationInfoMode::FULL_WITH_INLINE>\n+{\n+public:\n+    static constexpr auto name = \"addressToLineWithInlines\";\n+    String getName() const override { return name; }\n+    static FunctionPtr create(ContextPtr context)\n+    {\n+        context->checkAccess(AccessType::addressToLineWithInlines);\n+        return std::make_shared<FunctionAddressToLineWithInlines>();\n+    }\n+\n+protected:\n+    DataTypePtr getDataType() const override\n+    {\n+        return std::make_shared<DataTypeArray>(std::make_shared<DataTypeString>());\n+    }\n+\n+    ColumnPtr getResultColumn(const typename ColumnVector<UInt64>::Container & data, size_t input_rows_count) const override\n+    {\n+        auto result_column = ColumnArray::create(ColumnString::create());\n+        ColumnString & result_strings = typeid_cast<ColumnString &>(result_column->getData());\n+        ColumnArray::Offsets & result_offsets = result_column->getOffsets();\n+\n+        ColumnArray::Offset current_offset = 0;\n+\n+        for (size_t i = 0; i < input_rows_count; ++i)\n+        {\n+            StringRefs res = implCached(data[i]);\n+            for (auto & r : res)\n+                result_strings.insertData(r.data, r.size);\n+            current_offset += res.size();\n+            result_offsets.push_back(current_offset);\n+        }\n+\n+        return result_column;\n+    }\n+\n+    void setResult(StringRefs & result, const Dwarf::LocationInfo & location, const std::vector<Dwarf::SymbolizedFrame> & inline_frames) const override\n+    {\n+\n+        appendLocationToResult(result, location, nullptr);\n+        for (const auto & inline_frame : inline_frames)\n+            appendLocationToResult(result, inline_frame.location, &inline_frame);\n+    }\n+private:\n+\n+    inline ALWAYS_INLINE void appendLocationToResult(StringRefs & result, const Dwarf::LocationInfo & location, const Dwarf::SymbolizedFrame * frame) const\n+    {\n+        const char * arena_begin = nullptr;\n+        WriteBufferFromArena out(cache.arena, arena_begin);\n+\n+        writeString(location.file.toString(), out);\n+        writeChar(':', out);\n+        writeIntText(location.line, out);\n+\n+        if (frame)\n+        {\n+            writeChar(':', out);\n+            int status = 0;\n+            writeString(demangle(frame->name, status), out);\n+        }\n+\n+        result.emplace_back(out.complete());\n+    }\n+\n+};\n+\n+}\n+\n+void registerFunctionAddressToLineWithInlines(FunctionFactory & factory)\n+{\n+    factory.registerFunction<FunctionAddressToLineWithInlines>();\n+}\n+\n+}\n+\n+#endif\ndiff --git a/src/Functions/registerFunctionsIntrospection.cpp b/src/Functions/registerFunctionsIntrospection.cpp\nindex fe76c96d62da..76a92847d8e2 100644\n--- a/src/Functions/registerFunctionsIntrospection.cpp\n+++ b/src/Functions/registerFunctionsIntrospection.cpp\n@@ -6,6 +6,7 @@ class FunctionFactory;\n #if defined(OS_LINUX)\n void registerFunctionAddressToSymbol(FunctionFactory & factory);\n void registerFunctionAddressToLine(FunctionFactory & factory);\n+void registerFunctionAddressToLineWithInlines(FunctionFactory & factory);\n #endif\n \n void registerFunctionDemangle(FunctionFactory & factory);\n@@ -17,6 +18,7 @@ void registerFunctionsIntrospection(FunctionFactory & factory)\n #if defined(OS_LINUX)\n     registerFunctionAddressToSymbol(factory);\n     registerFunctionAddressToLine(factory);\n+    registerFunctionAddressToLineWithInlines(factory);\n #endif\n     registerFunctionDemangle(factory);\n     registerFunctionTrap(factory);\n",
  "test_patch": "diff --git a/tests/queries/0_stateless/01271_show_privileges.reference b/tests/queries/0_stateless/01271_show_privileges.reference\nindex 86ba859fb0e8..c18992583cd1 100644\n--- a/tests/queries/0_stateless/01271_show_privileges.reference\n+++ b/tests/queries/0_stateless/01271_show_privileges.reference\n@@ -118,6 +118,7 @@ SYSTEM THREAD FUZZER\t['SYSTEM START THREAD FUZZER','SYSTEM STOP THREAD FUZZER','\n SYSTEM\t[]\t\\N\tALL\n dictGet\t['dictHas','dictGetHierarchy','dictIsIn']\tDICTIONARY\tALL\n addressToLine\t[]\tGLOBAL\tINTROSPECTION\n+addressToLineWithInlines\t[]\tGLOBAL\tINTROSPECTION\n addressToSymbol\t[]\tGLOBAL\tINTROSPECTION\n demangle\t[]\tGLOBAL\tINTROSPECTION\n INTROSPECTION\t['INTROSPECTION FUNCTIONS']\t\\N\tALL\ndiff --git a/tests/queries/0_stateless/02117_show_create_table_system.reference b/tests/queries/0_stateless/02117_show_create_table_system.reference\nindex 2be7f65e227d..82faf3b21edf 100644\n--- a/tests/queries/0_stateless/02117_show_create_table_system.reference\n+++ b/tests/queries/0_stateless/02117_show_create_table_system.reference\n@@ -20,7 +20,7 @@ CREATE TABLE system.errors\\n(\\n    `name` String,\\n    `code` Int32,\\n    `value\n CREATE TABLE system.events\\n(\\n    `event` String,\\n    `value` UInt64,\\n    `description` String\\n)\\nENGINE = SystemEvents()\\nCOMMENT \\'SYSTEM TABLE is built on the fly.\\'\n CREATE TABLE system.formats\\n(\\n    `name` String,\\n    `is_input` UInt8,\\n    `is_output` UInt8\\n)\\nENGINE = SystemFormats()\\nCOMMENT \\'SYSTEM TABLE is built on the fly.\\'\n CREATE TABLE system.functions\\n(\\n    `name` String,\\n    `is_aggregate` UInt8,\\n    `case_insensitive` UInt8,\\n    `alias_to` String,\\n    `create_query` String,\\n    `origin` Enum8(\\'System\\' = 0, \\'SQLUserDefined\\' = 1, \\'ExecutableUserDefined\\' = 2)\\n)\\nENGINE = SystemFunctions()\\nCOMMENT \\'SYSTEM TABLE is built on the fly.\\'\n-CREATE TABLE system.grants\\n(\\n    `user_name` Nullable(String),\\n    `role_name` Nullable(String),\\n    `access_type` Enum16(\\'SHOW DATABASES\\' = 0, \\'SHOW TABLES\\' = 1, \\'SHOW COLUMNS\\' = 2, \\'SHOW DICTIONARIES\\' = 3, \\'SHOW\\' = 4, \\'SELECT\\' = 5, \\'INSERT\\' = 6, \\'ALTER UPDATE\\' = 7, \\'ALTER DELETE\\' = 8, \\'ALTER ADD COLUMN\\' = 9, \\'ALTER MODIFY COLUMN\\' = 10, \\'ALTER DROP COLUMN\\' = 11, \\'ALTER COMMENT COLUMN\\' = 12, \\'ALTER CLEAR COLUMN\\' = 13, \\'ALTER RENAME COLUMN\\' = 14, \\'ALTER MATERIALIZE COLUMN\\' = 15, \\'ALTER COLUMN\\' = 16, \\'ALTER MODIFY COMMENT\\' = 17, \\'ALTER ORDER BY\\' = 18, \\'ALTER SAMPLE BY\\' = 19, \\'ALTER ADD INDEX\\' = 20, \\'ALTER DROP INDEX\\' = 21, \\'ALTER MATERIALIZE INDEX\\' = 22, \\'ALTER CLEAR INDEX\\' = 23, \\'ALTER INDEX\\' = 24, \\'ALTER ADD PROJECTION\\' = 25, \\'ALTER DROP PROJECTION\\' = 26, \\'ALTER MATERIALIZE PROJECTION\\' = 27, \\'ALTER CLEAR PROJECTION\\' = 28, \\'ALTER PROJECTION\\' = 29, \\'ALTER ADD CONSTRAINT\\' = 30, \\'ALTER DROP CONSTRAINT\\' = 31, \\'ALTER CONSTRAINT\\' = 32, \\'ALTER TTL\\' = 33, \\'ALTER MATERIALIZE TTL\\' = 34, \\'ALTER SETTINGS\\' = 35, \\'ALTER MOVE PARTITION\\' = 36, \\'ALTER FETCH PARTITION\\' = 37, \\'ALTER FREEZE PARTITION\\' = 38, \\'ALTER DATABASE SETTINGS\\' = 39, \\'ALTER TABLE\\' = 40, \\'ALTER DATABASE\\' = 41, \\'ALTER VIEW REFRESH\\' = 42, \\'ALTER VIEW MODIFY QUERY\\' = 43, \\'ALTER VIEW\\' = 44, \\'ALTER\\' = 45, \\'CREATE DATABASE\\' = 46, \\'CREATE TABLE\\' = 47, \\'CREATE VIEW\\' = 48, \\'CREATE DICTIONARY\\' = 49, \\'CREATE TEMPORARY TABLE\\' = 50, \\'CREATE FUNCTION\\' = 51, \\'CREATE\\' = 52, \\'DROP DATABASE\\' = 53, \\'DROP TABLE\\' = 54, \\'DROP VIEW\\' = 55, \\'DROP DICTIONARY\\' = 56, \\'DROP FUNCTION\\' = 57, \\'DROP\\' = 58, \\'TRUNCATE\\' = 59, \\'OPTIMIZE\\' = 60, \\'KILL QUERY\\' = 61, \\'MOVE PARTITION BETWEEN SHARDS\\' = 62, \\'CREATE USER\\' = 63, \\'ALTER USER\\' = 64, \\'DROP USER\\' = 65, \\'CREATE ROLE\\' = 66, \\'ALTER ROLE\\' = 67, \\'DROP ROLE\\' = 68, \\'ROLE ADMIN\\' = 69, \\'CREATE ROW POLICY\\' = 70, \\'ALTER ROW POLICY\\' = 71, \\'DROP ROW POLICY\\' = 72, \\'CREATE QUOTA\\' = 73, \\'ALTER QUOTA\\' = 74, \\'DROP QUOTA\\' = 75, \\'CREATE SETTINGS PROFILE\\' = 76, \\'ALTER SETTINGS PROFILE\\' = 77, \\'DROP SETTINGS PROFILE\\' = 78, \\'SHOW USERS\\' = 79, \\'SHOW ROLES\\' = 80, \\'SHOW ROW POLICIES\\' = 81, \\'SHOW QUOTAS\\' = 82, \\'SHOW SETTINGS PROFILES\\' = 83, \\'SHOW ACCESS\\' = 84, \\'ACCESS MANAGEMENT\\' = 85, \\'SYSTEM SHUTDOWN\\' = 86, \\'SYSTEM DROP DNS CACHE\\' = 87, \\'SYSTEM DROP MARK CACHE\\' = 88, \\'SYSTEM DROP UNCOMPRESSED CACHE\\' = 89, \\'SYSTEM DROP MMAP CACHE\\' = 90, \\'SYSTEM DROP COMPILED EXPRESSION CACHE\\' = 91, \\'SYSTEM DROP CACHE\\' = 92, \\'SYSTEM RELOAD CONFIG\\' = 93, \\'SYSTEM RELOAD SYMBOLS\\' = 94, \\'SYSTEM RELOAD DICTIONARY\\' = 95, \\'SYSTEM RELOAD MODEL\\' = 96, \\'SYSTEM RELOAD FUNCTION\\' = 97, \\'SYSTEM RELOAD EMBEDDED DICTIONARIES\\' = 98, \\'SYSTEM RELOAD\\' = 99, \\'SYSTEM RESTART DISK\\' = 100, \\'SYSTEM MERGES\\' = 101, \\'SYSTEM TTL MERGES\\' = 102, \\'SYSTEM FETCHES\\' = 103, \\'SYSTEM MOVES\\' = 104, \\'SYSTEM DISTRIBUTED SENDS\\' = 105, \\'SYSTEM REPLICATED SENDS\\' = 106, \\'SYSTEM SENDS\\' = 107, \\'SYSTEM REPLICATION QUEUES\\' = 108, \\'SYSTEM DROP REPLICA\\' = 109, \\'SYSTEM SYNC REPLICA\\' = 110, \\'SYSTEM RESTART REPLICA\\' = 111, \\'SYSTEM RESTORE REPLICA\\' = 112, \\'SYSTEM FLUSH DISTRIBUTED\\' = 113, \\'SYSTEM FLUSH LOGS\\' = 114, \\'SYSTEM FLUSH\\' = 115, \\'SYSTEM THREAD FUZZER\\' = 116, \\'SYSTEM\\' = 117, \\'dictGet\\' = 118, \\'addressToLine\\' = 119, \\'addressToSymbol\\' = 120, \\'demangle\\' = 121, \\'INTROSPECTION\\' = 122, \\'FILE\\' = 123, \\'URL\\' = 124, \\'REMOTE\\' = 125, \\'MONGO\\' = 126, \\'MYSQL\\' = 127, \\'POSTGRES\\' = 128, \\'SQLITE\\' = 129, \\'ODBC\\' = 130, \\'JDBC\\' = 131, \\'HDFS\\' = 132, \\'S3\\' = 133, \\'SOURCES\\' = 134, \\'ALL\\' = 135, \\'NONE\\' = 136),\\n    `database` Nullable(String),\\n    `table` Nullable(String),\\n    `column` Nullable(String),\\n    `is_partial_revoke` UInt8,\\n    `grant_option` UInt8\\n)\\nENGINE = SystemGrants()\\nCOMMENT \\'SYSTEM TABLE is built on the fly.\\'\n+CREATE TABLE system.grants\\n(\\n    `user_name` Nullable(String),\\n    `role_name` Nullable(String),\\n    `access_type` Enum16(\\'SHOW DATABASES\\' = 0, \\'SHOW TABLES\\' = 1, \\'SHOW COLUMNS\\' = 2, \\'SHOW DICTIONARIES\\' = 3, \\'SHOW\\' = 4, \\'SELECT\\' = 5, \\'INSERT\\' = 6, \\'ALTER UPDATE\\' = 7, \\'ALTER DELETE\\' = 8, \\'ALTER ADD COLUMN\\' = 9, \\'ALTER MODIFY COLUMN\\' = 10, \\'ALTER DROP COLUMN\\' = 11, \\'ALTER COMMENT COLUMN\\' = 12, \\'ALTER CLEAR COLUMN\\' = 13, \\'ALTER RENAME COLUMN\\' = 14, \\'ALTER MATERIALIZE COLUMN\\' = 15, \\'ALTER COLUMN\\' = 16, \\'ALTER MODIFY COMMENT\\' = 17, \\'ALTER ORDER BY\\' = 18, \\'ALTER SAMPLE BY\\' = 19, \\'ALTER ADD INDEX\\' = 20, \\'ALTER DROP INDEX\\' = 21, \\'ALTER MATERIALIZE INDEX\\' = 22, \\'ALTER CLEAR INDEX\\' = 23, \\'ALTER INDEX\\' = 24, \\'ALTER ADD PROJECTION\\' = 25, \\'ALTER DROP PROJECTION\\' = 26, \\'ALTER MATERIALIZE PROJECTION\\' = 27, \\'ALTER CLEAR PROJECTION\\' = 28, \\'ALTER PROJECTION\\' = 29, \\'ALTER ADD CONSTRAINT\\' = 30, \\'ALTER DROP CONSTRAINT\\' = 31, \\'ALTER CONSTRAINT\\' = 32, \\'ALTER TTL\\' = 33, \\'ALTER MATERIALIZE TTL\\' = 34, \\'ALTER SETTINGS\\' = 35, \\'ALTER MOVE PARTITION\\' = 36, \\'ALTER FETCH PARTITION\\' = 37, \\'ALTER FREEZE PARTITION\\' = 38, \\'ALTER DATABASE SETTINGS\\' = 39, \\'ALTER TABLE\\' = 40, \\'ALTER DATABASE\\' = 41, \\'ALTER VIEW REFRESH\\' = 42, \\'ALTER VIEW MODIFY QUERY\\' = 43, \\'ALTER VIEW\\' = 44, \\'ALTER\\' = 45, \\'CREATE DATABASE\\' = 46, \\'CREATE TABLE\\' = 47, \\'CREATE VIEW\\' = 48, \\'CREATE DICTIONARY\\' = 49, \\'CREATE TEMPORARY TABLE\\' = 50, \\'CREATE FUNCTION\\' = 51, \\'CREATE\\' = 52, \\'DROP DATABASE\\' = 53, \\'DROP TABLE\\' = 54, \\'DROP VIEW\\' = 55, \\'DROP DICTIONARY\\' = 56, \\'DROP FUNCTION\\' = 57, \\'DROP\\' = 58, \\'TRUNCATE\\' = 59, \\'OPTIMIZE\\' = 60, \\'KILL QUERY\\' = 61, \\'MOVE PARTITION BETWEEN SHARDS\\' = 62, \\'CREATE USER\\' = 63, \\'ALTER USER\\' = 64, \\'DROP USER\\' = 65, \\'CREATE ROLE\\' = 66, \\'ALTER ROLE\\' = 67, \\'DROP ROLE\\' = 68, \\'ROLE ADMIN\\' = 69, \\'CREATE ROW POLICY\\' = 70, \\'ALTER ROW POLICY\\' = 71, \\'DROP ROW POLICY\\' = 72, \\'CREATE QUOTA\\' = 73, \\'ALTER QUOTA\\' = 74, \\'DROP QUOTA\\' = 75, \\'CREATE SETTINGS PROFILE\\' = 76, \\'ALTER SETTINGS PROFILE\\' = 77, \\'DROP SETTINGS PROFILE\\' = 78, \\'SHOW USERS\\' = 79, \\'SHOW ROLES\\' = 80, \\'SHOW ROW POLICIES\\' = 81, \\'SHOW QUOTAS\\' = 82, \\'SHOW SETTINGS PROFILES\\' = 83, \\'SHOW ACCESS\\' = 84, \\'ACCESS MANAGEMENT\\' = 85, \\'SYSTEM SHUTDOWN\\' = 86, \\'SYSTEM DROP DNS CACHE\\' = 87, \\'SYSTEM DROP MARK CACHE\\' = 88, \\'SYSTEM DROP UNCOMPRESSED CACHE\\' = 89, \\'SYSTEM DROP MMAP CACHE\\' = 90, \\'SYSTEM DROP COMPILED EXPRESSION CACHE\\' = 91, \\'SYSTEM DROP CACHE\\' = 92, \\'SYSTEM RELOAD CONFIG\\' = 93, \\'SYSTEM RELOAD SYMBOLS\\' = 94, \\'SYSTEM RELOAD DICTIONARY\\' = 95, \\'SYSTEM RELOAD MODEL\\' = 96, \\'SYSTEM RELOAD FUNCTION\\' = 97, \\'SYSTEM RELOAD EMBEDDED DICTIONARIES\\' = 98, \\'SYSTEM RELOAD\\' = 99, \\'SYSTEM RESTART DISK\\' = 100, \\'SYSTEM MERGES\\' = 101, \\'SYSTEM TTL MERGES\\' = 102, \\'SYSTEM FETCHES\\' = 103, \\'SYSTEM MOVES\\' = 104, \\'SYSTEM DISTRIBUTED SENDS\\' = 105, \\'SYSTEM REPLICATED SENDS\\' = 106, \\'SYSTEM SENDS\\' = 107, \\'SYSTEM REPLICATION QUEUES\\' = 108, \\'SYSTEM DROP REPLICA\\' = 109, \\'SYSTEM SYNC REPLICA\\' = 110, \\'SYSTEM RESTART REPLICA\\' = 111, \\'SYSTEM RESTORE REPLICA\\' = 112, \\'SYSTEM FLUSH DISTRIBUTED\\' = 113, \\'SYSTEM FLUSH LOGS\\' = 114, \\'SYSTEM FLUSH\\' = 115, \\'SYSTEM THREAD FUZZER\\' = 116, \\'SYSTEM\\' = 117, \\'dictGet\\' = 118, \\'addressToLine\\' = 119, \\'addressToLineWithInlines\\' = 120, \\'addressToSymbol\\' = 121, \\'demangle\\' = 122, \\'INTROSPECTION\\' = 123, \\'FILE\\' = 124, \\'URL\\' = 125, \\'REMOTE\\' = 126, \\'MONGO\\' = 127, \\'MYSQL\\' = 128, \\'POSTGRES\\' = 129, \\'SQLITE\\' = 130, \\'ODBC\\' = 131, \\'JDBC\\' = 132, \\'HDFS\\' = 133, \\'S3\\' = 134, \\'SOURCES\\' = 135, \\'ALL\\' = 136, \\'NONE\\' = 137),\\n    `database` Nullable(String),\\n    `table` Nullable(String),\\n    `column` Nullable(String),\\n    `is_partial_revoke` UInt8,\\n    `grant_option` UInt8\\n)\\nENGINE = SystemGrants()\\nCOMMENT \\'SYSTEM TABLE is built on the fly.\\'\n CREATE TABLE system.graphite_retentions\\n(\\n    `config_name` String,\\n    `rule_type` String,\\n    `regexp` String,\\n    `function` String,\\n    `age` UInt64,\\n    `precision` UInt64,\\n    `priority` UInt16,\\n    `is_default` UInt8,\\n    `Tables.database` Array(String),\\n    `Tables.table` Array(String)\\n)\\nENGINE = SystemGraphite()\\nCOMMENT \\'SYSTEM TABLE is built on the fly.\\'\n CREATE TABLE system.licenses\\n(\\n    `library_name` String,\\n    `license_type` String,\\n    `license_path` String,\\n    `license_text` String\\n)\\nENGINE = SystemLicenses()\\nCOMMENT \\'SYSTEM TABLE is built on the fly.\\'\n CREATE TABLE system.macros\\n(\\n    `macro` String,\\n    `substitution` String\\n)\\nENGINE = SystemMacros()\\nCOMMENT \\'SYSTEM TABLE is built on the fly.\\'\n@@ -35,7 +35,7 @@ CREATE TABLE system.one\\n(\\n    `dummy` UInt8\\n)\\nENGINE = SystemOne()\\nCOMMENT\n CREATE TABLE system.part_moves_between_shards\\n(\\n    `database` String,\\n    `table` String,\\n    `task_name` String,\\n    `task_uuid` UUID,\\n    `create_time` DateTime,\\n    `part_name` String,\\n    `part_uuid` UUID,\\n    `to_shard` String,\\n    `dst_part_name` String,\\n    `update_time` DateTime,\\n    `state` String,\\n    `rollback` UInt8,\\n    `num_tries` UInt32,\\n    `last_exception` String\\n)\\nENGINE = SystemShardMoves()\\nCOMMENT \\'SYSTEM TABLE is built on the fly.\\'\n CREATE TABLE system.parts\\n(\\n    `partition` String,\\n    `name` String,\\n    `uuid` UUID,\\n    `part_type` String,\\n    `active` UInt8,\\n    `marks` UInt64,\\n    `rows` UInt64,\\n    `bytes_on_disk` UInt64,\\n    `data_compressed_bytes` UInt64,\\n    `data_uncompressed_bytes` UInt64,\\n    `marks_bytes` UInt64,\\n    `secondary_indices_compressed_bytes` UInt64,\\n    `secondary_indices_uncompressed_bytes` UInt64,\\n    `secondary_indices_marks_bytes` UInt64,\\n    `modification_time` DateTime,\\n    `remove_time` DateTime,\\n    `refcount` UInt32,\\n    `min_date` Date,\\n    `max_date` Date,\\n    `min_time` DateTime,\\n    `max_time` DateTime,\\n    `partition_id` String,\\n    `min_block_number` Int64,\\n    `max_block_number` Int64,\\n    `level` UInt32,\\n    `data_version` UInt64,\\n    `primary_key_bytes_in_memory` UInt64,\\n    `primary_key_bytes_in_memory_allocated` UInt64,\\n    `is_frozen` UInt8,\\n    `database` String,\\n    `table` String,\\n    `engine` String,\\n    `disk_name` String,\\n    `path` String,\\n    `hash_of_all_files` String,\\n    `hash_of_uncompressed_files` String,\\n    `uncompressed_hash_of_compressed_files` String,\\n    `delete_ttl_info_min` DateTime,\\n    `delete_ttl_info_max` DateTime,\\n    `move_ttl_info.expression` Array(String),\\n    `move_ttl_info.min` Array(DateTime),\\n    `move_ttl_info.max` Array(DateTime),\\n    `default_compression_codec` String,\\n    `recompression_ttl_info.expression` Array(String),\\n    `recompression_ttl_info.min` Array(DateTime),\\n    `recompression_ttl_info.max` Array(DateTime),\\n    `group_by_ttl_info.expression` Array(String),\\n    `group_by_ttl_info.min` Array(DateTime),\\n    `group_by_ttl_info.max` Array(DateTime),\\n    `rows_where_ttl_info.expression` Array(String),\\n    `rows_where_ttl_info.min` Array(DateTime),\\n    `rows_where_ttl_info.max` Array(DateTime),\\n    `projections` Array(String),\\n    `bytes` UInt64,\\n    `marks_size` UInt64\\n)\\nENGINE = SystemParts()\\nCOMMENT \\'SYSTEM TABLE is built on the fly.\\'\n CREATE TABLE system.parts_columns\\n(\\n    `partition` String,\\n    `name` String,\\n    `uuid` UUID,\\n    `part_type` String,\\n    `active` UInt8,\\n    `marks` UInt64,\\n    `rows` UInt64,\\n    `bytes_on_disk` UInt64,\\n    `data_compressed_bytes` UInt64,\\n    `data_uncompressed_bytes` UInt64,\\n    `marks_bytes` UInt64,\\n    `modification_time` DateTime,\\n    `remove_time` DateTime,\\n    `refcount` UInt32,\\n    `min_date` Date,\\n    `max_date` Date,\\n    `min_time` DateTime,\\n    `max_time` DateTime,\\n    `partition_id` String,\\n    `min_block_number` Int64,\\n    `max_block_number` Int64,\\n    `level` UInt32,\\n    `data_version` UInt64,\\n    `primary_key_bytes_in_memory` UInt64,\\n    `primary_key_bytes_in_memory_allocated` UInt64,\\n    `database` String,\\n    `table` String,\\n    `engine` String,\\n    `disk_name` String,\\n    `path` String,\\n    `column` String,\\n    `type` String,\\n    `column_position` UInt64,\\n    `default_kind` String,\\n    `default_expression` String,\\n    `column_bytes_on_disk` UInt64,\\n    `column_data_compressed_bytes` UInt64,\\n    `column_data_uncompressed_bytes` UInt64,\\n    `column_marks_bytes` UInt64,\\n    `serialization_kind` String,\\n    `subcolumns.names` Array(String),\\n    `subcolumns.types` Array(String),\\n    `subcolumns.serializations` Array(String),\\n    `bytes` UInt64,\\n    `marks_size` UInt64\\n)\\nENGINE = SystemPartsColumns()\\nCOMMENT \\'SYSTEM TABLE is built on the fly.\\'\n-CREATE TABLE system.privileges\\n(\\n    `privilege` Enum16(\\'SHOW DATABASES\\' = 0, \\'SHOW TABLES\\' = 1, \\'SHOW COLUMNS\\' = 2, \\'SHOW DICTIONARIES\\' = 3, \\'SHOW\\' = 4, \\'SELECT\\' = 5, \\'INSERT\\' = 6, \\'ALTER UPDATE\\' = 7, \\'ALTER DELETE\\' = 8, \\'ALTER ADD COLUMN\\' = 9, \\'ALTER MODIFY COLUMN\\' = 10, \\'ALTER DROP COLUMN\\' = 11, \\'ALTER COMMENT COLUMN\\' = 12, \\'ALTER CLEAR COLUMN\\' = 13, \\'ALTER RENAME COLUMN\\' = 14, \\'ALTER MATERIALIZE COLUMN\\' = 15, \\'ALTER COLUMN\\' = 16, \\'ALTER MODIFY COMMENT\\' = 17, \\'ALTER ORDER BY\\' = 18, \\'ALTER SAMPLE BY\\' = 19, \\'ALTER ADD INDEX\\' = 20, \\'ALTER DROP INDEX\\' = 21, \\'ALTER MATERIALIZE INDEX\\' = 22, \\'ALTER CLEAR INDEX\\' = 23, \\'ALTER INDEX\\' = 24, \\'ALTER ADD PROJECTION\\' = 25, \\'ALTER DROP PROJECTION\\' = 26, \\'ALTER MATERIALIZE PROJECTION\\' = 27, \\'ALTER CLEAR PROJECTION\\' = 28, \\'ALTER PROJECTION\\' = 29, \\'ALTER ADD CONSTRAINT\\' = 30, \\'ALTER DROP CONSTRAINT\\' = 31, \\'ALTER CONSTRAINT\\' = 32, \\'ALTER TTL\\' = 33, \\'ALTER MATERIALIZE TTL\\' = 34, \\'ALTER SETTINGS\\' = 35, \\'ALTER MOVE PARTITION\\' = 36, \\'ALTER FETCH PARTITION\\' = 37, \\'ALTER FREEZE PARTITION\\' = 38, \\'ALTER DATABASE SETTINGS\\' = 39, \\'ALTER TABLE\\' = 40, \\'ALTER DATABASE\\' = 41, \\'ALTER VIEW REFRESH\\' = 42, \\'ALTER VIEW MODIFY QUERY\\' = 43, \\'ALTER VIEW\\' = 44, \\'ALTER\\' = 45, \\'CREATE DATABASE\\' = 46, \\'CREATE TABLE\\' = 47, \\'CREATE VIEW\\' = 48, \\'CREATE DICTIONARY\\' = 49, \\'CREATE TEMPORARY TABLE\\' = 50, \\'CREATE FUNCTION\\' = 51, \\'CREATE\\' = 52, \\'DROP DATABASE\\' = 53, \\'DROP TABLE\\' = 54, \\'DROP VIEW\\' = 55, \\'DROP DICTIONARY\\' = 56, \\'DROP FUNCTION\\' = 57, \\'DROP\\' = 58, \\'TRUNCATE\\' = 59, \\'OPTIMIZE\\' = 60, \\'KILL QUERY\\' = 61, \\'MOVE PARTITION BETWEEN SHARDS\\' = 62, \\'CREATE USER\\' = 63, \\'ALTER USER\\' = 64, \\'DROP USER\\' = 65, \\'CREATE ROLE\\' = 66, \\'ALTER ROLE\\' = 67, \\'DROP ROLE\\' = 68, \\'ROLE ADMIN\\' = 69, \\'CREATE ROW POLICY\\' = 70, \\'ALTER ROW POLICY\\' = 71, \\'DROP ROW POLICY\\' = 72, \\'CREATE QUOTA\\' = 73, \\'ALTER QUOTA\\' = 74, \\'DROP QUOTA\\' = 75, \\'CREATE SETTINGS PROFILE\\' = 76, \\'ALTER SETTINGS PROFILE\\' = 77, \\'DROP SETTINGS PROFILE\\' = 78, \\'SHOW USERS\\' = 79, \\'SHOW ROLES\\' = 80, \\'SHOW ROW POLICIES\\' = 81, \\'SHOW QUOTAS\\' = 82, \\'SHOW SETTINGS PROFILES\\' = 83, \\'SHOW ACCESS\\' = 84, \\'ACCESS MANAGEMENT\\' = 85, \\'SYSTEM SHUTDOWN\\' = 86, \\'SYSTEM DROP DNS CACHE\\' = 87, \\'SYSTEM DROP MARK CACHE\\' = 88, \\'SYSTEM DROP UNCOMPRESSED CACHE\\' = 89, \\'SYSTEM DROP MMAP CACHE\\' = 90, \\'SYSTEM DROP COMPILED EXPRESSION CACHE\\' = 91, \\'SYSTEM DROP CACHE\\' = 92, \\'SYSTEM RELOAD CONFIG\\' = 93, \\'SYSTEM RELOAD SYMBOLS\\' = 94, \\'SYSTEM RELOAD DICTIONARY\\' = 95, \\'SYSTEM RELOAD MODEL\\' = 96, \\'SYSTEM RELOAD FUNCTION\\' = 97, \\'SYSTEM RELOAD EMBEDDED DICTIONARIES\\' = 98, \\'SYSTEM RELOAD\\' = 99, \\'SYSTEM RESTART DISK\\' = 100, \\'SYSTEM MERGES\\' = 101, \\'SYSTEM TTL MERGES\\' = 102, \\'SYSTEM FETCHES\\' = 103, \\'SYSTEM MOVES\\' = 104, \\'SYSTEM DISTRIBUTED SENDS\\' = 105, \\'SYSTEM REPLICATED SENDS\\' = 106, \\'SYSTEM SENDS\\' = 107, \\'SYSTEM REPLICATION QUEUES\\' = 108, \\'SYSTEM DROP REPLICA\\' = 109, \\'SYSTEM SYNC REPLICA\\' = 110, \\'SYSTEM RESTART REPLICA\\' = 111, \\'SYSTEM RESTORE REPLICA\\' = 112, \\'SYSTEM FLUSH DISTRIBUTED\\' = 113, \\'SYSTEM FLUSH LOGS\\' = 114, \\'SYSTEM FLUSH\\' = 115, \\'SYSTEM THREAD FUZZER\\' = 116, \\'SYSTEM\\' = 117, \\'dictGet\\' = 118, \\'addressToLine\\' = 119, \\'addressToSymbol\\' = 120, \\'demangle\\' = 121, \\'INTROSPECTION\\' = 122, \\'FILE\\' = 123, \\'URL\\' = 124, \\'REMOTE\\' = 125, \\'MONGO\\' = 126, \\'MYSQL\\' = 127, \\'POSTGRES\\' = 128, \\'SQLITE\\' = 129, \\'ODBC\\' = 130, \\'JDBC\\' = 131, \\'HDFS\\' = 132, \\'S3\\' = 133, \\'SOURCES\\' = 134, \\'ALL\\' = 135, \\'NONE\\' = 136),\\n    `aliases` Array(String),\\n    `level` Nullable(Enum8(\\'GLOBAL\\' = 0, \\'DATABASE\\' = 1, \\'TABLE\\' = 2, \\'DICTIONARY\\' = 3, \\'VIEW\\' = 4, \\'COLUMN\\' = 5)),\\n    `parent_group` Nullable(Enum16(\\'SHOW DATABASES\\' = 0, \\'SHOW TABLES\\' = 1, \\'SHOW COLUMNS\\' = 2, \\'SHOW DICTIONARIES\\' = 3, \\'SHOW\\' = 4, \\'SELECT\\' = 5, \\'INSERT\\' = 6, \\'ALTER UPDATE\\' = 7, \\'ALTER DELETE\\' = 8, \\'ALTER ADD COLUMN\\' = 9, \\'ALTER MODIFY COLUMN\\' = 10, \\'ALTER DROP COLUMN\\' = 11, \\'ALTER COMMENT COLUMN\\' = 12, \\'ALTER CLEAR COLUMN\\' = 13, \\'ALTER RENAME COLUMN\\' = 14, \\'ALTER MATERIALIZE COLUMN\\' = 15, \\'ALTER COLUMN\\' = 16, \\'ALTER MODIFY COMMENT\\' = 17, \\'ALTER ORDER BY\\' = 18, \\'ALTER SAMPLE BY\\' = 19, \\'ALTER ADD INDEX\\' = 20, \\'ALTER DROP INDEX\\' = 21, \\'ALTER MATERIALIZE INDEX\\' = 22, \\'ALTER CLEAR INDEX\\' = 23, \\'ALTER INDEX\\' = 24, \\'ALTER ADD PROJECTION\\' = 25, \\'ALTER DROP PROJECTION\\' = 26, \\'ALTER MATERIALIZE PROJECTION\\' = 27, \\'ALTER CLEAR PROJECTION\\' = 28, \\'ALTER PROJECTION\\' = 29, \\'ALTER ADD CONSTRAINT\\' = 30, \\'ALTER DROP CONSTRAINT\\' = 31, \\'ALTER CONSTRAINT\\' = 32, \\'ALTER TTL\\' = 33, \\'ALTER MATERIALIZE TTL\\' = 34, \\'ALTER SETTINGS\\' = 35, \\'ALTER MOVE PARTITION\\' = 36, \\'ALTER FETCH PARTITION\\' = 37, \\'ALTER FREEZE PARTITION\\' = 38, \\'ALTER DATABASE SETTINGS\\' = 39, \\'ALTER TABLE\\' = 40, \\'ALTER DATABASE\\' = 41, \\'ALTER VIEW REFRESH\\' = 42, \\'ALTER VIEW MODIFY QUERY\\' = 43, \\'ALTER VIEW\\' = 44, \\'ALTER\\' = 45, \\'CREATE DATABASE\\' = 46, \\'CREATE TABLE\\' = 47, \\'CREATE VIEW\\' = 48, \\'CREATE DICTIONARY\\' = 49, \\'CREATE TEMPORARY TABLE\\' = 50, \\'CREATE FUNCTION\\' = 51, \\'CREATE\\' = 52, \\'DROP DATABASE\\' = 53, \\'DROP TABLE\\' = 54, \\'DROP VIEW\\' = 55, \\'DROP DICTIONARY\\' = 56, \\'DROP FUNCTION\\' = 57, \\'DROP\\' = 58, \\'TRUNCATE\\' = 59, \\'OPTIMIZE\\' = 60, \\'KILL QUERY\\' = 61, \\'MOVE PARTITION BETWEEN SHARDS\\' = 62, \\'CREATE USER\\' = 63, \\'ALTER USER\\' = 64, \\'DROP USER\\' = 65, \\'CREATE ROLE\\' = 66, \\'ALTER ROLE\\' = 67, \\'DROP ROLE\\' = 68, \\'ROLE ADMIN\\' = 69, \\'CREATE ROW POLICY\\' = 70, \\'ALTER ROW POLICY\\' = 71, \\'DROP ROW POLICY\\' = 72, \\'CREATE QUOTA\\' = 73, \\'ALTER QUOTA\\' = 74, \\'DROP QUOTA\\' = 75, \\'CREATE SETTINGS PROFILE\\' = 76, \\'ALTER SETTINGS PROFILE\\' = 77, \\'DROP SETTINGS PROFILE\\' = 78, \\'SHOW USERS\\' = 79, \\'SHOW ROLES\\' = 80, \\'SHOW ROW POLICIES\\' = 81, \\'SHOW QUOTAS\\' = 82, \\'SHOW SETTINGS PROFILES\\' = 83, \\'SHOW ACCESS\\' = 84, \\'ACCESS MANAGEMENT\\' = 85, \\'SYSTEM SHUTDOWN\\' = 86, \\'SYSTEM DROP DNS CACHE\\' = 87, \\'SYSTEM DROP MARK CACHE\\' = 88, \\'SYSTEM DROP UNCOMPRESSED CACHE\\' = 89, \\'SYSTEM DROP MMAP CACHE\\' = 90, \\'SYSTEM DROP COMPILED EXPRESSION CACHE\\' = 91, \\'SYSTEM DROP CACHE\\' = 92, \\'SYSTEM RELOAD CONFIG\\' = 93, \\'SYSTEM RELOAD SYMBOLS\\' = 94, \\'SYSTEM RELOAD DICTIONARY\\' = 95, \\'SYSTEM RELOAD MODEL\\' = 96, \\'SYSTEM RELOAD FUNCTION\\' = 97, \\'SYSTEM RELOAD EMBEDDED DICTIONARIES\\' = 98, \\'SYSTEM RELOAD\\' = 99, \\'SYSTEM RESTART DISK\\' = 100, \\'SYSTEM MERGES\\' = 101, \\'SYSTEM TTL MERGES\\' = 102, \\'SYSTEM FETCHES\\' = 103, \\'SYSTEM MOVES\\' = 104, \\'SYSTEM DISTRIBUTED SENDS\\' = 105, \\'SYSTEM REPLICATED SENDS\\' = 106, \\'SYSTEM SENDS\\' = 107, \\'SYSTEM REPLICATION QUEUES\\' = 108, \\'SYSTEM DROP REPLICA\\' = 109, \\'SYSTEM SYNC REPLICA\\' = 110, \\'SYSTEM RESTART REPLICA\\' = 111, \\'SYSTEM RESTORE REPLICA\\' = 112, \\'SYSTEM FLUSH DISTRIBUTED\\' = 113, \\'SYSTEM FLUSH LOGS\\' = 114, \\'SYSTEM FLUSH\\' = 115, \\'SYSTEM THREAD FUZZER\\' = 116, \\'SYSTEM\\' = 117, \\'dictGet\\' = 118, \\'addressToLine\\' = 119, \\'addressToSymbol\\' = 120, \\'demangle\\' = 121, \\'INTROSPECTION\\' = 122, \\'FILE\\' = 123, \\'URL\\' = 124, \\'REMOTE\\' = 125, \\'MONGO\\' = 126, \\'MYSQL\\' = 127, \\'POSTGRES\\' = 128, \\'SQLITE\\' = 129, \\'ODBC\\' = 130, \\'JDBC\\' = 131, \\'HDFS\\' = 132, \\'S3\\' = 133, \\'SOURCES\\' = 134, \\'ALL\\' = 135, \\'NONE\\' = 136))\\n)\\nENGINE = SystemPrivileges()\\nCOMMENT \\'SYSTEM TABLE is built on the fly.\\'\n+CREATE TABLE system.privileges\\n(\\n    `privilege` Enum16(\\'SHOW DATABASES\\' = 0, \\'SHOW TABLES\\' = 1, \\'SHOW COLUMNS\\' = 2, \\'SHOW DICTIONARIES\\' = 3, \\'SHOW\\' = 4, \\'SELECT\\' = 5, \\'INSERT\\' = 6, \\'ALTER UPDATE\\' = 7, \\'ALTER DELETE\\' = 8, \\'ALTER ADD COLUMN\\' = 9, \\'ALTER MODIFY COLUMN\\' = 10, \\'ALTER DROP COLUMN\\' = 11, \\'ALTER COMMENT COLUMN\\' = 12, \\'ALTER CLEAR COLUMN\\' = 13, \\'ALTER RENAME COLUMN\\' = 14, \\'ALTER MATERIALIZE COLUMN\\' = 15, \\'ALTER COLUMN\\' = 16, \\'ALTER MODIFY COMMENT\\' = 17, \\'ALTER ORDER BY\\' = 18, \\'ALTER SAMPLE BY\\' = 19, \\'ALTER ADD INDEX\\' = 20, \\'ALTER DROP INDEX\\' = 21, \\'ALTER MATERIALIZE INDEX\\' = 22, \\'ALTER CLEAR INDEX\\' = 23, \\'ALTER INDEX\\' = 24, \\'ALTER ADD PROJECTION\\' = 25, \\'ALTER DROP PROJECTION\\' = 26, \\'ALTER MATERIALIZE PROJECTION\\' = 27, \\'ALTER CLEAR PROJECTION\\' = 28, \\'ALTER PROJECTION\\' = 29, \\'ALTER ADD CONSTRAINT\\' = 30, \\'ALTER DROP CONSTRAINT\\' = 31, \\'ALTER CONSTRAINT\\' = 32, \\'ALTER TTL\\' = 33, \\'ALTER MATERIALIZE TTL\\' = 34, \\'ALTER SETTINGS\\' = 35, \\'ALTER MOVE PARTITION\\' = 36, \\'ALTER FETCH PARTITION\\' = 37, \\'ALTER FREEZE PARTITION\\' = 38, \\'ALTER DATABASE SETTINGS\\' = 39, \\'ALTER TABLE\\' = 40, \\'ALTER DATABASE\\' = 41, \\'ALTER VIEW REFRESH\\' = 42, \\'ALTER VIEW MODIFY QUERY\\' = 43, \\'ALTER VIEW\\' = 44, \\'ALTER\\' = 45, \\'CREATE DATABASE\\' = 46, \\'CREATE TABLE\\' = 47, \\'CREATE VIEW\\' = 48, \\'CREATE DICTIONARY\\' = 49, \\'CREATE TEMPORARY TABLE\\' = 50, \\'CREATE FUNCTION\\' = 51, \\'CREATE\\' = 52, \\'DROP DATABASE\\' = 53, \\'DROP TABLE\\' = 54, \\'DROP VIEW\\' = 55, \\'DROP DICTIONARY\\' = 56, \\'DROP FUNCTION\\' = 57, \\'DROP\\' = 58, \\'TRUNCATE\\' = 59, \\'OPTIMIZE\\' = 60, \\'KILL QUERY\\' = 61, \\'MOVE PARTITION BETWEEN SHARDS\\' = 62, \\'CREATE USER\\' = 63, \\'ALTER USER\\' = 64, \\'DROP USER\\' = 65, \\'CREATE ROLE\\' = 66, \\'ALTER ROLE\\' = 67, \\'DROP ROLE\\' = 68, \\'ROLE ADMIN\\' = 69, \\'CREATE ROW POLICY\\' = 70, \\'ALTER ROW POLICY\\' = 71, \\'DROP ROW POLICY\\' = 72, \\'CREATE QUOTA\\' = 73, \\'ALTER QUOTA\\' = 74, \\'DROP QUOTA\\' = 75, \\'CREATE SETTINGS PROFILE\\' = 76, \\'ALTER SETTINGS PROFILE\\' = 77, \\'DROP SETTINGS PROFILE\\' = 78, \\'SHOW USERS\\' = 79, \\'SHOW ROLES\\' = 80, \\'SHOW ROW POLICIES\\' = 81, \\'SHOW QUOTAS\\' = 82, \\'SHOW SETTINGS PROFILES\\' = 83, \\'SHOW ACCESS\\' = 84, \\'ACCESS MANAGEMENT\\' = 85, \\'SYSTEM SHUTDOWN\\' = 86, \\'SYSTEM DROP DNS CACHE\\' = 87, \\'SYSTEM DROP MARK CACHE\\' = 88, \\'SYSTEM DROP UNCOMPRESSED CACHE\\' = 89, \\'SYSTEM DROP MMAP CACHE\\' = 90, \\'SYSTEM DROP COMPILED EXPRESSION CACHE\\' = 91, \\'SYSTEM DROP CACHE\\' = 92, \\'SYSTEM RELOAD CONFIG\\' = 93, \\'SYSTEM RELOAD SYMBOLS\\' = 94, \\'SYSTEM RELOAD DICTIONARY\\' = 95, \\'SYSTEM RELOAD MODEL\\' = 96, \\'SYSTEM RELOAD FUNCTION\\' = 97, \\'SYSTEM RELOAD EMBEDDED DICTIONARIES\\' = 98, \\'SYSTEM RELOAD\\' = 99, \\'SYSTEM RESTART DISK\\' = 100, \\'SYSTEM MERGES\\' = 101, \\'SYSTEM TTL MERGES\\' = 102, \\'SYSTEM FETCHES\\' = 103, \\'SYSTEM MOVES\\' = 104, \\'SYSTEM DISTRIBUTED SENDS\\' = 105, \\'SYSTEM REPLICATED SENDS\\' = 106, \\'SYSTEM SENDS\\' = 107, \\'SYSTEM REPLICATION QUEUES\\' = 108, \\'SYSTEM DROP REPLICA\\' = 109, \\'SYSTEM SYNC REPLICA\\' = 110, \\'SYSTEM RESTART REPLICA\\' = 111, \\'SYSTEM RESTORE REPLICA\\' = 112, \\'SYSTEM FLUSH DISTRIBUTED\\' = 113, \\'SYSTEM FLUSH LOGS\\' = 114, \\'SYSTEM FLUSH\\' = 115, \\'SYSTEM THREAD FUZZER\\' = 116, \\'SYSTEM\\' = 117, \\'dictGet\\' = 118, \\'addressToLine\\' = 119, \\'addressToLineWithInlines\\' = 120, \\'addressToSymbol\\' = 121, \\'demangle\\' = 122, \\'INTROSPECTION\\' = 123, \\'FILE\\' = 124, \\'URL\\' = 125, \\'REMOTE\\' = 126, \\'MONGO\\' = 127, \\'MYSQL\\' = 128, \\'POSTGRES\\' = 129, \\'SQLITE\\' = 130, \\'ODBC\\' = 131, \\'JDBC\\' = 132, \\'HDFS\\' = 133, \\'S3\\' = 134, \\'SOURCES\\' = 135, \\'ALL\\' = 136, \\'NONE\\' = 137),\\n    `aliases` Array(String),\\n    `level` Nullable(Enum8(\\'GLOBAL\\' = 0, \\'DATABASE\\' = 1, \\'TABLE\\' = 2, \\'DICTIONARY\\' = 3, \\'VIEW\\' = 4, \\'COLUMN\\' = 5)),\\n    `parent_group` Nullable(Enum16(\\'SHOW DATABASES\\' = 0, \\'SHOW TABLES\\' = 1, \\'SHOW COLUMNS\\' = 2, \\'SHOW DICTIONARIES\\' = 3, \\'SHOW\\' = 4, \\'SELECT\\' = 5, \\'INSERT\\' = 6, \\'ALTER UPDATE\\' = 7, \\'ALTER DELETE\\' = 8, \\'ALTER ADD COLUMN\\' = 9, \\'ALTER MODIFY COLUMN\\' = 10, \\'ALTER DROP COLUMN\\' = 11, \\'ALTER COMMENT COLUMN\\' = 12, \\'ALTER CLEAR COLUMN\\' = 13, \\'ALTER RENAME COLUMN\\' = 14, \\'ALTER MATERIALIZE COLUMN\\' = 15, \\'ALTER COLUMN\\' = 16, \\'ALTER MODIFY COMMENT\\' = 17, \\'ALTER ORDER BY\\' = 18, \\'ALTER SAMPLE BY\\' = 19, \\'ALTER ADD INDEX\\' = 20, \\'ALTER DROP INDEX\\' = 21, \\'ALTER MATERIALIZE INDEX\\' = 22, \\'ALTER CLEAR INDEX\\' = 23, \\'ALTER INDEX\\' = 24, \\'ALTER ADD PROJECTION\\' = 25, \\'ALTER DROP PROJECTION\\' = 26, \\'ALTER MATERIALIZE PROJECTION\\' = 27, \\'ALTER CLEAR PROJECTION\\' = 28, \\'ALTER PROJECTION\\' = 29, \\'ALTER ADD CONSTRAINT\\' = 30, \\'ALTER DROP CONSTRAINT\\' = 31, \\'ALTER CONSTRAINT\\' = 32, \\'ALTER TTL\\' = 33, \\'ALTER MATERIALIZE TTL\\' = 34, \\'ALTER SETTINGS\\' = 35, \\'ALTER MOVE PARTITION\\' = 36, \\'ALTER FETCH PARTITION\\' = 37, \\'ALTER FREEZE PARTITION\\' = 38, \\'ALTER DATABASE SETTINGS\\' = 39, \\'ALTER TABLE\\' = 40, \\'ALTER DATABASE\\' = 41, \\'ALTER VIEW REFRESH\\' = 42, \\'ALTER VIEW MODIFY QUERY\\' = 43, \\'ALTER VIEW\\' = 44, \\'ALTER\\' = 45, \\'CREATE DATABASE\\' = 46, \\'CREATE TABLE\\' = 47, \\'CREATE VIEW\\' = 48, \\'CREATE DICTIONARY\\' = 49, \\'CREATE TEMPORARY TABLE\\' = 50, \\'CREATE FUNCTION\\' = 51, \\'CREATE\\' = 52, \\'DROP DATABASE\\' = 53, \\'DROP TABLE\\' = 54, \\'DROP VIEW\\' = 55, \\'DROP DICTIONARY\\' = 56, \\'DROP FUNCTION\\' = 57, \\'DROP\\' = 58, \\'TRUNCATE\\' = 59, \\'OPTIMIZE\\' = 60, \\'KILL QUERY\\' = 61, \\'MOVE PARTITION BETWEEN SHARDS\\' = 62, \\'CREATE USER\\' = 63, \\'ALTER USER\\' = 64, \\'DROP USER\\' = 65, \\'CREATE ROLE\\' = 66, \\'ALTER ROLE\\' = 67, \\'DROP ROLE\\' = 68, \\'ROLE ADMIN\\' = 69, \\'CREATE ROW POLICY\\' = 70, \\'ALTER ROW POLICY\\' = 71, \\'DROP ROW POLICY\\' = 72, \\'CREATE QUOTA\\' = 73, \\'ALTER QUOTA\\' = 74, \\'DROP QUOTA\\' = 75, \\'CREATE SETTINGS PROFILE\\' = 76, \\'ALTER SETTINGS PROFILE\\' = 77, \\'DROP SETTINGS PROFILE\\' = 78, \\'SHOW USERS\\' = 79, \\'SHOW ROLES\\' = 80, \\'SHOW ROW POLICIES\\' = 81, \\'SHOW QUOTAS\\' = 82, \\'SHOW SETTINGS PROFILES\\' = 83, \\'SHOW ACCESS\\' = 84, \\'ACCESS MANAGEMENT\\' = 85, \\'SYSTEM SHUTDOWN\\' = 86, \\'SYSTEM DROP DNS CACHE\\' = 87, \\'SYSTEM DROP MARK CACHE\\' = 88, \\'SYSTEM DROP UNCOMPRESSED CACHE\\' = 89, \\'SYSTEM DROP MMAP CACHE\\' = 90, \\'SYSTEM DROP COMPILED EXPRESSION CACHE\\' = 91, \\'SYSTEM DROP CACHE\\' = 92, \\'SYSTEM RELOAD CONFIG\\' = 93, \\'SYSTEM RELOAD SYMBOLS\\' = 94, \\'SYSTEM RELOAD DICTIONARY\\' = 95, \\'SYSTEM RELOAD MODEL\\' = 96, \\'SYSTEM RELOAD FUNCTION\\' = 97, \\'SYSTEM RELOAD EMBEDDED DICTIONARIES\\' = 98, \\'SYSTEM RELOAD\\' = 99, \\'SYSTEM RESTART DISK\\' = 100, \\'SYSTEM MERGES\\' = 101, \\'SYSTEM TTL MERGES\\' = 102, \\'SYSTEM FETCHES\\' = 103, \\'SYSTEM MOVES\\' = 104, \\'SYSTEM DISTRIBUTED SENDS\\' = 105, \\'SYSTEM REPLICATED SENDS\\' = 106, \\'SYSTEM SENDS\\' = 107, \\'SYSTEM REPLICATION QUEUES\\' = 108, \\'SYSTEM DROP REPLICA\\' = 109, \\'SYSTEM SYNC REPLICA\\' = 110, \\'SYSTEM RESTART REPLICA\\' = 111, \\'SYSTEM RESTORE REPLICA\\' = 112, \\'SYSTEM FLUSH DISTRIBUTED\\' = 113, \\'SYSTEM FLUSH LOGS\\' = 114, \\'SYSTEM FLUSH\\' = 115, \\'SYSTEM THREAD FUZZER\\' = 116, \\'SYSTEM\\' = 117, \\'dictGet\\' = 118, \\'addressToLine\\' = 119, \\'addressToLineWithInlines\\' = 120, \\'addressToSymbol\\' = 121, \\'demangle\\' = 122, \\'INTROSPECTION\\' = 123, \\'FILE\\' = 124, \\'URL\\' = 125, \\'REMOTE\\' = 126, \\'MONGO\\' = 127, \\'MYSQL\\' = 128, \\'POSTGRES\\' = 129, \\'SQLITE\\' = 130, \\'ODBC\\' = 131, \\'JDBC\\' = 132, \\'HDFS\\' = 133, \\'S3\\' = 134, \\'SOURCES\\' = 135, \\'ALL\\' = 136, \\'NONE\\' = 137))\\n)\\nENGINE = SystemPrivileges()\\nCOMMENT \\'SYSTEM TABLE is built on the fly.\\'\n CREATE TABLE system.processes\\n(\\n    `is_initial_query` UInt8,\\n    `user` String,\\n    `query_id` String,\\n    `address` IPv6,\\n    `port` UInt16,\\n    `initial_user` String,\\n    `initial_query_id` String,\\n    `initial_address` IPv6,\\n    `initial_port` UInt16,\\n    `interface` UInt8,\\n    `os_user` String,\\n    `client_hostname` String,\\n    `client_name` String,\\n    `client_revision` UInt64,\\n    `client_version_major` UInt64,\\n    `client_version_minor` UInt64,\\n    `client_version_patch` UInt64,\\n    `http_method` UInt8,\\n    `http_user_agent` String,\\n    `http_referer` String,\\n    `forwarded_for` String,\\n    `quota_key` String,\\n    `elapsed` Float64,\\n    `is_cancelled` UInt8,\\n    `read_rows` UInt64,\\n    `read_bytes` UInt64,\\n    `total_rows_approx` UInt64,\\n    `written_rows` UInt64,\\n    `written_bytes` UInt64,\\n    `memory_usage` Int64,\\n    `peak_memory_usage` Int64,\\n    `query` String,\\n    `thread_ids` Array(UInt64),\\n    `ProfileEvents` Map(String, UInt64),\\n    `Settings` Map(String, String),\\n    `current_database` String,\\n    `ProfileEvents.Names` Array(String),\\n    `ProfileEvents.Values` Array(UInt64),\\n    `Settings.Names` Array(String),\\n    `Settings.Values` Array(String)\\n)\\nENGINE = SystemProcesses()\\nCOMMENT \\'SYSTEM TABLE is built on the fly.\\'\n CREATE TABLE system.projection_parts\\n(\\n    `partition` String,\\n    `name` String,\\n    `part_type` String,\\n    `parent_name` String,\\n    `parent_uuid` UUID,\\n    `parent_part_type` String,\\n    `active` UInt8,\\n    `marks` UInt64,\\n    `rows` UInt64,\\n    `bytes_on_disk` UInt64,\\n    `data_compressed_bytes` UInt64,\\n    `data_uncompressed_bytes` UInt64,\\n    `marks_bytes` UInt64,\\n    `parent_marks` UInt64,\\n    `parent_rows` UInt64,\\n    `parent_bytes_on_disk` UInt64,\\n    `parent_data_compressed_bytes` UInt64,\\n    `parent_data_uncompressed_bytes` UInt64,\\n    `parent_marks_bytes` UInt64,\\n    `modification_time` DateTime,\\n    `remove_time` DateTime,\\n    `refcount` UInt32,\\n    `min_date` Date,\\n    `max_date` Date,\\n    `min_time` DateTime,\\n    `max_time` DateTime,\\n    `partition_id` String,\\n    `min_block_number` Int64,\\n    `max_block_number` Int64,\\n    `level` UInt32,\\n    `data_version` UInt64,\\n    `primary_key_bytes_in_memory` UInt64,\\n    `primary_key_bytes_in_memory_allocated` UInt64,\\n    `is_frozen` UInt8,\\n    `database` String,\\n    `table` String,\\n    `engine` String,\\n    `disk_name` String,\\n    `path` String,\\n    `hash_of_all_files` String,\\n    `hash_of_uncompressed_files` String,\\n    `uncompressed_hash_of_compressed_files` String,\\n    `delete_ttl_info_min` DateTime,\\n    `delete_ttl_info_max` DateTime,\\n    `move_ttl_info.expression` Array(String),\\n    `move_ttl_info.min` Array(DateTime),\\n    `move_ttl_info.max` Array(DateTime),\\n    `default_compression_codec` String,\\n    `recompression_ttl_info.expression` Array(String),\\n    `recompression_ttl_info.min` Array(DateTime),\\n    `recompression_ttl_info.max` Array(DateTime),\\n    `group_by_ttl_info.expression` Array(String),\\n    `group_by_ttl_info.min` Array(DateTime),\\n    `group_by_ttl_info.max` Array(DateTime),\\n    `rows_where_ttl_info.expression` Array(String),\\n    `rows_where_ttl_info.min` Array(DateTime),\\n    `rows_where_ttl_info.max` Array(DateTime),\\n    `bytes` UInt64,\\n    `marks_size` UInt64\\n)\\nENGINE = SystemProjectionParts()\\nCOMMENT \\'SYSTEM TABLE is built on the fly.\\'\n CREATE TABLE system.projection_parts_columns\\n(\\n    `partition` String,\\n    `name` String,\\n    `part_type` String,\\n    `parent_name` String,\\n    `parent_uuid` UUID,\\n    `parent_part_type` String,\\n    `active` UInt8,\\n    `marks` UInt64,\\n    `rows` UInt64,\\n    `bytes_on_disk` UInt64,\\n    `data_compressed_bytes` UInt64,\\n    `data_uncompressed_bytes` UInt64,\\n    `marks_bytes` UInt64,\\n    `parent_marks` UInt64,\\n    `parent_rows` UInt64,\\n    `parent_bytes_on_disk` UInt64,\\n    `parent_data_compressed_bytes` UInt64,\\n    `parent_data_uncompressed_bytes` UInt64,\\n    `parent_marks_bytes` UInt64,\\n    `modification_time` DateTime,\\n    `remove_time` DateTime,\\n    `refcount` UInt32,\\n    `min_date` Date,\\n    `max_date` Date,\\n    `min_time` DateTime,\\n    `max_time` DateTime,\\n    `partition_id` String,\\n    `min_block_number` Int64,\\n    `max_block_number` Int64,\\n    `level` UInt32,\\n    `data_version` UInt64,\\n    `primary_key_bytes_in_memory` UInt64,\\n    `primary_key_bytes_in_memory_allocated` UInt64,\\n    `database` String,\\n    `table` String,\\n    `engine` String,\\n    `disk_name` String,\\n    `path` String,\\n    `column` String,\\n    `type` String,\\n    `column_position` UInt64,\\n    `default_kind` String,\\n    `default_expression` String,\\n    `column_bytes_on_disk` UInt64,\\n    `column_data_compressed_bytes` UInt64,\\n    `column_data_uncompressed_bytes` UInt64,\\n    `column_marks_bytes` UInt64,\\n    `bytes` UInt64,\\n    `marks_size` UInt64\\n)\\nENGINE = SystemProjectionPartsColumns()\\nCOMMENT \\'SYSTEM TABLE is built on the fly.\\'\ndiff --git a/tests/queries/0_stateless/02161_addressToLineWithInlines.reference b/tests/queries/0_stateless/02161_addressToLineWithInlines.reference\nnew file mode 100644\nindex 000000000000..10e2c7069b3f\n--- /dev/null\n+++ b/tests/queries/0_stateless/02161_addressToLineWithInlines.reference\n@@ -0,0 +1,2 @@\n+10000000000\n+has inlines:\t1\ndiff --git a/tests/queries/0_stateless/02161_addressToLineWithInlines.sql b/tests/queries/0_stateless/02161_addressToLineWithInlines.sql\nnew file mode 100644\nindex 000000000000..baddea30ae34\n--- /dev/null\n+++ b/tests/queries/0_stateless/02161_addressToLineWithInlines.sql\n@@ -0,0 +1,25 @@\n+-- Tags: no-tsan, no-asan, no-ubsan, no-msan, no-debug\n+\n+\n+SELECT addressToLineWithInlines(1); -- { serverError 446 }\n+\n+SET allow_introspection_functions = 1;\n+SET query_profiler_real_time_period_ns = 0;\n+SET query_profiler_cpu_time_period_ns = 1000000;\n+SET log_queries = 1;\n+SELECT count() FROM numbers_mt(10000000000) SETTINGS log_comment='02161_test_case';\n+SET log_queries = 0;\n+SET query_profiler_cpu_time_period_ns = 0;\n+SYSTEM FLUSH LOGS;\n+\n+WITH\n+    lineWithInlines AS\n+    (\n+        SELECT DISTINCT addressToLineWithInlines(arrayJoin(trace)) AS lineWithInlines FROM system.trace_log WHERE query_id =\n+        (\n+            SELECT query_id FROM system.query_log WHERE current_database = currentDatabase() AND log_comment='02161_test_case' ORDER BY event_time DESC LIMIT 1\n+        )\n+    )\n+SELECT 'has inlines:', or(max(length(lineWithInlines)) > 1, max(locate(lineWithInlines[1], ':')) = 0) FROM lineWithInlines SETTINGS short_circuit_function_evaluation='enable';\n+-- `max(length(lineWithInlines)) > 1` check there is any inlines.\n+-- `max(locate(lineWithInlines[1], ':')) = 0` check whether none could get a symbol.\n",
  "problem_statement": "Add `addressToLineWithInlines` function.\n**Use case**\r\nSimilar to `addressToLine` but outputs an array with inlined places in code.\n",
  "hints_text": "Hi! I'm a first-timer contributor. Could you assign the task to me?\nOk.\r\n\r\nLook at the implementation of `addressToLine` in `src/Functions/addressToLine.cpp`\r\nAlso look how inlined stack frames are found at `src/Common/StackTrace.cpp`, near `static void toStringEveryLineImpl`.\r\n\r\n\nIs anyone working on this? \r\nIf not, @alexey-milovidov, can you give an example of function result, please? \r\nShould the result of the function contain only the line and the name of the called functions(inlined stack frames)? \r\nSomething like that:\r\n\r\n`SELECT addressToLineWithInlines(140072785384210)`\r\n` ['/ClickHouse/build/../contrib/libcxx/include/__threading_support:436: std::__1::__libcpp_condvar_wait(pthread_cond_t*, pthread_mutex_t*)']`\r\n\r\nif there are no inlined stack frames, it will be just an empty array?\r\n\n@fuzzERot It should return an array with main stack frame and all the inlined functions if any.\r\nSo, if there are no inlined function, the array will have one element.\nCurrently no one is working on this feature. I will be happy it you will help! :+1: ",
  "created_at": "2022-01-08T12:27:28Z",
  "modified_files": [
    "docs/en/operations/optimizing-performance/sampling-query-profiler.md",
    "docs/en/operations/system-tables/stack_trace.md",
    "docs/en/operations/system-tables/trace_log.md",
    "docs/en/sql-reference/functions/introspection.md",
    "docs/en/sql-reference/statements/grant.md",
    "src/Access/Common/AccessType.h",
    "src/Functions/addressToLine.cpp",
    "b/src/Functions/addressToLine.h",
    "b/src/Functions/addressToLineWithInlines.cpp",
    "src/Functions/registerFunctionsIntrospection.cpp"
  ],
  "modified_test_files": [
    "tests/queries/0_stateless/01271_show_privileges.reference",
    "tests/queries/0_stateless/02117_show_create_table_system.reference",
    "b/tests/queries/0_stateless/02161_addressToLineWithInlines.reference",
    "b/tests/queries/0_stateless/02161_addressToLineWithInlines.sql"
  ]
}