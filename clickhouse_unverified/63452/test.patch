diff --git a/tests/queries/0_stateless/03147_table_function_loop.reference b/tests/queries/0_stateless/03147_table_function_loop.reference
new file mode 100644
index 000000000000..46a2310b65f1
--- /dev/null
+++ b/tests/queries/0_stateless/03147_table_function_loop.reference
@@ -0,0 +1,65 @@
+0
+1
+2
+0
+1
+2
+0
+1
+2
+0
+0
+1
+2
+0
+1
+2
+0
+1
+2
+0
+0
+1
+2
+3
+4
+5
+6
+7
+8
+9
+0
+1
+2
+3
+4
+0
+1
+2
+3
+4
+5
+6
+7
+8
+9
+0
+1
+2
+3
+4
+0
+1
+2
+3
+4
+5
+6
+7
+8
+9
+0
+1
+2
+3
+4
diff --git a/tests/queries/0_stateless/03147_table_function_loop.sql b/tests/queries/0_stateless/03147_table_function_loop.sql
new file mode 100644
index 000000000000..af48e4b11e31
--- /dev/null
+++ b/tests/queries/0_stateless/03147_table_function_loop.sql
@@ -0,0 +1,14 @@
+-- Tags: no-parallel
+
+SELECT * FROM loop(numbers(3)) LIMIT 10;
+SELECT * FROM loop (numbers(3)) LIMIT 10 settings max_block_size = 1;
+
+DROP DATABASE IF EXISTS 03147_db;
+CREATE DATABASE IF NOT EXISTS 03147_db;
+CREATE TABLE 03147_db.t (n Int8) ENGINE=MergeTree ORDER BY n;
+INSERT INTO 03147_db.t SELECT * FROM numbers(10);
+USE 03147_db;
+
+SELECT * FROM loop(03147_db.t) LIMIT 15;
+SELECT * FROM loop(t) LIMIT 15;
+SELECT * FROM loop(03147_db, t) LIMIT 15;
