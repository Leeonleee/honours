diff --git a/src/Client/LocalConnection.cpp b/src/Client/LocalConnection.cpp
index c05f039ffb61..857b9147487c 100644
--- a/src/Client/LocalConnection.cpp
+++ b/src/Client/LocalConnection.cpp
@@ -95,12 +95,18 @@ void LocalConnection::sendQuery(
     else
         query_context = session.makeQueryContext();
     query_context->setCurrentQueryId(query_id);
+
     if (send_progress)
     {
         query_context->setProgressCallback([this] (const Progress & value) { this->updateProgress(value); });
         query_context->setFileProgressCallback([this](const FileProgress & value) { this->updateProgress(Progress(value)); });
     }
-    if (!current_database.empty())
+
+    /// Switch the database to the desired one (set by the USE query)
+    /// but don't attempt to do it if we are already in that database.
+    /// (there is a rare case when it matters - if we deleted the current database,
+    // we can still do some queries, but we cannot switch to the same database)
+    if (!current_database.empty() && current_database != query_context->getCurrentDatabase())
         query_context->setCurrentDatabase(current_database);
 
     query_context->addQueryParameters(query_parameters);
