diff --git a/src/IO/tests/gtest_WriteHelpers.cpp b/src/IO/tests/gtest_WriteHelpers.cpp
new file mode 100644
index 000000000000..b3c7062be580
--- /dev/null
+++ b/src/IO/tests/gtest_WriteHelpers.cpp
@@ -0,0 +1,32 @@
+#include <gtest/gtest.h>
+
+#include <string>
+#include <vector>
+#include <IO/WriteHelpers.h>
+
+using namespace DB;
+
+
+TEST(WriteHelpersTest, ToStringWithFinalSeparatorTest)
+{
+    {
+        std::vector<std::string> v;
+        EXPECT_EQ(toStringWithFinalSeparator(v, " or "), "");
+    }
+    {
+        std::vector<std::string> v = {"AAA"};
+        EXPECT_EQ(toStringWithFinalSeparator(v, " or "), "'AAA'");
+    }
+    {
+        std::vector<std::string> v = {"AAA", "BBB"};
+        EXPECT_EQ(toStringWithFinalSeparator(v, " or "), "'AAA' or 'BBB'");
+    }
+    {
+        std::vector<std::string> v = {"AAA", "BBB", "CCC"};
+        EXPECT_EQ(toStringWithFinalSeparator(v, " or "), "'AAA', 'BBB' or 'CCC'");
+    }
+    {
+        std::vector<std::string> v = {"AAA", "BBB", "CCC", "DDD"};
+        EXPECT_EQ(toStringWithFinalSeparator(v, " or "), "'AAA', 'BBB', 'CCC' or 'DDD'");
+    }
+}
