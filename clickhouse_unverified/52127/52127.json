{
  "repo": "ClickHouse/ClickHouse",
  "pull_number": 52127,
  "instance_id": "ClickHouse__ClickHouse-52127",
  "issue_numbers": [
    "52066"
  ],
  "base_commit": "04462333d26181a03562098a1f0c6b5ee290b421",
  "patch": "diff --git a/utils/list-licenses/list-licenses.sh b/utils/list-licenses/list-licenses.sh\nindex dd23e6321c8e..cee5cf87a085 100755\n--- a/utils/list-licenses/list-licenses.sh\n+++ b/utils/list-licenses/list-licenses.sh\n@@ -12,7 +12,7 @@ fi\n ROOT_PATH=\"$(git rev-parse --show-toplevel)\"\n LIBS_PATH=\"${ROOT_PATH}/contrib\"\n \n-ls -1 -d ${LIBS_PATH}/*/ | ${GREP_CMD} -F -v -- '-cmake' | LC_ALL=C sort | while read LIB; do\n+ls -1 -d ${LIBS_PATH}/*/ \"${ROOT_PATH}/base/poco\" | ${GREP_CMD} -F -v -- '-cmake' | LC_ALL=C sort | while read LIB; do\n     LIB_NAME=$(basename $LIB)\n \n     LIB_LICENSE=$(\n@@ -72,7 +72,7 @@ ls -1 -d ${LIBS_PATH}/*/ | ${GREP_CMD} -F -v -- '-cmake' | LC_ALL=C sort | while\n          echo \"HPND\") ||\n         echo \"Unknown\")\n \n-        RELATIVE_PATH=$(echo \"$LIB_LICENSE\" | sed -r -e 's!^.+/contrib/!/contrib/!')\n+        RELATIVE_PATH=$(echo \"$LIB_LICENSE\" | sed -r -e 's!^.+/(contrib|base)/!/\\1/!')\n \n         echo -e \"$LIB_NAME\\t$LICENSE_TYPE\\t$RELATIVE_PATH\"\n     fi\n",
  "test_patch": "diff --git a/tests/queries/0_stateless/02813_system_licenses_base.reference b/tests/queries/0_stateless/02813_system_licenses_base.reference\nnew file mode 100644\nindex 000000000000..89c42cc7a2f7\n--- /dev/null\n+++ b/tests/queries/0_stateless/02813_system_licenses_base.reference\n@@ -0,0 +1,7 @@\n+Row 1:\n+\u2500\u2500\u2500\u2500\u2500\u2500\n+library_name: poco\n+license_type: Boost\n+license_path: /base/poco/LICENSE\n+license_text: Boost Software License - Version 1.0 - August 17th, 2003\n+\ndiff --git a/tests/queries/0_stateless/02813_system_licenses_base.sql b/tests/queries/0_stateless/02813_system_licenses_base.sql\nnew file mode 100644\nindex 000000000000..e4b2ca3d36bb\n--- /dev/null\n+++ b/tests/queries/0_stateless/02813_system_licenses_base.sql\n@@ -0,0 +1,1 @@\n+SELECT * REPLACE substring(license_text, 1, position(license_text, '\\n')) AS license_text FROM system.licenses WHERE library_name = 'poco' FORMAT Vertical;\n",
  "problem_statement": "Credits to poco disappeared from system.licenses\n```\r\nSELECT\r\n    library_name,\r\n    license_type\r\nFROM system.licenses\r\nWHERE library_name ILIKE '%poco%'\r\n```\r\nnow is empty.\r\n\r\nHappened after https://github.com/ClickHouse/ClickHouse/pull/46075\r\n\r\nWe need to put the poco license back, because it's fair and mandatory according to their license.\r\n\r\n\"The copyright notices in the Software and this entire statement, including the above license grant, this restriction and the following disclaimer, must be included in all copies of the Software\"\n",
  "hints_text": "",
  "created_at": "2023-07-14T19:13:28Z"
}