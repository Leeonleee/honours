{
  "repo": "ClickHouse/ClickHouse",
  "pull_number": 62114,
  "instance_id": "ClickHouse__ClickHouse-62114",
  "issue_numbers": [
    "61677"
  ],
  "base_commit": "05a2d89aa6f06fd590014d704916ca14bee238cd",
  "patch": "diff --git a/packages/clickhouse-common-static-dbg.yaml b/packages/clickhouse-common-static-dbg.yaml\nindex 96de4c17d88f..74b7fa8381bc 100644\n--- a/packages/clickhouse-common-static-dbg.yaml\n+++ b/packages/clickhouse-common-static-dbg.yaml\n@@ -30,10 +30,6 @@ conflicts:\n contents:\n - src: root/usr/lib/debug/usr/bin/clickhouse.debug\n   dst: /usr/lib/debug/usr/bin/clickhouse.debug\n-- src: root/usr/lib/debug/usr/bin/clickhouse-odbc-bridge.debug\n-  dst: /usr/lib/debug/usr/bin/clickhouse-odbc-bridge.debug\n-- src: root/usr/lib/debug/usr/bin/clickhouse-library-bridge.debug\n-  dst: /usr/lib/debug/usr/bin/clickhouse-library-bridge.debug\n # docs\n - src: ../AUTHORS\n   dst: /usr/share/doc/clickhouse-common-static-dbg/AUTHORS\ndiff --git a/packages/clickhouse-common-static.yaml b/packages/clickhouse-common-static.yaml\nindex 383ad39591cd..db330f808e15 100644\n--- a/packages/clickhouse-common-static.yaml\n+++ b/packages/clickhouse-common-static.yaml\n@@ -36,10 +36,6 @@ contents:\n   dst: /usr/bin/clickhouse\n - src: root/usr/bin/clickhouse-extract-from-config\n   dst: /usr/bin/clickhouse-extract-from-config\n-- src: root/usr/bin/clickhouse-library-bridge\n-  dst: /usr/bin/clickhouse-library-bridge\n-- src: root/usr/bin/clickhouse-odbc-bridge\n-  dst: /usr/bin/clickhouse-odbc-bridge\n - src: root/usr/share/bash-completion/completions\n   dst: /usr/share/bash-completion/completions\n - src: root/usr/share/clickhouse\ndiff --git a/packages/clickhouse-library-bridge.yaml b/packages/clickhouse-library-bridge.yaml\nnew file mode 100644\nindex 000000000000..d041e7a26dbc\n--- /dev/null\n+++ b/packages/clickhouse-library-bridge.yaml\n@@ -0,0 +1,35 @@\n+# package sources should be placed in ${PWD}/root\n+# nfpm should run from the same directory with a config\n+name: \"clickhouse-library-bridge\"\n+description: |\n+  ClickHouse Library Bridge - is a separate process for loading libraries for the 'library' dictionary sources and the CatBoost library.\n+    ClickHouse is a column-oriented database management system\n+    that allows generating analytical data reports in real time.\n+\n+# Common packages config\n+arch: \"${DEB_ARCH}\" # amd64, arm64\n+platform: \"linux\"\n+version: \"${CLICKHOUSE_VERSION_STRING}\"\n+vendor: \"ClickHouse Inc.\"\n+homepage: \"https://clickhouse.com\"\n+license: \"Apache\"\n+section: \"database\"\n+priority: \"optional\"\n+maintainer: \"ClickHouse Dev Team <packages+linux@clickhouse.com>\"\n+deb:\n+  fields:\n+    Source: clickhouse\n+\n+# Package specific content\n+contents:\n+- src: root/usr/bin/clickhouse-library-bridge\n+  dst: /usr/bin/clickhouse-library-bridge\n+# docs\n+- src: ../AUTHORS\n+  dst: /usr/share/doc/clickhouse-library-bridge/AUTHORS\n+- src: ../CHANGELOG.md\n+  dst: /usr/share/doc/clickhouse-library-bridge/CHANGELOG.md\n+- src: ../LICENSE\n+  dst: /usr/share/doc/clickhouse-library-bridge/LICENSE\n+- src: ../README.md\n+  dst: /usr/share/doc/clickhouse-library-bridge/README.md\ndiff --git a/packages/clickhouse-odbc-bridge.yaml b/packages/clickhouse-odbc-bridge.yaml\nnew file mode 100644\nindex 000000000000..98c459c8c26b\n--- /dev/null\n+++ b/packages/clickhouse-odbc-bridge.yaml\n@@ -0,0 +1,35 @@\n+# package sources should be placed in ${PWD}/root\n+# nfpm should run from the same directory with a config\n+name: \"clickhouse-odbc-bridge\"\n+description: |\n+  ClickHouse ODBC Bridge - is a separate process for loading ODBC drivers and interacting with external databases using the ODBC protocol.\n+    ClickHouse is a column-oriented database management system\n+    that allows generating analytical data reports in real time.\n+\n+# Common packages config\n+arch: \"${DEB_ARCH}\" # amd64, arm64\n+platform: \"linux\"\n+version: \"${CLICKHOUSE_VERSION_STRING}\"\n+vendor: \"ClickHouse Inc.\"\n+homepage: \"https://clickhouse.com\"\n+license: \"Apache\"\n+section: \"database\"\n+priority: \"optional\"\n+maintainer: \"ClickHouse Dev Team <packages+linux@clickhouse.com>\"\n+deb:\n+  fields:\n+    Source: clickhouse\n+\n+# Package specific content\n+contents:\n+- src: root/usr/bin/clickhouse-odbc-bridge\n+  dst: /usr/bin/clickhouse-odbc-bridge\n+# docs\n+- src: ../AUTHORS\n+  dst: /usr/share/doc/clickhouse-odbc-bridge/AUTHORS\n+- src: ../CHANGELOG.md\n+  dst: /usr/share/doc/clickhouse-odbc-bridge/CHANGELOG.md\n+- src: ../LICENSE\n+  dst: /usr/share/doc/clickhouse-odbc-bridge/LICENSE\n+- src: ../README.md\n+  dst: /usr/share/doc/clickhouse-odbc-bridge/README.md\ndiff --git a/programs/library-bridge/CMakeLists.txt b/programs/library-bridge/CMakeLists.txt\nindex 98d8848502d2..2fca10ce4d77 100644\n--- a/programs/library-bridge/CMakeLists.txt\n+++ b/programs/library-bridge/CMakeLists.txt\n@@ -24,9 +24,4 @@ target_link_libraries(clickhouse-library-bridge PRIVATE\n \n set_target_properties(clickhouse-library-bridge PROPERTIES RUNTIME_OUTPUT_DIRECTORY ..)\n \n-if (SPLIT_DEBUG_SYMBOLS)\n-    clickhouse_split_debug_symbols(TARGET clickhouse-library-bridge DESTINATION_DIR ${CMAKE_CURRENT_BINARY_DIR}/../${SPLITTED_DEBUG_SYMBOLS_DIR} BINARY_PATH ../clickhouse-library-bridge)\n-else()\n-    clickhouse_make_empty_debug_info_for_nfpm(TARGET clickhouse-library-bridge DESTINATION_DIR ${CMAKE_CURRENT_BINARY_DIR}/../${SPLITTED_DEBUG_SYMBOLS_DIR})\n-    install(TARGETS clickhouse-library-bridge RUNTIME DESTINATION ${CMAKE_INSTALL_BINDIR} COMPONENT clickhouse)\n-endif()\n+install(TARGETS clickhouse-library-bridge RUNTIME DESTINATION ${CMAKE_INSTALL_BINDIR} COMPONENT clickhouse)\ndiff --git a/programs/odbc-bridge/CMakeLists.txt b/programs/odbc-bridge/CMakeLists.txt\nindex d6cbe8f7215a..83839cc21acd 100644\n--- a/programs/odbc-bridge/CMakeLists.txt\n+++ b/programs/odbc-bridge/CMakeLists.txt\n@@ -30,12 +30,7 @@ target_link_libraries(clickhouse-odbc-bridge PRIVATE\n set_target_properties(clickhouse-odbc-bridge PROPERTIES RUNTIME_OUTPUT_DIRECTORY ..)\n target_compile_options (clickhouse-odbc-bridge PRIVATE -Wno-reserved-id-macro -Wno-keyword-macro)\n \n-if (SPLIT_DEBUG_SYMBOLS)\n-    clickhouse_split_debug_symbols(TARGET clickhouse-odbc-bridge DESTINATION_DIR ${CMAKE_CURRENT_BINARY_DIR}/../${SPLITTED_DEBUG_SYMBOLS_DIR} BINARY_PATH ../clickhouse-odbc-bridge)\n-else()\n-    clickhouse_make_empty_debug_info_for_nfpm(TARGET clickhouse-odbc-bridge DESTINATION_DIR ${CMAKE_CURRENT_BINARY_DIR}/../${SPLITTED_DEBUG_SYMBOLS_DIR})\n-    install(TARGETS clickhouse-odbc-bridge RUNTIME DESTINATION ${CMAKE_INSTALL_BINDIR} COMPONENT clickhouse)\n-endif()\n+install(TARGETS clickhouse-odbc-bridge RUNTIME DESTINATION ${CMAKE_INSTALL_BINDIR} COMPONENT clickhouse)\n \n if(ENABLE_TESTS)\n     add_subdirectory(tests)\ndiff --git a/programs/odbc-bridge/ColumnInfoHandler.cpp b/programs/odbc-bridge/ColumnInfoHandler.cpp\nindex 4cb15de3b2cb..5ff985b3d121 100644\n--- a/programs/odbc-bridge/ColumnInfoHandler.cpp\n+++ b/programs/odbc-bridge/ColumnInfoHandler.cpp\n@@ -12,6 +12,7 @@\n #include <Poco/Net/HTTPServerRequest.h>\n #include <Poco/Net/HTTPServerResponse.h>\n #include <Poco/NumberParser.h>\n+#include <Interpreters/Context.h>\n #include <Common/logger_useful.h>\n #include <Common/BridgeProtocolVersion.h>\n #include <Common/quoteString.h>\ndiff --git a/programs/odbc-bridge/ColumnInfoHandler.h b/programs/odbc-bridge/ColumnInfoHandler.h\nindex ca7044fdf328..610fb128c9de 100644\n--- a/programs/odbc-bridge/ColumnInfoHandler.h\n+++ b/programs/odbc-bridge/ColumnInfoHandler.h\n@@ -5,7 +5,6 @@\n #if USE_ODBC\n \n #include <Interpreters/Context_fwd.h>\n-#include <Interpreters/Context.h>\n #include <Server/HTTP/HTTPRequestHandler.h>\n #include <Poco/Logger.h>\n \n",
  "test_patch": "diff --git a/docker/test/stateless/run.sh b/docker/test/stateless/run.sh\nindex b9ed0561a48e..d7088aa05fbd 100755\n--- a/docker/test/stateless/run.sh\n+++ b/docker/test/stateless/run.sh\n@@ -16,6 +16,8 @@ ln -snf \"/usr/share/zoneinfo/$TZ\" /etc/localtime && echo \"$TZ\" > /etc/timezone\n \n dpkg -i package_folder/clickhouse-common-static_*.deb\n dpkg -i package_folder/clickhouse-common-static-dbg_*.deb\n+dpkg -i package_folder/clickhouse-odbc-bridge_*.deb\n+dpkg -i package_folder/clickhouse-library-bridge_*.deb\n dpkg -i package_folder/clickhouse-server_*.deb\n dpkg -i package_folder/clickhouse-client_*.deb\n \ndiff --git a/tests/ci/integration_tests_runner.py b/tests/ci/integration_tests_runner.py\nindex f50124500cc5..90e2b08386fc 100755\n--- a/tests/ci/integration_tests_runner.py\n+++ b/tests/ci/integration_tests_runner.py\n@@ -342,6 +342,8 @@ def _install_clickhouse(self, debs_path):\n             \"clickhouse-common-static_\",\n             \"clickhouse-server_\",\n             \"clickhouse-client\",\n+            \"clickhouse-odbc-bridge_\",\n+            \"clickhouse-library-bridge_\",\n             \"clickhouse-common-static-dbg_\",\n         ):  # order matters\n             logging.info(\"Installing package %s\", package)\n",
  "problem_statement": "`clickhouse-odbc-bridge` and `clickhouse-library-bridge` should be separate packages\n**Use case**\r\n\r\nIt will leave the room in the main package.\r\n\n",
  "hints_text": "",
  "created_at": "2024-03-31T01:01:02Z"
}