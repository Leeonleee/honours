diff --git a/tests/queries/0_stateless/01115_prewhere_array_join.reference b/tests/queries/0_stateless/01115_prewhere_array_join.reference
new file mode 100644
index 000000000000..e69de29bb2d1
diff --git a/tests/queries/0_stateless/01115_prewhere_array_join.sql b/tests/queries/0_stateless/01115_prewhere_array_join.sql
new file mode 100644
index 000000000000..e614bdf402b4
--- /dev/null
+++ b/tests/queries/0_stateless/01115_prewhere_array_join.sql
@@ -0,0 +1,7 @@
+DROP TABLE IF EXISTS prewhere;
+
+CREATE TABLE prewhere (light UInt8, heavy String) ENGINE = MergeTree ORDER BY tuple();
+INSERT INTO prewhere SELECT 0, randomPrintableASCII(10000) FROM numbers(10000);
+SELECT arrayJoin([light]) != 0 AS cond, length(heavy) FROM prewhere WHERE light != 0 AND cond != 0;
+
+DROP TABLE prewhere;
diff --git a/tests/queries/1_stateful/00093_prewhere_array_join.reference b/tests/queries/1_stateful/00093_prewhere_array_join.reference
new file mode 100644
index 000000000000..e69de29bb2d1
diff --git a/tests/queries/1_stateful/00093_prewhere_array_join.sql b/tests/queries/1_stateful/00093_prewhere_array_join.sql
new file mode 100644
index 000000000000..a1263144bb19
--- /dev/null
+++ b/tests/queries/1_stateful/00093_prewhere_array_join.sql
@@ -0,0 +1,9 @@
+SELECT arrayJoin([SearchEngineID]) AS search_engine, URL FROM test.hits WHERE SearchEngineID != 0 AND search_engine != 0 FORMAT Null;
+
+SELECT
+    arrayJoin([0]) AS browser,
+    arrayJoin([SearchEngineID]) AS search_engine,
+    URL
+FROM test.hits
+WHERE 1 AND (SearchEngineID != 0) AND (browser != 0) AND (search_engine != 0)
+FORMAT Null;
