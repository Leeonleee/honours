diff --git a/tests/queries/0_stateless/03402_zero_streams_after_max_streams_to_max_threads_ratio.reference b/tests/queries/0_stateless/03402_zero_streams_after_max_streams_to_max_threads_ratio.reference
new file mode 100644
index 000000000000..e930be6a31bd
--- /dev/null
+++ b/tests/queries/0_stateless/03402_zero_streams_after_max_streams_to_max_threads_ratio.reference
@@ -0,0 +1,7 @@
+49.5
+49.5
+49.5
+
+0
+0
+0
diff --git a/tests/queries/0_stateless/03402_zero_streams_after_max_streams_to_max_threads_ratio.sql b/tests/queries/0_stateless/03402_zero_streams_after_max_streams_to_max_threads_ratio.sql
new file mode 100644
index 000000000000..c0a55d83d616
--- /dev/null
+++ b/tests/queries/0_stateless/03402_zero_streams_after_max_streams_to_max_threads_ratio.sql
@@ -0,0 +1,16 @@
+DROP TABLE IF EXISTS 03402_data;
+
+CREATE TABLE 03402_data (id UInt32) ENGINE = MergeTree ORDER BY id;
+INSERT INTO 03402_data SELECT * FROM numbers(100);
+
+SELECT avg(id) FROM 03402_data SETTINGS max_threads = 4, max_streams_to_max_threads_ratio = 0;
+SELECT avg(id) FROM 03402_data SETTINGS max_threads = 0, max_streams_to_max_threads_ratio = 0;
+SELECT avg(id) FROM 03402_data SETTINGS max_threads = 2, max_streams_to_max_threads_ratio = 0.2;
+
+SELECT '';
+
+SELECT id FROM 03402_data ORDER BY id LIMIT 1 SETTINGS max_threads = 4, max_streams_to_max_threads_ratio = 0;
+SELECT id FROM 03402_data ORDER BY id LIMIT 1 SETTINGS max_threads = 0, max_streams_to_max_threads_ratio = 0;
+SELECT id FROM 03402_data ORDER BY id LIMIT 1 SETTINGS max_threads = 2, max_streams_to_max_threads_ratio = 0.2;
+
+DROP TABLE 03402_data;
diff --git a/tests/queries/0_stateless/03403_read_in_order_streams_memory_usage.reference b/tests/queries/0_stateless/03403_read_in_order_streams_memory_usage.reference
new file mode 100644
index 000000000000..d00491fd7e5b
--- /dev/null
+++ b/tests/queries/0_stateless/03403_read_in_order_streams_memory_usage.reference
@@ -0,0 +1,1 @@
+1
diff --git a/tests/queries/0_stateless/03403_read_in_order_streams_memory_usage.sql b/tests/queries/0_stateless/03403_read_in_order_streams_memory_usage.sql
new file mode 100644
index 000000000000..3e700fba9b90
--- /dev/null
+++ b/tests/queries/0_stateless/03403_read_in_order_streams_memory_usage.sql
@@ -0,0 +1,20 @@
+DROP TABLE IF EXISTS 03403_data;
+CREATE TABLE 03403_data(id UInt32, val String) ENGINE = MergeTree ORDER BY id AS SELECT 1, 'test';
+
+SELECT *
+FROM 03403_data
+ORDER BY id
+FORMAT Null
+SETTINGS max_threads = 1024,
+         max_streams_to_max_threads_ratio = 10000000;
+
+SYSTEM FLUSH LOGS query_log;
+
+SELECT memory_usage < 10_000_000
+FROM system.query_log
+WHERE Settings['max_streams_to_max_threads_ratio'] = '10000000'
+  AND query like '%FROM 03403_data%'
+  AND type = 'QueryFinish'
+  AND current_database = currentDatabase();
+
+DROP TABLE 03403_data;
