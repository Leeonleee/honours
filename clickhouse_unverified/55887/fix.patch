diff --git a/src/Interpreters/NormalizeSelectWithUnionQueryVisitor.cpp b/src/Interpreters/NormalizeSelectWithUnionQueryVisitor.cpp
index cbdd656fb8cf..f48b987561e5 100644
--- a/src/Interpreters/NormalizeSelectWithUnionQueryVisitor.cpp
+++ b/src/Interpreters/NormalizeSelectWithUnionQueryVisitor.cpp
@@ -29,7 +29,13 @@ void NormalizeSelectWithUnionQueryMatcher::getSelectsFromUnionListNode(ASTPtr as
 void NormalizeSelectWithUnionQueryMatcher::visit(ASTPtr & ast, Data & data)
 {
     if (auto * select_union = ast->as<ASTSelectWithUnionQuery>())
+    {
+        /// The rewrite of ASTSelectWithUnionQuery may strip the format info, so
+        /// we need to keep and restore it.
+        auto format = select_union->format;
         visit(*select_union, data);
+        select_union->format = format;
+    }
 }
 
 void NormalizeSelectWithUnionQueryMatcher::visit(ASTSelectWithUnionQuery & ast, Data & data)
