You will be provided with a partial code base and an issue statement explaining a problem to resolve.

<issue>
UNION DISTINCT may strip FORMAT from the query
Union distinct can not be returned as PrettyCompactMonoBlock.

```
select 1
union all
select 2
format PrettyCompactMonoBlock
```

https://play.clickhouse.com/?user=play&query=select%201%20union%20all%20select%202%20format%20PrettyCompactMonoBlock

Returns as expected:
```
┌─[1m1[0m─┐
│ 1 │
│ 2 │
└───┘
```
However:
```
select 1
union distinct
select 2
format PrettyCompactMonoBlock
```

https://play.clickhouse.com/?user=play&query=select%201%20union%20distinct%20select%202%20format%20PrettyCompactMonoBlock

Returns TSV.
</issue>

I need you to solve the provided issue by generating a code fix that can be applied directly to the repository

Respond below:
