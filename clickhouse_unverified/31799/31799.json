{
  "repo": "ClickHouse/ClickHouse",
  "pull_number": 31799,
  "instance_id": "ClickHouse__ClickHouse-31799",
  "issue_numbers": [
    "30879"
  ],
  "base_commit": "b39c19399ff951a598dd35e575c715c5c4dfb5a2",
  "patch": "diff --git a/programs/keeper/keeper_config.xml b/programs/keeper/keeper_config.xml\nindex 02d5be705631..8b4d4274e6af 100644\n--- a/programs/keeper/keeper_config.xml\n+++ b/programs/keeper/keeper_config.xml\n@@ -49,7 +49,7 @@\n \n                     <!-- Internal port and hostname -->\n                     <hostname>localhost</hostname>\n-                    <port>44444</port>\n+                    <port>9234</port>\n                 </server>\n \n                 <!-- Add more servers here -->\ndiff --git a/programs/keeper/keeper_embedded.xml b/programs/keeper/keeper_embedded.xml\nindex 9d08a3ce910d..d887b95a7356 100644\n--- a/programs/keeper/keeper_embedded.xml\n+++ b/programs/keeper/keeper_embedded.xml\n@@ -14,7 +14,7 @@\n             <server>\n                 <id>1</id>\n                 <hostname>localhost</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n         </raft_configuration>\n     </keeper_server>\n",
  "test_patch": "diff --git a/tests/config/config.d/database_replicated.xml b/tests/config/config.d/database_replicated.xml\nindex 1ad43b9880ad..3fea87c4fd1c 100644\n--- a/tests/config/config.d/database_replicated.xml\n+++ b/tests/config/config.d/database_replicated.xml\n@@ -34,14 +34,14 @@\n             <server>\n                 <id>1</id>\n                 <hostname>localhost</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <priority>3</priority>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>localhost</hostname>\n-                <port>44445</port>\n+                <port>9235</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>2</priority>\n@@ -49,7 +49,7 @@\n             <server>\n                 <id>3</id>\n                 <hostname>localhost</hostname>\n-                <port>44446</port>\n+                <port>9236</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>1</priority>\ndiff --git a/tests/config/config.d/keeper_port.xml b/tests/config/config.d/keeper_port.xml\nindex 85d4bc0f04fa..21163ece1901 100644\n--- a/tests/config/config.d/keeper_port.xml\n+++ b/tests/config/config.d/keeper_port.xml\n@@ -22,7 +22,7 @@\n             <server>\n                 <id>1</id>\n                 <hostname>localhost</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n         </raft_configuration>\n     </keeper_server>\ndiff --git a/tests/integration/test_config_xml_full/configs/config.d/keeper_port.xml b/tests/integration/test_config_xml_full/configs/config.d/keeper_port.xml\nindex cee4d3382311..aada51c50b5f 100644\n--- a/tests/integration/test_config_xml_full/configs/config.d/keeper_port.xml\n+++ b/tests/integration/test_config_xml_full/configs/config.d/keeper_port.xml\n@@ -16,7 +16,7 @@\n             <server>\n                 <id>1</id>\n                 <hostname>localhost</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n         </raft_configuration>\n     </keeper_server>\ndiff --git a/tests/integration/test_config_xml_main/configs/config.d/keeper_port.yaml b/tests/integration/test_config_xml_main/configs/config.d/keeper_port.yaml\nindex 91723bc372f1..3019e530e840 100644\n--- a/tests/integration/test_config_xml_main/configs/config.d/keeper_port.yaml\n+++ b/tests/integration/test_config_xml_main/configs/config.d/keeper_port.yaml\n@@ -11,5 +11,5 @@ keeper_server:\n     server:\n       id: 1\n       hostname: localhost\n-      port: 44444\n+      port: 9234\n \ndiff --git a/tests/integration/test_config_xml_yaml_mix/configs/config.d/keeper_port.xml b/tests/integration/test_config_xml_yaml_mix/configs/config.d/keeper_port.xml\nindex cee4d3382311..aada51c50b5f 100644\n--- a/tests/integration/test_config_xml_yaml_mix/configs/config.d/keeper_port.xml\n+++ b/tests/integration/test_config_xml_yaml_mix/configs/config.d/keeper_port.xml\n@@ -16,7 +16,7 @@\n             <server>\n                 <id>1</id>\n                 <hostname>localhost</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n         </raft_configuration>\n     </keeper_server>\ndiff --git a/tests/integration/test_config_yaml_full/configs/config.d/keeper_port.yaml b/tests/integration/test_config_yaml_full/configs/config.d/keeper_port.yaml\nindex 91723bc372f1..3019e530e840 100644\n--- a/tests/integration/test_config_yaml_full/configs/config.d/keeper_port.yaml\n+++ b/tests/integration/test_config_yaml_full/configs/config.d/keeper_port.yaml\n@@ -11,5 +11,5 @@ keeper_server:\n     server:\n       id: 1\n       hostname: localhost\n-      port: 44444\n+      port: 9234\n \ndiff --git a/tests/integration/test_config_yaml_main/configs/config.d/keeper_port.xml b/tests/integration/test_config_yaml_main/configs/config.d/keeper_port.xml\nindex cee4d3382311..aada51c50b5f 100644\n--- a/tests/integration/test_config_yaml_main/configs/config.d/keeper_port.xml\n+++ b/tests/integration/test_config_yaml_main/configs/config.d/keeper_port.xml\n@@ -16,7 +16,7 @@\n             <server>\n                 <id>1</id>\n                 <hostname>localhost</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n         </raft_configuration>\n     </keeper_server>\ndiff --git a/tests/integration/test_keeper_auth/configs/keeper_config.xml b/tests/integration/test_keeper_auth/configs/keeper_config.xml\nindex 1a01b79cebd3..926cdd3a0f92 100644\n--- a/tests/integration/test_keeper_auth/configs/keeper_config.xml\n+++ b/tests/integration/test_keeper_auth/configs/keeper_config.xml\n@@ -21,7 +21,7 @@\n             <server>\n                 <id>1</id>\n                 <hostname>localhost</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n         </raft_configuration>\n     </keeper_server>\ndiff --git a/tests/integration/test_keeper_back_to_back/configs/enable_keeper.xml b/tests/integration/test_keeper_back_to_back/configs/enable_keeper.xml\nindex 30a56c6e1e16..9649117e4b19 100644\n--- a/tests/integration/test_keeper_back_to_back/configs/enable_keeper.xml\n+++ b/tests/integration/test_keeper_back_to_back/configs/enable_keeper.xml\n@@ -20,7 +20,7 @@\n             <server>\n                 <id>1</id>\n                 <hostname>localhost</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n         </raft_configuration>\n     </keeper_server>\ndiff --git a/tests/integration/test_keeper_clickhouse_hard_restart/configs/enable_keeper.xml b/tests/integration/test_keeper_clickhouse_hard_restart/configs/enable_keeper.xml\nnew file mode 100644\nindex 000000000000..c1d38a1de52f\n--- /dev/null\n+++ b/tests/integration/test_keeper_clickhouse_hard_restart/configs/enable_keeper.xml\n@@ -0,0 +1,22 @@\n+<clickhouse>\n+    <keeper_server>\n+        <tcp_port>9181</tcp_port>\n+        <server_id>1</server_id>\n+        <log_storage_path>/var/lib/clickhouse/coordination/log</log_storage_path>\n+        <snapshot_storage_path>/var/lib/clickhouse/coordination/snapshots</snapshot_storage_path>\n+\n+        <coordination_settings>\n+            <operation_timeout_ms>5000</operation_timeout_ms>\n+            <session_timeout_ms>10000</session_timeout_ms>\n+            <raft_logs_level>trace</raft_logs_level>\n+        </coordination_settings>\n+\n+        <raft_configuration>\n+            <server>\n+                <id>1</id>\n+                <hostname>node1</hostname>\n+                <port>9234</port>\n+            </server>\n+        </raft_configuration>\n+    </keeper_server>\n+</clickhouse>\ndiff --git a/tests/integration/test_keeper_clickhouse_hard_restart/configs/keeper_conf.xml b/tests/integration/test_keeper_clickhouse_hard_restart/configs/keeper_conf.xml\nnew file mode 100644\nindex 000000000000..ebb0d98ddf46\n--- /dev/null\n+++ b/tests/integration/test_keeper_clickhouse_hard_restart/configs/keeper_conf.xml\n@@ -0,0 +1,8 @@\n+<clickhouse>\n+    <zookeeper>\n+        <node index=\"1\">\n+            <host>node1</host>\n+            <port>9181</port>\n+        </node>\n+    </zookeeper>\n+</clickhouse>\ndiff --git a/tests/integration/test_keeper_four_word_command/configs/enable_keeper1.xml b/tests/integration/test_keeper_four_word_command/configs/enable_keeper1.xml\nindex 258e58b558ef..fcb3553bb98e 100644\n--- a/tests/integration/test_keeper_four_word_command/configs/enable_keeper1.xml\n+++ b/tests/integration/test_keeper_four_word_command/configs/enable_keeper1.xml\n@@ -17,14 +17,14 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <priority>3</priority>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>false</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>2</priority>\n@@ -32,7 +32,7 @@\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>false</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>1</priority>\ndiff --git a/tests/integration/test_keeper_four_word_command/configs/enable_keeper2.xml b/tests/integration/test_keeper_four_word_command/configs/enable_keeper2.xml\nindex f49fb8192562..65011cd26377 100644\n--- a/tests/integration/test_keeper_four_word_command/configs/enable_keeper2.xml\n+++ b/tests/integration/test_keeper_four_word_command/configs/enable_keeper2.xml\n@@ -17,14 +17,14 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <priority>3</priority>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>false</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>2</priority>\n@@ -32,7 +32,7 @@\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>false</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>1</priority>\ndiff --git a/tests/integration/test_keeper_four_word_command/configs/enable_keeper3.xml b/tests/integration/test_keeper_four_word_command/configs/enable_keeper3.xml\nindex 4606dce367f8..a0d8c99f3d8b 100644\n--- a/tests/integration/test_keeper_four_word_command/configs/enable_keeper3.xml\n+++ b/tests/integration/test_keeper_four_word_command/configs/enable_keeper3.xml\n@@ -17,14 +17,14 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <priority>3</priority>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>false</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>2</priority>\n@@ -32,7 +32,7 @@\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>false</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>1</priority>\ndiff --git a/tests/integration/test_keeper_four_word_command/configs/keeper_config_with_white_list.xml b/tests/integration/test_keeper_four_word_command/configs/keeper_config_with_white_list.xml\nindex 4263cdb38c93..a0c735fd5db0 100644\n--- a/tests/integration/test_keeper_four_word_command/configs/keeper_config_with_white_list.xml\n+++ b/tests/integration/test_keeper_four_word_command/configs/keeper_config_with_white_list.xml\n@@ -7,17 +7,17 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n         </raft_configuration>\n     </keeper_server>\ndiff --git a/tests/integration/test_keeper_four_word_command/configs/keeper_config_with_white_list_all.xml b/tests/integration/test_keeper_four_word_command/configs/keeper_config_with_white_list_all.xml\nindex 635afa70b858..2aa58b25130c 100644\n--- a/tests/integration/test_keeper_four_word_command/configs/keeper_config_with_white_list_all.xml\n+++ b/tests/integration/test_keeper_four_word_command/configs/keeper_config_with_white_list_all.xml\n@@ -7,17 +7,17 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n         </raft_configuration>\n     </keeper_server>\ndiff --git a/tests/integration/test_keeper_four_word_command/configs/keeper_config_without_white_list.xml b/tests/integration/test_keeper_four_word_command/configs/keeper_config_without_white_list.xml\nindex 084b9a636542..697acaebe580 100644\n--- a/tests/integration/test_keeper_four_word_command/configs/keeper_config_without_white_list.xml\n+++ b/tests/integration/test_keeper_four_word_command/configs/keeper_config_without_white_list.xml\n@@ -6,17 +6,17 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n         </raft_configuration>\n     </keeper_server>\ndiff --git a/tests/integration/test_keeper_internal_secure/configs/enable_secure_keeper1.xml b/tests/integration/test_keeper_internal_secure/configs/enable_secure_keeper1.xml\nindex 039d864711c8..986b503ebe35 100644\n--- a/tests/integration/test_keeper_internal_secure/configs/enable_secure_keeper1.xml\n+++ b/tests/integration/test_keeper_internal_secure/configs/enable_secure_keeper1.xml\n@@ -17,14 +17,14 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <priority>3</priority>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>2</priority>\n@@ -32,7 +32,7 @@\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>1</priority>\ndiff --git a/tests/integration/test_keeper_internal_secure/configs/enable_secure_keeper2.xml b/tests/integration/test_keeper_internal_secure/configs/enable_secure_keeper2.xml\nindex a3c20e095f37..652b1992f463 100644\n--- a/tests/integration/test_keeper_internal_secure/configs/enable_secure_keeper2.xml\n+++ b/tests/integration/test_keeper_internal_secure/configs/enable_secure_keeper2.xml\n@@ -17,14 +17,14 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <priority>3</priority>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>2</priority>\n@@ -32,7 +32,7 @@\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>1</priority>\ndiff --git a/tests/integration/test_keeper_internal_secure/configs/enable_secure_keeper3.xml b/tests/integration/test_keeper_internal_secure/configs/enable_secure_keeper3.xml\nindex 867c48ba2504..6507f97473b8 100644\n--- a/tests/integration/test_keeper_internal_secure/configs/enable_secure_keeper3.xml\n+++ b/tests/integration/test_keeper_internal_secure/configs/enable_secure_keeper3.xml\n@@ -17,14 +17,14 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <priority>3</priority>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>2</priority>\n@@ -32,7 +32,7 @@\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>1</priority>\ndiff --git a/tests/integration/test_keeper_multinode_blocade_leader/configs/enable_keeper1.xml b/tests/integration/test_keeper_multinode_blocade_leader/configs/enable_keeper1.xml\nindex 9acc30f02fa4..17455ed12f5d 100644\n--- a/tests/integration/test_keeper_multinode_blocade_leader/configs/enable_keeper1.xml\n+++ b/tests/integration/test_keeper_multinode_blocade_leader/configs/enable_keeper1.xml\n@@ -16,14 +16,14 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <priority>3</priority>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>2</priority>\n@@ -31,7 +31,7 @@\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>1</priority>\ndiff --git a/tests/integration/test_keeper_multinode_blocade_leader/configs/enable_keeper2.xml b/tests/integration/test_keeper_multinode_blocade_leader/configs/enable_keeper2.xml\nindex 9f8c0806ee04..03a23984cc26 100644\n--- a/tests/integration/test_keeper_multinode_blocade_leader/configs/enable_keeper2.xml\n+++ b/tests/integration/test_keeper_multinode_blocade_leader/configs/enable_keeper2.xml\n@@ -16,14 +16,14 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <priority>3</priority>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>2</priority>\n@@ -31,7 +31,7 @@\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>1</priority>\ndiff --git a/tests/integration/test_keeper_multinode_blocade_leader/configs/enable_keeper3.xml b/tests/integration/test_keeper_multinode_blocade_leader/configs/enable_keeper3.xml\nindex e0efa3a8d1ef..a3196ac30617 100644\n--- a/tests/integration/test_keeper_multinode_blocade_leader/configs/enable_keeper3.xml\n+++ b/tests/integration/test_keeper_multinode_blocade_leader/configs/enable_keeper3.xml\n@@ -16,14 +16,14 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <priority>3</priority>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>2</priority>\n@@ -31,7 +31,7 @@\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>1</priority>\ndiff --git a/tests/integration/test_keeper_multinode_simple/configs/enable_keeper1.xml b/tests/integration/test_keeper_multinode_simple/configs/enable_keeper1.xml\nindex 9acc30f02fa4..17455ed12f5d 100644\n--- a/tests/integration/test_keeper_multinode_simple/configs/enable_keeper1.xml\n+++ b/tests/integration/test_keeper_multinode_simple/configs/enable_keeper1.xml\n@@ -16,14 +16,14 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <priority>3</priority>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>2</priority>\n@@ -31,7 +31,7 @@\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>1</priority>\ndiff --git a/tests/integration/test_keeper_multinode_simple/configs/enable_keeper2.xml b/tests/integration/test_keeper_multinode_simple/configs/enable_keeper2.xml\nindex 9f8c0806ee04..03a23984cc26 100644\n--- a/tests/integration/test_keeper_multinode_simple/configs/enable_keeper2.xml\n+++ b/tests/integration/test_keeper_multinode_simple/configs/enable_keeper2.xml\n@@ -16,14 +16,14 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <priority>3</priority>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>2</priority>\n@@ -31,7 +31,7 @@\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>1</priority>\ndiff --git a/tests/integration/test_keeper_multinode_simple/configs/enable_keeper3.xml b/tests/integration/test_keeper_multinode_simple/configs/enable_keeper3.xml\nindex e0efa3a8d1ef..a3196ac30617 100644\n--- a/tests/integration/test_keeper_multinode_simple/configs/enable_keeper3.xml\n+++ b/tests/integration/test_keeper_multinode_simple/configs/enable_keeper3.xml\n@@ -16,14 +16,14 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <priority>3</priority>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>2</priority>\n@@ -31,7 +31,7 @@\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>1</priority>\ndiff --git a/tests/integration/test_keeper_nodes_add/configs/enable_keeper1.xml b/tests/integration/test_keeper_nodes_add/configs/enable_keeper1.xml\nindex bd695389fa66..c1d38a1de52f 100644\n--- a/tests/integration/test_keeper_nodes_add/configs/enable_keeper1.xml\n+++ b/tests/integration/test_keeper_nodes_add/configs/enable_keeper1.xml\n@@ -15,7 +15,7 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n         </raft_configuration>\n     </keeper_server>\ndiff --git a/tests/integration/test_keeper_nodes_add/configs/enable_keeper_three_nodes_1.xml b/tests/integration/test_keeper_nodes_add/configs/enable_keeper_three_nodes_1.xml\nindex 510424715c48..d2717283a8d0 100644\n--- a/tests/integration/test_keeper_nodes_add/configs/enable_keeper_three_nodes_1.xml\n+++ b/tests/integration/test_keeper_nodes_add/configs/enable_keeper_three_nodes_1.xml\n@@ -15,17 +15,17 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n         </raft_configuration>\n     </keeper_server>\ndiff --git a/tests/integration/test_keeper_nodes_add/configs/enable_keeper_three_nodes_2.xml b/tests/integration/test_keeper_nodes_add/configs/enable_keeper_three_nodes_2.xml\nindex 264601d8c984..5924ee1c2dc7 100644\n--- a/tests/integration/test_keeper_nodes_add/configs/enable_keeper_three_nodes_2.xml\n+++ b/tests/integration/test_keeper_nodes_add/configs/enable_keeper_three_nodes_2.xml\n@@ -15,17 +15,17 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n         </raft_configuration>\n     </keeper_server>\ndiff --git a/tests/integration/test_keeper_nodes_add/configs/enable_keeper_three_nodes_3.xml b/tests/integration/test_keeper_nodes_add/configs/enable_keeper_three_nodes_3.xml\nindex 7f9775939bb1..d261e4f67f3b 100644\n--- a/tests/integration/test_keeper_nodes_add/configs/enable_keeper_three_nodes_3.xml\n+++ b/tests/integration/test_keeper_nodes_add/configs/enable_keeper_three_nodes_3.xml\n@@ -15,17 +15,17 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n         </raft_configuration>\n     </keeper_server>\ndiff --git a/tests/integration/test_keeper_nodes_add/configs/enable_keeper_two_nodes_1.xml b/tests/integration/test_keeper_nodes_add/configs/enable_keeper_two_nodes_1.xml\nindex 3f6baf1ccc73..697986638d75 100644\n--- a/tests/integration/test_keeper_nodes_add/configs/enable_keeper_two_nodes_1.xml\n+++ b/tests/integration/test_keeper_nodes_add/configs/enable_keeper_two_nodes_1.xml\n@@ -15,12 +15,12 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n         </raft_configuration>\n     </keeper_server>\ndiff --git a/tests/integration/test_keeper_nodes_add/configs/enable_keeper_two_nodes_2.xml b/tests/integration/test_keeper_nodes_add/configs/enable_keeper_two_nodes_2.xml\nindex 61c9a00ffd6d..967940e1e2bf 100644\n--- a/tests/integration/test_keeper_nodes_add/configs/enable_keeper_two_nodes_2.xml\n+++ b/tests/integration/test_keeper_nodes_add/configs/enable_keeper_two_nodes_2.xml\n@@ -15,12 +15,12 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n         </raft_configuration>\n     </keeper_server>\ndiff --git a/tests/integration/test_keeper_nodes_move/configs/enable_keeper1.xml b/tests/integration/test_keeper_nodes_move/configs/enable_keeper1.xml\nindex a8a1a17b8317..1e57d42016d1 100644\n--- a/tests/integration/test_keeper_nodes_move/configs/enable_keeper1.xml\n+++ b/tests/integration/test_keeper_nodes_move/configs/enable_keeper1.xml\n@@ -15,18 +15,18 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <start_as_follower>true</start_as_follower>\n             </server>\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <start_as_follower>true</start_as_follower>\n             </server>\n         </raft_configuration>\ndiff --git a/tests/integration/test_keeper_nodes_move/configs/enable_keeper2.xml b/tests/integration/test_keeper_nodes_move/configs/enable_keeper2.xml\nindex 7820158680cf..98422b41c9b1 100644\n--- a/tests/integration/test_keeper_nodes_move/configs/enable_keeper2.xml\n+++ b/tests/integration/test_keeper_nodes_move/configs/enable_keeper2.xml\n@@ -15,18 +15,18 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <start_as_follower>true</start_as_follower>\n             </server>\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <start_as_follower>true</start_as_follower>\n             </server>\n         </raft_configuration>\ndiff --git a/tests/integration/test_keeper_nodes_move/configs/enable_keeper3.xml b/tests/integration/test_keeper_nodes_move/configs/enable_keeper3.xml\nindex cd76b0d216e6..43800bd2dfb6 100644\n--- a/tests/integration/test_keeper_nodes_move/configs/enable_keeper3.xml\n+++ b/tests/integration/test_keeper_nodes_move/configs/enable_keeper3.xml\n@@ -15,18 +15,18 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <start_as_follower>true</start_as_follower>\n             </server>\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <start_as_follower>true</start_as_follower>\n             </server>\n         </raft_configuration>\ndiff --git a/tests/integration/test_keeper_nodes_move/configs/enable_keeper_node4_1.xml b/tests/integration/test_keeper_nodes_move/configs/enable_keeper_node4_1.xml\nindex d99502e29595..0d7544f9a5b4 100644\n--- a/tests/integration/test_keeper_nodes_move/configs/enable_keeper_node4_1.xml\n+++ b/tests/integration/test_keeper_nodes_move/configs/enable_keeper_node4_1.xml\n@@ -15,18 +15,18 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <start_as_follower>true</start_as_follower>\n             </server>\n             <server>\n                 <id>4</id>\n                 <hostname>node4</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <start_as_follower>true</start_as_follower>\n             </server>\n         </raft_configuration>\ndiff --git a/tests/integration/test_keeper_nodes_move/configs/enable_keeper_node4_2.xml b/tests/integration/test_keeper_nodes_move/configs/enable_keeper_node4_2.xml\nindex 04d8776782fb..65feae85e3e6 100644\n--- a/tests/integration/test_keeper_nodes_move/configs/enable_keeper_node4_2.xml\n+++ b/tests/integration/test_keeper_nodes_move/configs/enable_keeper_node4_2.xml\n@@ -15,18 +15,18 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <start_as_follower>true</start_as_follower>\n             </server>\n             <server>\n                 <id>4</id>\n                 <hostname>node4</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <start_as_follower>true</start_as_follower>\n             </server>\n         </raft_configuration>\ndiff --git a/tests/integration/test_keeper_nodes_move/configs/enable_keeper_node4_4.xml b/tests/integration/test_keeper_nodes_move/configs/enable_keeper_node4_4.xml\nindex 10abf71b9f6e..2499de4fe869 100644\n--- a/tests/integration/test_keeper_nodes_move/configs/enable_keeper_node4_4.xml\n+++ b/tests/integration/test_keeper_nodes_move/configs/enable_keeper_node4_4.xml\n@@ -15,18 +15,18 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <start_as_follower>true</start_as_follower>\n             </server>\n             <server>\n                 <id>4</id>\n                 <hostname>node4</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <start_as_follower>true</start_as_follower>\n             </server>\n         </raft_configuration>\ndiff --git a/tests/integration/test_keeper_nodes_remove/configs/enable_keeper1.xml b/tests/integration/test_keeper_nodes_remove/configs/enable_keeper1.xml\nindex a8a1a17b8317..1e57d42016d1 100644\n--- a/tests/integration/test_keeper_nodes_remove/configs/enable_keeper1.xml\n+++ b/tests/integration/test_keeper_nodes_remove/configs/enable_keeper1.xml\n@@ -15,18 +15,18 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <start_as_follower>true</start_as_follower>\n             </server>\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <start_as_follower>true</start_as_follower>\n             </server>\n         </raft_configuration>\ndiff --git a/tests/integration/test_keeper_nodes_remove/configs/enable_keeper2.xml b/tests/integration/test_keeper_nodes_remove/configs/enable_keeper2.xml\nindex 7820158680cf..98422b41c9b1 100644\n--- a/tests/integration/test_keeper_nodes_remove/configs/enable_keeper2.xml\n+++ b/tests/integration/test_keeper_nodes_remove/configs/enable_keeper2.xml\n@@ -15,18 +15,18 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <start_as_follower>true</start_as_follower>\n             </server>\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <start_as_follower>true</start_as_follower>\n             </server>\n         </raft_configuration>\ndiff --git a/tests/integration/test_keeper_nodes_remove/configs/enable_keeper3.xml b/tests/integration/test_keeper_nodes_remove/configs/enable_keeper3.xml\nindex cd76b0d216e6..43800bd2dfb6 100644\n--- a/tests/integration/test_keeper_nodes_remove/configs/enable_keeper3.xml\n+++ b/tests/integration/test_keeper_nodes_remove/configs/enable_keeper3.xml\n@@ -15,18 +15,18 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <start_as_follower>true</start_as_follower>\n             </server>\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <start_as_follower>true</start_as_follower>\n             </server>\n         </raft_configuration>\ndiff --git a/tests/integration/test_keeper_nodes_remove/configs/enable_keeper_two_nodes_1.xml b/tests/integration/test_keeper_nodes_remove/configs/enable_keeper_two_nodes_1.xml\nindex 3f6baf1ccc73..697986638d75 100644\n--- a/tests/integration/test_keeper_nodes_remove/configs/enable_keeper_two_nodes_1.xml\n+++ b/tests/integration/test_keeper_nodes_remove/configs/enable_keeper_two_nodes_1.xml\n@@ -15,12 +15,12 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n         </raft_configuration>\n     </keeper_server>\ndiff --git a/tests/integration/test_keeper_nodes_remove/configs/enable_keeper_two_nodes_2.xml b/tests/integration/test_keeper_nodes_remove/configs/enable_keeper_two_nodes_2.xml\nindex 61c9a00ffd6d..967940e1e2bf 100644\n--- a/tests/integration/test_keeper_nodes_remove/configs/enable_keeper_two_nodes_2.xml\n+++ b/tests/integration/test_keeper_nodes_remove/configs/enable_keeper_two_nodes_2.xml\n@@ -15,12 +15,12 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n         </raft_configuration>\n     </keeper_server>\ndiff --git a/tests/integration/test_keeper_nodes_remove/configs/enable_single_keeper1.xml b/tests/integration/test_keeper_nodes_remove/configs/enable_single_keeper1.xml\nindex bd695389fa66..c1d38a1de52f 100644\n--- a/tests/integration/test_keeper_nodes_remove/configs/enable_single_keeper1.xml\n+++ b/tests/integration/test_keeper_nodes_remove/configs/enable_single_keeper1.xml\n@@ -15,7 +15,7 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n         </raft_configuration>\n     </keeper_server>\ndiff --git a/tests/integration/test_keeper_persistent_log/configs/enable_keeper.xml b/tests/integration/test_keeper_persistent_log/configs/enable_keeper.xml\nindex e302b857666d..d6166a83d2f9 100644\n--- a/tests/integration/test_keeper_persistent_log/configs/enable_keeper.xml\n+++ b/tests/integration/test_keeper_persistent_log/configs/enable_keeper.xml\n@@ -15,7 +15,7 @@\n             <server>\n                 <id>1</id>\n                 <hostname>localhost</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n         </raft_configuration>\n     </keeper_server>\ndiff --git a/tests/integration/test_keeper_persistent_log_multinode/configs/enable_keeper1.xml b/tests/integration/test_keeper_persistent_log_multinode/configs/enable_keeper1.xml\nindex 2ee384195816..06b70c1b5d05 100644\n--- a/tests/integration/test_keeper_persistent_log_multinode/configs/enable_keeper1.xml\n+++ b/tests/integration/test_keeper_persistent_log_multinode/configs/enable_keeper1.xml\n@@ -15,14 +15,14 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <priority>3</priority>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>2</priority>\n@@ -30,7 +30,7 @@\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>1</priority>\ndiff --git a/tests/integration/test_keeper_persistent_log_multinode/configs/enable_keeper2.xml b/tests/integration/test_keeper_persistent_log_multinode/configs/enable_keeper2.xml\nindex 018fa2848967..f13f8b902b44 100644\n--- a/tests/integration/test_keeper_persistent_log_multinode/configs/enable_keeper2.xml\n+++ b/tests/integration/test_keeper_persistent_log_multinode/configs/enable_keeper2.xml\n@@ -15,14 +15,14 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <priority>3</priority>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>2</priority>\n@@ -30,7 +30,7 @@\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>1</priority>\ndiff --git a/tests/integration/test_keeper_persistent_log_multinode/configs/enable_keeper3.xml b/tests/integration/test_keeper_persistent_log_multinode/configs/enable_keeper3.xml\nindex 77a1d720b692..a69cabf8c546 100644\n--- a/tests/integration/test_keeper_persistent_log_multinode/configs/enable_keeper3.xml\n+++ b/tests/integration/test_keeper_persistent_log_multinode/configs/enable_keeper3.xml\n@@ -15,14 +15,14 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <priority>3</priority>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>2</priority>\n@@ -30,7 +30,7 @@\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>1</priority>\ndiff --git a/tests/integration/test_keeper_remove_leader/configs/enable_keeper1.xml b/tests/integration/test_keeper_remove_leader/configs/enable_keeper1.xml\nnew file mode 100644\nindex 000000000000..1e57d42016d1\n--- /dev/null\n+++ b/tests/integration/test_keeper_remove_leader/configs/enable_keeper1.xml\n@@ -0,0 +1,34 @@\n+<clickhouse>\n+    <keeper_server>\n+        <tcp_port>9181</tcp_port>\n+        <server_id>1</server_id>\n+        <log_storage_path>/var/lib/clickhouse/coordination/log</log_storage_path>\n+        <snapshot_storage_path>/var/lib/clickhouse/coordination/snapshots</snapshot_storage_path>\n+\n+        <coordination_settings>\n+            <operation_timeout_ms>5000</operation_timeout_ms>\n+            <session_timeout_ms>10000</session_timeout_ms>\n+            <raft_logs_level>trace</raft_logs_level>\n+        </coordination_settings>\n+\n+        <raft_configuration>\n+            <server>\n+                <id>1</id>\n+                <hostname>node1</hostname>\n+                <port>9234</port>\n+            </server>\n+            <server>\n+                <id>2</id>\n+                <hostname>node2</hostname>\n+                <port>9234</port>\n+                <start_as_follower>true</start_as_follower>\n+            </server>\n+            <server>\n+                <id>3</id>\n+                <hostname>node3</hostname>\n+                <port>9234</port>\n+                <start_as_follower>true</start_as_follower>\n+            </server>\n+        </raft_configuration>\n+    </keeper_server>\n+</clickhouse>\ndiff --git a/tests/integration/test_keeper_remove_leader/configs/enable_keeper2.xml b/tests/integration/test_keeper_remove_leader/configs/enable_keeper2.xml\nnew file mode 100644\nindex 000000000000..98422b41c9b1\n--- /dev/null\n+++ b/tests/integration/test_keeper_remove_leader/configs/enable_keeper2.xml\n@@ -0,0 +1,34 @@\n+<clickhouse>\n+    <keeper_server>\n+        <tcp_port>9181</tcp_port>\n+        <server_id>2</server_id>\n+        <log_storage_path>/var/lib/clickhouse/coordination/log</log_storage_path>\n+        <snapshot_storage_path>/var/lib/clickhouse/coordination/snapshots</snapshot_storage_path>\n+\n+        <coordination_settings>\n+            <operation_timeout_ms>5000</operation_timeout_ms>\n+            <session_timeout_ms>10000</session_timeout_ms>\n+            <raft_logs_level>trace</raft_logs_level>\n+        </coordination_settings>\n+\n+        <raft_configuration>\n+            <server>\n+                <id>1</id>\n+                <hostname>node1</hostname>\n+                <port>9234</port>\n+            </server>\n+            <server>\n+                <id>2</id>\n+                <hostname>node2</hostname>\n+                <port>9234</port>\n+                <start_as_follower>true</start_as_follower>\n+            </server>\n+            <server>\n+                <id>3</id>\n+                <hostname>node3</hostname>\n+                <port>9234</port>\n+                <start_as_follower>true</start_as_follower>\n+            </server>\n+        </raft_configuration>\n+    </keeper_server>\n+</clickhouse>\ndiff --git a/tests/integration/test_keeper_remove_leader/configs/enable_keeper3.xml b/tests/integration/test_keeper_remove_leader/configs/enable_keeper3.xml\nnew file mode 100644\nindex 000000000000..43800bd2dfb6\n--- /dev/null\n+++ b/tests/integration/test_keeper_remove_leader/configs/enable_keeper3.xml\n@@ -0,0 +1,34 @@\n+<clickhouse>\n+    <keeper_server>\n+        <tcp_port>9181</tcp_port>\n+        <server_id>3</server_id>\n+        <log_storage_path>/var/lib/clickhouse/coordination/log</log_storage_path>\n+        <snapshot_storage_path>/var/lib/clickhouse/coordination/snapshots</snapshot_storage_path>\n+\n+        <coordination_settings>\n+            <operation_timeout_ms>5000</operation_timeout_ms>\n+            <session_timeout_ms>10000</session_timeout_ms>\n+            <raft_logs_level>trace</raft_logs_level>\n+        </coordination_settings>\n+\n+        <raft_configuration>\n+            <server>\n+                <id>1</id>\n+                <hostname>node1</hostname>\n+                <port>9234</port>\n+            </server>\n+            <server>\n+                <id>2</id>\n+                <hostname>node2</hostname>\n+                <port>9234</port>\n+                <start_as_follower>true</start_as_follower>\n+            </server>\n+            <server>\n+                <id>3</id>\n+                <hostname>node3</hostname>\n+                <port>9234</port>\n+                <start_as_follower>true</start_as_follower>\n+            </server>\n+        </raft_configuration>\n+    </keeper_server>\n+</clickhouse>\ndiff --git a/tests/integration/test_keeper_remove_leader/configs/enable_keeper_two_nodes_1.xml b/tests/integration/test_keeper_remove_leader/configs/enable_keeper_two_nodes_1.xml\nnew file mode 100644\nindex 000000000000..d51e420f7331\n--- /dev/null\n+++ b/tests/integration/test_keeper_remove_leader/configs/enable_keeper_two_nodes_1.xml\n@@ -0,0 +1,28 @@\n+<clickhouse>\n+    <keeper_server>\n+        <tcp_port>9181</tcp_port>\n+        <server_id>1</server_id>\n+        <log_storage_path>/var/lib/clickhouse/coordination/log</log_storage_path>\n+        <snapshot_storage_path>/var/lib/clickhouse/coordination/snapshots</snapshot_storage_path>\n+\n+        <coordination_settings>\n+            <operation_timeout_ms>5000</operation_timeout_ms>\n+            <session_timeout_ms>10000</session_timeout_ms>\n+            <raft_logs_level>trace</raft_logs_level>\n+        </coordination_settings>\n+\n+        <raft_configuration>\n+            <server>\n+                <id>2</id>\n+                <hostname>node2</hostname>\n+                <port>9234</port>\n+            </server>\n+            <server>\n+                <id>3</id>\n+                <hostname>node3</hostname>\n+                <port>9234</port>\n+                <start_as_follower>true</start_as_follower>\n+            </server>\n+        </raft_configuration>\n+    </keeper_server>\n+</clickhouse>\ndiff --git a/tests/integration/test_keeper_remove_leader/configs/enable_keeper_two_nodes_2.xml b/tests/integration/test_keeper_remove_leader/configs/enable_keeper_two_nodes_2.xml\nnew file mode 100644\nindex 000000000000..3f1ee1e01a8a\n--- /dev/null\n+++ b/tests/integration/test_keeper_remove_leader/configs/enable_keeper_two_nodes_2.xml\n@@ -0,0 +1,28 @@\n+<clickhouse>\n+    <keeper_server>\n+        <tcp_port>9181</tcp_port>\n+        <server_id>2</server_id>\n+        <log_storage_path>/var/lib/clickhouse/coordination/log</log_storage_path>\n+        <snapshot_storage_path>/var/lib/clickhouse/coordination/snapshots</snapshot_storage_path>\n+\n+        <coordination_settings>\n+            <operation_timeout_ms>5000</operation_timeout_ms>\n+            <session_timeout_ms>10000</session_timeout_ms>\n+            <raft_logs_level>trace</raft_logs_level>\n+        </coordination_settings>\n+\n+        <raft_configuration>\n+            <server>\n+                <id>2</id>\n+                <hostname>node2</hostname>\n+                <port>9234</port>\n+            </server>\n+            <server>\n+                <id>3</id>\n+                <hostname>node3</hostname>\n+                <port>9234</port>\n+                <start_as_follower>true</start_as_follower>\n+            </server>\n+        </raft_configuration>\n+    </keeper_server>\n+</clickhouse>\ndiff --git a/tests/integration/test_keeper_remove_leader/configs/enable_keeper_two_nodes_3.xml b/tests/integration/test_keeper_remove_leader/configs/enable_keeper_two_nodes_3.xml\nnew file mode 100644\nindex 000000000000..a99bd5d5296b\n--- /dev/null\n+++ b/tests/integration/test_keeper_remove_leader/configs/enable_keeper_two_nodes_3.xml\n@@ -0,0 +1,28 @@\n+<clickhouse>\n+    <keeper_server>\n+        <tcp_port>9181</tcp_port>\n+        <server_id>3</server_id>\n+        <log_storage_path>/var/lib/clickhouse/coordination/log</log_storage_path>\n+        <snapshot_storage_path>/var/lib/clickhouse/coordination/snapshots</snapshot_storage_path>\n+\n+        <coordination_settings>\n+            <operation_timeout_ms>5000</operation_timeout_ms>\n+            <session_timeout_ms>10000</session_timeout_ms>\n+            <raft_logs_level>trace</raft_logs_level>\n+        </coordination_settings>\n+\n+        <raft_configuration>\n+            <server>\n+                <id>2</id>\n+                <hostname>node2</hostname>\n+                <port>9234</port>\n+            </server>\n+            <server>\n+                <id>3</id>\n+                <hostname>node3</hostname>\n+                <port>9234</port>\n+                <start_as_follower>true</start_as_follower>\n+            </server>\n+        </raft_configuration>\n+    </keeper_server>\n+</clickhouse>\ndiff --git a/tests/integration/test_keeper_restore_from_snapshot/configs/enable_keeper1.xml b/tests/integration/test_keeper_restore_from_snapshot/configs/enable_keeper1.xml\nindex 6e838ed2a966..4ea543e6f31c 100644\n--- a/tests/integration/test_keeper_restore_from_snapshot/configs/enable_keeper1.xml\n+++ b/tests/integration/test_keeper_restore_from_snapshot/configs/enable_keeper1.xml\n@@ -18,14 +18,14 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <priority>70</priority>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>20</priority>\n@@ -33,7 +33,7 @@\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>10</priority>\ndiff --git a/tests/integration/test_keeper_restore_from_snapshot/configs/enable_keeper2.xml b/tests/integration/test_keeper_restore_from_snapshot/configs/enable_keeper2.xml\nindex 1ff565044e8f..4bf3083c1fab 100644\n--- a/tests/integration/test_keeper_restore_from_snapshot/configs/enable_keeper2.xml\n+++ b/tests/integration/test_keeper_restore_from_snapshot/configs/enable_keeper2.xml\n@@ -18,14 +18,14 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <priority>70</priority>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>20</priority>\n@@ -33,7 +33,7 @@\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>10</priority>\ndiff --git a/tests/integration/test_keeper_restore_from_snapshot/configs/enable_keeper3.xml b/tests/integration/test_keeper_restore_from_snapshot/configs/enable_keeper3.xml\nindex 8f022c22c3ce..b9e2a2d04225 100644\n--- a/tests/integration/test_keeper_restore_from_snapshot/configs/enable_keeper3.xml\n+++ b/tests/integration/test_keeper_restore_from_snapshot/configs/enable_keeper3.xml\n@@ -18,14 +18,14 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <priority>70</priority>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>20</priority>\n@@ -33,7 +33,7 @@\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>10</priority>\ndiff --git a/tests/integration/test_keeper_secure_client/configs/enable_secure_keeper.xml b/tests/integration/test_keeper_secure_client/configs/enable_secure_keeper.xml\nindex b8ef730c6ed6..2c144269bcc7 100644\n--- a/tests/integration/test_keeper_secure_client/configs/enable_secure_keeper.xml\n+++ b/tests/integration/test_keeper_secure_client/configs/enable_secure_keeper.xml\n@@ -17,7 +17,7 @@\n             <server>\n                 <id>1</id>\n                 <hostname>localhost</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n         </raft_configuration>\n     </keeper_server>\ndiff --git a/tests/integration/test_keeper_snapshot_small_distance/configs/keeper_config1.xml b/tests/integration/test_keeper_snapshot_small_distance/configs/keeper_config1.xml\nindex 1e9bea6c6063..ed5909d01eb7 100644\n--- a/tests/integration/test_keeper_snapshot_small_distance/configs/keeper_config1.xml\n+++ b/tests/integration/test_keeper_snapshot_small_distance/configs/keeper_config1.xml\n@@ -17,19 +17,19 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <priority>3</priority>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <priority>2</priority>\n             </server>\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <priority>1</priority>\n             </server>\n         </raft_configuration>\ndiff --git a/tests/integration/test_keeper_snapshot_small_distance/configs/keeper_config2.xml b/tests/integration/test_keeper_snapshot_small_distance/configs/keeper_config2.xml\nindex 4fc00055ff1c..896853a37138 100644\n--- a/tests/integration/test_keeper_snapshot_small_distance/configs/keeper_config2.xml\n+++ b/tests/integration/test_keeper_snapshot_small_distance/configs/keeper_config2.xml\n@@ -17,19 +17,19 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <priority>3</priority>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <priority>2</priority>\n             </server>\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <priority>1</priority>\n             </server>\n         </raft_configuration>\ndiff --git a/tests/integration/test_keeper_snapshot_small_distance/configs/keeper_config3.xml b/tests/integration/test_keeper_snapshot_small_distance/configs/keeper_config3.xml\nindex 89134440aa34..8d1d5c73dd80 100644\n--- a/tests/integration/test_keeper_snapshot_small_distance/configs/keeper_config3.xml\n+++ b/tests/integration/test_keeper_snapshot_small_distance/configs/keeper_config3.xml\n@@ -17,19 +17,19 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <priority>3</priority>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <priority>2</priority>\n             </server>\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <priority>1</priority>\n             </server>\n         </raft_configuration>\ndiff --git a/tests/integration/test_keeper_snapshots/configs/enable_keeper.xml b/tests/integration/test_keeper_snapshots/configs/enable_keeper.xml\nindex 15db48f4f371..a3217b34501e 100644\n--- a/tests/integration/test_keeper_snapshots/configs/enable_keeper.xml\n+++ b/tests/integration/test_keeper_snapshots/configs/enable_keeper.xml\n@@ -22,7 +22,7 @@\n             <server>\n                 <id>1</id>\n                 <hostname>localhost</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n         </raft_configuration>\n     </keeper_server>\ndiff --git a/tests/integration/test_keeper_snapshots_multinode/configs/enable_keeper1.xml b/tests/integration/test_keeper_snapshots_multinode/configs/enable_keeper1.xml\nindex 759d3e7415bc..27d0d38f5964 100644\n--- a/tests/integration/test_keeper_snapshots_multinode/configs/enable_keeper1.xml\n+++ b/tests/integration/test_keeper_snapshots_multinode/configs/enable_keeper1.xml\n@@ -17,14 +17,14 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <priority>3</priority>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>2</priority>\n@@ -32,7 +32,7 @@\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>1</priority>\ndiff --git a/tests/integration/test_keeper_snapshots_multinode/configs/enable_keeper2.xml b/tests/integration/test_keeper_snapshots_multinode/configs/enable_keeper2.xml\nindex d4b2296d54db..dedbd3125445 100644\n--- a/tests/integration/test_keeper_snapshots_multinode/configs/enable_keeper2.xml\n+++ b/tests/integration/test_keeper_snapshots_multinode/configs/enable_keeper2.xml\n@@ -17,14 +17,14 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <priority>3</priority>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>2</priority>\n@@ -32,7 +32,7 @@\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>1</priority>\ndiff --git a/tests/integration/test_keeper_snapshots_multinode/configs/enable_keeper3.xml b/tests/integration/test_keeper_snapshots_multinode/configs/enable_keeper3.xml\nindex 37fa4e8b3b79..fd36458b5eb2 100644\n--- a/tests/integration/test_keeper_snapshots_multinode/configs/enable_keeper3.xml\n+++ b/tests/integration/test_keeper_snapshots_multinode/configs/enable_keeper3.xml\n@@ -17,14 +17,14 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <priority>3</priority>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>2</priority>\n@@ -32,7 +32,7 @@\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>1</priority>\ndiff --git a/tests/integration/test_keeper_start_as_follower_multinode/configs/enable_keeper1.xml b/tests/integration/test_keeper_start_as_follower_multinode/configs/enable_keeper1.xml\nnew file mode 100644\nindex 000000000000..1e57d42016d1\n--- /dev/null\n+++ b/tests/integration/test_keeper_start_as_follower_multinode/configs/enable_keeper1.xml\n@@ -0,0 +1,34 @@\n+<clickhouse>\n+    <keeper_server>\n+        <tcp_port>9181</tcp_port>\n+        <server_id>1</server_id>\n+        <log_storage_path>/var/lib/clickhouse/coordination/log</log_storage_path>\n+        <snapshot_storage_path>/var/lib/clickhouse/coordination/snapshots</snapshot_storage_path>\n+\n+        <coordination_settings>\n+            <operation_timeout_ms>5000</operation_timeout_ms>\n+            <session_timeout_ms>10000</session_timeout_ms>\n+            <raft_logs_level>trace</raft_logs_level>\n+        </coordination_settings>\n+\n+        <raft_configuration>\n+            <server>\n+                <id>1</id>\n+                <hostname>node1</hostname>\n+                <port>9234</port>\n+            </server>\n+            <server>\n+                <id>2</id>\n+                <hostname>node2</hostname>\n+                <port>9234</port>\n+                <start_as_follower>true</start_as_follower>\n+            </server>\n+            <server>\n+                <id>3</id>\n+                <hostname>node3</hostname>\n+                <port>9234</port>\n+                <start_as_follower>true</start_as_follower>\n+            </server>\n+        </raft_configuration>\n+    </keeper_server>\n+</clickhouse>\ndiff --git a/tests/integration/test_keeper_start_as_follower_multinode/configs/enable_keeper2.xml b/tests/integration/test_keeper_start_as_follower_multinode/configs/enable_keeper2.xml\nnew file mode 100644\nindex 000000000000..98422b41c9b1\n--- /dev/null\n+++ b/tests/integration/test_keeper_start_as_follower_multinode/configs/enable_keeper2.xml\n@@ -0,0 +1,34 @@\n+<clickhouse>\n+    <keeper_server>\n+        <tcp_port>9181</tcp_port>\n+        <server_id>2</server_id>\n+        <log_storage_path>/var/lib/clickhouse/coordination/log</log_storage_path>\n+        <snapshot_storage_path>/var/lib/clickhouse/coordination/snapshots</snapshot_storage_path>\n+\n+        <coordination_settings>\n+            <operation_timeout_ms>5000</operation_timeout_ms>\n+            <session_timeout_ms>10000</session_timeout_ms>\n+            <raft_logs_level>trace</raft_logs_level>\n+        </coordination_settings>\n+\n+        <raft_configuration>\n+            <server>\n+                <id>1</id>\n+                <hostname>node1</hostname>\n+                <port>9234</port>\n+            </server>\n+            <server>\n+                <id>2</id>\n+                <hostname>node2</hostname>\n+                <port>9234</port>\n+                <start_as_follower>true</start_as_follower>\n+            </server>\n+            <server>\n+                <id>3</id>\n+                <hostname>node3</hostname>\n+                <port>9234</port>\n+                <start_as_follower>true</start_as_follower>\n+            </server>\n+        </raft_configuration>\n+    </keeper_server>\n+</clickhouse>\ndiff --git a/tests/integration/test_keeper_start_as_follower_multinode/configs/enable_keeper3.xml b/tests/integration/test_keeper_start_as_follower_multinode/configs/enable_keeper3.xml\nnew file mode 100644\nindex 000000000000..43800bd2dfb6\n--- /dev/null\n+++ b/tests/integration/test_keeper_start_as_follower_multinode/configs/enable_keeper3.xml\n@@ -0,0 +1,34 @@\n+<clickhouse>\n+    <keeper_server>\n+        <tcp_port>9181</tcp_port>\n+        <server_id>3</server_id>\n+        <log_storage_path>/var/lib/clickhouse/coordination/log</log_storage_path>\n+        <snapshot_storage_path>/var/lib/clickhouse/coordination/snapshots</snapshot_storage_path>\n+\n+        <coordination_settings>\n+            <operation_timeout_ms>5000</operation_timeout_ms>\n+            <session_timeout_ms>10000</session_timeout_ms>\n+            <raft_logs_level>trace</raft_logs_level>\n+        </coordination_settings>\n+\n+        <raft_configuration>\n+            <server>\n+                <id>1</id>\n+                <hostname>node1</hostname>\n+                <port>9234</port>\n+            </server>\n+            <server>\n+                <id>2</id>\n+                <hostname>node2</hostname>\n+                <port>9234</port>\n+                <start_as_follower>true</start_as_follower>\n+            </server>\n+            <server>\n+                <id>3</id>\n+                <hostname>node3</hostname>\n+                <port>9234</port>\n+                <start_as_follower>true</start_as_follower>\n+            </server>\n+        </raft_configuration>\n+    </keeper_server>\n+</clickhouse>\ndiff --git a/tests/integration/test_keeper_three_nodes_start/configs/enable_keeper1.xml b/tests/integration/test_keeper_three_nodes_start/configs/enable_keeper1.xml\nindex bc62d817074f..d21593485881 100644\n--- a/tests/integration/test_keeper_three_nodes_start/configs/enable_keeper1.xml\n+++ b/tests/integration/test_keeper_three_nodes_start/configs/enable_keeper1.xml\n@@ -15,17 +15,17 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>3</id>\n                 <hostname>non_existing_node</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n         </raft_configuration>\n     </keeper_server>\ndiff --git a/tests/integration/test_keeper_three_nodes_start/configs/enable_keeper2.xml b/tests/integration/test_keeper_three_nodes_start/configs/enable_keeper2.xml\nindex a6c476fb4490..0d9aeb191d9f 100644\n--- a/tests/integration/test_keeper_three_nodes_start/configs/enable_keeper2.xml\n+++ b/tests/integration/test_keeper_three_nodes_start/configs/enable_keeper2.xml\n@@ -15,17 +15,17 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>3</id>\n                 <hostname>non_existing_node</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n         </raft_configuration>\n     </keeper_server>\ndiff --git a/tests/integration/test_keeper_three_nodes_two_alive/configs/enable_keeper1.xml b/tests/integration/test_keeper_three_nodes_two_alive/configs/enable_keeper1.xml\nindex 510424715c48..d2717283a8d0 100644\n--- a/tests/integration/test_keeper_three_nodes_two_alive/configs/enable_keeper1.xml\n+++ b/tests/integration/test_keeper_three_nodes_two_alive/configs/enable_keeper1.xml\n@@ -15,17 +15,17 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n         </raft_configuration>\n     </keeper_server>\ndiff --git a/tests/integration/test_keeper_three_nodes_two_alive/configs/enable_keeper2.xml b/tests/integration/test_keeper_three_nodes_two_alive/configs/enable_keeper2.xml\nindex 264601d8c984..5924ee1c2dc7 100644\n--- a/tests/integration/test_keeper_three_nodes_two_alive/configs/enable_keeper2.xml\n+++ b/tests/integration/test_keeper_three_nodes_two_alive/configs/enable_keeper2.xml\n@@ -15,17 +15,17 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n         </raft_configuration>\n     </keeper_server>\ndiff --git a/tests/integration/test_keeper_three_nodes_two_alive/configs/enable_keeper3.xml b/tests/integration/test_keeper_three_nodes_two_alive/configs/enable_keeper3.xml\nindex 7f9775939bb1..d261e4f67f3b 100644\n--- a/tests/integration/test_keeper_three_nodes_two_alive/configs/enable_keeper3.xml\n+++ b/tests/integration/test_keeper_three_nodes_two_alive/configs/enable_keeper3.xml\n@@ -15,17 +15,17 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n             <server>\n                 <id>3</id>\n                 <hostname>node3</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n         </raft_configuration>\n     </keeper_server>\ndiff --git a/tests/integration/test_keeper_two_nodes_cluster/configs/enable_keeper1.xml b/tests/integration/test_keeper_two_nodes_cluster/configs/enable_keeper1.xml\nindex 70626b331300..7c2e283e89f9 100644\n--- a/tests/integration/test_keeper_two_nodes_cluster/configs/enable_keeper1.xml\n+++ b/tests/integration/test_keeper_two_nodes_cluster/configs/enable_keeper1.xml\n@@ -16,14 +16,14 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <priority>3</priority>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>2</priority>\ndiff --git a/tests/integration/test_keeper_two_nodes_cluster/configs/enable_keeper2.xml b/tests/integration/test_keeper_two_nodes_cluster/configs/enable_keeper2.xml\nindex 96068de33a9f..618e6a04aec0 100644\n--- a/tests/integration/test_keeper_two_nodes_cluster/configs/enable_keeper2.xml\n+++ b/tests/integration/test_keeper_two_nodes_cluster/configs/enable_keeper2.xml\n@@ -16,14 +16,14 @@\n             <server>\n                 <id>1</id>\n                 <hostname>node1</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <priority>3</priority>\n             </server>\n             <server>\n                 <id>2</id>\n                 <hostname>node2</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n                 <can_become_leader>true</can_become_leader>\n                 <start_as_follower>true</start_as_follower>\n                 <priority>2</priority>\ndiff --git a/tests/integration/test_keeper_zookeeper_converter/configs/keeper_config.xml b/tests/integration/test_keeper_zookeeper_converter/configs/keeper_config.xml\nindex 612cb979bb7d..9b50f2c6c419 100644\n--- a/tests/integration/test_keeper_zookeeper_converter/configs/keeper_config.xml\n+++ b/tests/integration/test_keeper_zookeeper_converter/configs/keeper_config.xml\n@@ -16,7 +16,7 @@\n             <server>\n                 <id>1</id>\n                 <hostname>localhost</hostname>\n-                <port>44444</port>\n+                <port>9234</port>\n             </server>\n         </raft_configuration>\n     </keeper_server>\n",
  "problem_statement": "clickhouse-keeper is using port 44444 by default that can be randomly allocated by other applications\n(you don't have to strictly follow this form)\r\n\r\n**Describe the issue**\r\n`<Error> RaftInstance: got exception: bind: Address already in use`\r\n\r\nIt does not say what address is already in use.\r\n\r\nIt is:\r\n\r\n```\r\n$ cat config.d/keeper_port.xml \r\n<clickhouse>\r\n    <keeper_server>\r\n        <tcp_port>9181</tcp_port>\r\n        <server_id>1</server_id>\r\n\r\n        <coordination_settings>\r\n            <operation_timeout_ms>10000</operation_timeout_ms>\r\n            <session_timeout_ms>30000</session_timeout_ms>\r\n            <force_sync>false</force_sync>\r\n            <startup_timeout>240000</startup_timeout>\r\n            <!-- we want all logs for complex problems investigation -->\r\n            <reserved_log_items>1000000000000000</reserved_log_items>\r\n            <snapshot_distance>10000</snapshot_distance>\r\n\r\n            <!-- For instant start in single node configuration -->\r\n            <heart_beat_interval_ms>0</heart_beat_interval_ms>\r\n            <election_timeout_lower_bound_ms>0</election_timeout_lower_bound_ms>\r\n            <election_timeout_upper_bound_ms>0</election_timeout_upper_bound_ms>\r\n        </coordination_settings>\r\n\r\n        <raft_configuration>\r\n            <server>\r\n                <id>1</id>\r\n                <hostname>localhost</hostname>\r\n                <port>44444</port>\r\n            </server>\r\n        </raft_configuration>\r\n    </keeper_server>\r\n</clickhouse>\r\n```\r\n\r\n`netstat -n | grep 44444`\r\n\r\nLooks like that this port is used by my Firefox browser.\n",
  "hints_text": "https://en.wikipedia.org/wiki/Ephemeral_port\r\n\r\n> Many Linux kernels use the port range 32768\u201360999.\r\n\r\nIt can be tuned via `/proc/sys/net/ipv4/ip_local_port_range`\r\n\r\nBut we should respect system defaults.\nyes  that's a problem, should be configure in conf file.\nLet's change to 9234.\nAlso note that on many highly-loaded systems users extend the ephemeral port range.",
  "created_at": "2021-11-25T14:02:48Z"
}