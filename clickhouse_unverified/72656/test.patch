diff --git a/tests/queries/0_stateless/03277_http_response_headers.reference b/tests/queries/0_stateless/03277_http_response_headers.reference
new file mode 100644
index 000000000000..57a820de8f5f
--- /dev/null
+++ b/tests/queries/0_stateless/03277_http_response_headers.reference
@@ -0,0 +1,17 @@
+We can add a new header:
+> POST /?http_response_headers={'My-New-Header':'Hello,+world.'} HTTP/1.1
+< My-New-Header: Hello, world.
+It works even with the settings clause:
+< My-New-Header: Hello, world.
+Check the default header value:
+> Content-Type: application/x-www-form-urlencoded
+< Content-Type: text/tab-separated-values; charset=UTF-8
+Check that we can override it:
+> POST /?http_response_headers={'Content-Type':'image/png'} HTTP/1.1
+> Content-Type: application/x-www-form-urlencoded
+< Content-Type: image/png
+It does not allow bad characters:
+BAD_ARGUMENTS
+BAD_ARGUMENTS
+It does not let duplicate entries:
+BAD_ARGUMENTS
diff --git a/tests/queries/0_stateless/03277_http_response_headers.sh b/tests/queries/0_stateless/03277_http_response_headers.sh
new file mode 100755
index 000000000000..f5f0223bf94a
--- /dev/null
+++ b/tests/queries/0_stateless/03277_http_response_headers.sh
@@ -0,0 +1,24 @@
+#!/usr/bin/env bash
+
+CUR_DIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
+# shellcheck source=../shell_config.sh
+. "$CUR_DIR"/../shell_config.sh
+
+echo "We can add a new header:"
+${CLICKHOUSE_CURL} -sS --globoff -v "http://localhost:8123/?http_response_headers={'My-New-Header':'Hello,+world.'}" -d "SELECT 1" 2>&1 | grep -i 'My-New'
+
+echo "It works even with the settings clause:"
+${CLICKHOUSE_CURL} -sS --globoff -v "http://localhost:8123/" -d "SELECT 1 SETTINGS http_response_headers = \$\${'My-New-Header':'Hello, world.'}\$\$" 2>&1 | grep -i 'My-New'
+
+echo "Check the default header value:"
+${CLICKHOUSE_CURL} -sS --globoff -v "http://localhost:8123/" -d "SELECT 1" 2>&1 | grep -i 'Content-Type'
+
+echo "Check that we can override it:"
+${CLICKHOUSE_CURL} -sS --globoff -v "http://localhost:8123/?http_response_headers={'Content-Type':'image/png'}" -d "SELECT 1" 2>&1 | grep -i 'Content-Type'
+
+echo "It does not allow bad characters:"
+${CLICKHOUSE_CURL} -sS --globoff -v "http://localhost:8123/" -d "SELECT 1 SETTINGS http_response_headers = \$\${'My-New-Header':'Hello,

world.'}\$\$" 2>&1 | grep -o -F 'BAD_ARGUMENTS'
+${CLICKHOUSE_CURL} -sS --globoff -v "http://localhost:8123/" -d "SELECT 1 SETTINGS http_response_headers = \$\${'My\rNew-Header':'Hello, world.'}\$\$" 2>&1 | grep -o -F 'BAD_ARGUMENTS'
+
+echo "It does not let duplicate entries:"
+${CLICKHOUSE_CURL} -sS --globoff -v "http://localhost:8123/" -d "SELECT 1 SETTINGS http_response_headers = \$\${'a':'b','a':'c'}\$\$" 2>&1 | grep -o -F 'BAD_ARGUMENTS'
