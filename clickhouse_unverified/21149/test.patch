diff --git a/tests/queries/1_stateful/00161_parallel_parsing_with_names.reference b/tests/queries/1_stateful/00161_parallel_parsing_with_names.reference
new file mode 100644
index 000000000000..fb0ba75c1485
--- /dev/null
+++ b/tests/queries/1_stateful/00161_parallel_parsing_with_names.reference
@@ -0,0 +1,8 @@
+TSVWithNames, false
+29caf86494f169d6339f6c5610b20731  -
+TSVWithNames, true
+29caf86494f169d6339f6c5610b20731  -
+CSVWithNames, false
+29caf86494f169d6339f6c5610b20731  -
+CSVWithNames, true
+29caf86494f169d6339f6c5610b20731  -
diff --git a/tests/queries/1_stateful/00161_parallel_parsing_with_names.sh b/tests/queries/1_stateful/00161_parallel_parsing_with_names.sh
new file mode 100755
index 000000000000..ca9984900e19
--- /dev/null
+++ b/tests/queries/1_stateful/00161_parallel_parsing_with_names.sh
@@ -0,0 +1,32 @@
+#!/usr/bin/env bash
+
+CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
+# shellcheck source=../shell_config.sh
+. "$CURDIR"/../shell_config.sh
+
+FORMATS=('TSVWithNames' 'CSVWithNames')
+$CLICKHOUSE_CLIENT -q "DROP TABLE IF EXISTS parsing_with_names"
+
+for format in "${FORMATS[@]}"
+do
+    # Columns are permuted
+    $CLICKHOUSE_CLIENT -q "CREATE TABLE parsing_with_names(c FixedString(16), a DateTime,  b String) ENGINE=Memory()"
+    
+    echo "$format, false";
+    $CLICKHOUSE_CLIENT --output_format_parallel_formatting=false -q \
+    "SELECT URLRegions as d, ClientEventTime as a, MobilePhoneModel as b, ParamPrice as e, ClientIP6 as c FROM test.hits LIMIT 50000 Format $format" | \
+    $CLICKHOUSE_CLIENT --input_format_skip_unknown_fields=1 --input_format_parallel_parsing=false -q "INSERT INTO parsing_with_names FORMAT $format"
+
+    $CLICKHOUSE_CLIENT -q "SELECT * FROM parsing_with_names;" | md5sum
+    $CLICKHOUSE_CLIENT -q "DROP TABLE IF EXISTS parsing_with_names"
+
+    
+    $CLICKHOUSE_CLIENT -q "CREATE TABLE parsing_with_names(c FixedString(16), a DateTime,  b String) ENGINE=Memory()"
+    echo "$format, true";
+    $CLICKHOUSE_CLIENT --output_format_parallel_formatting=false -q \
+    "SELECT URLRegions as d, ClientEventTime as a, MobilePhoneModel as b, ParamPrice as e, ClientIP6 as c FROM test.hits LIMIT 50000 Format $format" | \
+    $CLICKHOUSE_CLIENT --input_format_skip_unknown_fields=1 --input_format_parallel_parsing=true -q "INSERT INTO parsing_with_names FORMAT $format"
+
+    $CLICKHOUSE_CLIENT -q "SELECT * FROM parsing_with_names;" | md5sum
+    $CLICKHOUSE_CLIENT -q "DROP TABLE IF EXISTS parsing_with_names"
+done
\ No newline at end of file
