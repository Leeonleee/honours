diff --git a/.github/workflows/backport_branches.yml b/.github/workflows/backport_branches.yml
index d69168b01ee5..a9503136b1ae 100644
--- a/.github/workflows/backport_branches.yml
+++ b/.github/workflows/backport_branches.yml
@@ -76,6 +76,7 @@ jobs:
         uses: ClickHouse/checkout@v1
         with:
           clear-repository: true
+          fetch-depth: 0  # to find ancestor merge commits necessary for finding proper docker tags
       - name: Download changed aarch64 images
         uses: actions/download-artifact@v3
         with:
diff --git a/.github/workflows/docs_check.yml b/.github/workflows/docs_check.yml
index a0d0e49b95b8..a6be21fb14ae 100644
--- a/.github/workflows/docs_check.yml
+++ b/.github/workflows/docs_check.yml
@@ -73,6 +73,7 @@ jobs:
         uses: ClickHouse/checkout@v1
         with:
           clear-repository: true
+          fetch-depth: 0  # to find ancestor merge commits necessary for finding proper docker tags
       - name: Download changed aarch64 images
         uses: actions/download-artifact@v3
         with:
diff --git a/.github/workflows/master.yml b/.github/workflows/master.yml
index 93ef4aa9da3c..0a21fb93beb5 100644
--- a/.github/workflows/master.yml
+++ b/.github/workflows/master.yml
@@ -60,6 +60,7 @@ jobs:
         uses: ClickHouse/checkout@v1
         with:
           clear-repository: true
+          fetch-depth: 0  # to find ancestor merge commits necessary for finding proper docker tags
       - name: Download changed aarch64 images
         uses: actions/download-artifact@v3
         with:
diff --git a/.github/workflows/nightly.yml b/.github/workflows/nightly.yml
index 9de0444bd837..8162dc37223e 100644
--- a/.github/workflows/nightly.yml
+++ b/.github/workflows/nightly.yml
@@ -53,6 +53,7 @@ jobs:
         uses: ClickHouse/checkout@v1
         with:
           clear-repository: true
+          fetch-depth: 0  # to find ancestor merge commits necessary for finding proper docker tags
       - name: Download changed aarch64 images
         uses: actions/download-artifact@v3
         with:
diff --git a/.github/workflows/pull_request.yml b/.github/workflows/pull_request.yml
index ce135846dd5b..3845ebdcac74 100644
--- a/.github/workflows/pull_request.yml
+++ b/.github/workflows/pull_request.yml
@@ -94,6 +94,7 @@ jobs:
         uses: ClickHouse/checkout@v1
         with:
           clear-repository: true
+          fetch-depth: 0  # to find ancestor merge commits necessary for finding proper docker tags
       - name: Download changed aarch64 images
         uses: actions/download-artifact@v3
         with:
diff --git a/.github/workflows/release_branches.yml b/.github/workflows/release_branches.yml
index 212848155831..6d999d1bee76 100644
--- a/.github/workflows/release_branches.yml
+++ b/.github/workflows/release_branches.yml
@@ -52,6 +52,7 @@ jobs:
         uses: ClickHouse/checkout@v1
         with:
           clear-repository: true
+          fetch-depth: 0  # to find ancestor merge commits necessary for finding proper docker tags
       - name: Download changed aarch64 images
         uses: actions/download-artifact@v3
         with:
