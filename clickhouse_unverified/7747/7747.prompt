You will be provided with a partial code base and an issue statement explaining a problem to resolve.

<issue>
arraySplit usage lead to: Data compressed with different methods exception
```
Exception on client:
Code: 271. DB::Exception: Data compressed with different methods, given method byte 00, previous method byte 82: while receiving packet from localhost:9000
```
</issue>

I need you to solve the provided issue by generating a code fix that can be applied directly to the repository

Respond below:
