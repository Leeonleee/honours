You will be provided with a partial code base and an issue statement explaining a problem to resolve.

<issue>
Support complex types as map key
Currently OLAP systems like Spark and Presto supports complex types(array/map/tuple) as map key, but CH do not. 

I'm glad to contribute to it if you guys agree with this proposal.
</issue>

I need you to solve the provided issue by generating a code fix that can be applied directly to the repository

Respond below:
