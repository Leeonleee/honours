{
  "repo": "ClickHouse/ClickHouse",
  "pull_number": 80140,
  "instance_id": "ClickHouse__ClickHouse-80140",
  "issue_numbers": [
    "79302"
  ],
  "base_commit": "95072a27324043c0e07100230ef85fe58972a06e",
  "patch": "diff --git a/ci/jobs/scripts/check_style/check-settings-style b/ci/jobs/scripts/check_style/check-settings-style\nindex c07e4d4a3c33..228da45c3eb2 100755\n--- a/ci/jobs/scripts/check_style/check-settings-style\n+++ b/ci/jobs/scripts/check_style/check-settings-style\n@@ -69,7 +69,7 @@ done\n # previous releases, which is more important than consistency\n for setting in $(\n       awk '{ gsub(/^.*Settings/, \"\", $2); print $1 \" \" $2}' \"${SETTINGS_FILE}\" | \\\n-      sort | uniq | awk '{ print $1 }' | uniq -d | grep -v \"connect_timeout\" | grep -v \"max_connections\"\n+      sort | uniq | awk '{ print $1 }' | uniq -d | grep -v \"connect_timeout\" | grep -v \"max_connections\" | grep -v \"max_block_size\"\n     );\n do\n     echo \"# Found multiple definitions of setting ${setting} with different types: \"\ndiff --git a/programs/keeper-bench/Runner.cpp b/programs/keeper-bench/Runner.cpp\nindex 03a9bb43ab3b..32764bfdc611 100644\n--- a/programs/keeper-bench/Runner.cpp\n+++ b/programs/keeper-bench/Runner.cpp\n@@ -41,7 +41,7 @@ namespace CurrentMetrics\n \n namespace DB::Setting\n {\n-    extern const SettingsUInt64 max_block_size;\n+    extern const SettingsNonZeroUInt64 max_block_size;\n }\n \n namespace DB::ErrorCodes\ndiff --git a/src/Client/ClientBase.cpp b/src/Client/ClientBase.cpp\nindex 3ad3038ef315..70ad08e4b630 100644\n--- a/src/Client/ClientBase.cpp\n+++ b/src/Client/ClientBase.cpp\n@@ -104,7 +104,7 @@ namespace Setting\n     extern const SettingsBool allow_settings_after_format_in_insert;\n     extern const SettingsBool async_insert;\n     extern const SettingsDialect dialect;\n-    extern const SettingsUInt64 max_block_size;\n+    extern const SettingsNonZeroUInt64 max_block_size;\n     extern const SettingsUInt64 max_insert_block_size;\n     extern const SettingsUInt64 max_parser_backtracks;\n     extern const SettingsUInt64 max_parser_depth;\ndiff --git a/src/Core/Settings.cpp b/src/Core/Settings.cpp\nindex 23095bec0cb3..c99b19c13e1f 100644\n--- a/src/Core/Settings.cpp\n+++ b/src/Core/Settings.cpp\n@@ -103,7 +103,7 @@ This is an expert-level setting, and you shouldn't change it if you're just gett\n \n Don't confuse blocks for compression (a chunk of memory consisting of bytes) with blocks for query processing (a set of rows from a table).\n )\", 0) \\\n-    DECLARE(UInt64, max_block_size, DEFAULT_BLOCK_SIZE, R\"(\n+    DECLARE(NonZeroUInt64, max_block_size, DEFAULT_BLOCK_SIZE, R\"(\n In ClickHouse, data is processed by blocks, which are sets of column parts. The internal processing cycles for a single block are efficient but there are noticeable costs when processing each block.\n \n The `max_block_size` setting indicates the recommended maximum number of rows to include in a single block when loading data from tables. Blocks the size of `max_block_size` are not always loaded from the table: if ClickHouse determines that less data needs to be retrieved, a smaller block is processed.\ndiff --git a/src/Core/SettingsQuirks.cpp b/src/Core/SettingsQuirks.cpp\nindex 236887f1496d..2793973a9f32 100644\n--- a/src/Core/SettingsQuirks.cpp\n+++ b/src/Core/SettingsQuirks.cpp\n@@ -53,7 +53,7 @@ namespace Setting\n     extern const SettingsBool async_query_sending_for_remote;\n     extern const SettingsBool async_socket_for_remote;\n     extern const SettingsUInt64 input_format_parquet_max_block_size;\n-    extern const SettingsUInt64 max_block_size;\n+    extern const SettingsNonZeroUInt64 max_block_size;\n     extern const SettingsUInt64 max_insert_block_size;\n     extern const SettingsUInt64 min_insert_block_size_rows;\n     extern const SettingsUInt64 min_insert_block_size_bytes_for_materialized_views;\ndiff --git a/src/Interpreters/InterpreterInsertQuery.cpp b/src/Interpreters/InterpreterInsertQuery.cpp\nindex 88df8d1eaf2f..b319c42dbabd 100644\n--- a/src/Interpreters/InterpreterInsertQuery.cpp\n+++ b/src/Interpreters/InterpreterInsertQuery.cpp\n@@ -72,7 +72,7 @@ namespace Setting\n     extern const SettingsMaxThreads max_threads;\n     extern const SettingsUInt64 max_insert_threads;\n     extern const SettingsUInt64 min_insert_block_size_rows;\n-    extern const SettingsUInt64 max_block_size;\n+    extern const SettingsNonZeroUInt64 max_block_size;\n     extern const SettingsUInt64 preferred_block_size_bytes;\n     extern const SettingsUInt64 min_insert_block_size_bytes;\n     extern const SettingsString insert_deduplication_token;\ndiff --git a/src/Interpreters/InterpreterSelectQuery.cpp b/src/Interpreters/InterpreterSelectQuery.cpp\nindex 8cf1c9dd377d..a1c4e5b42d8f 100644\n--- a/src/Interpreters/InterpreterSelectQuery.cpp\n+++ b/src/Interpreters/InterpreterSelectQuery.cpp\n@@ -141,7 +141,7 @@ namespace Setting\n     extern const SettingsBool group_by_use_nulls;\n     extern const SettingsSeconds lock_acquire_timeout;\n     extern const SettingsUInt64 max_analyze_depth;\n-    extern const SettingsUInt64 max_block_size;\n+    extern const SettingsNonZeroUInt64 max_block_size;\n     extern const SettingsUInt64 max_bytes_in_distinct;\n     extern const SettingsUInt64 max_columns_to_read;\n     extern const SettingsUInt64 max_distributed_connections;\ndiff --git a/src/Interpreters/InterpreterWatchQuery.cpp b/src/Interpreters/InterpreterWatchQuery.cpp\nindex 28c97797ee58..fce80c8a8180 100644\n--- a/src/Interpreters/InterpreterWatchQuery.cpp\n+++ b/src/Interpreters/InterpreterWatchQuery.cpp\n@@ -28,7 +28,7 @@ namespace Setting\n {\n     extern const SettingsBool allow_experimental_live_view;\n     extern const SettingsBool allow_experimental_window_view;\n-    extern const SettingsUInt64 max_block_size;\n+    extern const SettingsNonZeroUInt64 max_block_size;\n     extern const SettingsUInt64 max_columns_to_read;\n     extern const SettingsUInt64 max_result_bytes;\n     extern const SettingsUInt64 max_result_rows;\ndiff --git a/src/Interpreters/JoinInfo.cpp b/src/Interpreters/JoinInfo.cpp\nindex 44e137057df5..8a4117685a54 100644\n--- a/src/Interpreters/JoinInfo.cpp\n+++ b/src/Interpreters/JoinInfo.cpp\n@@ -21,7 +21,7 @@ namespace ErrorCodes\n namespace Setting\n {\n     extern const SettingsJoinAlgorithm join_algorithm;\n-    extern const SettingsUInt64 max_block_size;\n+    extern const SettingsNonZeroUInt64 max_block_size;\n     extern const SettingsUInt64 max_rows_in_join;\n     extern const SettingsUInt64 max_bytes_in_join;\n     extern const SettingsOverflowMode join_overflow_mode;\ndiff --git a/src/Interpreters/MutationsInterpreter.cpp b/src/Interpreters/MutationsInterpreter.cpp\nindex 345cfd213f61..8d4ec50c7b37 100644\n--- a/src/Interpreters/MutationsInterpreter.cpp\n+++ b/src/Interpreters/MutationsInterpreter.cpp\n@@ -52,7 +52,7 @@ namespace Setting\n {\n     extern const SettingsBool allow_experimental_analyzer;\n     extern const SettingsBool allow_nondeterministic_mutations;\n-    extern const SettingsUInt64 max_block_size;\n+    extern const SettingsNonZeroUInt64 max_block_size;\n     extern const SettingsBool use_concurrency_control;\n     extern const SettingsBool validate_mutation_query;\n }\ndiff --git a/src/Interpreters/executeQuery.cpp b/src/Interpreters/executeQuery.cpp\nindex 0cea0da557ca..85920ad0e4d3 100644\n--- a/src/Interpreters/executeQuery.cpp\n+++ b/src/Interpreters/executeQuery.cpp\n@@ -130,7 +130,7 @@ namespace Setting\n     extern const SettingsBool log_query_settings;\n     extern const SettingsUInt64 max_ast_depth;\n     extern const SettingsUInt64 max_ast_elements;\n-    extern const SettingsUInt64 max_block_size;\n+    extern const SettingsNonZeroUInt64 max_block_size;\n     extern const SettingsUInt64 max_parser_backtracks;\n     extern const SettingsUInt64 max_parser_depth;\n     extern const SettingsUInt64 max_query_size;\ndiff --git a/src/Planner/Planner.cpp b/src/Planner/Planner.cpp\nindex 10cb16d08470..fdf3d91b9361 100644\n--- a/src/Planner/Planner.cpp\n+++ b/src/Planner/Planner.cpp\n@@ -115,7 +115,7 @@ namespace Setting\n     extern const SettingsUInt64 group_by_two_level_threshold_bytes;\n     extern const SettingsBool group_by_use_nulls;\n     extern const SettingsUInt64 max_bytes_in_distinct;\n-    extern const SettingsUInt64 max_block_size;\n+    extern const SettingsNonZeroUInt64 max_block_size;\n     extern const SettingsUInt64 max_size_to_preallocate_for_aggregation;\n     extern const SettingsUInt64 max_subquery_depth;\n     extern const SettingsUInt64 max_rows_in_distinct;\ndiff --git a/src/Planner/PlannerJoinTree.cpp b/src/Planner/PlannerJoinTree.cpp\nindex 5f2ffeeb6a2c..c8311c8eeaef 100644\n--- a/src/Planner/PlannerJoinTree.cpp\n+++ b/src/Planner/PlannerJoinTree.cpp\n@@ -94,7 +94,7 @@ namespace Setting\n     extern const SettingsBool enable_unaligned_array_join;\n     extern const SettingsBool join_use_nulls;\n     extern const SettingsBool query_plan_use_new_logical_join_step;\n-    extern const SettingsUInt64 max_block_size;\n+    extern const SettingsNonZeroUInt64 max_block_size;\n     extern const SettingsUInt64 max_columns_to_read;\n     extern const SettingsUInt64 max_distributed_connections;\n     extern const SettingsUInt64 max_rows_in_set_to_optimize_join;\ndiff --git a/src/Processors/Formats/InputFormatErrorsLogger.cpp b/src/Processors/Formats/InputFormatErrorsLogger.cpp\nindex 495ed16dfad3..7446324f9794 100644\n--- a/src/Processors/Formats/InputFormatErrorsLogger.cpp\n+++ b/src/Processors/Formats/InputFormatErrorsLogger.cpp\n@@ -17,7 +17,7 @@ namespace Setting\n {\n     extern const SettingsString errors_output_format;\n     extern const SettingsString input_format_record_errors_file_path;\n-    extern const SettingsUInt64 max_block_size;\n+    extern const SettingsNonZeroUInt64 max_block_size;\n }\n \n namespace ErrorCodes\ndiff --git a/src/Processors/QueryPlan/Optimizations/optimizeJoin.cpp b/src/Processors/QueryPlan/Optimizations/optimizeJoin.cpp\nindex 2b5912dc57d6..bea02a7d7d6d 100644\n--- a/src/Processors/QueryPlan/Optimizations/optimizeJoin.cpp\n+++ b/src/Processors/QueryPlan/Optimizations/optimizeJoin.cpp\n@@ -38,7 +38,7 @@ namespace ErrorCodes\n namespace Setting\n {\n     extern const SettingsMaxThreads max_threads;\n-    extern const SettingsUInt64 max_block_size;\n+    extern const SettingsNonZeroUInt64 max_block_size;\n     extern const SettingsUInt64 min_joined_block_size_bytes;\n }\n \ndiff --git a/src/Processors/QueryPlan/SortingStep.cpp b/src/Processors/QueryPlan/SortingStep.cpp\nindex 77300b3c61a2..073f03bde17e 100644\n--- a/src/Processors/QueryPlan/SortingStep.cpp\n+++ b/src/Processors/QueryPlan/SortingStep.cpp\n@@ -30,7 +30,7 @@ namespace DB\n {\n namespace Setting\n {\n-    extern const SettingsUInt64 max_block_size;\n+    extern const SettingsNonZeroUInt64 max_block_size;\n     extern const SettingsUInt64 min_external_sort_block_bytes;\n     extern const SettingsUInt64 max_bytes_before_external_sort;\n     extern const SettingsDouble max_bytes_ratio_before_external_sort;\ndiff --git a/src/Processors/QueryPlan/resolveStorages.cpp b/src/Processors/QueryPlan/resolveStorages.cpp\nindex b077edb787da..546ef4370328 100644\n--- a/src/Processors/QueryPlan/resolveStorages.cpp\n+++ b/src/Processors/QueryPlan/resolveStorages.cpp\n@@ -38,7 +38,7 @@ namespace Setting\n     extern const SettingsUInt64 max_query_size;\n     extern const SettingsUInt64 max_parser_depth;\n     extern const SettingsUInt64 max_parser_backtracks;\n-    extern const SettingsUInt64 max_block_size;\n+    extern const SettingsNonZeroUInt64 max_block_size;\n     extern const SettingsMaxThreads max_threads;\n     extern const SettingsSetOperationMode except_default_mode;\n     extern const SettingsSetOperationMode intersect_default_mode;\ndiff --git a/src/Processors/Sources/MySQLSource.cpp b/src/Processors/Sources/MySQLSource.cpp\nindex 66f4685220cb..c1ac19e21a58 100644\n--- a/src/Processors/Sources/MySQLSource.cpp\n+++ b/src/Processors/Sources/MySQLSource.cpp\n@@ -30,7 +30,7 @@ namespace Setting\n {\n     extern const SettingsUInt64 external_storage_max_read_bytes;\n     extern const SettingsUInt64 external_storage_max_read_rows;\n-    extern const SettingsUInt64 max_block_size;\n+    extern const SettingsNonZeroUInt64 max_block_size;\n }\n \n namespace ErrorCodes\ndiff --git a/src/Processors/TTL/TTLAggregationAlgorithm.cpp b/src/Processors/TTL/TTLAggregationAlgorithm.cpp\nindex e9aa7d39d1fb..43f0eafc8da5 100644\n--- a/src/Processors/TTL/TTLAggregationAlgorithm.cpp\n+++ b/src/Processors/TTL/TTLAggregationAlgorithm.cpp\n@@ -11,7 +11,7 @@ namespace Setting\n     extern const SettingsBool empty_result_for_aggregation_by_empty_set;\n     extern const SettingsBool enable_software_prefetch_in_aggregation;\n     extern const SettingsOverflowModeGroupBy group_by_overflow_mode;\n-    extern const SettingsUInt64 max_block_size;\n+    extern const SettingsNonZeroUInt64 max_block_size;\n     extern const SettingsUInt64 max_bytes_before_external_group_by;\n     extern const SettingsDouble max_bytes_ratio_before_external_group_by;\n     extern const SettingsUInt64 max_rows_to_group_by;\ndiff --git a/src/Processors/Transforms/buildPushingToViewsChain.cpp b/src/Processors/Transforms/buildPushingToViewsChain.cpp\nindex 622e5d280604..3a54f0e7345c 100644\n--- a/src/Processors/Transforms/buildPushingToViewsChain.cpp\n+++ b/src/Processors/Transforms/buildPushingToViewsChain.cpp\n@@ -60,7 +60,7 @@ namespace Setting\n     extern const SettingsLogQueriesType log_queries_min_type;\n     extern const SettingsBool log_query_views;\n     extern const SettingsBool materialized_views_ignore_errors;\n-    extern const SettingsUInt64 max_block_size;\n+    extern const SettingsNonZeroUInt64 max_block_size;\n     extern const SettingsMaxThreads max_threads;\n     extern const SettingsUInt64 min_insert_block_size_bytes;\n     extern const SettingsUInt64 min_insert_block_size_bytes_for_materialized_views;\ndiff --git a/src/Storages/FileLog/StorageFileLog.cpp b/src/Storages/FileLog/StorageFileLog.cpp\nindex 02500eede18b..5fb5d3ac3b8e 100644\n--- a/src/Storages/FileLog/StorageFileLog.cpp\n+++ b/src/Storages/FileLog/StorageFileLog.cpp\n@@ -39,7 +39,7 @@ namespace DB\n {\n namespace Setting\n {\n-    extern const SettingsUInt64 max_block_size;\n+    extern const SettingsNonZeroUInt64 max_block_size;\n     extern const SettingsUInt64 max_insert_block_size;\n     extern const SettingsMilliseconds stream_poll_timeout_ms;\n     extern const SettingsBool use_concurrency_control;\ndiff --git a/src/Storages/Hive/StorageHive.cpp b/src/Storages/Hive/StorageHive.cpp\nindex c0cc6847e7de..cf5049457669 100644\n--- a/src/Storages/Hive/StorageHive.cpp\n+++ b/src/Storages/Hive/StorageHive.cpp\n@@ -62,7 +62,7 @@ namespace Setting\n {\n     extern const SettingsBool input_format_parquet_case_insensitive_column_matching;\n     extern const SettingsBool input_format_orc_case_insensitive_column_matching;\n-    extern const SettingsUInt64 max_block_size;\n+    extern const SettingsNonZeroUInt64 max_block_size;\n     extern const SettingsInt64 max_partitions_to_read;\n     extern const SettingsMaxThreads max_threads;\n }\ndiff --git a/src/Storages/Kafka/StorageKafka.cpp b/src/Storages/Kafka/StorageKafka.cpp\nindex b6e309d68116..92086593f5e9 100644\n--- a/src/Storages/Kafka/StorageKafka.cpp\n+++ b/src/Storages/Kafka/StorageKafka.cpp\n@@ -61,7 +61,7 @@ namespace DB\n {\n namespace Setting\n {\n-    extern const SettingsUInt64 max_block_size;\n+    extern const SettingsNonZeroUInt64 max_block_size;\n     extern const SettingsUInt64 max_insert_block_size;\n     extern const SettingsUInt64 output_format_avro_rows_in_file;\n     extern const SettingsMilliseconds stream_flush_interval_ms;\ndiff --git a/src/Storages/Kafka/StorageKafka2.cpp b/src/Storages/Kafka/StorageKafka2.cpp\nindex b040d3e1e4b1..f7f9f039212c 100644\n--- a/src/Storages/Kafka/StorageKafka2.cpp\n+++ b/src/Storages/Kafka/StorageKafka2.cpp\n@@ -76,7 +76,7 @@ namespace DB\n {\n namespace Setting\n {\n-    extern const SettingsUInt64 max_block_size;\n+    extern const SettingsNonZeroUInt64 max_block_size;\n     extern const SettingsUInt64 max_insert_block_size;\n     extern const SettingsUInt64 output_format_avro_rows_in_file;\n     extern const SettingsMilliseconds stream_flush_interval_ms;\ndiff --git a/src/TableFunctions/TableFunctionFormat.cpp b/src/TableFunctions/TableFunctionFormat.cpp\nindex 01f414dfcbac..46534cb75e53 100644\n--- a/src/TableFunctions/TableFunctionFormat.cpp\n+++ b/src/TableFunctions/TableFunctionFormat.cpp\n@@ -27,7 +27,7 @@ namespace DB\n {\n namespace Setting\n {\n-    extern const SettingsUInt64 max_block_size;\n+    extern const SettingsNonZeroUInt64 max_block_size;\n     extern const SettingsBool use_concurrency_control;\n }\n \n",
  "test_patch": "diff --git a/tests/queries/0_stateless/03149_numbers_max_block_size_zero.reference b/tests/queries/0_stateless/03149_numbers_max_block_size_zero.reference\ndeleted file mode 100644\nindex d86bac9de59a..000000000000\n--- a/tests/queries/0_stateless/03149_numbers_max_block_size_zero.reference\n+++ /dev/null\n@@ -1,1 +0,0 @@\n-OK\ndiff --git a/tests/queries/0_stateless/03149_numbers_max_block_size_zero.sh b/tests/queries/0_stateless/03149_numbers_max_block_size_zero.sh\ndeleted file mode 100755\nindex 7f606d889a7f..000000000000\n--- a/tests/queries/0_stateless/03149_numbers_max_block_size_zero.sh\n+++ /dev/null\n@@ -1,9 +0,0 @@\n-#!/usr/bin/env bash\n-# shellcheck disable=SC2266\n-\n-CUR_DIR=$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" && pwd)\n-# shellcheck source=../shell_config.sh\n-. \"$CUR_DIR\"/../shell_config.sh\n-\n-$CLICKHOUSE_CLIENT -q \"SELECT count(*) FROM numbers(10) AS a, numbers(11) AS b, numbers(12) AS c SETTINGS max_block_size = 0\" 2>&1 |\n-    [ \"$(grep -c \"Sanity check: 'max_block_size' cannot be 0. Set to default value\")\" -gt 0 ] && echo \"OK\" || echo \"FAIL\"\ndiff --git a/tests/queries/0_stateless/03512_settings_max_block_size.reference b/tests/queries/0_stateless/03512_settings_max_block_size.reference\nnew file mode 100644\nindex 000000000000..b79deb98a752\n--- /dev/null\n+++ b/tests/queries/0_stateless/03512_settings_max_block_size.reference\n@@ -0,0 +1,1 @@\n+Set to zero.\ndiff --git a/tests/queries/0_stateless/03512_settings_max_block_size.sql b/tests/queries/0_stateless/03512_settings_max_block_size.sql\nnew file mode 100644\nindex 000000000000..989c3bac5507\n--- /dev/null\n+++ b/tests/queries/0_stateless/03512_settings_max_block_size.sql\n@@ -0,0 +1,7 @@\n+CREATE TABLE tab (column Int) ENGINE = Memory;\n+\n+SELECT 'Set to zero.';\n+INSERT INTO TABLE tab (column) FROM INFILE '/dev/null' SETTINGS max_block_size = 0 FORMAT Values; -- { clientError BAD_ARGUMENTS }\n+SELECT count() FROM numbers(10) AS a, numbers(11) AS b, numbers(12) AS c SETTINGS max_block_size = 0; -- { clientError BAD_ARGUMENTS }\n+\n+DROP TABLE tab;\n",
  "problem_statement": "Another division by 0\n### Describe the bug\n\nDon't set `max_block_size = 0`. I mentioned in the comment here: https://github.com/ClickHouse/ClickHouse/issues/78392 , but that issue is now closed.\n\n### How to reproduce\n\nRun:\n\n```sql\nCREATE TABLE t0 (c0 Int) ENGINE = Memory;\nINSERT INTO TABLE FUNCTION file('<path to file>', 'Values', 'c0 Int') SELECT 1;\nINSERT INTO TABLE t0 (c0) FROM INFILE '<path to file>' SETTINGS max_block_size = 0 FORMAT Values;\n```\n\n### Error message and/or stacktrace\n\nStack trace:\n```\nLogical error: 'Unread data in PeekableReadBuffer will be lost. Most likely it's a bug.'.\nStack trace (when copying this message, always include the lines below):\n\n0. src/contrib/llvm-project/libcxx/include/__exception/exception.h:113: std::exception::exception[abi:se190107]() @ 0x000000001a572b94\n1. src/base/poco/Foundation/src/Exception.cpp:27: Poco::Exception::Exception(String const&, int) @ 0x00000000377cc8a0\n2. src/src/Common/Exception.cpp:108: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000256bd6eb\n3. src/src/Common/Exception.h:112: DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000001a56e296\n4. src/src/Common/Exception.h:130: DB::Exception::Exception<>(int, FormatStringHelperImpl<>) @ 0x000000001a5840ef\n5. src/src/Processors/Formats/Impl/ValuesBlockInputFormat.cpp:640: DB::ValuesBlockInputFormat::readSuffix() @ 0x0000000032e2bcff\n6. src/src/Processors/Formats/Impl/ValuesBlockInputFormat.cpp:171: DB::ValuesBlockInputFormat::read() @ 0x0000000032e294f3\n7. src/src/Processors/Formats/IInputFormat.cpp:19: DB::IInputFormat::generate() @ 0x000000003294e524\n8. src/src/Processors/ISource.cpp:139: DB::ISource::tryGenerate() @ 0x0000000032910179\n9. src/src/Processors/ISource.cpp:108: DB::ISource::work() @ 0x000000003290fa44\n10. src/src/Processors/Executors/ExecutionThreadContext.cpp:53: DB::ExecutionThreadContext::executeTask() @ 0x000000003293e9ad\n11. src/src/Processors/Executors/PipelineExecutor.cpp:296: DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x0000000032929f7c\n12. src/src/Processors/Executors/PipelineExecutor.cpp:170: DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x0000000032928da3\n13. src/src/Processors/Executors/PullingPipelineExecutor.cpp:54: DB::PullingPipelineExecutor::pull(DB::Chunk&) @ 0x00000000329455d4\n14. src/src/Storages/StorageFile.cpp:1480: DB::StorageFileSource::generate() @ 0x000000003155c1c2\n15. src/src/Processors/ISource.cpp:139: DB::ISource::tryGenerate() @ 0x0000000032910179\n16. src/src/Processors/ISource.cpp:108: DB::ISource::work() @ 0x000000003290fa44\n17. src/src/Processors/Executors/ExecutionThreadContext.cpp:53: DB::ExecutionThreadContext::executeTask() @ 0x000000003293e9ad\n18. src/src/Processors/Executors/PipelineExecutor.cpp:296: DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x0000000032929f7c\n19. src/src/Processors/Executors/PipelineExecutor.cpp:262: DB::PipelineExecutor::executeSingleThread(unsigned long) @ 0x000000003292a201\n20. src/src/Processors/Executors/PipelineExecutor.cpp:454: DB::PipelineExecutor::executeImpl(unsigned long, bool) @ 0x000000003292783c\n21. src/src/Processors/Executors/PipelineExecutor.cpp:128: DB::PipelineExecutor::execute(unsigned long, bool) @ 0x0000000032926b80\n22. src/src/Processors/Executors/PullingAsyncPipelineExecutor.cpp:76: void std::__function::__policy_invoker<void ()>::__call_impl[abi:se190107]<std::__function::__default_alloc_func<ThreadFromGlobalPoolImpl<true, true>::ThreadFromGlobalPoolImpl<DB::PullingAsyncPipelineExecutor::pull(DB::Chunk&, unsigned long)::$_0>(DB::PullingAsyncPipelineExecutor::pull(DB::Chunk&, unsigned long)::$_0&&)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x0000000032943c78\n23. src/contrib/llvm-project/libcxx/include/__functional/function.h:716: ? @ 0x0000000025898b3a\n24. src/contrib/llvm-project/libcxx/include/__type_traits/invoke.h:117: void* std::__thread_proxy[abi:se190107]<std::tuple<std::unique_ptr<std::__thread_struct, std::default_delete<std::__thread_struct>>, void (ThreadPoolImpl<std::thread>::ThreadFromThreadPool::*)(), ThreadPoolImpl<std::thread>::ThreadFromThreadPool*>>(void*) @ 0x00000000258a08ff\n25. ? @ 0x00007ffff7ca1e2e\n26. ? @ 0x00007ffff7d33a4c\n```\n",
  "hints_text": "",
  "created_at": "2025-05-12T22:06:01Z"
}