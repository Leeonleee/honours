diff --git a/tests/queries/0_stateless/00098_k_union_all.sql b/tests/queries/0_stateless/00098_k_union_all.sql
index 280ad5ca2e6a..a3da234d4a57 100644
--- a/tests/queries/0_stateless/00098_k_union_all.sql
+++ b/tests/queries/0_stateless/00098_k_union_all.sql
@@ -1,5 +1,6 @@
 SET output_format_pretty_color=1;
 SET output_format_pretty_display_footer_column_names=0;
+SET output_format_pretty_squash_consecutive_ms = 0;
 SELECT 1 FORMAT PrettySpace;
 SELECT 1 UNION ALL SELECT 1 FORMAT PrettySpace;
 SELECT 1 UNION ALL SELECT 1 UNION ALL SELECT 1 FORMAT PrettySpace;
diff --git a/tests/queries/0_stateless/00405_output_format_pretty_color.sql b/tests/queries/0_stateless/00405_output_format_pretty_color.sql
index de83567dd5dc..af9635e9724a 100644
--- a/tests/queries/0_stateless/00405_output_format_pretty_color.sql
+++ b/tests/queries/0_stateless/00405_output_format_pretty_color.sql
@@ -1,5 +1,6 @@
 SET output_format_pretty_display_footer_column_names=0;
 SET output_format_pretty_color = 0;
+SET output_format_pretty_squash_consecutive_ms = 0;
 SHOW SETTING output_format_pretty_color;
 
 SELECT number AS hello, toString(number) AS world, (hello, world) AS tuple, nullIf(hello % 3, 0) AS sometimes_nulls FROM system.numbers LIMIT 10 SETTINGS max_block_size = 5 FORMAT Pretty;
diff --git a/tests/queries/0_stateless/00405_pretty_formats.sql b/tests/queries/0_stateless/00405_pretty_formats.sql
index 4715f4fc1105..3d6017163a72 100644
--- a/tests/queries/0_stateless/00405_pretty_formats.sql
+++ b/tests/queries/0_stateless/00405_pretty_formats.sql
@@ -1,5 +1,6 @@
 SET output_format_pretty_display_footer_column_names=0;
 SET output_format_pretty_color = 1;
+SET output_format_pretty_squash_consecutive_ms = 0;
 
 SELECT number AS hello, toString(number) AS world, (hello, world) AS tuple, nullIf(hello % 3, 0) AS sometimes_nulls FROM system.numbers LIMIT 10 SETTINGS max_block_size = 5 FORMAT Pretty;
 SELECT number AS hello, toString(number) AS world, (hello, world) AS tuple, nullIf(hello % 3, 0) AS sometimes_nulls FROM system.numbers LIMIT 10 SETTINGS max_block_size = 5 FORMAT PrettyCompact;
diff --git a/tests/queries/0_stateless/00730_unicode_terminal_format.sql b/tests/queries/0_stateless/00730_unicode_terminal_format.sql
index 8e9e6a9b29c1..19750d13b6ea 100644
--- a/tests/queries/0_stateless/00730_unicode_terminal_format.sql
+++ b/tests/queries/0_stateless/00730_unicode_terminal_format.sql
@@ -1,3 +1,4 @@
+SET output_format_pretty_squash_consecutive_ms = 0;
 SET output_format_pretty_max_column_name_width_cut_to = 0;
 DROP TABLE IF EXISTS unicode;
 
diff --git a/tests/queries/0_stateless/01509_output_format_pretty_row_numbers.sql b/tests/queries/0_stateless/01509_output_format_pretty_row_numbers.sql
index 04d02b8d3896..b0e03c1bd502 100644
--- a/tests/queries/0_stateless/01509_output_format_pretty_row_numbers.sql
+++ b/tests/queries/0_stateless/01509_output_format_pretty_row_numbers.sql
@@ -1,6 +1,8 @@
 SET output_format_pretty_color=1;
 SET output_format_pretty_row_numbers=0;
 SET output_format_pretty_display_footer_column_names=0;
+SET output_format_pretty_squash_consecutive_ms = 0;
+
 SELECT * FROM numbers(10) FORMAT Pretty;
 SELECT * FROM numbers(10) FORMAT PrettyCompact;
 SELECT * FROM numbers(10) FORMAT PrettyCompactMonoBlock;
diff --git a/tests/queries/0_stateless/02122_parallel_formatting.lib b/tests/queries/0_stateless/02122_parallel_formatting.lib
index a26e6917c90e..b92b08be2765 100755
--- a/tests/queries/0_stateless/02122_parallel_formatting.lib
+++ b/tests/queries/0_stateless/02122_parallel_formatting.lib
@@ -11,14 +11,14 @@ non_parallel_file=$CLICKHOUSE_TMP/$CLICKHOUSE_TEST_UNIQUE_NAME"_non_parallel"
 format=$1
 
 echo $format-1
-$CLICKHOUSE_CLIENT -q "select number, number + 1, concat('string: ', toString(number)) from numbers(200000) format $format" --output_format_write_statistics=0 --output_format_parallel_formatting=0 --output_format_pretty_max_rows=1000000 | grep -a -v "elapsed" > $non_parallel_file
-$CLICKHOUSE_CLIENT -q "select number, number + 1, concat('string: ', toString(number)) from numbers(200000) format $format" --output_format_write_statistics=0 --output_format_parallel_formatting=1 --output_format_pretty_max_rows=1000000 | grep -a -v "elapsed" > $parallel_file
+$CLICKHOUSE_CLIENT -q "select number, number + 1, concat('string: ', toString(number)) from numbers(200000) format $format" --output_format_write_statistics=0 --output_format_parallel_formatting=0 --output_format_pretty_max_rows=1000000 --output_format_pretty_squash_consecutive_ms=0 | grep -a -v "elapsed" > $non_parallel_file
+$CLICKHOUSE_CLIENT -q "select number, number + 1, concat('string: ', toString(number)) from numbers(200000) format $format" --output_format_write_statistics=0 --output_format_parallel_formatting=1 --output_format_pretty_max_rows=1000000 --output_format_pretty_squash_consecutive_ms=0 | grep -a -v "elapsed" > $parallel_file
 
 diff $non_parallel_file $parallel_file
 
 echo $format-2
-$CLICKHOUSE_CLIENT -q "select number, number + 1, concat('string: ', toString(number)) from numbers(200000) group by number with totals order by number limit 190000 format $format" --extremes=1 --output_format_write_statistics=0 --output_format_parallel_formatting=0 --output_format_pretty_max_rows=1000000 | grep -a -v "elapsed" > $non_parallel_file
-$CLICKHOUSE_CLIENT -q "select number, number + 1, concat('string: ', toString(number)) from numbers(200000) group by number with totals order by number limit 190000 format $format" --extremes=1 --output_format_write_statistics=0 --output_format_parallel_formatting=1 --output_format_pretty_max_rows=1000000 | grep -a -v "elapsed" > $parallel_file
+$CLICKHOUSE_CLIENT -q "select number, number + 1, concat('string: ', toString(number)) from numbers(200000) group by number with totals order by number limit 190000 format $format" --extremes=1 --output_format_write_statistics=0 --output_format_parallel_formatting=0 --output_format_pretty_max_rows=1000000 --output_format_pretty_squash_consecutive_ms=0 | grep -a -v "elapsed" > $non_parallel_file
+$CLICKHOUSE_CLIENT -q "select number, number + 1, concat('string: ', toString(number)) from numbers(200000) group by number with totals order by number limit 190000 format $format" --extremes=1 --output_format_write_statistics=0 --output_format_parallel_formatting=1 --output_format_pretty_max_rows=1000000 --output_format_pretty_squash_consecutive_ms=0 | grep -a -v "elapsed" > $parallel_file
 
 diff $non_parallel_file $parallel_file
 
diff --git a/tests/queries/0_stateless/02375_pretty_formats.sql.j2 b/tests/queries/0_stateless/02375_pretty_formats.sql.j2
index 36a4479260cf..374fd89294bd 100644
--- a/tests/queries/0_stateless/02375_pretty_formats.sql.j2
+++ b/tests/queries/0_stateless/02375_pretty_formats.sql.j2
@@ -2,6 +2,7 @@
                   'PrettyCompactMonoBlock', 'PrettyCompactNoEscapesMonoBlock', 'PrettySpace', 'PrettySpaceNoEscapes', 'PrettySpaceMonoBlock',
                   'PrettySpaceNoEscapesMonoBlock'] -%}
 
+SET output_format_pretty_squash_consecutive_ms = 0;
 select '{{ format }}';
 select number as x, number + 1 as y from numbers(4) settings max_block_size=2, output_format_pretty_color=1, output_format_pretty_display_footer_column_names=0 format {{ format }};
 
diff --git a/tests/queries/0_stateless/03160_pretty_format_tty.sh b/tests/queries/0_stateless/03160_pretty_format_tty.sh
index 200bd52f3fa7..4a7991e91056 100755
--- a/tests/queries/0_stateless/03160_pretty_format_tty.sh
+++ b/tests/queries/0_stateless/03160_pretty_format_tty.sh
@@ -5,4 +5,4 @@ CUR_DIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
 . "$CUR_DIR"/../shell_config.sh
 
 # default output_format_pretty_max_rows is 10K
-$CLICKHOUSE_LOCAL -q "select * from numbers(100e3) format PrettySpace settings max_threads=1, output_format_pretty_display_footer_column_names=0" | wc -l
+$CLICKHOUSE_LOCAL --output_format_pretty_squash_consecutive_ms 0 -q "select * from numbers(100e3) format PrettySpace settings max_threads=1, output_format_pretty_display_footer_column_names=0" | wc -l
diff --git a/tests/queries/0_stateless/03299_pretty_squash.reference b/tests/queries/0_stateless/03299_pretty_squash.reference
new file mode 100644
index 000000000000..fd6e8e954f64
--- /dev/null
+++ b/tests/queries/0_stateless/03299_pretty_squash.reference
@@ -0,0 +1,42 @@
+    ┌─number─┐
+ 1. │      0 │
+ 2. │      1 │
+ 3. │      2 │
+ 4. │      3 │
+ 5. │      4 │
+ 6. │      5 │
+ 7. │      6 │
+ 8. │      7 │
+ 9. │      8 │
+10. │      9 │
+    └────────┘
+   ┌─number─┐
+1. │      0 │
+   └────────┘
+   ┌─number─┐
+2. │      1 │
+   └────────┘
+   ┌─number─┐
+3. │      2 │
+   └────────┘
+   ┌─number─┐
+4. │      3 │
+   └────────┘
+   ┌─number─┐
+5. │      4 │
+   └────────┘
+   ┌─number─┐
+6. │      5 │
+   └────────┘
+   ┌─number─┐
+7. │      6 │
+   └────────┘
+   ┌─number─┐
+8. │      7 │
+   └────────┘
+   ┌─number─┐
+9. │      8 │
+   └────────┘
+    ┌─number─┐
+10. │      9 │
+    └────────┘
diff --git a/tests/queries/0_stateless/03299_pretty_squash.sql b/tests/queries/0_stateless/03299_pretty_squash.sql
new file mode 100644
index 000000000000..e3bddba792b7
--- /dev/null
+++ b/tests/queries/0_stateless/03299_pretty_squash.sql
@@ -0,0 +1,3 @@
+--- Despite max_block_size = 1, this will squash the blocks and output everything as a single block:
+SELECT number FROM numbers(10) FORMAT PrettyCompact SETTINGS max_block_size = 1, output_format_pretty_squash_consecutive_ms = 60000, output_format_pretty_squash_max_wait_ms = 60000;
+SELECT number FROM numbers(10) FORMAT PrettyCompact SETTINGS max_block_size = 1, output_format_pretty_squash_consecutive_ms = 0;
