{
  "repo": "ClickHouse/ClickHouse",
  "pull_number": 59295,
  "instance_id": "ClickHouse__ClickHouse-59295",
  "issue_numbers": [
    "56202"
  ],
  "base_commit": "ca124df92b69925d230c130a5347dcd7e8b7facc",
  "patch": "diff --git a/src/Storages/MergeTree/MutateTask.cpp b/src/Storages/MergeTree/MutateTask.cpp\nindex 6bcdfe34296b..302a9bb2b1e2 100644\n--- a/src/Storages/MergeTree/MutateTask.cpp\n+++ b/src/Storages/MergeTree/MutateTask.cpp\n@@ -21,6 +21,7 @@\n #include <Storages/MutationCommands.h>\n #include <Storages/MergeTree/MergeTreeDataMergerMutator.h>\n #include <Storages/MergeTree/MergeTreeIndexInverted.h>\n+#include <Storages/BlockNumberColumn.h>\n #include <DataTypes/DataTypeNullable.h>\n #include <boost/algorithm/string/replace.hpp>\n #include <Common/ProfileEventsScope.h>\n@@ -308,6 +309,15 @@ getColumnsForNewDataPart(\n         }\n     }\n \n+    if (!storage_columns_set.contains(BlockNumberColumn::name))\n+    {\n+        if (source_part->tryGetSerialization(BlockNumberColumn::name) != nullptr)\n+        {\n+            storage_columns.push_back({BlockNumberColumn::name, BlockNumberColumn::type});\n+            storage_columns_set.insert(BlockNumberColumn::name);\n+        }\n+    }\n+\n     SerializationInfoByName new_serialization_infos;\n     for (const auto & [name, old_info] : serialization_infos)\n     {\n",
  "test_patch": "diff --git a/docker/test/stateless/stress_tests.lib b/docker/test/stateless/stress_tests.lib\nindex 6f0dabb52071..6e1834d6cded 100644\n--- a/docker/test/stateless/stress_tests.lib\n+++ b/docker/test/stateless/stress_tests.lib\n@@ -78,6 +78,8 @@ function configure()\n         randomize_config_boolean_value use_compression zookeeper\n     fi\n \n+    randomize_config_boolean_value allow_experimental_block_number_column block_number\n+\n     # for clickhouse-server (via service)\n     echo \"ASAN_OPTIONS='malloc_context_size=10 verbosity=1 allocator_release_to_os_interval_ms=10000'\" >> /etc/environment\n     # for clickhouse-client\ndiff --git a/docker/test/upgrade/run.sh b/docker/test/upgrade/run.sh\nindex 9c0082093160..aaba5cc6a8c7 100644\n--- a/docker/test/upgrade/run.sh\n+++ b/docker/test/upgrade/run.sh\n@@ -122,6 +122,7 @@ rm /etc/clickhouse-server/config.d/merge_tree.xml\n rm /etc/clickhouse-server/config.d/enable_wait_for_shutdown_replicated_tables.xml\n rm /etc/clickhouse-server/config.d/zero_copy_destructive_operations.xml\n rm /etc/clickhouse-server/config.d/storage_conf_02963.xml\n+rm /etc/clickhouse-server/config.d/block_number.xml\n rm /etc/clickhouse-server/users.d/nonconst_timezone.xml\n rm /etc/clickhouse-server/users.d/s3_cache_new.xml\n rm /etc/clickhouse-server/users.d/replicated_ddl_entry.xml\ndiff --git a/tests/config/config.d/block_number.xml b/tests/config/config.d/block_number.xml\nnew file mode 100644\nindex 000000000000..b56f1f1afc25\n--- /dev/null\n+++ b/tests/config/config.d/block_number.xml\n@@ -0,0 +1,6 @@\n+<clickhouse>\n+    <merge_tree>\n+        <!-- Setting randomized for stress test, it is disabled here and this line is used to randomize it in the script -->\n+        <allow_experimental_block_number_column>0</allow_experimental_block_number_column>\n+    </merge_tree>\n+</clickhouse>\ndiff --git a/tests/config/install.sh b/tests/config/install.sh\nindex a68a4c195019..cfe810cda843 100755\n--- a/tests/config/install.sh\n+++ b/tests/config/install.sh\n@@ -64,6 +64,7 @@ ln -sf $SRC_PATH/config.d/backups.xml $DEST_SERVER_PATH/config.d/\n ln -sf $SRC_PATH/config.d/filesystem_caches_path.xml $DEST_SERVER_PATH/config.d/\n ln -sf $SRC_PATH/config.d/validate_tcp_client_information.xml $DEST_SERVER_PATH/config.d/\n ln -sf $SRC_PATH/config.d/zero_copy_destructive_operations.xml $DEST_SERVER_PATH/config.d/\n+ln -sf $SRC_PATH/config.d/block_number.xml $DEST_SERVER_PATH/config.d/\n \n # Not supported with fasttest.\n if [ \"${DEST_SERVER_PATH}\" = \"/etc/clickhouse-server\" ]\ndiff --git a/tests/queries/0_stateless/02973_block_number_sparse_serialization_and_mutation.reference b/tests/queries/0_stateless/02973_block_number_sparse_serialization_and_mutation.reference\nnew file mode 100644\nindex 000000000000..e69de29bb2d1\ndiff --git a/tests/queries/0_stateless/02973_block_number_sparse_serialization_and_mutation.sql b/tests/queries/0_stateless/02973_block_number_sparse_serialization_and_mutation.sql\nnew file mode 100644\nindex 000000000000..7a1de2897fbf\n--- /dev/null\n+++ b/tests/queries/0_stateless/02973_block_number_sparse_serialization_and_mutation.sql\n@@ -0,0 +1,39 @@\n+-- Tags: zookeeper\n+\n+-- we need exact block-numbers\n+SET insert_keeper_fault_injection_probability=0;\n+\n+DROP TABLE IF EXISTS table_with_some_columns;\n+\n+CREATE TABLE table_with_some_columns(\n+    key UInt64,\n+    value0 UInt8\n+)\n+ENGINE = ReplicatedMergeTree('/clickhouse/tables/{database}/table_with_some_columns', '1')\n+ORDER BY key\n+SETTINGS allow_experimental_block_number_column=1,\n+ratio_of_defaults_for_sparse_serialization=0.0001,\n+min_bytes_for_wide_part = 0,\n+replace_long_file_name_to_hash=0; -- simpler to debug\n+\n+INSERT INTO table_with_some_columns SELECT rand(), number + 10 from numbers(100000);\n+\n+INSERT INTO table_with_some_columns SELECT rand(), number + 10 from numbers(1);\n+\n+OPTIMIZE TABLE table_with_some_columns FINAL;\n+\n+INSERT INTO table_with_some_columns SELECT rand(), number+222222222 from numbers(1);\n+\n+OPTIMIZE TABLE table_with_some_columns FINAL;\n+\n+set alter_sync = 2;\n+\n+ALTER TABLE table_with_some_columns DROP COLUMN value0;\n+\n+INSERT INTO table_with_some_columns SELECT rand() from numbers(1);\n+\n+OPTIMIZE TABLE table_with_some_columns FINAL;\n+\n+SELECT *, _block_number FROM table_with_some_columns where not ignore(*) Format Null;\n+\n+DROP TABLE IF EXISTS table_with_some_columns;\n",
  "problem_statement": "Logical error: Invalid number of rows in Chunk column UInt64 position 4: expected 8192, got 2 (`_block_number`)\nhttps://s3.amazonaws.com/clickhouse-test-reports/55987/073a6a6f0e8074c1a89f0b6f839e52447f8b8b3e/upgrade_check__tsan_.html\r\n\r\nhttps://s3.amazonaws.com/clickhouse-test-reports/55978/985c74b20f67b15196c69426295a50d55e4d4e32/upgrade_check__tsan_.html\r\n\r\nIt's related to `_block_number` column (introduced in https://github.com/ClickHouse/ClickHouse/pull/47532)\r\n\r\nCan be reproduced by `01079_parallel_alter_add_drop_column_zookeeper` with `allow_experimental_block_number_column=1`:\r\n```\r\ndiff --git a/tests/queries/0_stateless/01079_parallel_alter_add_drop_column_zookeeper.sh b/tests/queries/0_stateless/01079_parallel_alter_add_drop_column_zookeeper.sh\r\nindex bfdea95fa9e..60e3a1bc006 100755\r\n--- a/tests/queries/0_stateless/01079_parallel_alter_add_drop_column_zookeeper.sh\r\n+++ b/tests/queries/0_stateless/01079_parallel_alter_add_drop_column_zookeeper.sh\r\n@@ -15,7 +15,12 @@ done\r\n \r\n \r\n for i in $(seq $REPLICAS); do\r\n-    $CLICKHOUSE_CLIENT --query \"CREATE TABLE concurrent_alter_add_drop_$i (key UInt64, value0 UInt8) ENGINE = ReplicatedMergeTree('/clickhouse/tables/$CLICKHOUSE_TEST_ZOOKEEPER_PREFIX/concurrent_alter_add_drop_column', '$i') ORDER BY key SETTINGS max_replicated_mutations_in_queue = 1000, number_of_free_entries_in_pool_to_execute_mutation = 0, max_replicated_merges_in_queue = 1000, index_granularity = 8192, index_granularity_bytes = '10Mi'\"\r\n+    $CLICKHOUSE_CLIENT --query \"CREATE TABLE concurrent_alter_add_drop_$i (key UInt64, value0 UInt8) ENGINE = ReplicatedMergeTree('/clickhouse/tables/$CLICKHOUSE_TEST_ZOOKEEPER_PREFIX/concurrent_alter_add_drop_column', '$i') ORDER BY key\r\n+    SETTINGS max_replicated_mutations_in_queue = 1000, number_of_free_entries_in_pool_to_execute_mutation = 0, max_replicated_merges_in_queue = 1000, index_granularity = 8192, index_granularity_bytes = '10Mi',\r\n+    max_replicated_mutations_in_queue = 1000, number_of_free_entries_in_pool_to_execute_mutation = 0, max_replicated_merges_in_queue = 1000, index_granularity = 8192, index_granularity_bytes = '10Mi', min_bytes_for_wide_part = 0,\r\n+    ratio_of_defaults_for_sparse_serialization = 0.5678088665008545, replace_long_file_name_to_hash = false, max_file_name_length = 66, merge_max_block_size = 23954, prefer_fetch_merged_part_size_threshold = 10737418240,\r\n+    vertical_merge_algorithm_min_rows_to_activate = 1, vertical_merge_algorithm_min_columns_to_activate = 46, min_merge_bytes_to_use_direct_io = 1, allow_vertical_merges_from_compact_to_wide_parts = false, marks_compress_block_size = 58933, primary_key_compress_block_size = 86483,\r\n+    allow_experimental_block_number_column=1\"\r\n done\r\n \r\n $CLICKHOUSE_CLIENT --query \"INSERT INTO concurrent_alter_add_drop_1 SELECT number, number + 10 from numbers(100000)\"\r\n@@ -31,7 +36,7 @@ function alter_thread()\r\n         REPLICA=$(($RANDOM % 3 + 1))\r\n         ADD=$(($RANDOM % 5 + 1))\r\n         $CLICKHOUSE_CLIENT --query \"ALTER TABLE concurrent_alter_add_drop_$REPLICA ADD COLUMN value$ADD UInt32 DEFAULT 42 SETTINGS replication_alter_partitions_sync=0\"; # additionaly we don't wait anything for more heavy concurrency\r\n-        DROP=$(($RANDOM % 5 + 1))\r\n+        DROP=$(($RANDOM % 15 + 1))\r\n         $CLICKHOUSE_CLIENT --query \"ALTER TABLE concurrent_alter_add_drop_$REPLICA DROP COLUMN value$DROP SETTINGS replication_alter_partitions_sync=0\"; # additionaly we don't wait anything for more heavy concurrency\r\n         sleep 0.$RANDOM\r\n     done\r\n@@ -63,7 +68,7 @@ export -f optimize_thread;\r\n export -f insert_thread;\r\n \r\n \r\n-TIMEOUT=30\r\n+TIMEOUT=60\r\n \r\n # Sometimes we detach and attach tables\r\n timeout $TIMEOUT bash -c alter_thread 2> /dev/null &\r\n```\r\n\r\n```\r\n2023.11.01 15:02:01.995042 [ 20329 ] {55f70984-4f74-4858-b793-ea79f8d01b67::all_0_2_14_4} <Fatal> : Logical error: 'Invalid number of rows in Chunk column UInt64 position 4: expected 8192, got 2'.\r\n2023.11.01 15:02:01.995898 [ 20761 ] {} <Fatal> BaseDaemon: ########## Short fault info ############\r\n2023.11.01 15:02:01.996121 [ 20761 ] {} <Fatal> BaseDaemon: (version 23.10.1.1, build id: EC9D8BF9A510B6167AE23FBBC122701ACC2A81E2, git hash: ac089003717e3805d9a9da20fe6a28793dde6219) (from thread 20329) Received signal 6\r\n2023.11.01 15:02:01.996290 [ 20761 ] {} <Fatal> BaseDaemon: Signal description: Aborted\r\n2023.11.01 15:02:01.996422 [ 20761 ] {} <Fatal> BaseDaemon: \r\n2023.11.01 15:02:01.996634 [ 20761 ] {} <Fatal> BaseDaemon: Stack trace: 0x00007fdcd4bc283c 0x00007fdcd4b72668 0x00007fdcd4b5a4b8 0x0000000014cffdf8 0x0000000014cffe95 0x0000000014d00394 0x000000000b170fd7 0x000000000b2526ae 0x0000000020bfe708 0x0000000020bfe4df 0x00000000205a14b0 0x0000000020c143e0 0x0000000020c14023 0x0000000020c51850 0x0000000020c51521 0x0000000020c33c3e 0x0000000020c3364c 0x0000000020c5cc4b 0x0000000020c5cd37 0x00000000202625c3 0x000000002027b298 0x000000002027b275 0x000000002027b255 0x000000002027b235 0x000000002027b1fd 0x0000000014cbf556 0x0000000014cbe5b5 0x00000000202624c6 0x0000000020266d63 0x0000000020253124 0x000000002072e007 0x000000002072c7fc 0x000000002029beda 0x000000002029cb37 0x00000000202a5f18 0x00000000202a5ef5 0x00000000202a5ed5 0x00000000202a5eb5 0x00000000202a5e7d 0x0000000014d835b6 0x0000000014d82915\r\n2023.11.01 15:02:01.996863 [ 20761 ] {} <Fatal> BaseDaemon: ########################################\r\n2023.11.01 15:02:01.997011 [ 20761 ] {} <Fatal> BaseDaemon: (version 23.10.1.1, build id: EC9D8BF9A510B6167AE23FBBC122701ACC2A81E2, git hash: ac089003717e3805d9a9da20fe6a28793dde6219) (from thread 20329) (query_id: 55f70984-4f74-4858-b793-ea79f8d01b67::all_0_2_14_4) (query: ) Received signal Aborted (6)\r\n2023.11.01 15:02:01.997164 [ 20761 ] {} <Fatal> BaseDaemon: \r\n2023.11.01 15:02:01.997284 [ 20761 ] {} <Fatal> BaseDaemon: Stack trace: 0x00007fdcd4bc283c 0x00007fdcd4b72668 0x00007fdcd4b5a4b8 0x0000000014cffdf8 0x0000000014cffe95 0x0000000014d00394 0x000000000b170fd7 0x000000000b2526ae 0x0000000020bfe708 0x0000000020bfe4df 0x00000000205a14b0 0x0000000020c143e0 0x0000000020c14023 0x0000000020c51850 0x0000000020c51521 0x0000000020c33c3e 0x0000000020c3364c 0x0000000020c5cc4b 0x0000000020c5cd37 0x00000000202625c3 0x000000002027b298 0x000000002027b275 0x000000002027b255 0x000000002027b235 0x000000002027b1fd 0x0000000014cbf556 0x0000000014cbe5b5 0x00000000202624c6 0x0000000020266d63 0x0000000020253124 0x000000002072e007 0x000000002072c7fc 0x000000002029beda 0x000000002029cb37 0x00000000202a5f18 0x00000000202a5ef5 0x00000000202a5ed5 0x00000000202a5eb5 0x00000000202a5e7d 0x0000000014d835b6 0x0000000014d82915\r\n2023.11.01 15:02:01.997478 [ 20761 ] {} <Fatal> BaseDaemon: 4. ? @ 0x00007fdcd4bc283c in ?\r\n2023.11.01 15:02:01.997628 [ 20761 ] {} <Fatal> BaseDaemon: 5. ? @ 0x00007fdcd4b72668 in ?\r\n2023.11.01 15:02:01.997773 [ 20761 ] {} <Fatal> BaseDaemon: 6. ? @ 0x00007fdcd4b5a4b8 in ?\r\n2023.11.01 15:02:01.997919 [ 20340 ] {2f84417b-8cc4-493d-95b1-cc41e8ce8d9f::all_0_2_14_4} <Fatal> : Logical error: 'Invalid number of rows in Chunk column UInt64 position 4: expected 8192, got 2'.\r\n2023.11.01 15:02:01.998818 [ 20762 ] {} <Fatal> BaseDaemon: ########## Short fault info ############\r\n2023.11.01 15:02:01.999013 [ 20762 ] {} <Fatal> BaseDaemon: (version 23.10.1.1, build id: EC9D8BF9A510B6167AE23FBBC122701ACC2A81E2, git hash: ac089003717e3805d9a9da20fe6a28793dde6219) (from thread 20340) Received signal 6\r\n2023.11.01 15:02:01.999195 [ 20762 ] {} <Fatal> BaseDaemon: Signal description: Aborted\r\n2023.11.01 15:02:01.999333 [ 20762 ] {} <Fatal> BaseDaemon: \r\n2023.11.01 15:02:01.999566 [ 20762 ] {} <Fatal> BaseDaemon: Stack trace: 0x00007fdcd4bc283c 0x00007fdcd4b72668 0x00007fdcd4b5a4b8 0x0000000014cffdf8 0x0000000014cffe95 0x0000000014d00394 0x000000000b170fd7 0x000000000b2526ae 0x0000000020bfe708 0x0000000020bfe4df 0x00000000205a14b0 0x0000000020c143e0 0x0000000020c14023 0x0000000020c51850 0x0000000020c51521 0x0000000020c33c3e 0x0000000020c3364c 0x0000000020c5cc4b 0x0000000020c5cd37 0x00000000202625c3 0x000000002027b298 0x000000002027b275 0x000000002027b255 0x000000002027b235 0x000000002027b1fd 0x0000000014cbf556 0x0000000014cbe5b5 0x00000000202624c6 0x0000000020266d63 0x0000000020253124 0x000000002072e007 0x000000002072c7fc 0x000000002029beda 0x000000002029cb37 0x00000000202a5f18 0x00000000202a5ef5 0x00000000202a5ed5 0x00000000202a5eb5 0x00000000202a5e7d 0x0000000014d835b6 0x0000000014d82915\r\n2023.11.01 15:02:01.999783 [ 20762 ] {} <Fatal> BaseDaemon: ########################################\r\n2023.11.01 15:02:01.999949 [ 20762 ] {} <Fatal> BaseDaemon: (version 23.10.1.1, build id: EC9D8BF9A510B6167AE23FBBC122701ACC2A81E2, git hash: ac089003717e3805d9a9da20fe6a28793dde6219) (from thread 20340) (query_id: 2f84417b-8cc4-493d-95b1-cc41e8ce8d9f::all_0_2_14_4) (query: ) Received signal Aborted (6)\r\n2023.11.01 15:02:02.000112 [ 20762 ] {} <Fatal> BaseDaemon: \r\n2023.11.01 15:02:02.000228 [ 20762 ] {} <Fatal> BaseDaemon: Stack trace: 0x00007fdcd4bc283c 0x00007fdcd4b72668 0x00007fdcd4b5a4b8 0x0000000014cffdf8 0x0000000014cffe95 0x0000000014d00394 0x000000000b170fd7 0x000000000b2526ae 0x0000000020bfe708 0x0000000020bfe4df 0x00000000205a14b0 0x0000000020c143e0 0x0000000020c14023 0x0000000020c51850 0x0000000020c51521 0x0000000020c33c3e 0x0000000020c3364c 0x0000000020c5cc4b 0x0000000020c5cd37 0x00000000202625c3 0x000000002027b298 0x000000002027b275 0x000000002027b255 0x000000002027b235 0x000000002027b1fd 0x0000000014cbf556 0x0000000014cbe5b5 0x00000000202624c6 0x0000000020266d63 0x0000000020253124 0x000000002072e007 0x000000002072c7fc 0x000000002029beda 0x000000002029cb37 0x00000000202a5f18 0x00000000202a5ef5 0x00000000202a5ed5 0x00000000202a5eb5 0x00000000202a5e7d 0x0000000014d835b6 0x0000000014d82915\r\n2023.11.01 15:02:02.000421 [ 20762 ] {} <Fatal> BaseDaemon: 4. ? @ 0x00007fdcd4bc283c in ?\r\n2023.11.01 15:02:02.000571 [ 20762 ] {} <Fatal> BaseDaemon: 5. ? @ 0x00007fdcd4b72668 in ?\r\n2023.11.01 15:02:02.000723 [ 20762 ] {} <Fatal> BaseDaemon: 6. ? @ 0x00007fdcd4b5a4b8 in ?\r\n2023.11.01 15:02:02.198785 [ 20761 ] {} <Fatal> BaseDaemon: 7. /home/tavplubix/ch/ClickHouse/src/Common/Exception.cpp:43: DB::abortOnFailedAssertion(String const&) @ 0x0000000014cffdf8 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:02.201905 [ 20762 ] {} <Fatal> BaseDaemon: 7. /home/tavplubix/ch/ClickHouse/src/Common/Exception.cpp:43: DB::abortOnFailedAssertion(String const&) @ 0x0000000014cffdf8 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:02.208390 [ 20760 ] {} <Fatal> BaseDaemon: 7. /home/tavplubix/ch/ClickHouse/src/Common/Exception.cpp:43: DB::abortOnFailedAssertion(String const&) @ 0x0000000014cffdf8 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:02.317152 [ 20761 ] {} <Fatal> BaseDaemon: 8. /home/tavplubix/ch/ClickHouse/src/Common/Exception.cpp:70: DB::handle_error_code(String const&, int, bool, std::vector<void*, std::allocator<void*>> const&) @ 0x0000000014cffe95 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:02.398071 [ 20762 ] {} <Fatal> BaseDaemon: 8. /home/tavplubix/ch/ClickHouse/src/Common/Exception.cpp:70: DB::handle_error_code(String const&, int, bool, std::vector<void*, std::allocator<void*>> const&) @ 0x0000000014cffe95 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:02.404434 [ 20760 ] {} <Fatal> BaseDaemon: 8. /home/tavplubix/ch/ClickHouse/src/Common/Exception.cpp:70: DB::handle_error_code(String const&, int, bool, std::vector<void*, std::allocator<void*>> const&) @ 0x0000000014cffe95 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:02.408871 [ 20761 ] {} <Fatal> BaseDaemon: 9. /home/tavplubix/ch/ClickHouse/src/Common/Exception.cpp:107: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x0000000014d00394 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:02.519059 [ 20761 ] {} <Fatal> BaseDaemon: 10. /home/tavplubix/ch/ClickHouse/src/Common/Exception.h:85: DB::Exception::Exception(String&&, int, bool) @ 0x000000000b170fd7 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:02.569895 [ 20762 ] {} <Fatal> BaseDaemon: 9. /home/tavplubix/ch/ClickHouse/src/Common/Exception.cpp:107: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x0000000014d00394 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:02.577991 [ 20760 ] {} <Fatal> BaseDaemon: 9. /home/tavplubix/ch/ClickHouse/src/Common/Exception.cpp:107: DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x0000000014d00394 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:02.728116 [ 20760 ] {} <Fatal> BaseDaemon: 10. /home/tavplubix/ch/ClickHouse/src/Common/Exception.h:85: DB::Exception::Exception(String&&, int, bool) @ 0x000000000b170fd7 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:02.767260 [ 20762 ] {} <Fatal> BaseDaemon: 10. /home/tavplubix/ch/ClickHouse/src/Common/Exception.h:85: DB::Exception::Exception(String&&, int, bool) @ 0x000000000b170fd7 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:04.571060 [ 20761 ] {} <Fatal> BaseDaemon: 11. /home/tavplubix/ch/ClickHouse/src/Common/Exception.h:113: DB::Exception::Exception<String, String, String>(int, FormatStringHelperImpl<std::type_identity<String>::type, std::type_identity<String>::type, std::type_identity<String>::type>, String&&, String&&, String&&) @ 0x000000000b2526ae in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:04.605351 [ 20760 ] {} <Fatal> BaseDaemon: 11. /home/tavplubix/ch/ClickHouse/src/Common/Exception.h:113: DB::Exception::Exception<String, String, String>(int, FormatStringHelperImpl<std::type_identity<String>::type, std::type_identity<String>::type, std::type_identity<String>::type>, String&&, String&&, String&&) @ 0x000000000b2526ae in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:04.691564 [ 20761 ] {} <Fatal> BaseDaemon: 12. /home/tavplubix/ch/ClickHouse/src/Processors/Chunk.cpp:75: DB::Chunk::checkNumRowsIsConsistent() @ 0x0000000020bfe708 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:04.719076 [ 20760 ] {} <Fatal> BaseDaemon: 12. /home/tavplubix/ch/ClickHouse/src/Processors/Chunk.cpp:75: DB::Chunk::checkNumRowsIsConsistent() @ 0x0000000020bfe708 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:04.806735 [ 20761 ] {} <Fatal> BaseDaemon: 13. /home/tavplubix/ch/ClickHouse/src/Processors/Chunk.cpp:19: DB::Chunk::Chunk(std::vector<COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::allocator<COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>, unsigned long) @ 0x0000000020bfe4df in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:04.833980 [ 20760 ] {} <Fatal> BaseDaemon: 13. /home/tavplubix/ch/ClickHouse/src/Processors/Chunk.cpp:19: DB::Chunk::Chunk(std::vector<COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::allocator<COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>, unsigned long) @ 0x0000000020bfe4df in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:04.895018 [ 20762 ] {} <Fatal> BaseDaemon: 11. /home/tavplubix/ch/ClickHouse/src/Common/Exception.h:113: DB::Exception::Exception<String, String, String>(int, FormatStringHelperImpl<std::type_identity<String>::type, std::type_identity<String>::type, std::type_identity<String>::type>, String&&, String&&, String&&) @ 0x000000000b2526ae in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:05.011175 [ 20762 ] {} <Fatal> BaseDaemon: 12. /home/tavplubix/ch/ClickHouse/src/Processors/Chunk.cpp:75: DB::Chunk::checkNumRowsIsConsistent() @ 0x0000000020bfe708 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:05.127502 [ 20762 ] {} <Fatal> BaseDaemon: 13. /home/tavplubix/ch/ClickHouse/src/Processors/Chunk.cpp:19: DB::Chunk::Chunk(std::vector<COW<DB::IColumn>::immutable_ptr<DB::IColumn>, std::allocator<COW<DB::IColumn>::immutable_ptr<DB::IColumn>>>, unsigned long) @ 0x0000000020bfe4df in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:05.128355 [ 20761 ] {} <Fatal> BaseDaemon: 14. /home/tavplubix/ch/ClickHouse/src/Storages/MergeTree/MergeTreeSequentialSource.cpp:208: DB::MergeTreeSequentialSource::generate() @ 0x00000000205a14b0 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:05.152718 [ 20760 ] {} <Fatal> BaseDaemon: 14. /home/tavplubix/ch/ClickHouse/src/Storages/MergeTree/MergeTreeSequentialSource.cpp:208: DB::MergeTreeSequentialSource::generate() @ 0x00000000205a14b0 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:05.269066 [ 20761 ] {} <Fatal> BaseDaemon: 15. /home/tavplubix/ch/ClickHouse/src/Processors/ISource.cpp:139: DB::ISource::tryGenerate() @ 0x0000000020c143e0 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:05.294628 [ 20760 ] {} <Fatal> BaseDaemon: 15. /home/tavplubix/ch/ClickHouse/src/Processors/ISource.cpp:139: DB::ISource::tryGenerate() @ 0x0000000020c143e0 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:05.362006 [ 20761 ] {} <Fatal> BaseDaemon: 16. /home/tavplubix/ch/ClickHouse/src/Processors/ISource.cpp:108: DB::ISource::work() @ 0x0000000020c14023 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:05.402713 [ 20761 ] {} <Fatal> BaseDaemon: 17. /home/tavplubix/ch/ClickHouse/src/Processors/Executors/ExecutionThreadContext.cpp:47: DB::executeJob(DB::ExecutingGraph::Node*, DB::ReadProgressCallback*) @ 0x0000000020c51850 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:05.438734 [ 20760 ] {} <Fatal> BaseDaemon: 16. /home/tavplubix/ch/ClickHouse/src/Processors/ISource.cpp:108: DB::ISource::work() @ 0x0000000020c14023 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:05.440054 [ 20761 ] {} <Fatal> BaseDaemon: 18. /home/tavplubix/ch/ClickHouse/src/Processors/Executors/ExecutionThreadContext.cpp:95: DB::ExecutionThreadContext::executeTask() @ 0x0000000020c51521 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:05.442949 [ 20762 ] {} <Fatal> BaseDaemon: 14. /home/tavplubix/ch/ClickHouse/src/Storages/MergeTree/MergeTreeSequentialSource.cpp:208: DB::MergeTreeSequentialSource::generate() @ 0x00000000205a14b0 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:05.509813 [ 20760 ] {} <Fatal> BaseDaemon: 17. /home/tavplubix/ch/ClickHouse/src/Processors/Executors/ExecutionThreadContext.cpp:47: DB::executeJob(DB::ExecutingGraph::Node*, DB::ReadProgressCallback*) @ 0x0000000020c51850 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:05.574309 [ 20760 ] {} <Fatal> BaseDaemon: 18. /home/tavplubix/ch/ClickHouse/src/Processors/Executors/ExecutionThreadContext.cpp:95: DB::ExecutionThreadContext::executeTask() @ 0x0000000020c51521 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:05.587789 [ 20762 ] {} <Fatal> BaseDaemon: 15. /home/tavplubix/ch/ClickHouse/src/Processors/ISource.cpp:139: DB::ISource::tryGenerate() @ 0x0000000020c143e0 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:05.608030 [ 20761 ] {} <Fatal> BaseDaemon: 19. /home/tavplubix/ch/ClickHouse/src/Processors/Executors/PipelineExecutor.cpp:272: DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x0000000020c33c3e in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:05.717267 [ 20761 ] {} <Fatal> BaseDaemon: 20. /home/tavplubix/ch/ClickHouse/src/Processors/Executors/PipelineExecutor.cpp:147: DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x0000000020c3364c in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:05.726160 [ 20762 ] {} <Fatal> BaseDaemon: 16. /home/tavplubix/ch/ClickHouse/src/Processors/ISource.cpp:108: DB::ISource::work() @ 0x0000000020c14023 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:05.783021 [ 20762 ] {} <Fatal> BaseDaemon: 17. /home/tavplubix/ch/ClickHouse/src/Processors/Executors/ExecutionThreadContext.cpp:47: DB::executeJob(DB::ExecutingGraph::Node*, DB::ReadProgressCallback*) @ 0x0000000020c51850 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:05.783994 [ 20760 ] {} <Fatal> BaseDaemon: 19. /home/tavplubix/ch/ClickHouse/src/Processors/Executors/PipelineExecutor.cpp:272: DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x0000000020c33c3e in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:05.820886 [ 20761 ] {} <Fatal> BaseDaemon: 21. /home/tavplubix/ch/ClickHouse/src/Processors/Executors/PullingPipelineExecutor.cpp:54: DB::PullingPipelineExecutor::pull(DB::Chunk&) @ 0x0000000020c5cc4b in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:05.847014 [ 20762 ] {} <Fatal> BaseDaemon: 18. /home/tavplubix/ch/ClickHouse/src/Processors/Executors/ExecutionThreadContext.cpp:95: DB::ExecutionThreadContext::executeTask() @ 0x0000000020c51521 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:05.914221 [ 20761 ] {} <Fatal> BaseDaemon: 22. /home/tavplubix/ch/ClickHouse/src/Processors/Executors/PullingPipelineExecutor.cpp:65: DB::PullingPipelineExecutor::pull(DB::Block&) @ 0x0000000020c5cd37 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:05.999248 [ 20760 ] {} <Fatal> BaseDaemon: 20. /home/tavplubix/ch/ClickHouse/src/Processors/Executors/PipelineExecutor.cpp:147: DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x0000000020c3364c in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:06.067591 [ 20762 ] {} <Fatal> BaseDaemon: 19. /home/tavplubix/ch/ClickHouse/src/Processors/Executors/PipelineExecutor.cpp:272: DB::PipelineExecutor::executeStepImpl(unsigned long, std::atomic<bool>*) @ 0x0000000020c33c3e in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:06.146341 [ 20760 ] {} <Fatal> BaseDaemon: 21. /home/tavplubix/ch/ClickHouse/src/Processors/Executors/PullingPipelineExecutor.cpp:54: DB::PullingPipelineExecutor::pull(DB::Chunk&) @ 0x0000000020c5cc4b in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:06.265712 [ 20762 ] {} <Fatal> BaseDaemon: 20. /home/tavplubix/ch/ClickHouse/src/Processors/Executors/PipelineExecutor.cpp:147: DB::PipelineExecutor::executeStep(std::atomic<bool>*) @ 0x0000000020c3364c in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:06.292821 [ 20760 ] {} <Fatal> BaseDaemon: 22. /home/tavplubix/ch/ClickHouse/src/Processors/Executors/PullingPipelineExecutor.cpp:65: DB::PullingPipelineExecutor::pull(DB::Block&) @ 0x0000000020c5cd37 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:06.339739 [ 20762 ] {} <Fatal> BaseDaemon: 21. /home/tavplubix/ch/ClickHouse/src/Processors/Executors/PullingPipelineExecutor.cpp:54: DB::PullingPipelineExecutor::pull(DB::Chunk&) @ 0x0000000020c5cc4b in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:06.450763 [ 20762 ] {} <Fatal> BaseDaemon: 22. /home/tavplubix/ch/ClickHouse/src/Processors/Executors/PullingPipelineExecutor.cpp:65: DB::PullingPipelineExecutor::pull(DB::Block&) @ 0x0000000020c5cd37 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:06.651935 [ 20761 ] {} <Fatal> BaseDaemon: 23. /home/tavplubix/ch/ClickHouse/src/Storages/MergeTree/MergeTask.cpp:445: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::executeImpl() @ 0x00000000202625c3 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:07.249217 [ 20760 ] {} <Fatal> BaseDaemon: 23. /home/tavplubix/ch/ClickHouse/src/Storages/MergeTree/MergeTask.cpp:445: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::executeImpl() @ 0x00000000202625c3 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:07.399732 [ 20762 ] {} <Fatal> BaseDaemon: 23. /home/tavplubix/ch/ClickHouse/src/Storages/MergeTree/MergeTask.cpp:445: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::executeImpl() @ 0x00000000202625c3 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:07.557362 [ 20761 ] {} <Fatal> BaseDaemon: 24. /home/tavplubix/ch/ClickHouse/src/Storages/MergeTree/MergeTask.h:241: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda0'()::operator()() const @ 0x000000002027b298 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:07.889280 [ 20760 ] {} <Fatal> BaseDaemon: 24. /home/tavplubix/ch/ClickHouse/src/Storages/MergeTree/MergeTask.h:241: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda0'()::operator()() const @ 0x000000002027b298 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:08.287300 [ 20762 ] {} <Fatal> BaseDaemon: 24. /home/tavplubix/ch/ClickHouse/src/Storages/MergeTree/MergeTask.h:241: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda0'()::operator()() const @ 0x000000002027b298 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:08.617333 [ 20761 ] {} <Fatal> BaseDaemon: 25. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/invoke.h:394: decltype(std::declval<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda0'()&>()()) std::__invoke[abi:v15000]<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda0'()&>(DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda0'()&) @ 0x000000002027b275 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:08.674533 [ 20760 ] {} <Fatal> BaseDaemon: 25. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/invoke.h:394: decltype(std::declval<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda0'()&>()()) std::__invoke[abi:v15000]<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda0'()&>(DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda0'()&) @ 0x000000002027b275 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:09.171127 [ 20762 ] {} <Fatal> BaseDaemon: 25. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/invoke.h:394: decltype(std::declval<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda0'()&>()()) std::__invoke[abi:v15000]<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda0'()&>(DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda0'()&) @ 0x000000002027b275 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:09.568871 [ 20761 ] {} <Fatal> BaseDaemon: 26. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/invoke.h:470: bool std::__invoke_void_return_wrapper<bool, false>::__call<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda0'()&>(DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda0'()&) @ 0x000000002027b255 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:09.774541 [ 20762 ] {} <Fatal> BaseDaemon: 26. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/invoke.h:470: bool std::__invoke_void_return_wrapper<bool, false>::__call<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda0'()&>(DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda0'()&) @ 0x000000002027b255 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:09.825387 [ 20760 ] {} <Fatal> BaseDaemon: 26. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/invoke.h:470: bool std::__invoke_void_return_wrapper<bool, false>::__call<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda0'()&>(DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda0'()&) @ 0x000000002027b255 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:10.483803 [ 20762 ] {} <Fatal> BaseDaemon: 27. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/function.h:235: std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda0'(), bool ()>::operator()[abi:v15000]() @ 0x000000002027b235 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:10.663880 [ 20761 ] {} <Fatal> BaseDaemon: 27. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/function.h:235: std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda0'(), bool ()>::operator()[abi:v15000]() @ 0x000000002027b235 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:10.991315 [ 20760 ] {} <Fatal> BaseDaemon: 27. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/function.h:235: std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda0'(), bool ()>::operator()[abi:v15000]() @ 0x000000002027b235 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:11.572420 [ 20762 ] {} <Fatal> BaseDaemon: 28. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda0'(), bool ()>>(std::__function::__policy_storage const*) @ 0x000000002027b1fd in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:11.653083 [ 20761 ] {} <Fatal> BaseDaemon: 28. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda0'(), bool ()>>(std::__function::__policy_storage const*) @ 0x000000002027b1fd in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:11.660455 [ 20760 ] {} <Fatal> BaseDaemon: 28. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/function.h:716: bool std::__function::__policy_invoker<bool ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTask::ExecuteAndFinalizeHorizontalPart::subtasks::'lambda0'(), bool ()>>(std::__function::__policy_storage const*) @ 0x000000002027b1fd in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:11.772065 [ 20762 ] {} <Fatal> BaseDaemon: 29. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/function.h:848: std::__function::__policy_func<bool ()>::operator()[abi:v15000]() const @ 0x0000000014cbf556 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:11.856782 [ 20761 ] {} <Fatal> BaseDaemon: 29. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/function.h:848: std::__function::__policy_func<bool ()>::operator()[abi:v15000]() const @ 0x0000000014cbf556 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:11.858193 [ 20760 ] {} <Fatal> BaseDaemon: 29. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/function.h:848: std::__function::__policy_func<bool ()>::operator()[abi:v15000]() const @ 0x0000000014cbf556 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:11.970132 [ 20762 ] {} <Fatal> BaseDaemon: 30. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/function.h:1187: std::function<bool ()>::operator()() const @ 0x0000000014cbe5b5 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:12.056809 [ 20761 ] {} <Fatal> BaseDaemon: 30. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/function.h:1187: std::function<bool ()>::operator()() const @ 0x0000000014cbe5b5 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:12.057244 [ 20760 ] {} <Fatal> BaseDaemon: 30. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/function.h:1187: std::function<bool ()>::operator()() const @ 0x0000000014cbe5b5 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:12.541294 [ 20762 ] {} <Fatal> BaseDaemon: 31. /home/tavplubix/ch/ClickHouse/src/Storages/MergeTree/MergeTask.cpp:433: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x00000000202624c6 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:12.781691 [ 20761 ] {} <Fatal> BaseDaemon: 31. /home/tavplubix/ch/ClickHouse/src/Storages/MergeTree/MergeTask.cpp:433: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x00000000202624c6 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:12.834319 [ 20760 ] {} <Fatal> BaseDaemon: 31. /home/tavplubix/ch/ClickHouse/src/Storages/MergeTree/MergeTask.cpp:433: DB::MergeTask::ExecuteAndFinalizeHorizontalPart::execute() @ 0x00000000202624c6 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:13.528887 [ 20762 ] {} <Fatal> BaseDaemon: 32. /home/tavplubix/ch/ClickHouse/src/Storages/MergeTree/MergeTask.cpp:854: DB::MergeTask::execute() @ 0x0000000020266d63 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:13.671968 [ 20760 ] {} <Fatal> BaseDaemon: 32. /home/tavplubix/ch/ClickHouse/src/Storages/MergeTree/MergeTask.cpp:854: DB::MergeTask::execute() @ 0x0000000020266d63 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:13.802129 [ 20762 ] {} <Fatal> BaseDaemon: 33. /home/tavplubix/ch/ClickHouse/src/Storages/MergeTree/MergeFromLogEntryTask.h:36: DB::MergeFromLogEntryTask::executeInnerTask() @ 0x0000000020253124 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:13.809583 [ 20761 ] {} <Fatal> BaseDaemon: 32. /home/tavplubix/ch/ClickHouse/src/Storages/MergeTree/MergeTask.cpp:854: DB::MergeTask::execute() @ 0x0000000020266d63 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:13.877148 [ 20760 ] {} <Fatal> BaseDaemon: 33. /home/tavplubix/ch/ClickHouse/src/Storages/MergeTree/MergeFromLogEntryTask.h:36: DB::MergeFromLogEntryTask::executeInnerTask() @ 0x0000000020253124 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:13.992050 [ 20762 ] {} <Fatal> BaseDaemon: 34. /home/tavplubix/ch/ClickHouse/src/Storages/MergeTree/ReplicatedMergeMutateTaskBase.cpp:190: DB::ReplicatedMergeMutateTaskBase::executeImpl() @ 0x000000002072e007 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:14.008959 [ 20760 ] {} <Fatal> BaseDaemon: 34. /home/tavplubix/ch/ClickHouse/src/Storages/MergeTree/ReplicatedMergeMutateTaskBase.cpp:190: DB::ReplicatedMergeMutateTaskBase::executeImpl() @ 0x000000002072e007 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:14.074426 [ 20761 ] {} <Fatal> BaseDaemon: 33. /home/tavplubix/ch/ClickHouse/src/Storages/MergeTree/MergeFromLogEntryTask.h:36: DB::MergeFromLogEntryTask::executeInnerTask() @ 0x0000000020253124 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:14.183891 [ 20762 ] {} <Fatal> BaseDaemon: 35. /home/tavplubix/ch/ClickHouse/src/Storages/MergeTree/ReplicatedMergeMutateTaskBase.cpp:46: DB::ReplicatedMergeMutateTaskBase::executeStep() @ 0x000000002072c7fc in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:14.200508 [ 20760 ] {} <Fatal> BaseDaemon: 35. /home/tavplubix/ch/ClickHouse/src/Storages/MergeTree/ReplicatedMergeMutateTaskBase.cpp:46: DB::ReplicatedMergeMutateTaskBase::executeStep() @ 0x000000002072c7fc in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:14.271348 [ 20761 ] {} <Fatal> BaseDaemon: 34. /home/tavplubix/ch/ClickHouse/src/Storages/MergeTree/ReplicatedMergeMutateTaskBase.cpp:190: DB::ReplicatedMergeMutateTaskBase::executeImpl() @ 0x000000002072e007 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:14.311858 [ 20762 ] {} <Fatal> BaseDaemon: 36. /home/tavplubix/ch/ClickHouse/src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:280: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x000000002029beda in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:14.331675 [ 20760 ] {} <Fatal> BaseDaemon: 36. /home/tavplubix/ch/ClickHouse/src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:280: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x000000002029beda in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:14.446169 [ 20762 ] {} <Fatal> BaseDaemon: 37. /home/tavplubix/ch/ClickHouse/src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:346: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x000000002029cb37 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:14.464792 [ 20760 ] {} <Fatal> BaseDaemon: 37. /home/tavplubix/ch/ClickHouse/src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:346: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x000000002029cb37 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:14.465100 [ 20761 ] {} <Fatal> BaseDaemon: 35. /home/tavplubix/ch/ClickHouse/src/Storages/MergeTree/ReplicatedMergeMutateTaskBase.cpp:46: DB::ReplicatedMergeMutateTaskBase::executeStep() @ 0x000000002072c7fc in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:14.597874 [ 20761 ] {} <Fatal> BaseDaemon: 36. /home/tavplubix/ch/ClickHouse/src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:280: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::routine(std::shared_ptr<DB::TaskRuntimeData>) @ 0x000000002029beda in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:14.611881 [ 20762 ] {} <Fatal> BaseDaemon: 38. /home/tavplubix/ch/ClickHouse/src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:56: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::MergeTreeBackgroundExecutor(String, unsigned long, unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, std::basic_string_view<char, std::char_traits<char>>)::'lambda'()::operator()() const @ 0x00000000202a5f18 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:14.637697 [ 20760 ] {} <Fatal> BaseDaemon: 38. /home/tavplubix/ch/ClickHouse/src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:56: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::MergeTreeBackgroundExecutor(String, unsigned long, unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, std::basic_string_view<char, std::char_traits<char>>)::'lambda'()::operator()() const @ 0x00000000202a5f18 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:14.728933 [ 20761 ] {} <Fatal> BaseDaemon: 37. /home/tavplubix/ch/ClickHouse/src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:346: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::threadFunction() @ 0x000000002029cb37 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:14.791101 [ 20762 ] {} <Fatal> BaseDaemon: 39. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/invoke.h:394: decltype(std::declval<DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::MergeTreeBackgroundExecutor(String, unsigned long, unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, std::basic_string_view<char, std::char_traits<char>>)::'lambda'()&>()()) std::__invoke[abi:v15000]<DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::MergeTreeBackgroundExecutor(String, unsigned long, unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, std::basic_string_view<char, std::char_traits<char>>)::'lambda'()&>(DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::MergeTreeBackgroundExecutor(String, unsigned long, unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, std::basic_string_view<char, std::char_traits<char>>)::'lambda'()&) @ 0x00000000202a5ef5 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:14.817706 [ 20760 ] {} <Fatal> BaseDaemon: 39. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/invoke.h:394: decltype(std::declval<DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::MergeTreeBackgroundExecutor(String, unsigned long, unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, std::basic_string_view<char, std::char_traits<char>>)::'lambda'()&>()()) std::__invoke[abi:v15000]<DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::MergeTreeBackgroundExecutor(String, unsigned long, unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, std::basic_string_view<char, std::char_traits<char>>)::'lambda'()&>(DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::MergeTreeBackgroundExecutor(String, unsigned long, unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, std::basic_string_view<char, std::char_traits<char>>)::'lambda'()&) @ 0x00000000202a5ef5 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:14.900963 [ 20761 ] {} <Fatal> BaseDaemon: 38. /home/tavplubix/ch/ClickHouse/src/Storages/MergeTree/MergeTreeBackgroundExecutor.cpp:56: DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::MergeTreeBackgroundExecutor(String, unsigned long, unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, std::basic_string_view<char, std::char_traits<char>>)::'lambda'()::operator()() const @ 0x00000000202a5f18 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:14.962647 [ 20762 ] {} <Fatal> BaseDaemon: 40. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/invoke.h:480: void std::__invoke_void_return_wrapper<void, true>::__call<DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::MergeTreeBackgroundExecutor(String, unsigned long, unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, std::basic_string_view<char, std::char_traits<char>>)::'lambda'()&>(DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::MergeTreeBackgroundExecutor(String, unsigned long, unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, std::basic_string_view<char, std::char_traits<char>>)::'lambda'()&) @ 0x00000000202a5ed5 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:14.989927 [ 20760 ] {} <Fatal> BaseDaemon: 40. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/invoke.h:480: void std::__invoke_void_return_wrapper<void, true>::__call<DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::MergeTreeBackgroundExecutor(String, unsigned long, unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, std::basic_string_view<char, std::char_traits<char>>)::'lambda'()&>(DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::MergeTreeBackgroundExecutor(String, unsigned long, unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, std::basic_string_view<char, std::char_traits<char>>)::'lambda'()&) @ 0x00000000202a5ed5 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:15.077594 [ 20761 ] {} <Fatal> BaseDaemon: 39. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/invoke.h:394: decltype(std::declval<DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::MergeTreeBackgroundExecutor(String, unsigned long, unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, std::basic_string_view<char, std::char_traits<char>>)::'lambda'()&>()()) std::__invoke[abi:v15000]<DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::MergeTreeBackgroundExecutor(String, unsigned long, unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, std::basic_string_view<char, std::char_traits<char>>)::'lambda'()&>(DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::MergeTreeBackgroundExecutor(String, unsigned long, unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, std::basic_string_view<char, std::char_traits<char>>)::'lambda'()&) @ 0x00000000202a5ef5 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:15.133274 [ 20762 ] {} <Fatal> BaseDaemon: 41. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/function.h:235: std::__function::__default_alloc_func<DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::MergeTreeBackgroundExecutor(String, unsigned long, unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, std::basic_string_view<char, std::char_traits<char>>)::'lambda'(), void ()>::operator()[abi:v15000]() @ 0x00000000202a5eb5 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:15.161304 [ 20760 ] {} <Fatal> BaseDaemon: 41. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/function.h:235: std::__function::__default_alloc_func<DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::MergeTreeBackgroundExecutor(String, unsigned long, unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, std::basic_string_view<char, std::char_traits<char>>)::'lambda'(), void ()>::operator()[abi:v15000]() @ 0x00000000202a5eb5 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:15.247696 [ 20761 ] {} <Fatal> BaseDaemon: 40. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/invoke.h:480: void std::__invoke_void_return_wrapper<void, true>::__call<DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::MergeTreeBackgroundExecutor(String, unsigned long, unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, std::basic_string_view<char, std::char_traits<char>>)::'lambda'()&>(DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::MergeTreeBackgroundExecutor(String, unsigned long, unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, std::basic_string_view<char, std::char_traits<char>>)::'lambda'()&) @ 0x00000000202a5ed5 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:15.304610 [ 20762 ] {} <Fatal> BaseDaemon: 42. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/function.h:716: void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::MergeTreeBackgroundExecutor(String, unsigned long, unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, std::basic_string_view<char, std::char_traits<char>>)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x00000000202a5e7d in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:15.333456 [ 20760 ] {} <Fatal> BaseDaemon: 42. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/function.h:716: void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::MergeTreeBackgroundExecutor(String, unsigned long, unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, std::basic_string_view<char, std::char_traits<char>>)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x00000000202a5e7d in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:15.421137 [ 20761 ] {} <Fatal> BaseDaemon: 41. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/function.h:235: std::__function::__default_alloc_func<DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::MergeTreeBackgroundExecutor(String, unsigned long, unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, std::basic_string_view<char, std::char_traits<char>>)::'lambda'(), void ()>::operator()[abi:v15000]() @ 0x00000000202a5eb5 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:15.422520 [ 20762 ] {} <Fatal> BaseDaemon: 43. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/function.h:848: std::__function::__policy_func<void ()>::operator()[abi:v15000]() const @ 0x0000000014d835b6 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:15.449761 [ 20760 ] {} <Fatal> BaseDaemon: 43. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/function.h:848: std::__function::__policy_func<void ()>::operator()[abi:v15000]() const @ 0x0000000014d835b6 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:15.530512 [ 20762 ] {} <Fatal> BaseDaemon: 44. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/function.h:1187: std::function<void ()>::operator()() const @ 0x0000000014d82915 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:15.530735 [ 20762 ] {} <Fatal> BaseDaemon: Integrity check of the executable skipped because the reference checksum could not be read.\r\n2023.11.01 15:02:15.557124 [ 20760 ] {} <Fatal> BaseDaemon: 44. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/function.h:1187: std::function<void ()>::operator()() const @ 0x0000000014d82915 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:15.557472 [ 20760 ] {} <Fatal> BaseDaemon: Integrity check of the executable skipped because the reference checksum could not be read.\r\n2023.11.01 15:02:15.595884 [ 20761 ] {} <Fatal> BaseDaemon: 42. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/function.h:716: void std::__function::__policy_invoker<void ()>::__call_impl<std::__function::__default_alloc_func<DB::MergeTreeBackgroundExecutor<DB::DynamicRuntimeQueue>::MergeTreeBackgroundExecutor(String, unsigned long, unsigned long, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, StrongTypedef<unsigned long, CurrentMetrics::MetricTag>, std::basic_string_view<char, std::char_traits<char>>)::'lambda'(), void ()>>(std::__function::__policy_storage const*) @ 0x00000000202a5e7d in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:15.718049 [ 20761 ] {} <Fatal> BaseDaemon: 43. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/function.h:848: std::__function::__policy_func<void ()>::operator()[abi:v15000]() const @ 0x0000000014d835b6 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:15.830666 [ 20761 ] {} <Fatal> BaseDaemon: 44. /home/tavplubix/ch/ClickHouse/contrib/llvm-project/libcxx/include/__functional/function.h:1187: std::function<void ()>::operator()() const @ 0x0000000014d82915 in /home/tavplubix/ch/ClickHouse/cmake-build-debug/programs/clickhouse\r\n2023.11.01 15:02:15.830922 [ 20761 ] {} <Fatal> BaseDaemon: Integrity check of the executable skipped because the reference checksum could not be read.\r\n\r\n```\n",
  "hints_text": "https://s3.amazonaws.com/clickhouse-test-reports/56176/c4c5defc37b1216935b7c659e33fc9367d1c70c8/upgrade_check__tsan_.html\nhttps://s3.amazonaws.com/clickhouse-test-reports/56215/977380b17176e51a59e65a611545bba5526cbe67/upgrade_check__debug_.html \nI believe I've stamped on the same problem here: https://s3.amazonaws.com/clickhouse-test-reports/55841/6548ce2eb52200383907e2dc6d411664efaf8df7/fuzzer_astfuzzerasan/report.html\r\n\r\n100% reproducible with `old_school_table` from `01712_no_adaptive_granularity_vertical_merge.sql` and query\r\n\r\n``` sql\r\nSELECT isDecimalOverflow(toNullable(toDecimal64(NULL, NULL, 1024)), isDecimalOverflow(toDecimal32(42, 0)), materialize(toNullable(toDecimal32(1025, 1)))), toNullable(toDecimal64(toDecimal64(2147483648, 0), NULL, 1048577, 2)), * FROM old_school_table PREWHERE isDecimalOverflow(materialize(toNullable(toDecimal64(1025, 10))), 3) ORDER BY isDecimalOverflow(materialize(toNullable(toDecimal32(3, 1))), 2) ASC NULLS LAST, toNullable(toDecimal64(65535, 1)) DESC NULLS LAST\r\n```\r\n\r\nbtw, if you replace `prewhere` with `where` - it works.\nhttps://s3.amazonaws.com/clickhouse-test-reports/56374/b666ca93c7fc1d018d37acba0ca564dcc8f239b6/upgrade_check__tsan_.html",
  "created_at": "2024-01-27T19:26:39Z"
}