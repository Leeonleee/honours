diff --git a/src/DataTypes/tests/gtest_data_type_get_common_type.cpp b/src/DataTypes/tests/gtest_data_type_get_common_type.cpp
index bd13de79ef62..8212555e8bcc 100644
--- a/src/DataTypes/tests/gtest_data_type_get_common_type.cpp
+++ b/src/DataTypes/tests/gtest_data_type_get_common_type.cpp
@@ -86,7 +86,7 @@ TEST_P(LeastSuperTypeTest, getLeastSupertype)
 
 class MostSubtypeTest : public TypeTest {};
 
-TEST_P(MostSubtypeTest, getLeastSupertype)
+TEST_P(MostSubtypeTest, getMostSubtype)
 {
     if (this->expected_type)
     {
@@ -124,9 +124,7 @@ INSTANTIATE_TEST_SUITE_P(data_type,
             {"Date DateTime64(3)", "DateTime64(3)"},
             {"DateTime DateTime64(3)", "DateTime64(3)"},
             {"DateTime DateTime64(0)", "DateTime64(0)"},
-            {"DateTime64(9) DateTime64(3)", "DateTime64(3)"},
-            {"DateTime DateTime64(12)", "DateTime64(8)"},
-            {"Date DateTime64(15)", "DateTime64(13)"},
+            {"DateTime64(9) DateTime64(3)", "DateTime64(9)"},
 
             {"String FixedString(32) FixedString(8)", "String"},
 
diff --git a/tests/queries/0_stateless/01259_datetime64_ubsan.sql b/tests/queries/0_stateless/01259_datetime64_ubsan.sql
index 3cba78c713f7..4bc7a71dac39 100644
--- a/tests/queries/0_stateless/01259_datetime64_ubsan.sql
+++ b/tests/queries/0_stateless/01259_datetime64_ubsan.sql
@@ -1,2 +1,2 @@
-select now64(10); -- { serverError 407 }
+select now64(10); -- { serverError 69 }
 select length(toString(now64(9)));
diff --git a/tests/queries/0_stateless/01268_DateTime64_in_WHERE.sql b/tests/queries/0_stateless/01268_DateTime64_in_WHERE.sql
index 4ffcf3be3c99..63d9a11daaad 100644
--- a/tests/queries/0_stateless/01268_DateTime64_in_WHERE.sql
+++ b/tests/queries/0_stateless/01268_DateTime64_in_WHERE.sql
@@ -6,7 +6,7 @@ WITH '2020-02-05 14:34:12.333' as S, toDateTime64(S, 3) as DT64 SELECT * WHERE D
 WITH '2020-02-05 14:34:12.333' as S, toDateTime64(S, 3) as DT64 SELECT * WHERE materialize(S) = DT64; -- {serverError 43}
 
 SELECT * WHERE toDateTime64(123.345, 3) == 'ABCD'; -- {serverError 53} -- invalid DateTime64 string
-SELECT * WHERE toDateTime64(123.345, 3) == '2020-02-05 14:34:12.33333333333333333333333333333333333333333333333333333333'; -- {serverError 53} -- invalid string length
+SELECT * WHERE toDateTime64(123.345, 3) == '2020-02-05 14:34:12.33333333333333333333333333333333333333333333333333333333';
 
 SELECT 'in SELECT';
 WITH '2020-02-05 14:34:12.333' as S, toDateTime64(S, 3) as DT64 SELECT DT64 = S;
diff --git a/tests/queries/0_stateless/01340_datetime64_fpe.reference b/tests/queries/0_stateless/01340_datetime64_fpe.reference
new file mode 100644
index 000000000000..0a99fbafde48
--- /dev/null
+++ b/tests/queries/0_stateless/01340_datetime64_fpe.reference
@@ -0,0 +1,22 @@
+2011-11-11 11:11:11
+2011-11-11 11:11:11
+2011-11-11 11:11:11
+2011-11-11 11:11:11
+2011-11-11 11:11:11
+2011-11-11 11:11:11
+2011-11-11 11:11:11
+2011-11-11 11:11:11
+2011-11-11 11:11:11
+2011-11-11 11:11:11
+2011-11-11 11:11:11
+2011-11-11 11:11:11
+2011-11-11 11:11:11
+2011-11-11 11:11:11
+2011-11-11 11:11:11
+2011-11-11 11:11:11
+2011-11-11 11:11:11
+2011-11-11 11:11:11
+2011-11-11 11:11:11
+2011-11-11 11:11:11
+2011-11-11 11:11:11
+2011-11-11 11:11:11
diff --git a/tests/queries/0_stateless/01340_datetime64_fpe.sql b/tests/queries/0_stateless/01340_datetime64_fpe.sql
new file mode 100644
index 000000000000..3e76e3164b1c
--- /dev/null
+++ b/tests/queries/0_stateless/01340_datetime64_fpe.sql
@@ -0,0 +1,71 @@
+WITH toDateTime64('2019-09-16 19:20:12.3456789102019-09-16 19:20:12.345678910', 0) AS dt64 SELECT dt64; -- { serverError 6 }
+
+SELECT toDateTime64('2011-11-11 11:11:11.1234567890123456789', 0);
+SELECT toDateTime64('2011-11-11 11:11:11.-12345678901234567890', 0); -- { serverError 6 }
+
+
+SELECT toDateTime64('2011-11-11 11:11:11.1', 0);
+SELECT toDateTime64('2011-11-11 11:11:11.11', 0);
+SELECT toDateTime64('2011-11-11 11:11:11.111', 0);
+SELECT toDateTime64('2011-11-11 11:11:11.1111', 0);
+SELECT toDateTime64('2011-11-11 11:11:11.11111', 0);
+SELECT toDateTime64('2011-11-11 11:11:11.111111', 0);
+SELECT toDateTime64('2011-11-11 11:11:11.1111111', 0);
+SELECT toDateTime64('2011-11-11 11:11:11.11111111', 0);
+SELECT toDateTime64('2011-11-11 11:11:11.111111111', 0);
+SELECT toDateTime64('2011-11-11 11:11:11.1111111111', 0);
+SELECT toDateTime64('2011-11-11 11:11:11.11111111111', 0);
+SELECT toDateTime64('2011-11-11 11:11:11.111111111111', 0);
+SELECT toDateTime64('2011-11-11 11:11:11.1111111111111', 0);
+SELECT toDateTime64('2011-11-11 11:11:11.11111111111111', 0);
+SELECT toDateTime64('2011-11-11 11:11:11.111111111111111', 0);
+SELECT toDateTime64('2011-11-11 11:11:11.1111111111111111', 0);
+SELECT toDateTime64('2011-11-11 11:11:11.11111111111111111', 0);
+SELECT toDateTime64('2011-11-11 11:11:11.111111111111111111', 0);
+SELECT toDateTime64('2011-11-11 11:11:11.1111111111111111111', 0);
+SELECT toDateTime64('2011-11-11 11:11:11.11111111111111111111', 0);
+SELECT toDateTime64('2011-11-11 11:11:11.111111111111111111111', 0);
+
+SELECT toDateTime64('2011-11-11 11:11:11.-1', 0); -- { serverError 6 }
+SELECT toDateTime64('2011-11-11 11:11:11.-11', 0); -- { serverError 6 }
+SELECT toDateTime64('2011-11-11 11:11:11.-111', 0); -- { serverError 6 }
+SELECT toDateTime64('2011-11-11 11:11:11.-1111', 0); -- { serverError 6 }
+SELECT toDateTime64('2011-11-11 11:11:11.-11111', 0); -- { serverError 6 }
+SELECT toDateTime64('2011-11-11 11:11:11.-111111', 0); -- { serverError 6 }
+SELECT toDateTime64('2011-11-11 11:11:11.-1111111', 0); -- { serverError 6 }
+SELECT toDateTime64('2011-11-11 11:11:11.-11111111', 0); -- { serverError 6 }
+SELECT toDateTime64('2011-11-11 11:11:11.-111111111', 0); -- { serverError 6 }
+SELECT toDateTime64('2011-11-11 11:11:11.-1111111111', 0); -- { serverError 6 }
+SELECT toDateTime64('2011-11-11 11:11:11.-11111111111', 0); -- { serverError 6 }
+SELECT toDateTime64('2011-11-11 11:11:11.-111111111111', 0); -- { serverError 6 }
+SELECT toDateTime64('2011-11-11 11:11:11.-1111111111111', 0); -- { serverError 6 }
+SELECT toDateTime64('2011-11-11 11:11:11.-11111111111111', 0); -- { serverError 6 }
+SELECT toDateTime64('2011-11-11 11:11:11.-111111111111111', 0); -- { serverError 6 }
+SELECT toDateTime64('2011-11-11 11:11:11.-1111111111111111', 0); -- { serverError 6 }
+SELECT toDateTime64('2011-11-11 11:11:11.-11111111111111111', 0); -- { serverError 6 }
+SELECT toDateTime64('2011-11-11 11:11:11.-111111111111111111', 0); -- { serverError 6 }
+SELECT toDateTime64('2011-11-11 11:11:11.-1111111111111111111', 0); -- { serverError 6 }
+SELECT toDateTime64('2011-11-11 11:11:11.-11111111111111111111', 0); -- { serverError 6 }
+SELECT toDateTime64('2011-11-11 11:11:11.-111111111111111111111', 0); -- { serverError 6 }
+
+SELECT toDateTime64('2011-11-11 11:11:11.+1', 0); -- { serverError 6 }
+SELECT toDateTime64('2011-11-11 11:11:11.++11', 10); -- { serverError 69 }
+SELECT toDateTime64('2011-11-11 11:11:11.+111', 3); -- { serverError 6 }
+SELECT toDateTime64('2011-11-11 11:11:11.+++1111', 5); -- { serverError 6 }
+SELECT toDateTime64('2011-11-11 11:11:11.+11111', 7); -- { serverError 6 }
+SELECT toDateTime64('2011-11-11 11:11:11.+++++111111', 2); -- { serverError 6 }
+SELECT toDateTime64('2011-11-11 11:11:11.+1111111', 1); -- { serverError 6 }
+SELECT toDateTime64('2011-11-11 11:11:11.++++++11111111', 8); -- { serverError 6 }
+SELECT toDateTime64('2011-11-11 11:11:11.+111111111', 9); -- { serverError 6 }
+SELECT toDateTime64('2011-11-11 11:11:11.+++++++1111111111', 6); -- { serverError 6 }
+SELECT toDateTime64('2011-11-11 11:11:11.+11111111111', 4); -- { serverError 6 }
+SELECT toDateTime64('2011-11-11 11:11:11.++++++++111111111111', 11);  -- { serverError 69 }
+SELECT toDateTime64('2011-11-11 11:11:11.+1111111111111', 15); -- { serverError 69 }
+SELECT toDateTime64('2011-11-11 11:11:11.+++++++++11111111111111', 13); -- { serverError 69 }
+SELECT toDateTime64('2011-11-11 11:11:11.+111111111111111', 12); -- { serverError 69 }
+SELECT toDateTime64('2011-11-11 11:11:11.++++++++++1111111111111111', 16); -- { serverError 69 }
+SELECT toDateTime64('2011-11-11 11:11:11.+11111111111111111', 14); -- { serverError 69 }
+SELECT toDateTime64('2011-11-11 11:11:11.+++++++++++111111111111111111', 15); -- { serverError 69 }
+SELECT toDateTime64('2011-11-11 11:11:11.+1111111111111111111', 17); -- { serverError 69 }
+SELECT toDateTime64('2011-11-11 11:11:11.++++++++++++11111111111111111111', 19); -- { serverError 69 }
+SELECT toDateTime64('2011-11-11 11:11:11.+111111111111111111111', 18); -- { serverError 69 }
diff --git a/tests/queries/0_stateless/01341_datetime64_wrong_supertype.reference b/tests/queries/0_stateless/01341_datetime64_wrong_supertype.reference
new file mode 100644
index 000000000000..09076dd68dba
--- /dev/null
+++ b/tests/queries/0_stateless/01341_datetime64_wrong_supertype.reference
@@ -0,0 +1,1 @@
+['2000-01-01 01:01:01.123000','2000-01-01 01:01:01.123456']
diff --git a/tests/queries/0_stateless/01341_datetime64_wrong_supertype.sql b/tests/queries/0_stateless/01341_datetime64_wrong_supertype.sql
new file mode 100644
index 000000000000..39acaf93e347
--- /dev/null
+++ b/tests/queries/0_stateless/01341_datetime64_wrong_supertype.sql
@@ -0,0 +1,1 @@
+SELECT [toDateTime64('2000-01-01 01:01:01.123', 3), toDateTime64('2000-01-01 01:01:01.123456', 6)];
