{
  "repo": "ClickHouse/ClickHouse",
  "pull_number": 80293,
  "instance_id": "ClickHouse__ClickHouse-80293",
  "issue_numbers": [
    "80292"
  ],
  "base_commit": "c01849379548b69cb35d34969453b7786b04c0c4",
  "patch": "diff --git a/src/Client/ClientBaseOptimizedParts.cpp b/src/Client/ClientBaseOptimizedParts.cpp\nindex 6c1fc27dc70e..2f369d41b0df 100644\n--- a/src/Client/ClientBaseOptimizedParts.cpp\n+++ b/src/Client/ClientBaseOptimizedParts.cpp\n@@ -102,6 +102,10 @@ void ClientApplicationBase::parseAndCheckOptions(OptionsDescription & options_de\n     /// Check positional options.\n     for (const auto & op : parsed.options)\n     {\n+        /// Skip all options after empty `--`. These are processed separately into the Application configuration.\n+        if (op.string_key.empty() && op.original_tokens[0].starts_with(\"--\"))\n+            break;\n+\n         if (!op.unregistered && op.string_key.empty() && !op.original_tokens[0].starts_with(\"--\")\n             && !op.original_tokens[0].empty() && !op.value.empty())\n         {\n",
  "test_patch": "diff --git a/tests/queries/0_stateless/03461_clickhouse_local_extra_options.reference b/tests/queries/0_stateless/03461_clickhouse_local_extra_options.reference\nnew file mode 100644\nindex 000000000000..459fa4db3093\n--- /dev/null\n+++ b/tests/queries/0_stateless/03461_clickhouse_local_extra_options.reference\n@@ -0,0 +1,2 @@\n+666\n+666\ndiff --git a/tests/queries/0_stateless/03461_clickhouse_local_extra_options.sh b/tests/queries/0_stateless/03461_clickhouse_local_extra_options.sh\nnew file mode 100755\nindex 000000000000..2af5b0707d77\n--- /dev/null\n+++ b/tests/queries/0_stateless/03461_clickhouse_local_extra_options.sh\n@@ -0,0 +1,8 @@\n+#!/usr/bin/env bash\n+\n+CURDIR=$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" && pwd)\n+# shellcheck source=../shell_config.sh\n+. \"$CURDIR\"/../shell_config.sh\n+\n+${CLICKHOUSE_LOCAL} --query \"SELECT getServerSetting('max_connections')\" -- --max_connections=666\n+${CLICKHOUSE_LOCAL} --query \"SELECT getServerSetting('max_connections')\" -- --max_connections 666\n",
  "problem_statement": "clickhouse-local does not support extra arguments in the form of `-- --option value`, only `-- --option=value`, while server does\n### Company or project name\n\nClickHouse\n\n### Describe the unexpected behaviour\n\n```\n$ clickhouse-local --stacktrace --query \"SELECT getServerSetting('max_connections')\" -- --max_connections=666\n666\n\n$ clickhouse-local --stacktrace --query \"SELECT getServerSetting('max_connections')\" -- --max_connections 666\nCode: 36. DB::Exception: Positional option `666` is not supported. (BAD_ARGUMENTS)\n```\n\n### How to reproduce\n\n.\n\n### Expected behavior\n\n_No response_\n\n### Error message and/or stacktrace\n\n_No response_\n\n### Additional context\n\n_No response_\n",
  "hints_text": "",
  "created_at": "2025-05-16T01:01:21Z"
}