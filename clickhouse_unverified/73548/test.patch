diff --git a/tests/queries/0_stateless/02971_functions_to_subcolumns_variant.reference b/tests/queries/0_stateless/02971_functions_to_subcolumns_variant.reference
index 04616738a159..507524524b95 100644
--- a/tests/queries/0_stateless/02971_functions_to_subcolumns_variant.reference
+++ b/tests/queries/0_stateless/02971_functions_to_subcolumns_variant.reference
@@ -1,4 +1,4 @@
-SELECT __table1.`v.String` AS `variantElement(v, \'String\')`
+SELECT _CAST(__table1.`v.String`, \'Nullable(String)\') AS `variantElement(v, \'String\')`
 FROM default.t_func_to_subcolumns_variant AS __table1
 foo
 \N
diff --git a/tests/queries/0_stateless/03289_tuple_element_to_subcolumn.reference b/tests/queries/0_stateless/03289_tuple_element_to_subcolumn.reference
new file mode 100644
index 000000000000..a0a5e06ff1b4
--- /dev/null
+++ b/tests/queries/0_stateless/03289_tuple_element_to_subcolumn.reference
@@ -0,0 +1,6 @@
+([1,2],['a','b','c'])
+([3,4],['d','e'])
+([1,2],['a','b','c'])
+([3,4],['d','e'])
+([],['d','e'])
+([3,4],[])
diff --git a/tests/queries/0_stateless/03289_tuple_element_to_subcolumn.sql b/tests/queries/0_stateless/03289_tuple_element_to_subcolumn.sql
new file mode 100644
index 000000000000..776b6ce8b89b
--- /dev/null
+++ b/tests/queries/0_stateless/03289_tuple_element_to_subcolumn.sql
@@ -0,0 +1,24 @@
+DROP TABLE IF EXISTS t_tuple_elem;
+
+SET enable_variant_type = 1;
+
+CREATE TABLE t_tuple_elem (
+    t1 Tuple(
+        a Array(UInt64),
+        b Array(LowCardinality(String))),
+    v Variant(
+        Array(UInt64),
+        Array(LowCardinality(String)))
+)
+ENGINE = MergeTree ORDER BY tuple();
+
+INSERT INTO t_tuple_elem VALUES (([1, 2], ['a', 'b', 'c']), [3, 4]);
+INSERT INTO t_tuple_elem VALUES (([3, 4], ['d', 'e']), ['d', 'e']);
+
+SET optimize_functions_to_subcolumns = 1;
+
+SELECT (tupleElement(t1, 1), tupleElement(t1, 2)) FROM t_tuple_elem ORDER BY ALL;
+SELECT (tupleElement(t1, 'a'), tupleElement(t1, 'b')) FROM t_tuple_elem ORDER BY ALL;
+SELECT (variantElement(v, 'Array(UInt64)'), variantElement(v, 'Array(LowCardinality(String))')) FROM t_tuple_elem ORDER BY ALL;
+
+DROP TABLE t_tuple_elem;
