You will be provided with a partial code base and an issue statement explaining a problem to resolve.

<issue>
src/Core/Field.h:772: Assertion `target == which || (isInt64FieldType(target) && isInt64FieldType(which)) || target == Field::Types::Decimal64' failed.
https://clickhouse-test-reports.s3.yandex.net/0/813a876e9314e582dd2d3938cdc1f76042687ab0/fuzzer/server.log

```
2020.09.24 17:13:56.484241 [ 86 ] {8663ce68-e9a1-43c0-b6f0-c4feffe881b7} <Debug> executeQuery: (from [::1]:40714) SELECT range(NULL, -2) FROM null_in WHERE (i IN range(range(range('-92233720368547758.0(', '257', NULL), 255), 1025, NULL)) NOT IN (NULL)
clickhouse-server: ../src/Core/Field.h:772: T &DB::Field::get() [T = unsigned long]: Assertion `target == which || (isInt64FieldType(target) && isInt64FieldType(which)) || target == Field::Types::Decimal64' failed.
2020.09.24 17:13:56.484241 [ 86 ] {8663ce68-e9a1-43c0-b6f0-c4feffe881b7} <Debug> executeQuery: (from [::1]:40714) SELECT range(NULL, -2) FROM null_in WHERE (i IN range(range(range('-92233720368547758.0(', '257', NULL), 255), 1025, NULL)) NOT IN (NULL)
clickhouse-server: ../src/Core/Field.h:772: T &DB::Field::get() [T = unsigned long]: Assertion `target == which || (isInt64FieldType(target) && isInt64FieldType(which)) || target == Field::Types::Decimal64' failed.
2020.09.24 17:13:56.490687 [ 53 ] {} <Trace> BaseDaemon: Received signal 6
2020.09.24 17:13:56.491053 [ 251 ] {} <Fatal> BaseDaemon: ########################################
2020.09.24 17:13:56.491674 [ 251 ] {} <Fatal> BaseDaemon: (version 20.10.1.4746 (official build), build id: F32360D3866E261C) (from thread 86) (query_id: 8663ce68-e9a1-43c0-b6f0-c4feffe881b7) Received signal Aborted (6)
2020.09.24 17:13:56.491863 [ 251 ] {} <Fatal> BaseDaemon: 
2020.09.24 17:13:56.492059 [ 251 ] {} <Fatal> BaseDaemon: Stack trace: 0x7f9596e8ef47 0x7f9596e908b1 0x7f9596e8042a 0x7f9596e804a2 0xf9ad59e 0xf9ace6d 0xfb82ab5 0x11764077 0x18888484 0x18881503 0x18880b41 0x188862f4 0x18883118 0x188824f7 0x188697ab 0x1886087d 0x18863090 0x18866184 0x185aff8b 0x185aced4 0x185a9b1b 0x185a89ec 0x188a8ff1 0x188a7b3d 0x184d2f25 0x184d1e4f 0x18ab1d6e 0x18ab0f3a
2020.09.24 17:13:56.492424 [ 251 ] {} <Fatal> BaseDaemon: 4. /build/glibc-2ORdQG/glibc-2.27/signal/../sysdeps/unix/sysv/linux/raise.c:51: __GI_raise @ 0x3ef47 in /usr/lib/debug/lib/x86_64-linux-gnu/libc-2.27.so
2020.09.24 17:13:56.492693 [ 251 ] {} <Fatal> BaseDaemon: 5. /build/glibc-2ORdQG/glibc-2.27/stdlib/abort.c:81: abort @ 0x408b1 in /usr/lib/debug/lib/x86_64-linux-gnu/libc-2.27.so
2020.09.24 17:13:56.492942 [ 251 ] {} <Fatal> BaseDaemon: 6. /build/glibc-2ORdQG/glibc-2.27/assert/assert.c:89: __assert_fail_base @ 0x3042a in /usr/lib/debug/lib/x86_64-linux-gnu/libc-2.27.so
2020.09.24 17:13:56.493343 [ 251 ] {} <Fatal> BaseDaemon: 7. ? @ 0x304a2 in /usr/lib/debug/lib/x86_64-linux-gnu/libc-2.27.so
2020.09.24 17:13:56.493988 [ 251 ] {} <Fatal> BaseDaemon: 8. /build/obj-x86_64-linux-gnu/../src/Core/Field.h:0: unsigned long& DB::Field::get<unsigned long>() @ 0xf9ad59e in /workspace/clickhouse
2020.09.24 17:13:56.494626 [ 251 ] {} <Fatal> BaseDaemon: 9. /build/obj-x86_64-linux-gnu/../src/Core/Field.h:400: unsigned long const& DB::Field::get<unsigned long>() const @ 0xf9ace6d in /workspace/clickhouse
2020.09.24 17:13:56.497509 [ 251 ] {} <Fatal> BaseDaemon: 10. /build/obj-x86_64-linux-gnu/../src/Core/Field.h:790: unsigned long DB::get<unsigned long>(DB::Field const&) @ 0xfb82ab5 in /workspace/clickhouse
2020.09.24 17:13:56.504551 [ 251 ] {} <Fatal> BaseDaemon: 11. /build/obj-x86_64-linux-gnu/../src/Columns/ColumnVector.h:269: DB::ColumnVector<char8_t>::insert(DB::Field const&) @ 0x11764077 in /workspace/clickhouse
2020.09.24 17:13:56.542958 [ 251 ] {} <Fatal> BaseDaemon: 12. /build/obj-x86_64-linux-gnu/../src/Interpreters/ActionsVisitor.cpp:90: DB::Block DB::createBlockFromCollection<DB::Array>(DB::Array const&, std::__1::vector<std::__1::shared_ptr<DB::IDataType const>, std::__1::allocator<std::__1::shared_ptr<DB::IDataType const> > > const&, DB::Context const&) @ 0x18888484 in /workspace/clickhouse
2020.09.24 17:13:56.581148 [ 251 ] {} <Fatal> BaseDaemon: 13. /build/obj-x86_64-linux-gnu/../src/Interpreters/ActionsVisitor.cpp:264: DB::createBlockForSet(std::__1::shared_ptr<DB::IDataType const> const&, std::__1::shared_ptr<DB::IAST> const&, std::__1::vector<std::__1::shared_ptr<DB::IDataType const>, std::__1::allocator<std::__1::shared_ptr<DB::IDataType const> > > const&, DB::Context const&) @ 0x18881503 in /workspace/clickhouse
2020.09.24 17:13:56.619364 [ 251 ] {} <Fatal> BaseDaemon: 14. /build/obj-x86_64-linux-gnu/../src/Interpreters/ActionsVisitor.cpp:373: DB::makeExplicitSet(DB::ASTFunction const*, DB::Block const&, bool, DB::Context const&, DB::SizeLimits const&, std::__1::unordered_map<DB::PreparedSetKey, std::__1::shared_ptr<DB::Set>, DB::PreparedSetKey::Hash, std::__1::equal_to<DB::PreparedSetKey>, std::__1::allocator<std::__1::pair<DB::PreparedSetKey const, std::__1::shared_ptr<DB::Set> > > >&) @ 0x18880b41 in /workspace/clickhouse
2020.09.24 17:13:56.657650 [ 251 ] {} <Fatal> BaseDaemon: 15. /build/obj-x86_64-linux-gnu/../src/Interpreters/ActionsVisitor.cpp:918: DB::ActionsMatcher::makeSet(DB::ASTFunction const&, DB::ActionsMatcher::Data&, bool) @ 0x188862f4 in /workspace/clickhouse
2020.09.24 17:13:56.695346 [ 251 ] {} <Fatal> BaseDaemon: 16. /build/obj-x86_64-linux-gnu/../src/Interpreters/ActionsVisitor.cpp:578: DB::ActionsMatcher::visit(DB::ASTFunction const&, std::__1::shared_ptr<DB::IAST> const&, DB::ActionsMatcher::Data&) @ 0x18883118 in /workspace/clickhouse
2020.09.24 17:13:56.731187 [ 251 ] {} <Fatal> BaseDaemon: 17. /build/obj-x86_64-linux-gnu/../src/Interpreters/ActionsVisitor.cpp:508: DB::ActionsMatcher::visit(std::__1::shared_ptr<DB::IAST> const&, DB::ActionsMatcher::Data&) @ 0x188824f7 in /workspace/clickhouse
2020.09.24 17:13:56.767313 [ 251 ] {} <Fatal> BaseDaemon: 18. /build/obj-x86_64-linux-gnu/../src/Interpreters/InDepthNodeVisitor.h:32: DB::InDepthNodeVisitor<DB::ActionsMatcher, true, std::__1::shared_ptr<DB::IAST> const>::visit(std::__1::shared_ptr<DB::IAST> const&) @ 0x188697ab in /workspace/clickhouse
2020.09.24 17:13:56.803584 [ 251 ] {} <Fatal> BaseDaemon: 19. /build/obj-x86_64-linux-gnu/../src/Interpreters/ExpressionAnalyzer.cpp:384: DB::ExpressionAnalyzer::getRootActions(std::__1::shared_ptr<DB::IAST> const&, bool, std::__1::shared_ptr<DB::ExpressionActions>&, bool) @ 0x1886087d in /workspace/clickhouse
2020.09.24 17:13:56.839023 [ 251 ] {} <Fatal> BaseDaemon: 20. /build/obj-x86_64-linux-gnu/../src/Interpreters/ExpressionAnalyzer.cpp:722: DB::SelectQueryExpressionAnalyzer::appendWhere(DB::ExpressionActionsChain&, bool) @ 0x18863090 in /workspace/clickhouse
2020.09.24 17:13:56.875227 [ 251 ] {} <Fatal> BaseDaemon: 21. /build/obj-x86_64-linux-gnu/../src/Interpreters/ExpressionAnalyzer.cpp:1098: DB::ExpressionAnalysisResult::ExpressionAnalysisResult(DB::SelectQueryExpressionAnalyzer&, std::__1::shared_ptr<DB::StorageInMemoryMetadata const> const&, bool, bool, bool, std::__1::shared_ptr<DB::FilterInfo> const&, DB::Block const&) @ 0x18866184 in /workspace/clickhouse
2020.09.24 17:13:56.911693 [ 251 ] {} <Fatal> BaseDaemon: 22. /build/obj-x86_64-linux-gnu/../src/Interpreters/InterpreterSelectQuery.cpp:507: DB::InterpreterSelectQuery::getSampleBlockImpl() @ 0x185aff8b in /workspace/clickhouse
2020.09.24 17:13:56.947188 [ 251 ] {} <Fatal> BaseDaemon: 23. /build/obj-x86_64-linux-gnu/../src/Interpreters/InterpreterSelectQuery.cpp:404: DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, DB::Context const&, std::__1::shared_ptr<DB::IBlockInputStream> const&, std::__1::optional<DB::Pipe>, std::__1::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, std::__1::shared_ptr<DB::StorageInMemoryMetadata const> const&)::$_2::operator()(bool) const @ 0x185aced4 in /workspace/clickhouse
2020.09.24 17:13:56.983118 [ 251 ] {} <Fatal> BaseDaemon: 24. /build/obj-x86_64-linux-gnu/../src/Interpreters/InterpreterSelectQuery.cpp:407: DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, DB::Context const&, std::__1::shared_ptr<DB::IBlockInputStream> const&, std::__1::optional<DB::Pipe>, std::__1::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, std::__1::shared_ptr<DB::StorageInMemoryMetadata const> const&) @ 0x185a9b1b in /workspace/clickhouse
2020.09.24 17:13:57.019267 [ 251 ] {} <Fatal> BaseDaemon: 25. /build/obj-x86_64-linux-gnu/../src/Interpreters/InterpreterSelectQuery.cpp:146: DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, DB::Context const&, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x185a89ec in /workspace/clickhouse
2020.09.24 17:13:57.055052 [ 251 ] {} <Fatal> BaseDaemon: 26. /build/obj-x86_64-linux-gnu/../contrib/libcxx/include/memory:3028: std::__1::__unique_if<DB::InterpreterSelectQuery>::__unique_single std::__1::make_unique<DB::InterpreterSelectQuery, std::__1::shared_ptr<DB::IAST>&, DB::Context&, DB::SelectQueryOptions&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&>(std::__1::shared_ptr<DB::IAST>&, DB::Context&, DB::SelectQueryOptions&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x188a8ff1 in /workspace/clickhouse
2020.09.24 17:13:57.092312 [ 251 ] {} <Fatal> BaseDaemon: 27. /build/obj-x86_64-linux-gnu/../src/Interpreters/InterpreterSelectWithUnionQuery.cpp:84: DB::InterpreterSelectWithUnionQuery::InterpreterSelectWithUnionQuery(std::__1::shared_ptr<DB::IAST> const&, DB::Context const&, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x188a7b3d in /workspace/clickhouse
2020.09.24 17:13:57.103866 [ 56 ] {} <Trace> SystemLog (system.query_thread_log): Flushing system log, 1590 entries to flush
2020.09.24 17:13:57.127220 [ 251 ] {} <Fatal> BaseDaemon: 28. /build/obj-x86_64-linux-gnu/../contrib/libcxx/include/memory:3028: std::__1::__unique_if<DB::InterpreterSelectWithUnionQuery>::__unique_single std::__1::make_unique<DB::InterpreterSelectWithUnionQuery, std::__1::shared_ptr<DB::IAST>&, DB::Context&, DB::SelectQueryOptions>(std::__1::shared_ptr<DB::IAST>&, DB::Context&, DB::SelectQueryOptions&&) @ 0x184d2f25 in /workspace/clickhouse
2020.09.24 17:13:57.159642 [ 56 ] {} <Debug> DiskLocal: Reserving 1.55 MiB on disk `default`, having unreserved 1.16 TiB.
2020.09.24 17:13:57.161931 [ 251 ] {} <Fatal> BaseDaemon: 29. /build/obj-x86_64-linux-gnu/../src/Interpreters/InterpreterFactory.cpp:107: DB::InterpreterFactory::get(std::__1::shared_ptr<DB::IAST>&, DB::Context&, DB::QueryProcessingStage::Enum) @ 0x184d1e4f in /workspace/clickhouse
2020.09.24 17:13:57.175961 [ 56 ] {} <Trace> system.query_thread_log (aa0a7011-6f49-4d83-a0ae-7e91e566994b): Renaming temporary part tmp_insert_202009_72_72_0 to 202009_72_72_0.
2020.09.24 17:13:57.180195 [ 56 ] {} <Trace> SystemLog (system.query_thread_log): Flushed system log
2020.09.24 17:13:57.201434 [ 251 ] {} <Fatal> BaseDaemon: 30. /build/obj-x86_64-linux-gnu/../src/Interpreters/executeQuery.cpp:389: DB::executeQueryImpl(char const*, char const*, DB::Context&, bool, DB::QueryProcessingStage::Enum, bool, DB::ReadBuffer*) @ 0x18ab1d6e in /workspace/clickhouse
2020.09.24 17:13:57.239028 [ 251 ] {} <Fatal> BaseDaemon: 31. /build/obj-x86_64-linux-gnu/../src/Interpreters/executeQuery.cpp:696: DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, DB::Context&, bool, DB::QueryProcessingStage::Enum, bool) @ 0x18ab0f3a in /workspace/clickhouse
```
</issue>

I need you to solve the provided issue by generating a code fix that can be applied directly to the repository

Respond below:
