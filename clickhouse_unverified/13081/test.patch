diff --git a/tests/queries/0_stateless/01418_index_analysis_bug.reference b/tests/queries/0_stateless/01418_index_analysis_bug.reference
new file mode 100644
index 000000000000..54a57d63d564
--- /dev/null
+++ b/tests/queries/0_stateless/01418_index_analysis_bug.reference
@@ -0,0 +1,24 @@
+2020-07-03	706
+2020-07-04	695
+2020-07-05	726
+2020-07-06	686
+2020-07-07	715
+2020-07-08	706
+2020-07-09	695
+2020-07-10	726
+2020-07-11	686
+2020-07-12	715
+2020-07-13	706
+2020-07-14	695
+2020-07-15	726
+2020-07-16	686
+2020-07-17	715
+2020-07-18	706
+2020-07-19	695
+2020-07-20	726
+2020-07-21	686
+2020-07-22	715
+2020-07-23	706
+2020-07-24	695
+2020-07-25	726
+2
diff --git a/tests/queries/0_stateless/01418_index_analysis_bug.sql b/tests/queries/0_stateless/01418_index_analysis_bug.sql
new file mode 100644
index 000000000000..c5033ac7d96e
--- /dev/null
+++ b/tests/queries/0_stateless/01418_index_analysis_bug.sql
@@ -0,0 +1,43 @@
+DROP TABLE IF EXISTS mytable_local;
+
+CREATE TABLE mytable_local (
+    created          DateTime,
+    eventday         Date,
+    user_id          UInt32
+)
+ENGINE = MergeTree()
+PARTITION BY toYYYYMM(eventday)
+ORDER BY (eventday, user_id);
+
+INSERT INTO mytable_local SELECT 
+    toDateTime('2020-06-01 00:00:00') + toIntervalMinute(number) AS created,
+    toDate(created) AS eventday,
+    if((number % 100) > 50, 742522, number % 32141) AS user_id
+FROM numbers(100000);
+
+SELECT 
+    eventday,
+    count(*)
+FROM mytable_local
+WHERE (toYYYYMM(eventday) = 202007) AND (user_id = 742522) AND (eventday >= '2020-07-03') AND (eventday <= '2020-07-25')
+GROUP BY eventday
+ORDER BY eventday;
+
+DROP TABLE mytable_local;
+DROP TABLE IF EXISTS table_float;
+
+CREATE TABLE table_float
+(
+    f Float64,
+    u UInt32
+)
+ENGINE = MergeTree
+ORDER BY (f, u);
+
+INSERT INTO table_float VALUES (1.2, 1) (1.3, 2) (1.4, 3) (1.5, 4);
+
+SELECT count()
+FROM table_float
+WHERE (toUInt64(f) = 1) AND (f >= 1.3) AND (f <= 1.4) AND (u > 0);
+
+DROP TABLE table_float;
