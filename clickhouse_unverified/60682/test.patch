diff --git a/tests/queries/0_stateless/03002_modify_query_cte.reference b/tests/queries/0_stateless/03002_modify_query_cte.reference
new file mode 100644
index 000000000000..50e4a7c6a070
--- /dev/null
+++ b/tests/queries/0_stateless/03002_modify_query_cte.reference
@@ -0,0 +1,2 @@
+CREATE MATERIALIZED VIEW default.mv_03002 TO default.table_03002
(
    `ts` DateTime
)
AS SELECT ts
FROM default.table_03002
+CREATE MATERIALIZED VIEW default.mv_03002 TO default.table_03002
(
    `ts` DateTime
)
AS WITH MY_CTE AS
    (
        SELECT ts
        FROM default.table_03002
    )
SELECT *
FROM MY_CTE
diff --git a/tests/queries/0_stateless/03002_modify_query_cte.sql b/tests/queries/0_stateless/03002_modify_query_cte.sql
new file mode 100644
index 000000000000..3a36ce7e7fd0
--- /dev/null
+++ b/tests/queries/0_stateless/03002_modify_query_cte.sql
@@ -0,0 +1,15 @@
+
+CREATE TABLE table_03002 (ts DateTime, event_type String) ENGINE = MergeTree ORDER BY (event_type, ts);
+
+CREATE MATERIALIZED VIEW mv_03002 TO table_03002 AS SELECT ts FROM table_03002;
+
+SHOW CREATE TABLE mv_03002;
+
+ALTER TABLE mv_03002 MODIFY QUERY
+WITH MY_CTE AS (SELECT ts FROM table_03002)
+SELECT * FROM MY_CTE;
+
+SHOW CREATE TABLE mv_03002;
+
+DROP TABLE mv_03002;
+DROP TABLE table_03002;
