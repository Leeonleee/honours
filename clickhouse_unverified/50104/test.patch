diff --git a/tests/queries/0_stateless/02763_mutate_compact_part_with_skip_indices_and_projections.reference b/tests/queries/0_stateless/02763_mutate_compact_part_with_skip_indices_and_projections.reference
new file mode 100644
index 000000000000..e69de29bb2d1
diff --git a/tests/queries/0_stateless/02763_mutate_compact_part_with_skip_indices_and_projections.sql b/tests/queries/0_stateless/02763_mutate_compact_part_with_skip_indices_and_projections.sql
new file mode 100644
index 000000000000..bb9825fe5a0a
--- /dev/null
+++ b/tests/queries/0_stateless/02763_mutate_compact_part_with_skip_indices_and_projections.sql
@@ -0,0 +1,31 @@
+DROP TABLE IF EXISTS test;
+
+CREATE TABLE test ( col1 Int64, dt Date ) ENGINE = MergeTree PARTITION BY dt ORDER BY tuple();
+
+INSERT INTO test FORMAT Values (1, today());
+
+ALTER TABLE test ADD COLUMN col2 String;
+
+ALTER TABLE test ADD INDEX i1 (col1, col2) TYPE set(100) GRANULARITY 1;
+
+ALTER TABLE test MATERIALIZE INDEX i1;
+
+ALTER TABLE test ADD COLUMN col3 String;
+
+ALTER TABLE test DROP COLUMN col3;
+
+DROP TABLE IF EXISTS test;
+
+CREATE TABLE test ( col1 Int64, dt Date ) ENGINE = MergeTree PARTITION BY dt ORDER BY tuple();
+
+INSERT INTO test FORMAT Values (1, today());
+
+ALTER TABLE test ADD COLUMN col2 String;
+
+ALTER TABLE test ADD PROJECTION p1 ( SELECT col2, sum(col1) GROUP BY col2 );
+
+ALTER TABLE test MATERIALIZE PROJECTION p1;
+
+ALTER TABLE test ADD COLUMN col3 String;
+
+ALTER TABLE test DROP COLUMN col3;
