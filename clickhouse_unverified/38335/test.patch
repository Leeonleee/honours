diff --git a/docker/test/stateful/run.sh b/docker/test/stateful/run.sh
index 5f55bb9fa21c..d77978c904b2 100755
--- a/docker/test/stateful/run.sh
+++ b/docker/test/stateful/run.sh
@@ -120,6 +120,10 @@ function run_tests()
         ADDITIONAL_OPTIONS+=('--replicated-database')
     fi
 
+    if [[ -n "$USE_DATABASE_ORDINARY" ]] && [[ "$USE_DATABASE_ORDINARY" -eq 1 ]]; then
+        ADDITIONAL_OPTIONS+=('--db-engine=Ordinary')
+    fi
+
     set +e
     clickhouse-test -j 2 --testname --shard --zookeeper --check-zookeeper-session --no-stateless --hung-check --print-time \
         --skip 00168_parallel_processing_on_replicas "${ADDITIONAL_OPTIONS[@]}" \
diff --git a/docker/test/stateless/run.sh b/docker/test/stateless/run.sh
index 52bf8a60669d..075f588cae30 100755
--- a/docker/test/stateless/run.sh
+++ b/docker/test/stateless/run.sh
@@ -115,6 +115,10 @@ function run_tests()
         ADDITIONAL_OPTIONS+=("$RUN_BY_HASH_TOTAL")
     fi
 
+    if [[ -n "$USE_DATABASE_ORDINARY" ]] && [[ "$USE_DATABASE_ORDINARY" -eq 1 ]]; then
+        ADDITIONAL_OPTIONS+=('--db-engine=Ordinary')
+    fi
+
     set +e
     clickhouse-test --testname --shard --zookeeper --check-zookeeper-session --hung-check --print-time \
             --test-runs "$NUM_TRIES" "${ADDITIONAL_OPTIONS[@]}" 2>&1 \
diff --git a/docker/test/stress/run.sh b/docker/test/stress/run.sh
index f0f5d21c0b8e..119ea04080fb 100755
--- a/docker/test/stress/run.sh
+++ b/docker/test/stress/run.sh
@@ -284,6 +284,11 @@ then
 
     rm -rf /var/lib/clickhouse/*
 
+    # Make BC check more funny by forcing Ordinary engine for system database
+    # New version will try to convert it to Atomic on startup
+    mkdir /var/lib/clickhouse/metadata
+    echo "ATTACH DATABASE system ENGINE=Ordinary" > /var/lib/clickhouse/metadata/system.sql
+
     # Install previous release packages
     install_packages previous_release_package_folder
 
diff --git a/tests/clickhouse-test b/tests/clickhouse-test
index 22c6816eec20..8744e8bf95bd 100755
--- a/tests/clickhouse-test
+++ b/tests/clickhouse-test
@@ -1490,9 +1490,9 @@ def collect_build_flags(args):
         result.append(BuildFlags.RELEASE)
 
     value = clickhouse_execute(
-        args, "SELECT value FROM system.settings WHERE name = 'default_database_engine'"
+        args, "SELECT value FROM system.settings WHERE name = 'allow_deprecated_database_ordinary'"
     )
-    if value == b"Ordinary":
+    if value == b"1":
         result.append(BuildFlags.ORDINARY_DATABASE)
 
     value = int(
diff --git a/tests/config/users.d/database_ordinary.xml b/tests/config/users.d/database_ordinary.xml
index b3b81ee25ffa..8ffd2f27a626 100644
--- a/tests/config/users.d/database_ordinary.xml
+++ b/tests/config/users.d/database_ordinary.xml
@@ -1,7 +1,7 @@
 <clickhouse>
     <profiles>
         <default>
-            <default_database_engine>Ordinary</default_database_engine>
+            <allow_deprecated_database_ordinary>1</allow_deprecated_database_ordinary>
         </default>
     </profiles>
 </clickhouse>
diff --git a/tests/integration/helpers/cluster.py b/tests/integration/helpers/cluster.py
index e917e5a18855..0d32547358cb 100644
--- a/tests/integration/helpers/cluster.py
+++ b/tests/integration/helpers/cluster.py
@@ -3390,14 +3390,6 @@ def restart_with_original_version(
             ],
             user="root",
         )
-        self.exec_in_container(
-            [
-                "bash",
-                "-c",
-                "cp /usr/share/clickhouse-odbc-bridge_fresh /usr/bin/clickhouse-odbc-bridge && chmod 777 /usr/bin/clickhouse",
-            ],
-            user="root",
-        )
         self.exec_in_container(
             ["bash", "-c", "{} --daemon".format(self.clickhouse_start_command)],
             user=str(os.getuid()),
@@ -3411,7 +3403,11 @@ def restart_with_original_version(
             self.wait_start(time_left)
 
     def restart_with_latest_version(
-        self, stop_start_wait_sec=300, callback_onstop=None, signal=15
+        self,
+        stop_start_wait_sec=300,
+        callback_onstop=None,
+        signal=15,
+        fix_metadata=False,
     ):
         begin_time = time.time()
         if not self.stay_alive:
@@ -3458,14 +3454,23 @@ def restart_with_latest_version(
                 "echo 'restart_with_latest_version: From version' && /usr/share/clickhouse_original server --version && echo 'To version' /usr/share/clickhouse_fresh server --version",
             ]
         )
-        self.exec_in_container(
-            [
-                "bash",
-                "-c",
-                "cp /usr/share/clickhouse-odbc-bridge_fresh /usr/bin/clickhouse-odbc-bridge && chmod 777 /usr/bin/clickhouse",
-            ],
-            user="root",
-        )
+        if fix_metadata:
+            # Versions older than 20.7 might not create .sql file for system and default database
+            # Create it manually if upgrading from older version
+            self.exec_in_container(
+                [
+                    "bash",
+                    "-c",
+                    "echo 'ATTACH DATABASE system ENGINE=Ordinary' > /var/lib/clickhouse/metadata/system.sql",
+                ],
+            )
+            self.exec_in_container(
+                [
+                    "bash",
+                    "-c",
+                    "echo 'ATTACH DATABASE system ENGINE=Ordinary' > /var/lib/clickhouse/metadata/default.sql",
+                ],
+            )
         self.exec_in_container(
             ["bash", "-c", "{} --daemon".format(self.clickhouse_start_command)],
             user=str(os.getuid()),
diff --git a/tests/integration/test_atomic_drop_table/test.py b/tests/integration/test_atomic_drop_table/test.py
index 1fe88dde099c..6ffa60de7b52 100644
--- a/tests/integration/test_atomic_drop_table/test.py
+++ b/tests/integration/test_atomic_drop_table/test.py
@@ -20,7 +20,8 @@ def start_cluster():
     try:
         cluster.start()
         node1.query(
-            "CREATE DATABASE zktest ENGINE=Ordinary;"
+            "CREATE DATABASE zktest ENGINE=Ordinary;",
+            settings={"allow_deprecated_database_ordinary": 1},
         )  # Different behaviour with Atomic
         node1.query(
             """
diff --git a/tests/integration/test_attach_partition_with_large_destination/test.py b/tests/integration/test_attach_partition_with_large_destination/test.py
index 0a4ab9fada13..a82e63bb7ba6 100644
--- a/tests/integration/test_attach_partition_with_large_destination/test.py
+++ b/tests/integration/test_attach_partition_with_large_destination/test.py
@@ -34,7 +34,10 @@ def create_force_drop_flag(node):
 @pytest.mark.parametrize("engine", ["Ordinary", "Atomic"])
 def test_attach_partition_with_large_destination(started_cluster, engine):
     # Initialize
-    node.query("CREATE DATABASE db ENGINE={}".format(engine))
+    node.query(
+        "CREATE DATABASE db ENGINE={}".format(engine),
+        settings={"allow_deprecated_database_ordinary": 1},
+    )
     node.query(
         "CREATE TABLE db.destination (n UInt64) ENGINE=ReplicatedMergeTree('/test/destination', 'r1') ORDER BY n PARTITION BY n % 2"
     )
diff --git a/tests/integration/test_backup_restore/test.py b/tests/integration/test_backup_restore/test.py
index 905abef05b0c..193e638186ca 100644
--- a/tests/integration/test_backup_restore/test.py
+++ b/tests/integration/test_backup_restore/test.py
@@ -15,7 +15,8 @@ def started_cluster():
     try:
         cluster.start()
         instance.query(
-            "CREATE DATABASE test ENGINE = Ordinary"
+            "CREATE DATABASE test ENGINE = Ordinary",
+            settings={"allow_deprecated_database_ordinary": 1},
         )  # Different path in shadow/ with Atomic
         instance.query("DROP TABLE IF EXISTS test.tbl")
         instance.query(
diff --git a/tests/integration/test_backup_with_other_granularity/test.py b/tests/integration/test_backup_with_other_granularity/test.py
index 9cb998fb5051..d30c45c3691a 100644
--- a/tests/integration/test_backup_with_other_granularity/test.py
+++ b/tests/integration/test_backup_with_other_granularity/test.py
@@ -54,7 +54,7 @@ def test_backup_from_old_version(started_cluster):
 
     node1.query("ALTER TABLE source_table FREEZE PARTITION tuple();")
 
-    node1.restart_with_latest_version()
+    node1.restart_with_latest_version(fix_metadata=True)
 
     node1.query(
         "CREATE TABLE dest_table (A Int64,  B String,  Y String) ENGINE = ReplicatedMergeTree('/test/dest_table1', '1')  ORDER BY tuple()"
@@ -107,7 +107,7 @@ def test_backup_from_old_version_setting(started_cluster):
 
     node2.query("ALTER TABLE source_table FREEZE PARTITION tuple();")
 
-    node2.restart_with_latest_version()
+    node2.restart_with_latest_version(fix_metadata=True)
 
     node2.query(
         "CREATE TABLE dest_table (A Int64,  B String,  Y String) ENGINE = ReplicatedMergeTree('/test/dest_table2', '1')  ORDER BY tuple() SETTINGS enable_mixed_granularity_parts = 1"
@@ -163,7 +163,7 @@ def callback(n):
             "<clickhouse><merge_tree><enable_mixed_granularity_parts>1</enable_mixed_granularity_parts></merge_tree></clickhouse>",
         )
 
-    node3.restart_with_latest_version(callback_onstop=callback)
+    node3.restart_with_latest_version(callback_onstop=callback, fix_metadata=True)
 
     node3.query(
         "CREATE TABLE dest_table (A Int64,  B String,  Y String) ENGINE = ReplicatedMergeTree('/test/dest_table3', '1')  ORDER BY tuple() SETTINGS enable_mixed_granularity_parts = 1"
@@ -202,7 +202,8 @@ def callback(n):
 
 def test_backup_and_alter(started_cluster):
     node4.query(
-        "CREATE DATABASE test ENGINE=Ordinary"
+        "CREATE DATABASE test ENGINE=Ordinary",
+        settings={"allow_deprecated_database_ordinary": 1},
     )  # Different path in shadow/ with Atomic
 
     node4.query(
diff --git a/tests/integration/test_backward_compatibility/test_aggregate_function_state_avg.py b/tests/integration/test_backward_compatibility/test_aggregate_function_state_avg.py
index b3ad90112399..13dd28ee8af6 100644
--- a/tests/integration/test_backward_compatibility/test_aggregate_function_state_avg.py
+++ b/tests/integration/test_backward_compatibility/test_aggregate_function_state_avg.py
@@ -71,7 +71,7 @@ def test_backward_compatability(start_cluster):
 
     assert node1.query("SELECT avgMerge(x) FROM state") == "2.5
"
 
-    node1.restart_with_latest_version()
+    node1.restart_with_latest_version(fix_metadata=True)
 
     assert node1.query("SELECT avgMerge(x) FROM state") == "2.5
"
 
diff --git a/tests/integration/test_backward_compatibility/test_convert_ordinary.py b/tests/integration/test_backward_compatibility/test_convert_ordinary.py
new file mode 100644
index 000000000000..59ceca23a51d
--- /dev/null
+++ b/tests/integration/test_backward_compatibility/test_convert_ordinary.py
@@ -0,0 +1,77 @@
+import pytest
+from helpers.cluster import ClickHouseCluster
+
+cluster = ClickHouseCluster(__file__, name="convert_ordinary")
+node = cluster.add_instance(
+    "node",
+    image="yandex/clickhouse-server",
+    tag="19.17.8.54",
+    stay_alive=True,
+    with_installed_binary=True,
+)
+
+
+@pytest.fixture(scope="module")
+def start_cluster():
+    try:
+        cluster.start()
+        yield cluster
+
+    finally:
+        cluster.shutdown()
+
+
+def q(query):
+    return node.query(query, settings={"log_queries": 1})
+
+
+def test_convert_system_db_to_atomic(start_cluster):
+    q(
+        "CREATE TABLE t(date Date, id UInt32) ENGINE = MergeTree PARTITION BY toYYYYMM(date) ORDER BY id"
+    )
+    q("INSERT INTO t VALUES (today(), 1)")
+    q("INSERT INTO t SELECT number % 1000, number FROM system.numbers LIMIT 1000000")
+
+    assert "1000001
" == q("SELECT count() FROM t")
+    assert "499999500001
" == q("SELECT sum(id) FROM t")
+    assert "1970-01-01\t1000\t499500000
1970-01-02\t1000\t499501000
" == q(
+        "SELECT date, count(), sum(id) FROM t GROUP BY date ORDER BY date LIMIT 2"
+    )
+    q("SYSTEM FLUSH LOGS")
+
+    assert "query_log" in q("SHOW TABLES FROM system")
+    assert "part_log" in q("SHOW TABLES FROM system")
+    q("SYSTEM FLUSH LOGS")
+    assert "1
" == q("SELECT count() != 0 FROM system.query_log")
+    assert "1
" == q("SELECT count() != 0 FROM system.part_log")
+
+    node.restart_with_latest_version(fix_metadata=True)
+
+    assert "Ordinary" in node.query("SHOW CREATE DATABASE default")
+    assert "Atomic" in node.query("SHOW CREATE DATABASE system")
+    assert "query_log" in node.query("SHOW TABLES FROM system")
+    assert "part_log" in node.query("SHOW TABLES FROM system")
+    node.query("SYSTEM FLUSH LOGS")
+
+    assert "query_log_0" in node.query("SHOW TABLES FROM system")
+    assert "part_log_0" in node.query("SHOW TABLES FROM system")
+    assert "1
" == node.query("SELECT count() != 0 FROM system.query_log_0")
+    assert "1
" == node.query("SELECT count() != 0 FROM system.part_log_0")
+    assert "1970-01-01\t1000\t499500000
1970-01-02\t1000\t499501000
" == node.query(
+        "SELECT date, count(), sum(id) FROM t GROUP BY date ORDER BY date LIMIT 2"
+    )
+    assert "INFORMATION_SCHEMA
default
information_schema
system
" == node.query(
+        "SELECT name FROM system.databases ORDER BY name"
+    )
+
+    errors_count = node.count_in_log("<Error>")
+    assert "0
" == errors_count or (
+        "1
" == errors_count
+        and "1
" == node.count_in_log("Can't receive Netlink response")
+    )
+    assert "0
" == node.count_in_log("<Warning> Database")
+    errors_count = node.count_in_log("always include the lines below")
+    assert "0
" == errors_count or (
+        "1
" == errors_count
+        and "1
" == node.count_in_log("Can't receive Netlink response")
+    )
diff --git a/tests/integration/test_cluster_copier/configs/users.xml b/tests/integration/test_cluster_copier/configs/users.xml
index 492cf4d7ee60..2542642f6df7 100644
--- a/tests/integration/test_cluster_copier/configs/users.xml
+++ b/tests/integration/test_cluster_copier/configs/users.xml
@@ -5,6 +5,7 @@
             <log_queries>1</log_queries>
             <!-- Just to test settings_pull -->
             <max_rows_in_distinct>5</max_rows_in_distinct>
+            <allow_deprecated_syntax_for_merge_tree>1</allow_deprecated_syntax_for_merge_tree>
         </default>
     </profiles>
 
diff --git a/tests/integration/test_cluster_copier/configs_three_nodes/users.xml b/tests/integration/test_cluster_copier/configs_three_nodes/users.xml
index ce3538a31b82..f017daff9746 100644
--- a/tests/integration/test_cluster_copier/configs_three_nodes/users.xml
+++ b/tests/integration/test_cluster_copier/configs_three_nodes/users.xml
@@ -3,6 +3,7 @@
     <profiles>
         <default>
             <log_queries>1</log_queries>
+            <allow_deprecated_syntax_for_merge_tree>1</allow_deprecated_syntax_for_merge_tree>
         </default>
     </profiles>
 
diff --git a/tests/integration/test_cluster_copier/configs_two_nodes/users.xml b/tests/integration/test_cluster_copier/configs_two_nodes/users.xml
index ce3538a31b82..f017daff9746 100644
--- a/tests/integration/test_cluster_copier/configs_two_nodes/users.xml
+++ b/tests/integration/test_cluster_copier/configs_two_nodes/users.xml
@@ -3,6 +3,7 @@
     <profiles>
         <default>
             <log_queries>1</log_queries>
+            <allow_deprecated_syntax_for_merge_tree>1</allow_deprecated_syntax_for_merge_tree>
         </default>
     </profiles>
 
diff --git a/tests/integration/test_config_substitutions/configs/config_allow_databases.xml b/tests/integration/test_config_substitutions/configs/config_allow_databases.xml
index 98008306787d..be727360dcf3 100644
--- a/tests/integration/test_config_substitutions/configs/config_allow_databases.xml
+++ b/tests/integration/test_config_substitutions/configs/config_allow_databases.xml
@@ -1,4 +1,9 @@
 <clickhouse>
+    <profiles>
+        <default>
+            <allow_deprecated_syntax_for_merge_tree>1</allow_deprecated_syntax_for_merge_tree>
+        </default>
+    </profiles>
     <users>
         <default>
             <password></password>
diff --git a/tests/integration/test_cross_replication/test.py b/tests/integration/test_cross_replication/test.py
index 143b8823bf23..2a73acadafd8 100644
--- a/tests/integration/test_cross_replication/test.py
+++ b/tests/integration/test_cross_replication/test.py
@@ -37,7 +37,7 @@ def started_cluster():
 CREATE DATABASE shard_{shard};
 
 CREATE TABLE shard_{shard}.replicated(date Date, id UInt32, shard_id UInt32)
-    ENGINE = ReplicatedMergeTree('/clickhouse/tables/{shard}/replicated', '{replica}', date, id, 8192);
+    ENGINE = ReplicatedMergeTree('/clickhouse/tables/{shard}/replicated', '{replica}') PARTITION BY toYYYYMM(date) ORDER BY id;
                 """.format(
                         shard=shard, replica=node.name
                     )
diff --git a/tests/integration/test_default_compression_codec/test.py b/tests/integration/test_default_compression_codec/test.py
index 4af276b97282..5d033ac8f7ec 100644
--- a/tests/integration/test_default_compression_codec/test.py
+++ b/tests/integration/test_default_compression_codec/test.py
@@ -421,7 +421,7 @@ def test_default_codec_version_update(start_cluster):
     )
 
     old_version = node3.query("SELECT version()")
-    node3.restart_with_latest_version()
+    node3.restart_with_latest_version(fix_metadata=True)
     new_version = node3.query("SELECT version()")
     logging.debug(f"Updated from {old_version} to {new_version}")
     assert (
diff --git a/tests/integration/test_delayed_replica_failover/test.py b/tests/integration/test_delayed_replica_failover/test.py
index 387d6a12f482..a480ee3f2788 100644
--- a/tests/integration/test_delayed_replica_failover/test.py
+++ b/tests/integration/test_delayed_replica_failover/test.py
@@ -32,7 +32,7 @@ def started_cluster():
                 node.query(
                     """
 CREATE TABLE replicated (d Date, x UInt32) ENGINE =
-    ReplicatedMergeTree('/clickhouse/tables/{shard}/replicated', '{instance}', d, d, 8192)""".format(
+    ReplicatedMergeTree('/clickhouse/tables/{shard}/replicated', '{instance}') PARTITION BY toYYYYMM(d) ORDER BY d""".format(
                         shard=shard, instance=node.name
                     )
                 )
diff --git a/tests/integration/test_dictionaries_dependency/test.py b/tests/integration/test_dictionaries_dependency/test.py
index f57d4e428133..2042db69fa2d 100644
--- a/tests/integration/test_dictionaries_dependency/test.py
+++ b/tests/integration/test_dictionaries_dependency/test.py
@@ -16,7 +16,10 @@ def start_cluster():
         for node in nodes:
             node.query("CREATE DATABASE IF NOT EXISTS test")
             # Different internal dictionary name with Atomic
-            node.query("CREATE DATABASE IF NOT EXISTS test_ordinary ENGINE=Ordinary")
+            node.query(
+                "CREATE DATABASE IF NOT EXISTS test_ordinary ENGINE=Ordinary",
+                settings={"allow_deprecated_database_ordinary": 1},
+            )
             node.query("CREATE DATABASE IF NOT EXISTS atest")
             node.query("CREATE DATABASE IF NOT EXISTS ztest")
             node.query("CREATE TABLE test.source(x UInt64, y UInt64) ENGINE=Log")
diff --git a/tests/integration/test_distributed_ddl/configs/users.d/query_log.xml b/tests/integration/test_distributed_ddl/configs/users.d/query_log.xml
index 26db7f545142..ef8abbd91741 100644
--- a/tests/integration/test_distributed_ddl/configs/users.d/query_log.xml
+++ b/tests/integration/test_distributed_ddl/configs/users.d/query_log.xml
@@ -3,6 +3,7 @@
         <!-- Default profile settings. -->
         <default>
             <log_queries>1</log_queries>
+            <allow_deprecated_syntax_for_merge_tree>1</allow_deprecated_syntax_for_merge_tree>
         </default>
     </profiles>
 </clickhouse>
diff --git a/tests/integration/test_distributed_ddl/configs_secure/users.d/query_log.xml b/tests/integration/test_distributed_ddl/configs_secure/users.d/query_log.xml
index 26db7f545142..ef8abbd91741 100644
--- a/tests/integration/test_distributed_ddl/configs_secure/users.d/query_log.xml
+++ b/tests/integration/test_distributed_ddl/configs_secure/users.d/query_log.xml
@@ -3,6 +3,7 @@
         <!-- Default profile settings. -->
         <default>
             <log_queries>1</log_queries>
+            <allow_deprecated_syntax_for_merge_tree>1</allow_deprecated_syntax_for_merge_tree>
         </default>
     </profiles>
 </clickhouse>
diff --git a/tests/integration/test_distributed_ddl/test.py b/tests/integration/test_distributed_ddl/test.py
index 2789541b519d..85d0a5f0999d 100755
--- a/tests/integration/test_distributed_ddl/test.py
+++ b/tests/integration/test_distributed_ddl/test.py
@@ -552,7 +552,9 @@ def test_replicated_without_arguments(test_cluster):
     )
 
     test_cluster.ddl_check_query(
-        instance, "CREATE DATABASE test_ordinary ON CLUSTER cluster ENGINE=Ordinary"
+        instance,
+        "CREATE DATABASE test_ordinary ON CLUSTER cluster ENGINE=Ordinary",
+        settings={"allow_deprecated_database_ordinary": 1},
     )
     assert (
         "are supported only for ON CLUSTER queries with Atomic database engine"
diff --git a/tests/integration/test_distributed_storage_configuration/test.py b/tests/integration/test_distributed_storage_configuration/test.py
index fa4e01bb7b37..950ce1034fe9 100644
--- a/tests/integration/test_distributed_storage_configuration/test.py
+++ b/tests/integration/test_distributed_storage_configuration/test.py
@@ -20,7 +20,8 @@ def start_cluster():
     try:
         cluster.start()
         node.query(
-            "CREATE DATABASE IF NOT EXISTS test ENGINE=Ordinary"
+            "CREATE DATABASE IF NOT EXISTS test ENGINE=Ordinary",
+            settings={"allow_deprecated_database_ordinary": 1},
         )  # Different paths with Atomic
         yield cluster
     finally:
diff --git a/tests/integration/test_extreme_deduplication/test.py b/tests/integration/test_extreme_deduplication/test.py
index 2c8772aad4e0..71f783d37c91 100644
--- a/tests/integration/test_extreme_deduplication/test.py
+++ b/tests/integration/test_extreme_deduplication/test.py
@@ -40,7 +40,7 @@ def test_deduplication_window_in_seconds(started_cluster):
     node1.query(
         """
         CREATE TABLE simple ON CLUSTER test_cluster (date Date, id UInt32)
-        ENGINE = ReplicatedMergeTree('/clickhouse/tables/{shard}/simple', '{replica}', date, id, 8192)"""
+        ENGINE = ReplicatedMergeTree('/clickhouse/tables/{shard}/simple', '{replica}') PARTITION BY toYYYYMM(date) ORDER BY id"""
     )
 
     node.query("INSERT INTO simple VALUES (0, 0)")
@@ -77,7 +77,7 @@ def test_deduplication_works_in_case_of_intensive_inserts(started_cluster):
     node1.query(
         """
         CREATE TABLE simple ON CLUSTER test_cluster (date Date, id UInt32)
-        ENGINE = ReplicatedMergeTree('/clickhouse/tables/{shard}/simple', '{replica}', date, id, 8192)"""
+        ENGINE = ReplicatedMergeTree('/clickhouse/tables/{shard}/simple', '{replica}') PARTITION BY toYYYYMM(date) ORDER BY id"""
     )
 
     node1.query("INSERT INTO simple VALUES (0, 0)")
diff --git a/tests/integration/test_filesystem_layout/test.py b/tests/integration/test_filesystem_layout/test.py
index 34e377e0ae4d..898bbc40eb97 100644
--- a/tests/integration/test_filesystem_layout/test.py
+++ b/tests/integration/test_filesystem_layout/test.py
@@ -16,7 +16,10 @@ def started_cluster():
 
 
 def test_file_path_escaping(started_cluster):
-    node.query("CREATE DATABASE IF NOT EXISTS test ENGINE = Ordinary")
+    node.query(
+        "CREATE DATABASE IF NOT EXISTS test ENGINE = Ordinary",
+        settings={"allow_deprecated_database_ordinary": 1},
+    )
     node.query(
         """
         CREATE TABLE test.`T.a_b,l-e!` (`~Id` UInt32)
diff --git a/tests/integration/test_force_drop_table/test.py b/tests/integration/test_force_drop_table/test.py
index c1eec1cd2778..ae6c7a1a3bf5 100644
--- a/tests/integration/test_force_drop_table/test.py
+++ b/tests/integration/test_force_drop_table/test.py
@@ -33,7 +33,10 @@ def create_force_drop_flag(node):
 
 @pytest.mark.parametrize("engine", ["Ordinary", "Atomic"])
 def test_drop_materialized_view(started_cluster, engine):
-    node.query("CREATE DATABASE d ENGINE={}".format(engine))
+    node.query(
+        "CREATE DATABASE d ENGINE={}".format(engine),
+        settings={"allow_deprecated_database_ordinary": 1},
+    )
     node.query(
         "CREATE TABLE d.rmt (n UInt64) ENGINE=ReplicatedMergeTree('/test/rmt', 'r1') ORDER BY n PARTITION BY n % 2"
     )
diff --git a/tests/integration/test_https_replication/test.py b/tests/integration/test_https_replication/test.py
index 4cf9f19b870d..301487aa6cf9 100644
--- a/tests/integration/test_https_replication/test.py
+++ b/tests/integration/test_https_replication/test.py
@@ -19,7 +19,7 @@ def _fill_nodes(nodes, shard):
                 CREATE DATABASE test;
     
                 CREATE TABLE test_table(date Date, id UInt32, dummy UInt32)
-                ENGINE = ReplicatedMergeTree('/clickhouse/tables/test{shard}/replicated', '{replica}', date, id, 8192);
+                ENGINE = ReplicatedMergeTree('/clickhouse/tables/test{shard}/replicated', '{replica}') PARTITION BY toYYYYMM(date) ORDER BY id;
             """.format(
                 shard=shard, replica=node.name
             )
diff --git a/tests/integration/test_insert_into_distributed/test.py b/tests/integration/test_insert_into_distributed/test.py
index b8d94d2a0437..a52809f817c1 100644
--- a/tests/integration/test_insert_into_distributed/test.py
+++ b/tests/integration/test_insert_into_distributed/test.py
@@ -52,7 +52,7 @@ def started_cluster():
         )
 
         remote.query(
-            "CREATE TABLE local2 (d Date, x UInt32, s String) ENGINE = MergeTree(d, x, 8192)"
+            "CREATE TABLE local2 (d Date, x UInt32, s String) ENGINE = MergeTree PARTITION BY toYYYYMM(d) ORDER BY x"
         )
         instance_test_inserts_batching.query(
             """
@@ -61,7 +61,7 @@ def started_cluster():
         )
 
         instance_test_inserts_local_cluster.query(
-            "CREATE TABLE local (d Date, x UInt32) ENGINE = MergeTree(d, x, 8192)"
+            "CREATE TABLE local (d Date, x UInt32) ENGINE = MergeTree PARTITION BY toYYYYMM(d) ORDER BY x"
         )
         instance_test_inserts_local_cluster.query(
             """
@@ -71,12 +71,12 @@ def started_cluster():
 
         node1.query(
             """
-CREATE TABLE replicated(date Date, id UInt32) ENGINE = ReplicatedMergeTree('/clickhouse/tables/0/replicated', 'node1', date, id, 8192)
+CREATE TABLE replicated(date Date, id UInt32) ENGINE = ReplicatedMergeTree('/clickhouse/tables/0/replicated', 'node1') PARTITION BY toYYYYMM(date) ORDER BY id
 """
         )
         node2.query(
             """
-CREATE TABLE replicated(date Date, id UInt32) ENGINE = ReplicatedMergeTree('/clickhouse/tables/0/replicated', 'node2', date, id, 8192)
+CREATE TABLE replicated(date Date, id UInt32) ENGINE = ReplicatedMergeTree('/clickhouse/tables/0/replicated', 'node2') PARTITION BY toYYYYMM(date) ORDER BY id
 """
         )
 
@@ -94,12 +94,12 @@ def started_cluster():
 
         shard1.query(
             """
-CREATE TABLE low_cardinality (d Date, x UInt32, s LowCardinality(String)) ENGINE = MergeTree(d, x, 8192)"""
+CREATE TABLE low_cardinality (d Date, x UInt32, s LowCardinality(String)) ENGINE = MergeTree PARTITION BY toYYYYMM(d) ORDER BY x"""
         )
 
         shard2.query(
             """
-CREATE TABLE low_cardinality (d Date, x UInt32, s LowCardinality(String)) ENGINE = MergeTree(d, x, 8192)"""
+CREATE TABLE low_cardinality (d Date, x UInt32, s LowCardinality(String)) ENGINE = MergeTree PARTITION BY toYYYYMM(d) ORDER BY x"""
         )
 
         shard1.query(
@@ -143,7 +143,7 @@ def started_cluster():
 
         node2.query(
             """
-CREATE TABLE single_replicated(date Date, id UInt32) ENGINE = ReplicatedMergeTree('/clickhouse/tables/0/single_replicated', 'node2', date, id, 8192)
+CREATE TABLE single_replicated(date Date, id UInt32) ENGINE = ReplicatedMergeTree('/clickhouse/tables/0/single_replicated', 'node2') PARTITION BY toYYYYMM(date) ORDER BY id
 """
         )
 
@@ -228,11 +228,11 @@ def test_inserts_batching(started_cluster):
     # 4. Full batch of inserts after ALTER (that have different block structure).
     # 5. What was left to insert with the column structure before ALTER.
     expected = """\
-20000101_20000101_1_1_0\t[1]
-20000101_20000101_2_2_0\t[2,3,4]
-20000101_20000101_3_3_0\t[5,6,7]
-20000101_20000101_4_4_0\t[10,11,12]
-20000101_20000101_5_5_0\t[8,9]
+200001_1_1_0\t[1]
+200001_2_2_0\t[2,3,4]
+200001_3_3_0\t[5,6,7]
+200001_4_4_0\t[10,11,12]
+200001_5_5_0\t[8,9]
 """
     assert TSV(result) == TSV(expected)
 
diff --git a/tests/integration/test_insert_into_distributed_sync_async/test.py b/tests/integration/test_insert_into_distributed_sync_async/test.py
index e0c454feee64..12423cc47472 100755
--- a/tests/integration/test_insert_into_distributed_sync_async/test.py
+++ b/tests/integration/test_insert_into_distributed_sync_async/test.py
@@ -23,7 +23,7 @@ def started_cluster():
         for node in (node1, node2):
             node.query(
                 """
-CREATE TABLE local_table(date Date, val UInt64) ENGINE = MergeTree(date, (date, val), 8192);
+CREATE TABLE local_table(date Date, val UInt64) ENGINE = MergeTree() PARTITION BY toYYYYMM(date) ORDER BY (date, val);
 """
             )
 
diff --git a/tests/integration/test_insert_into_distributed_through_materialized_view/configs/enable_distributed_inserts_batching.xml b/tests/integration/test_insert_into_distributed_through_materialized_view/configs/enable_distributed_inserts_batching.xml
index de0c930b8ab3..295d1c8d3ccd 100644
--- a/tests/integration/test_insert_into_distributed_through_materialized_view/configs/enable_distributed_inserts_batching.xml
+++ b/tests/integration/test_insert_into_distributed_through_materialized_view/configs/enable_distributed_inserts_batching.xml
@@ -3,6 +3,7 @@
         <default>
             <distributed_directory_monitor_batch_inserts>1</distributed_directory_monitor_batch_inserts>
             <min_insert_block_size_rows>3</min_insert_block_size_rows>
+            <allow_deprecated_syntax_for_merge_tree>1</allow_deprecated_syntax_for_merge_tree>
         </default>
     </profiles>
 </clickhouse>
diff --git a/tests/integration/test_insert_into_distributed_through_materialized_view/test.py b/tests/integration/test_insert_into_distributed_through_materialized_view/test.py
index 7c2ce9f05f2b..a5f92002450a 100644
--- a/tests/integration/test_insert_into_distributed_through_materialized_view/test.py
+++ b/tests/integration/test_insert_into_distributed_through_materialized_view/test.py
@@ -44,7 +44,8 @@ def started_cluster():
         )
 
         remote.query(
-            "CREATE TABLE local2 (d Date, x UInt32, s String) ENGINE = MergeTree(d, x, 8192)"
+            "CREATE TABLE local2 (d Date, x UInt32, s String) ENGINE = MergeTree(d, x, 8192)",
+            settings={"allow_deprecated_syntax_for_merge_tree": 1},
         )
         instance_test_inserts_batching.query(
             """
@@ -65,7 +66,8 @@ def started_cluster():
             "CREATE MATERIALIZED VIEW local_view to distributed_on_local AS SELECT d,x FROM local_source"
         )
         instance_test_inserts_local_cluster.query(
-            "CREATE TABLE local (d Date, x UInt32) ENGINE = MergeTree(d, x, 8192)"
+            "CREATE TABLE local (d Date, x UInt32) ENGINE = MergeTree(d, x, 8192)",
+            settings={"allow_deprecated_syntax_for_merge_tree": 1},
         )
         instance_test_inserts_local_cluster.query(
             """
diff --git a/tests/integration/test_keeper_multinode_blocade_leader/test.py b/tests/integration/test_keeper_multinode_blocade_leader/test.py
index c2d4039e1223..d6d01a5d0a64 100644
--- a/tests/integration/test_keeper_multinode_blocade_leader/test.py
+++ b/tests/integration/test_keeper_multinode_blocade_leader/test.py
@@ -95,7 +95,10 @@ def test_blocade_leader(started_cluster):
         wait_nodes()
         try:
             for i, node in enumerate([node1, node2, node3]):
-                node.query("CREATE DATABASE IF NOT EXISTS ordinary ENGINE=Ordinary")
+                node.query(
+                    "CREATE DATABASE IF NOT EXISTS ordinary ENGINE=Ordinary",
+                    settings={"allow_deprecated_database_ordinary": 1},
+                )
                 node.query(
                     "CREATE TABLE IF NOT EXISTS ordinary.t1 (value UInt64) ENGINE = ReplicatedMergeTree('/clickhouse/t1', '{}') ORDER BY tuple()".format(
                         i + 1
@@ -296,7 +299,10 @@ def test_blocade_leader_twice(started_cluster):
         wait_nodes()
         try:
             for i, node in enumerate([node1, node2, node3]):
-                node.query("CREATE DATABASE IF NOT EXISTS ordinary ENGINE=Ordinary")
+                node.query(
+                    "CREATE DATABASE IF NOT EXISTS ordinary ENGINE=Ordinary",
+                    settings={"allow_deprecated_database_ordinary": 1},
+                )
                 node.query(
                     "CREATE TABLE IF NOT EXISTS ordinary.t2 (value UInt64) ENGINE = ReplicatedMergeTree('/clickhouse/t2', '{}') ORDER BY tuple()".format(
                         i + 1
diff --git a/tests/integration/test_materialized_mysql_database/configs/users.xml b/tests/integration/test_materialized_mysql_database/configs/users.xml
index 4b7f5a1b109f..0e116f115fea 100644
--- a/tests/integration/test_materialized_mysql_database/configs/users.xml
+++ b/tests/integration/test_materialized_mysql_database/configs/users.xml
@@ -3,7 +3,6 @@
     <profiles>
         <default>
             <allow_experimental_database_materialized_mysql>1</allow_experimental_database_materialized_mysql>
-            <default_database_engine>Atomic</default_database_engine>
             <allow_introspection_functions>1</allow_introspection_functions>
             <optimize_on_insert>0</optimize_on_insert>
         </default>
diff --git a/tests/integration/test_materialized_mysql_database/configs/users_disable_bytes_settings.xml b/tests/integration/test_materialized_mysql_database/configs/users_disable_bytes_settings.xml
index f590ebff6b41..a00b6ca6b9ad 100644
--- a/tests/integration/test_materialized_mysql_database/configs/users_disable_bytes_settings.xml
+++ b/tests/integration/test_materialized_mysql_database/configs/users_disable_bytes_settings.xml
@@ -3,7 +3,6 @@
     <profiles>
         <default>
             <allow_experimental_database_materialized_mysql>1</allow_experimental_database_materialized_mysql>
-            <default_database_engine>Atomic</default_database_engine>
             <external_storage_max_read_rows>1</external_storage_max_read_rows>
             <external_storage_max_read_bytes>0</external_storage_max_read_bytes>
         </default>
diff --git a/tests/integration/test_materialized_mysql_database/configs/users_disable_rows_settings.xml b/tests/integration/test_materialized_mysql_database/configs/users_disable_rows_settings.xml
index e0fa0a9097b6..3a7cc2537e59 100644
--- a/tests/integration/test_materialized_mysql_database/configs/users_disable_rows_settings.xml
+++ b/tests/integration/test_materialized_mysql_database/configs/users_disable_rows_settings.xml
@@ -3,7 +3,6 @@
     <profiles>
         <default>
             <allow_experimental_database_materialized_mysql>1</allow_experimental_database_materialized_mysql>
-            <default_database_engine>Atomic</default_database_engine>
             <external_storage_max_read_rows>0</external_storage_max_read_rows>
             <external_storage_max_read_bytes>1</external_storage_max_read_bytes>
         </default>
diff --git a/tests/integration/test_merge_tree_empty_parts/test.py b/tests/integration/test_merge_tree_empty_parts/test.py
index 7ca275e96de0..57bf49e68038 100644
--- a/tests/integration/test_merge_tree_empty_parts/test.py
+++ b/tests/integration/test_merge_tree_empty_parts/test.py
@@ -25,7 +25,7 @@ def started_cluster():
 def test_empty_parts_alter_delete(started_cluster):
     node1.query(
         "CREATE TABLE empty_parts_delete (d Date, key UInt64, value String) \
-        ENGINE = ReplicatedMergeTree('/clickhouse/tables/empty_parts_delete', 'r1', d, key, 8192)"
+        ENGINE = ReplicatedMergeTree('/clickhouse/tables/empty_parts_delete', 'r1') PARTITION BY toYYYYMM(d) ORDER BY key"
     )
 
     node1.query("INSERT INTO empty_parts_delete VALUES (toDate('2020-10-10'), 1, 'a')")
@@ -44,7 +44,7 @@ def test_empty_parts_alter_delete(started_cluster):
 def test_empty_parts_summing(started_cluster):
     node1.query(
         "CREATE TABLE empty_parts_summing (d Date, key UInt64, value Int64) \
-        ENGINE = ReplicatedSummingMergeTree('/clickhouse/tables/empty_parts_summing', 'r1', d, key, 8192)"
+        ENGINE = ReplicatedSummingMergeTree('/clickhouse/tables/empty_parts_summing', 'r1') PARTITION BY toYYYYMM(d) ORDER BY key"
     )
 
     node1.query("INSERT INTO empty_parts_summing VALUES (toDate('2020-10-10'), 1, 1)")
diff --git a/tests/integration/test_merge_tree_s3_restore/test.py b/tests/integration/test_merge_tree_s3_restore/test.py
index e6ca4a78c255..f4acc4ac91ef 100644
--- a/tests/integration/test_merge_tree_s3_restore/test.py
+++ b/tests/integration/test_merge_tree_s3_restore/test.py
@@ -93,7 +93,8 @@ def create_table(
     node.query(
         "CREATE DATABASE IF NOT EXISTS s3 ENGINE = {engine}".format(
             engine="Atomic" if db_atomic else "Ordinary"
-        )
+        ),
+        settings={"allow_deprecated_database_ordinary": 1},
     )
 
     create_table_statement = """
diff --git a/tests/integration/test_mutations_with_merge_tree/test.py b/tests/integration/test_mutations_with_merge_tree/test.py
index d1843017b9f6..7831cde7dea6 100644
--- a/tests/integration/test_mutations_with_merge_tree/test.py
+++ b/tests/integration/test_mutations_with_merge_tree/test.py
@@ -17,7 +17,7 @@ def started_cluster():
     try:
         cluster.start()
         instance_test_mutations.query(
-            """CREATE TABLE test_mutations_with_ast_elements(date Date, a UInt64, b String) ENGINE = MergeTree(date, (a, date), 8192)"""
+            """CREATE TABLE test_mutations_with_ast_elements(date Date, a UInt64, b String) ENGINE = MergeTree PARTITION BY toYYYYMM(date) ORDER BY (a, date)"""
         )
         instance_test_mutations.query(
             """INSERT INTO test_mutations_with_ast_elements SELECT '2019-07-29' AS date, 1, toString(number) FROM numbers(1) SETTINGS force_index_by_date = 0, force_primary_key = 0"""
diff --git a/tests/integration/test_partition/test.py b/tests/integration/test_partition/test.py
index b396b58df101..f3df66631a5c 100644
--- a/tests/integration/test_partition/test.py
+++ b/tests/integration/test_partition/test.py
@@ -14,7 +14,8 @@ def started_cluster():
     try:
         cluster.start()
         q(
-            "CREATE DATABASE test ENGINE = Ordinary"
+            "CREATE DATABASE test ENGINE = Ordinary",
+            settings={"allow_deprecated_database_ordinary": 1},
         )  # Different path in shadow/ with Atomic
 
         yield cluster
diff --git a/tests/integration/test_polymorphic_parts/configs/users.d/not_optimize_count.xml b/tests/integration/test_polymorphic_parts/configs/users.d/not_optimize_count.xml
index 7f8036c4f879..c654cf0791a5 100644
--- a/tests/integration/test_polymorphic_parts/configs/users.d/not_optimize_count.xml
+++ b/tests/integration/test_polymorphic_parts/configs/users.d/not_optimize_count.xml
@@ -2,6 +2,7 @@
     <profiles>
         <default>
             <optimize_trivial_count_query>0</optimize_trivial_count_query>
+            <allow_deprecated_syntax_for_merge_tree>1</allow_deprecated_syntax_for_merge_tree>
         </default>
     </profiles>
 </clickhouse>
diff --git a/tests/integration/test_polymorphic_parts/test.py b/tests/integration/test_polymorphic_parts/test.py
index edd65ec002c7..32b5e531fa8e 100644
--- a/tests/integration/test_polymorphic_parts/test.py
+++ b/tests/integration/test_polymorphic_parts/test.py
@@ -66,7 +66,8 @@ def create_tables_old_format(name, nodes, shard):
             ENGINE = ReplicatedMergeTree('/clickhouse/tables/test/{shard}/{name}', '{repl}', date, id, 64)
             """.format(
                 name=name, shard=shard, repl=i
-            )
+            ),
+            settings={"allow_deprecated_syntax_for_merge_tree": 1},
         )
 
 
@@ -495,7 +496,7 @@ def test_polymorphic_parts_diff_versions_2(start_cluster_diff_versions):
     with pytest.raises(Exception):
         node_old.query("SYSTEM SYNC REPLICA polymorphic_table_2", timeout=3)
 
-    node_old.restart_with_latest_version()
+    node_old.restart_with_latest_version(fix_metadata=True)
 
     node_old.query("SYSTEM SYNC REPLICA polymorphic_table_2", timeout=20)
 
@@ -720,7 +721,8 @@ def check_parts_type(parts_num):
 
 def test_polymorphic_parts_index(start_cluster):
     node1.query(
-        "CREATE DATABASE test_index ENGINE=Ordinary"
+        "CREATE DATABASE test_index ENGINE=Ordinary",
+        settings={"allow_deprecated_database_ordinary": 1},
     )  # Different paths with Atomic
     node1.query(
         """
diff --git a/tests/integration/test_random_inserts/test.py b/tests/integration/test_random_inserts/test.py
index 4d6aaa9276d3..9ac0c5b024ca 100644
--- a/tests/integration/test_random_inserts/test.py
+++ b/tests/integration/test_random_inserts/test.py
@@ -44,7 +44,7 @@ def test_random_inserts(started_cluster):
     node1.query(
         """
         CREATE TABLE simple ON CLUSTER test_cluster (date Date, i UInt32, s String)
-        ENGINE = ReplicatedMergeTree('/clickhouse/tables/{shard}/simple', '{replica}', date, i, 8192)"""
+        ENGINE = ReplicatedMergeTree('/clickhouse/tables/{shard}/simple', '{replica}') PARTITION BY toYYYYMM(date) ORDER BY i"""
     )
 
     with PartitionManager() as pm_random_drops:
diff --git a/tests/integration/test_replace_partition/test.py b/tests/integration/test_replace_partition/test.py
index 7ce79d9aca8a..579b22286b90 100644
--- a/tests/integration/test_replace_partition/test.py
+++ b/tests/integration/test_replace_partition/test.py
@@ -20,13 +20,13 @@ def _fill_nodes(nodes, shard):
                 CREATE DATABASE test;
 
                 CREATE TABLE real_table(date Date, id UInt32, dummy UInt32)
-                ENGINE = MergeTree(date, id, 8192);
+                ENGINE = MergeTree PARTITION BY toYYYYMM(date) ORDER BY id;
 
                 CREATE TABLE other_table(date Date, id UInt32, dummy UInt32)
-                ENGINE = MergeTree(date, id, 8192);
+                ENGINE = MergeTree PARTITION BY toYYYYMM(date) ORDER BY id;
 
                 CREATE TABLE test_table(date Date, id UInt32, dummy UInt32)
-                ENGINE = ReplicatedMergeTree('/clickhouse/tables/test{shard}/replicated', '{replica}', date, id, 8192);
+                ENGINE = ReplicatedMergeTree('/clickhouse/tables/test{shard}/replicated', '{replica}') PARTITION BY toYYYYMM(date) ORDER BY id;
             """.format(
                 shard=shard, replica=node.name
             )
diff --git a/tests/integration/test_replicated_database/test.py b/tests/integration/test_replicated_database/test.py
index 92c109974e14..11ca0d2f9620 100644
--- a/tests/integration/test_replicated_database/test.py
+++ b/tests/integration/test_replicated_database/test.py
@@ -96,13 +96,16 @@ def test_create_replicated_table(started_cluster):
         "Explicit zookeeper_path and replica_name are specified"
         in main_node.query_and_get_error(
             "CREATE TABLE testdb.replicated_table (d Date, k UInt64, i32 Int32) "
-            "ENGINE=ReplicatedMergeTree('/test/tmp', 'r', d, k, 8192);"
+            "ENGINE=ReplicatedMergeTree('/test/tmp', 'r') ORDER BY k PARTITION BY toYYYYMM(d);"
         )
     )
 
-    assert "Old syntax is not allowed" in main_node.query_and_get_error(
-        "CREATE TABLE testdb.replicated_table (d Date, k UInt64, i32 Int32) "
-        "ENGINE=ReplicatedMergeTree('/test/tmp/{shard}', '{replica}', d, k, 8192);"
+    assert (
+        "This syntax for *MergeTree engine is deprecated"
+        in main_node.query_and_get_error(
+            "CREATE TABLE testdb.replicated_table (d Date, k UInt64, i32 Int32) "
+            "ENGINE=ReplicatedMergeTree('/test/tmp/{shard}', '{replica}', d, k, 8192);"
+        )
     )
 
     main_node.query(
@@ -393,7 +396,7 @@ def test_alters_from_different_replicas(started_cluster):
     main_node.query(
         "CREATE TABLE testdb.concurrent_test "
         "(CounterID UInt32, StartDate Date, UserID UInt32, VisitID UInt32, NestedColumn Nested(A UInt8, S String), ToDrop UInt32) "
-        "ENGINE = MergeTree(StartDate, intHash32(UserID), (CounterID, StartDate, intHash32(UserID), VisitID), 8192);"
+        "ENGINE = MergeTree PARTITION BY toYYYYMM(StartDate) ORDER BY (CounterID, StartDate, intHash32(UserID), VisitID);"
     )
 
     main_node.query(
@@ -443,7 +446,7 @@ def test_alters_from_different_replicas(started_cluster):
         "    `Added0` UInt32,\
    `Added1` UInt32,\
    `Added2` UInt32,\
    `AddedNested1.A` Array(UInt32),\
"
         "    `AddedNested1.B` Array(UInt64),\
    `AddedNested1.C` Array(String),\
    `AddedNested2.A` Array(UInt32),\
"
         "    `AddedNested2.B` Array(UInt64)\
)\
"
-        "ENGINE = MergeTree(StartDate, intHash32(UserID), (CounterID, StartDate, intHash32(UserID), VisitID), 8192)"
+        "ENGINE = MergeTree\
PARTITION BY toYYYYMM(StartDate)\
ORDER BY (CounterID, StartDate, intHash32(UserID), VisitID)\
SETTINGS index_granularity = 8192"
     )
 
     assert_create_query([main_node, competing_node], "testdb.concurrent_test", expected)
diff --git a/tests/integration/test_replicated_merge_tree_compatibility/test.py b/tests/integration/test_replicated_merge_tree_compatibility/test.py
index 00367daad331..eb2b14ffb1a6 100644
--- a/tests/integration/test_replicated_merge_tree_compatibility/test.py
+++ b/tests/integration/test_replicated_merge_tree_compatibility/test.py
@@ -52,7 +52,10 @@ def test_replicated_merge_tree_defaults_compatibility(started_cluster):
     """
 
     for node in (node1, node2):
-        node.query("CREATE DATABASE test ENGINE = Ordinary")
+        node.query(
+            "CREATE DATABASE test ENGINE = Ordinary",
+            settings={"allow_deprecated_database_ordinary": 1},
+        )
         node.query(create_query.format(replica=node.name))
 
     node1.query("DETACH TABLE test.table")
diff --git a/tests/integration/test_replicated_merge_tree_s3_restore/test.py b/tests/integration/test_replicated_merge_tree_s3_restore/test.py
index 904bcfa42801..d743dedbdde3 100644
--- a/tests/integration/test_replicated_merge_tree_s3_restore/test.py
+++ b/tests/integration/test_replicated_merge_tree_s3_restore/test.py
@@ -76,7 +76,8 @@ def create_table(node, table_name, schema, attach=False, db_atomic=False, uuid="
         "CREATE DATABASE IF NOT EXISTS s3 {on_cluster} ENGINE = {engine}".format(
             engine="Atomic" if db_atomic else "Ordinary",
             on_cluster="ON CLUSTER '{cluster}'",
-        )
+        ),
+        settings={"allow_deprecated_database_ordinary": 1},
     )
 
     create_table_statement = """
diff --git a/tests/integration/test_replication_credentials/test.py b/tests/integration/test_replication_credentials/test.py
index e5313cb6bd4a..79588fcd38bc 100644
--- a/tests/integration/test_replication_credentials/test.py
+++ b/tests/integration/test_replication_credentials/test.py
@@ -10,7 +10,7 @@ def _fill_nodes(nodes, shard):
             """
                 CREATE DATABASE test;
                 CREATE TABLE test_table(date Date, id UInt32, dummy UInt32)
-                ENGINE = ReplicatedMergeTree('/clickhouse/tables/test{shard}/replicated', '{replica}', date, id, 8192);
+                ENGINE = ReplicatedMergeTree('/clickhouse/tables/test{shard}/replicated', '{replica}') PARTITION BY toYYYYMM(date) ORDER BY id;
             """.format(
                 shard=shard, replica=node.name
             )
diff --git a/tests/integration/test_send_request_to_leader_replica/test.py b/tests/integration/test_send_request_to_leader_replica/test.py
index 60df18bf7d39..b56e1315672d 100644
--- a/tests/integration/test_send_request_to_leader_replica/test.py
+++ b/tests/integration/test_send_request_to_leader_replica/test.py
@@ -40,7 +40,7 @@ def started_cluster():
             node.query(
                 """
             CREATE TABLE sometable(date Date, id UInt32, value Int32)
-    ENGINE = ReplicatedMergeTree('/clickhouse/tables/0/sometable', '{replica}', date, id, 8192);
+    ENGINE = ReplicatedMergeTree('/clickhouse/tables/0/sometable', '{replica}') PARTITION BY toYYYYMM(date) ORDER BY id;
                 """.format(
                     replica=node.name
                 ),
@@ -51,7 +51,7 @@ def started_cluster():
             node.query(
                 """
             CREATE TABLE someothertable(date Date, id UInt32, value Int32)
-    ENGINE = ReplicatedMergeTree('/clickhouse/tables/0/someothertable', '{replica}', date, id, 8192);
+    ENGINE = ReplicatedMergeTree('/clickhouse/tables/0/someothertable', '{replica}') PARTITION BY toYYYYMM(date) ORDER BY id;
                 """.format(
                     replica=node.name
                 ),
diff --git a/tests/integration/test_server_initialization/clickhouse_path/metadata/default.sql b/tests/integration/test_server_initialization/clickhouse_path/metadata/default.sql
new file mode 100644
index 000000000000..9fae1d577266
--- /dev/null
+++ b/tests/integration/test_server_initialization/clickhouse_path/metadata/default.sql
@@ -0,0 +1,1 @@
+ATTACH DATABASE default ENGINE=Ordinary
\ No newline at end of file
diff --git a/tests/integration/test_system_merges/test.py b/tests/integration/test_system_merges/test.py
index 775706f4df67..b908ba0eb330 100644
--- a/tests/integration/test_system_merges/test.py
+++ b/tests/integration/test_system_merges/test.py
@@ -26,9 +26,13 @@ def started_cluster():
     try:
         cluster.start()
         node1.query(
-            "CREATE DATABASE test ENGINE=Ordinary"
+            "CREATE DATABASE test ENGINE=Ordinary",
+            settings={"allow_deprecated_database_ordinary": 1},
         )  # Different paths with Atomic
-        node2.query("CREATE DATABASE test ENGINE=Ordinary")
+        node2.query(
+            "CREATE DATABASE test ENGINE=Ordinary",
+            settings={"allow_deprecated_database_ordinary": 1},
+        )
         yield cluster
 
     finally:
diff --git a/tests/integration/test_union_header/test.py b/tests/integration/test_union_header/test.py
index f883057c1d83..2e7f6cb399a2 100644
--- a/tests/integration/test_union_header/test.py
+++ b/tests/integration/test_union_header/test.py
@@ -27,7 +27,7 @@ def started_cluster():
                 log_type UInt32,
                 account_id String
             )
-            ENGINE = MergeTree(event_date, (event_time, account_id), 8192);
+            ENGINE = MergeTree PARTITION BY toYYYYMM(event_date) ORDER BY (event_time, account_id);
             """
             )
 
diff --git a/tests/integration/test_version_update_after_mutation/test.py b/tests/integration/test_version_update_after_mutation/test.py
index 2971cbc97929..a21186bba8d5 100644
--- a/tests/integration/test_version_update_after_mutation/test.py
+++ b/tests/integration/test_version_update_after_mutation/test.py
@@ -58,8 +58,8 @@ def test_mutate_and_upgrade(start_cluster):
 
     node2.query("DETACH TABLE mt")  # stop being leader
     node1.query("DETACH TABLE mt")  # stop being leader
-    node1.restart_with_latest_version(signal=9)
-    node2.restart_with_latest_version(signal=9)
+    node1.restart_with_latest_version(signal=9, fix_metadata=True)
+    node2.restart_with_latest_version(signal=9, fix_metadata=True)
 
     # After hard restart table can be in readonly mode
     exec_query_with_retry(
@@ -111,7 +111,7 @@ def test_upgrade_while_mutation(start_cluster):
     node3.query("ALTER TABLE mt1 DELETE WHERE id % 2 == 0")
 
     node3.query("DETACH TABLE mt1")  # stop being leader
-    node3.restart_with_latest_version(signal=9)
+    node3.restart_with_latest_version(signal=9, fix_metadata=True)
 
     # checks for readonly
     exec_query_with_retry(node3, "OPTIMIZE TABLE mt1", sleep_time=5, retry_count=60)
diff --git a/tests/integration/test_zookeeper_config/test.py b/tests/integration/test_zookeeper_config/test.py
index d3d90ca0d4f6..65f82c2286b1 100644
--- a/tests/integration/test_zookeeper_config/test.py
+++ b/tests/integration/test_zookeeper_config/test.py
@@ -48,7 +48,7 @@ def test_chroot_with_same_root(started_cluster):
         node.query(
             """
         CREATE TABLE simple (date Date, id UInt32)
-        ENGINE = ReplicatedMergeTree('/clickhouse/tables/0/simple', '{replica}', date, id, 8192);
+        ENGINE = ReplicatedMergeTree('/clickhouse/tables/0/simple', '{replica}') PARTITION BY toYYYYMM(date) ORDER BY id;
         """.format(
                 replica=node.name
             )
@@ -68,7 +68,7 @@ def test_chroot_with_different_root(started_cluster):
         node.query(
             """
         CREATE TABLE simple_different (date Date, id UInt32)
-        ENGINE = ReplicatedMergeTree('/clickhouse/tables/0/simple_different', '{replica}', date, id, 8192);
+        ENGINE = ReplicatedMergeTree('/clickhouse/tables/0/simple_different', '{replica}') PARTITION BY toYYYYMM(date) ORDER BY id;
         """.format(
                 replica=node.name
             )
diff --git a/tests/integration/test_zookeeper_config/test_password.py b/tests/integration/test_zookeeper_config/test_password.py
index 580b426db6fd..71f059b3277c 100644
--- a/tests/integration/test_zookeeper_config/test_password.py
+++ b/tests/integration/test_zookeeper_config/test_password.py
@@ -35,7 +35,7 @@ def test_identity(started_cluster):
     node1.query(
         """
     CREATE TABLE simple (date Date, id UInt32)
-    ENGINE = ReplicatedMergeTree('/clickhouse/tables/0/simple', '{replica}', date, id, 8192);
+    ENGINE = ReplicatedMergeTree('/clickhouse/tables/0/simple', '{replica}') PARTITION BY toYYYYMM(date) ORDER BY id;
     """.format(
             replica=node1.name
         )
@@ -45,6 +45,6 @@ def test_identity(started_cluster):
         node2.query(
             """
         CREATE TABLE simple (date Date, id UInt32)
-        ENGINE = ReplicatedMergeTree('/clickhouse/tables/0/simple', '1', date, id, 8192);
+        ENGINE = ReplicatedMergeTree('/clickhouse/tables/0/simple', '1') PARTITION BY toYYYYMM(date) ORDER BY id;
         """
         )
diff --git a/tests/performance/merge_table_streams.xml b/tests/performance/merge_table_streams.xml
index efeb4547f379..1e053c987389 100644
--- a/tests/performance/merge_table_streams.xml
+++ b/tests/performance/merge_table_streams.xml
@@ -1,6 +1,7 @@
 <test>
 <settings>
     <max_threads>5</max_threads>
+    <allow_deprecated_syntax_for_merge_tree>1</allow_deprecated_syntax_for_merge_tree>
 </settings>
 
 <!-- Create four empty tables. We will test select from Merge table involving one real table and four empty tables. 
diff --git a/tests/performance/parallel_final.xml b/tests/performance/parallel_final.xml
index ca84ed52a046..d7ea0240105e 100644
--- a/tests/performance/parallel_final.xml
+++ b/tests/performance/parallel_final.xml
@@ -4,6 +4,7 @@
         <max_partitions_per_insert_block>1024</max_partitions_per_insert_block>
         <max_insert_threads>1</max_insert_threads>
         <max_memory_usage>20G</max_memory_usage>
+        <allow_deprecated_syntax_for_merge_tree>1</allow_deprecated_syntax_for_merge_tree>
     </settings>
 
     <substitutions>
diff --git a/tests/performance/scalar2.xml b/tests/performance/scalar2.xml
index eb4275366462..7a122dbec952 100644
--- a/tests/performance/scalar2.xml
+++ b/tests/performance/scalar2.xml
@@ -1,4 +1,8 @@
 <test>
+    <settings>
+        <allow_deprecated_syntax_for_merge_tree>1</allow_deprecated_syntax_for_merge_tree>
+    </settings>
+
     <create_query>CREATE TABLE tbl0 (`ds` Date, `x1` String, `x2` UInt32, `x3` UInt32, `x4` UInt32, `bm` AggregateFunction(groupBitmap, UInt32)) ENGINE = MergeTree PARTITION BY (ds, x1) ORDER BY (x2, x3, x4) SETTINGS index_granularity = 1</create_query>
 
     <create_query>CREATE TABLE tbl (`ds` Date, `y1` UInt32, `x4` UInt32, `y2` UInt32, `y3` UInt32, `bm` AggregateFunction(groupBitmap, UInt32), `y4` UInt32 DEFAULT 0) ENGINE = MergeTree PARTITION BY (ds) ORDER BY (x4, y2, y3) SETTINGS index_granularity = 8192, max_parts_in_total = 10000000</create_query>
diff --git a/tests/queries/0_stateless/00030_alter_table.sql b/tests/queries/0_stateless/00030_alter_table.sql
index 5fc45575a4a6..fb9b3de40678 100644
--- a/tests/queries/0_stateless/00030_alter_table.sql
+++ b/tests/queries/0_stateless/00030_alter_table.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS alter_test;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE alter_test (CounterID UInt32, StartDate Date, UserID UInt32, VisitID UInt32, NestedColumn Nested(A UInt8, S String), ToDrop UInt32) ENGINE = MergeTree(StartDate, intHash32(UserID), (CounterID, StartDate, intHash32(UserID), VisitID), 8192);
 
 INSERT INTO alter_test VALUES (1, '2014-01-01', 2, 3, [1,2,3], ['a','b','c'], 4);
diff --git a/tests/queries/0_stateless/00043_summing_empty_part.sql b/tests/queries/0_stateless/00043_summing_empty_part.sql
index 68fc4b5b1c45..40cecabf3781 100644
--- a/tests/queries/0_stateless/00043_summing_empty_part.sql
+++ b/tests/queries/0_stateless/00043_summing_empty_part.sql
@@ -1,4 +1,5 @@
 DROP TABLE IF EXISTS empty_summing;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE empty_summing (d Date, k UInt64, v Int8) ENGINE=SummingMergeTree(d, k, 8192);
 
 INSERT INTO empty_summing VALUES ('2015-01-01', 1, 10);
diff --git a/tests/queries/0_stateless/00046_stored_aggregates_simple.sql b/tests/queries/0_stateless/00046_stored_aggregates_simple.sql
index 8b1ef5ba48dd..2a4ee9fa5d3a 100644
--- a/tests/queries/0_stateless/00046_stored_aggregates_simple.sql
+++ b/tests/queries/0_stateless/00046_stored_aggregates_simple.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS stored_aggregates;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE stored_aggregates
 (
     d Date,
diff --git a/tests/queries/0_stateless/00047_stored_aggregates_complex.sql b/tests/queries/0_stateless/00047_stored_aggregates_complex.sql
index 63728f131b02..2e416f91d5de 100644
--- a/tests/queries/0_stateless/00047_stored_aggregates_complex.sql
+++ b/tests/queries/0_stateless/00047_stored_aggregates_complex.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS stored_aggregates;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE stored_aggregates
 (
 	d	Date,
diff --git a/tests/queries/0_stateless/00048_a_stored_aggregates_merge.sql b/tests/queries/0_stateless/00048_a_stored_aggregates_merge.sql
index 0138a75c19ab..0213ebf46d61 100644
--- a/tests/queries/0_stateless/00048_a_stored_aggregates_merge.sql
+++ b/tests/queries/0_stateless/00048_a_stored_aggregates_merge.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS stored_aggregates;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE stored_aggregates
 (
     d   Date,
diff --git a/tests/queries/0_stateless/00048_b_stored_aggregates_merge.sql b/tests/queries/0_stateless/00048_b_stored_aggregates_merge.sql
index 79617692ebd7..708794eabff1 100644
--- a/tests/queries/0_stateless/00048_b_stored_aggregates_merge.sql
+++ b/tests/queries/0_stateless/00048_b_stored_aggregates_merge.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS stored_aggregates;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE stored_aggregates
 (
 	d	Date,
diff --git a/tests/queries/0_stateless/00061_merge_tree_alter.sql b/tests/queries/0_stateless/00061_merge_tree_alter.sql
index 822386baa472..ee5694518d9f 100644
--- a/tests/queries/0_stateless/00061_merge_tree_alter.sql
+++ b/tests/queries/0_stateless/00061_merge_tree_alter.sql
@@ -1,6 +1,7 @@
 -- Tags: no-backward-compatibility-check
 
 DROP TABLE IF EXISTS alter_00061;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE alter_00061 (d Date, k UInt64, i32 Int32) ENGINE=MergeTree(d, k, 8192);
 
 INSERT INTO alter_00061 VALUES ('2015-01-01', 10, 42);
diff --git a/tests/queries/0_stateless/00062_replicated_merge_tree_alter_zookeeper_long.sql b/tests/queries/0_stateless/00062_replicated_merge_tree_alter_zookeeper_long.sql
index e8d1a713c21a..4475421d36f5 100644
--- a/tests/queries/0_stateless/00062_replicated_merge_tree_alter_zookeeper_long.sql
+++ b/tests/queries/0_stateless/00062_replicated_merge_tree_alter_zookeeper_long.sql
@@ -6,6 +6,7 @@ DROP TABLE IF EXISTS replicated_alter2;
 
 SET replication_alter_partitions_sync = 2;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE replicated_alter1 (d Date, k UInt64, i32 Int32) ENGINE=ReplicatedMergeTree('/clickhouse/tables/{database}/test_00062/alter', 'r1', d, k, 8192);
 CREATE TABLE replicated_alter2 (d Date, k UInt64, i32 Int32) ENGINE=ReplicatedMergeTree('/clickhouse/tables/{database}/test_00062/alter', 'r2', d, k, 8192);
 
diff --git a/tests/queries/0_stateless/00079_defaulted_columns.sql b/tests/queries/0_stateless/00079_defaulted_columns.sql
index 617dc2435c48..04dfb7057d2a 100644
--- a/tests/queries/0_stateless/00079_defaulted_columns.sql
+++ b/tests/queries/0_stateless/00079_defaulted_columns.sql
@@ -13,6 +13,7 @@ drop table defaulted;
 
 create table defaulted (col1 Int8, col2 UInt64 default (SELECT dummy+99 from system.one)) engine=Memory; --{serverError 116}
 
+set allow_deprecated_syntax_for_merge_tree=1;
 create table defaulted (payload String, date materialized today(), key materialized 0 * rand()) engine=MergeTree(date, key, 8192);
 desc table defaulted;
 insert into defaulted (payload) values ('hello clickhouse');
diff --git a/tests/queries/0_stateless/00083_create_merge_tree_zookeeper_long.sql b/tests/queries/0_stateless/00083_create_merge_tree_zookeeper_long.sql
index 3418d093f709..583fc6d58268 100644
--- a/tests/queries/0_stateless/00083_create_merge_tree_zookeeper_long.sql
+++ b/tests/queries/0_stateless/00083_create_merge_tree_zookeeper_long.sql
@@ -33,6 +33,7 @@ DROP TABLE IF EXISTS replicated_summing_merge_tree_with_sampling_with_list_of_co
 DROP TABLE IF EXISTS replicated_aggregating_merge_tree_with_sampling;
 
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE merge_tree
 	(d Date, a String, b UInt8, x String, y Int8, z UInt32) ENGINE = MergeTree(d, (a, b), 111);
 CREATE TABLE collapsing_merge_tree
diff --git a/tests/queries/0_stateless/00084_summing_merge_tree.sql b/tests/queries/0_stateless/00084_summing_merge_tree.sql
index 5be1371fbcc6..429fde5c2b56 100644
--- a/tests/queries/0_stateless/00084_summing_merge_tree.sql
+++ b/tests/queries/0_stateless/00084_summing_merge_tree.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS summing_merge_tree;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE summing_merge_tree (d Date, a String, x UInt32, y UInt64, z Float64) ENGINE = SummingMergeTree(d, a, 8192);
 
 INSERT INTO summing_merge_tree VALUES ('2000-01-01', 'Hello', 1, 2, 3);
diff --git a/tests/queries/0_stateless/00090_union_race_conditions_1.sh b/tests/queries/0_stateless/00090_union_race_conditions_1.sh
index 241436369b18..f7483b741c42 100755
--- a/tests/queries/0_stateless/00090_union_race_conditions_1.sh
+++ b/tests/queries/0_stateless/00090_union_race_conditions_1.sh
@@ -10,6 +10,7 @@ set -o pipefail
 
 echo "
     DROP TABLE IF EXISTS two_blocks;
+    set allow_deprecated_syntax_for_merge_tree=1;
     CREATE TABLE two_blocks (d Date) ENGINE = MergeTree(d, d, 1);
     INSERT INTO two_blocks VALUES ('2000-01-01');
     INSERT INTO two_blocks VALUES ('2000-01-02');
diff --git a/tests/queries/0_stateless/00098_shard_i_union_all.sql b/tests/queries/0_stateless/00098_shard_i_union_all.sql
index 5151f9ad0e5b..58db30a8f9a9 100644
--- a/tests/queries/0_stateless/00098_shard_i_union_all.sql
+++ b/tests/queries/0_stateless/00098_shard_i_union_all.sql
@@ -3,6 +3,7 @@
 DROP TABLE IF EXISTS report1;
 DROP TABLE IF EXISTS report2;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE report1(id UInt32, event_date Date, priority UInt32, description String) ENGINE = MergeTree(event_date, intHash32(id), (id, event_date, intHash32(id)), 8192);
 CREATE TABLE report2(id UInt32, event_date Date, priority UInt32, description String) ENGINE = MergeTree(event_date, intHash32(id), (id, event_date, intHash32(id)), 8192);
 
diff --git a/tests/queries/0_stateless/00101_materialized_views_and_insert_without_explicit_database.sql b/tests/queries/0_stateless/00101_materialized_views_and_insert_without_explicit_database.sql
index b05b49ba33a4..95d460326016 100644
--- a/tests/queries/0_stateless/00101_materialized_views_and_insert_without_explicit_database.sql
+++ b/tests/queries/0_stateless/00101_materialized_views_and_insert_without_explicit_database.sql
@@ -8,6 +8,7 @@ DROP TABLE IF EXISTS test_table;
 DROP TABLE IF EXISTS test_view;
 DROP TABLE IF EXISTS test_view_filtered;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE test_table (EventDate Date, CounterID UInt32,  UserID UInt64,  EventTime DateTime('America/Los_Angeles'), UTCEventTime DateTime('UTC')) ENGINE = MergeTree(EventDate, CounterID, 8192);
 CREATE MATERIALIZED VIEW test_view (Rows UInt64,  MaxHitTime DateTime('America/Los_Angeles')) ENGINE = Memory AS SELECT count() AS Rows, max(UTCEventTime) AS MaxHitTime FROM test_table;
 CREATE MATERIALIZED VIEW test_view_filtered (EventDate Date, CounterID UInt32) ENGINE = Memory POPULATE AS SELECT CounterID, EventDate FROM test_table WHERE EventDate < '2013-01-01';
diff --git a/tests/queries/0_stateless/00121_drop_column_zookeeper.sql b/tests/queries/0_stateless/00121_drop_column_zookeeper.sql
index fd32f3d32d2d..f62f11c60fde 100644
--- a/tests/queries/0_stateless/00121_drop_column_zookeeper.sql
+++ b/tests/queries/0_stateless/00121_drop_column_zookeeper.sql
@@ -2,6 +2,7 @@
 -- Tag no-replicated-database: Old syntax is not allowed
 
 DROP TABLE IF EXISTS alter_00121;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE alter_00121 (d Date, x UInt8) ENGINE = ReplicatedMergeTree('/clickhouse/tables/{database}/test/alter_00121/t1', 'r1', d, (d), 8192);
 
 INSERT INTO alter_00121 VALUES ('2014-01-01', 1);
diff --git a/tests/queries/0_stateless/00124_shard_distributed_with_many_replicas.sql b/tests/queries/0_stateless/00124_shard_distributed_with_many_replicas.sql
index e29a166c1eed..901b818cbc06 100644
--- a/tests/queries/0_stateless/00124_shard_distributed_with_many_replicas.sql
+++ b/tests/queries/0_stateless/00124_shard_distributed_with_many_replicas.sql
@@ -4,6 +4,7 @@ SET allow_experimental_parallel_reading_from_replicas = 0;
 SET max_parallel_replicas = 2;
 DROP TABLE IF EXISTS report;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE report(id UInt32, event_date Date, priority UInt32, description String) ENGINE = MergeTree(event_date, intHash32(id), (id, event_date, intHash32(id)), 8192);
 
 INSERT INTO report(id,event_date,priority,description) VALUES (1, '2015-01-01', 1, 'foo')(2, '2015-02-01', 2, 'bar')(3, '2015-03-01', 3, 'foo')(4, '2015-04-01', 4, 'bar')(5, '2015-05-01', 5, 'foo');
diff --git a/tests/queries/0_stateless/00140_prewhere_column_order.sql b/tests/queries/0_stateless/00140_prewhere_column_order.sql
index d949b6f780b2..61c2fbcf39cf 100644
--- a/tests/queries/0_stateless/00140_prewhere_column_order.sql
+++ b/tests/queries/0_stateless/00140_prewhere_column_order.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS prewhere;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE prewhere (d Date, a String, b String) ENGINE = MergeTree(d, d, 8192);
 INSERT INTO prewhere VALUES ('2015-01-01', 'hello', 'world');
 
diff --git a/tests/queries/0_stateless/00141_parse_timestamp_as_datetime.sql b/tests/queries/0_stateless/00141_parse_timestamp_as_datetime.sql
index 4780884ca02d..dbd251f878c7 100644
--- a/tests/queries/0_stateless/00141_parse_timestamp_as_datetime.sql
+++ b/tests/queries/0_stateless/00141_parse_timestamp_as_datetime.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS default;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE default (d Date DEFAULT toDate(t), t DateTime) ENGINE = MergeTree(d, t, 8192);
 INSERT INTO default (t) VALUES ('1234567890');
 SELECT toStartOfMonth(d), toUInt32(t) FROM default;
diff --git a/tests/queries/0_stateless/00146_summing_merge_tree_nested_map.sql b/tests/queries/0_stateless/00146_summing_merge_tree_nested_map.sql
index ab9e8c9b177e..e759fbd85d4a 100644
--- a/tests/queries/0_stateless/00146_summing_merge_tree_nested_map.sql
+++ b/tests/queries/0_stateless/00146_summing_merge_tree_nested_map.sql
@@ -1,5 +1,6 @@
 drop table if exists nested_map;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 create table nested_map (d default today(), k UInt64, payload default rand(), SomeMap Nested(ID UInt32, Num Int64)) engine=SummingMergeTree(d, k, 8192);
 
 insert into nested_map (k, `SomeMap.ID`, `SomeMap.Num`) values (0,[1],[100]),(1,[1],[100]),(2,[1],[100]),(3,[1,2],[100,150]);
diff --git a/tests/queries/0_stateless/00147_alter_nested_default.sql b/tests/queries/0_stateless/00147_alter_nested_default.sql
index 54c99545364a..070204aef659 100644
--- a/tests/queries/0_stateless/00147_alter_nested_default.sql
+++ b/tests/queries/0_stateless/00147_alter_nested_default.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS alter_00147;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE alter_00147 (d Date DEFAULT toDate('2015-01-01'), n Nested(x String)) ENGINE = MergeTree(d, d, 8192);
 
 INSERT INTO alter_00147 (`n.x`) VALUES (['Hello', 'World']);
diff --git a/tests/queries/0_stateless/00148_summing_merge_tree_aggregate_function.sql b/tests/queries/0_stateless/00148_summing_merge_tree_aggregate_function.sql
index eab6b9da4651..649c09dbbf17 100644
--- a/tests/queries/0_stateless/00148_summing_merge_tree_aggregate_function.sql
+++ b/tests/queries/0_stateless/00148_summing_merge_tree_aggregate_function.sql
@@ -2,6 +2,7 @@ drop table if exists summing_merge_tree_aggregate_function;
 drop table if exists summing_merge_tree_null;
 
 ---- partition merge
+set allow_deprecated_syntax_for_merge_tree=1;
 create table summing_merge_tree_aggregate_function (
     d Date,
     k UInt64,
@@ -29,6 +30,7 @@ select count() from summing_merge_tree_aggregate_function;
 drop table summing_merge_tree_aggregate_function;
 
 ---- sum + uniq + uniqExact
+set allow_deprecated_syntax_for_merge_tree=1;
 create table summing_merge_tree_aggregate_function (
     d materialized today(),
     k UInt64,
diff --git a/tests/queries/0_stateless/00148_summing_merge_tree_nested_map_multiple_values.sql b/tests/queries/0_stateless/00148_summing_merge_tree_nested_map_multiple_values.sql
index 68c27cd726fa..7c5757cd526f 100644
--- a/tests/queries/0_stateless/00148_summing_merge_tree_nested_map_multiple_values.sql
+++ b/tests/queries/0_stateless/00148_summing_merge_tree_nested_map_multiple_values.sql
@@ -1,5 +1,6 @@
 drop table if exists nested_map_multiple_values;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 create table nested_map_multiple_values (d materialized today(), k UInt64, payload materialized rand(), SomeMap Nested(ID UInt32, Num1 Int64, Num2 Float64)) engine=SummingMergeTree(d, k, 8192);
 
 insert into nested_map_multiple_values values (0,[1],[100],[1.0]),(1,[1],[100],[1.0]),(2,[1],[100],[1.0]),(3,[1,2],[100,150],[1.0,1.5]);
diff --git a/tests/queries/0_stateless/00155_long_merges.sh b/tests/queries/0_stateless/00155_long_merges.sh
index 15ad0892a42c..83d89c57cfaa 100755
--- a/tests/queries/0_stateless/00155_long_merges.sh
+++ b/tests/queries/0_stateless/00155_long_merges.sh
@@ -11,10 +11,10 @@ function create {
     $CLICKHOUSE_CLIENT --query="DROP TABLE IF EXISTS aggregating_00155"
     $CLICKHOUSE_CLIENT --query="DROP TABLE IF EXISTS replacing_00155"
 
-    $CLICKHOUSE_CLIENT --query="CREATE TABLE summing_00155 (d Date DEFAULT today(), x UInt64, s UInt64 DEFAULT 1) ENGINE = SummingMergeTree(d, x, 8192)"
-    $CLICKHOUSE_CLIENT --query="CREATE TABLE collapsing_00155 (d Date DEFAULT today(), x UInt64, s Int8 DEFAULT 1) ENGINE = CollapsingMergeTree(d, x, 8192, s)"
-    $CLICKHOUSE_CLIENT --query="CREATE TABLE aggregating_00155 (d Date DEFAULT today(), x UInt64, s AggregateFunction(sum, UInt64)) ENGINE = AggregatingMergeTree(d, x, 8192)"
-    $CLICKHOUSE_CLIENT --query="CREATE TABLE replacing_00155 (d Date DEFAULT today(), x UInt64, s Int8 DEFAULT 1, v UInt64) ENGINE = ReplacingMergeTree(d, (x), 8192, v)"
+    $CLICKHOUSE_CLIENT --allow_deprecated_syntax_for_merge_tree=1 --query="CREATE TABLE summing_00155 (d Date DEFAULT today(), x UInt64, s UInt64 DEFAULT 1) ENGINE = SummingMergeTree(d, x, 8192)"
+    $CLICKHOUSE_CLIENT --allow_deprecated_syntax_for_merge_tree=1 --query="CREATE TABLE collapsing_00155 (d Date DEFAULT today(), x UInt64, s Int8 DEFAULT 1) ENGINE = CollapsingMergeTree(d, x, 8192, s)"
+    $CLICKHOUSE_CLIENT --allow_deprecated_syntax_for_merge_tree=1 --query="CREATE TABLE aggregating_00155 (d Date DEFAULT today(), x UInt64, s AggregateFunction(sum, UInt64)) ENGINE = AggregatingMergeTree(d, x, 8192)"
+    $CLICKHOUSE_CLIENT --allow_deprecated_syntax_for_merge_tree=1 --query="CREATE TABLE replacing_00155 (d Date DEFAULT today(), x UInt64, s Int8 DEFAULT 1, v UInt64) ENGINE = ReplacingMergeTree(d, (x), 8192, v)"
 }
 
 
diff --git a/tests/queries/0_stateless/00168_buffer_defaults.sql b/tests/queries/0_stateless/00168_buffer_defaults.sql
index 8e0008adf4de..ce1dea8aaa89 100644
--- a/tests/queries/0_stateless/00168_buffer_defaults.sql
+++ b/tests/queries/0_stateless/00168_buffer_defaults.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS mt_00168;
 DROP TABLE IF EXISTS mt_00168_buffer;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE mt_00168 (EventDate Date, UTCEventTime DateTime, MoscowEventDate Date DEFAULT toDate(UTCEventTime)) ENGINE = MergeTree(EventDate, UTCEventTime, 8192);
 CREATE TABLE mt_00168_buffer AS mt_00168 ENGINE = Buffer(currentDatabase(), mt_00168, 16, 10, 100, 10000, 1000000, 10000000, 100000000);
 DESC TABLE mt_00168;
diff --git a/tests/queries/0_stateless/00191_aggregating_merge_tree_and_final.sql b/tests/queries/0_stateless/00191_aggregating_merge_tree_and_final.sql
index 776edeeb43cc..8160d4dee9e2 100644
--- a/tests/queries/0_stateless/00191_aggregating_merge_tree_and_final.sql
+++ b/tests/queries/0_stateless/00191_aggregating_merge_tree_and_final.sql
@@ -1,4 +1,5 @@
 DROP TABLE IF EXISTS aggregating_00191;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE aggregating_00191 (d Date DEFAULT '2000-01-01', k UInt64, u AggregateFunction(uniq, UInt64)) ENGINE = AggregatingMergeTree(d, k, 8192);
 
 INSERT INTO aggregating_00191 (k, u) SELECT intDiv(number, 100) AS k, uniqState(toUInt64(number % 100)) AS u FROM (SELECT * FROM system.numbers LIMIT 1000) GROUP BY k;
diff --git a/tests/queries/0_stateless/00193_parallel_replicas.sql b/tests/queries/0_stateless/00193_parallel_replicas.sql
index 6c5b50972cc1..2549ada2a78a 100644
--- a/tests/queries/0_stateless/00193_parallel_replicas.sql
+++ b/tests/queries/0_stateless/00193_parallel_replicas.sql
@@ -3,6 +3,7 @@
 DROP TABLE IF EXISTS parallel_replicas;
 DROP TABLE IF EXISTS parallel_replicas_backup;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE parallel_replicas (d Date DEFAULT today(), x UInt32, u UInt64, s String) ENGINE = MergeTree(d, cityHash64(u, s), (x, d, cityHash64(u, s)), 8192);
 INSERT INTO parallel_replicas (x, u, s) VALUES (1, 2, 'A'),(3, 4, 'B'),(5, 6, 'C'),(7, 8, 'D'),(9,10,'E');
 INSERT INTO parallel_replicas (x, u, s) VALUES (11, 12, 'F'),(13, 14, 'G'),(15, 16, 'H'),(17, 18, 'I'),(19,20,'J');
diff --git a/tests/queries/0_stateless/00214_primary_key_order.sql b/tests/queries/0_stateless/00214_primary_key_order.sql
index 3c751e63e6db..e8a3be5f8dc2 100644
--- a/tests/queries/0_stateless/00214_primary_key_order.sql
+++ b/tests/queries/0_stateless/00214_primary_key_order.sql
@@ -1,4 +1,6 @@
 DROP TABLE IF EXISTS primary_key;
+
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE primary_key (d Date DEFAULT today(), x Int8) ENGINE = MergeTree(d, -x, 1);
 
 INSERT INTO primary_key (x) VALUES (1), (2), (3);
diff --git a/tests/queries/0_stateless/00215_primary_key_order_zookeeper_long.sql b/tests/queries/0_stateless/00215_primary_key_order_zookeeper_long.sql
index d50f0daeb144..f031ae7f54fb 100644
--- a/tests/queries/0_stateless/00215_primary_key_order_zookeeper_long.sql
+++ b/tests/queries/0_stateless/00215_primary_key_order_zookeeper_long.sql
@@ -2,6 +2,7 @@
 -- Tag no-replicated-database: Old syntax is not allowed
 
 DROP TABLE IF EXISTS primary_key;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE primary_key (d Date DEFAULT today(), x Int8) ENGINE = ReplicatedMergeTree('/clickhouse/tables/{database}/test_00215/primary_key', 'r1', d, -x, 1);
 
 INSERT INTO primary_key (x) VALUES (1), (2), (3);
diff --git a/tests/queries/0_stateless/00226_zookeeper_deduplication_and_unexpected_parts_long.sql b/tests/queries/0_stateless/00226_zookeeper_deduplication_and_unexpected_parts_long.sql
index 0dec3ca05bc8..727c793efb03 100644
--- a/tests/queries/0_stateless/00226_zookeeper_deduplication_and_unexpected_parts_long.sql
+++ b/tests/queries/0_stateless/00226_zookeeper_deduplication_and_unexpected_parts_long.sql
@@ -2,6 +2,7 @@
 -- Tag no-replicated-database: Old syntax is not allowed
 
 DROP TABLE IF EXISTS deduplication;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE deduplication (d Date DEFAULT '2015-01-01', x Int8) ENGINE = ReplicatedMergeTree('/clickhouse/tables/{database}/test_00226/deduplication', 'r1', d, x, 1);
 
 INSERT INTO deduplication (x) VALUES (1);
diff --git a/tests/queries/0_stateless/00229_prewhere_column_missing.sql b/tests/queries/0_stateless/00229_prewhere_column_missing.sql
index 324e37bfce7b..1fb74b04af0c 100644
--- a/tests/queries/0_stateless/00229_prewhere_column_missing.sql
+++ b/tests/queries/0_stateless/00229_prewhere_column_missing.sql
@@ -1,5 +1,6 @@
 drop table if exists prewhere_column_missing;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 create table prewhere_column_missing (d Date default '2015-01-01', x UInt64) engine=MergeTree(d, x, 1);
 
 insert into prewhere_column_missing (x) values (0);
diff --git a/tests/queries/0_stateless/00236_replicated_drop_on_non_leader_zookeeper_long.sql b/tests/queries/0_stateless/00236_replicated_drop_on_non_leader_zookeeper_long.sql
index f6eb4b2f8c1d..78319c3edd4b 100644
--- a/tests/queries/0_stateless/00236_replicated_drop_on_non_leader_zookeeper_long.sql
+++ b/tests/queries/0_stateless/00236_replicated_drop_on_non_leader_zookeeper_long.sql
@@ -6,6 +6,7 @@ SET replication_alter_partitions_sync = 2;
 DROP TABLE IF EXISTS attach_r1;
 DROP TABLE IF EXISTS attach_r2;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE attach_r1 (d Date) ENGINE = ReplicatedMergeTree('/clickhouse/tables/{database}/test_00236/01/attach', 'r1', d, d, 8192);
 CREATE TABLE attach_r2 (d Date) ENGINE = ReplicatedMergeTree('/clickhouse/tables/{database}/test_00236/01/attach', 'r2', d, d, 8192);
 
diff --git a/tests/queries/0_stateless/00253_insert_recursive_defaults.sql b/tests/queries/0_stateless/00253_insert_recursive_defaults.sql
index 37bfe0aa1880..c0edc4471254 100644
--- a/tests/queries/0_stateless/00253_insert_recursive_defaults.sql
+++ b/tests/queries/0_stateless/00253_insert_recursive_defaults.sql
@@ -5,6 +5,7 @@ SELECT * FROM defaults;
 DROP TABLE defaults;
 
 DROP TABLE IF EXISTS elog_cut;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE elog_cut
 (
     date Date DEFAULT toDate(uts),
diff --git a/tests/queries/0_stateless/00261_storage_aliases_and_array_join.sql b/tests/queries/0_stateless/00261_storage_aliases_and_array_join.sql
index 71562ffd6fa1..bb3376a9e61b 100644
--- a/tests/queries/0_stateless/00261_storage_aliases_and_array_join.sql
+++ b/tests/queries/0_stateless/00261_storage_aliases_and_array_join.sql
@@ -1,5 +1,6 @@
 drop table if exists aliases_test;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 create table aliases_test (
 date Date, id UInt64,
 array default ['zero','one','two'],
diff --git a/tests/queries/0_stateless/00262_alter_alias.sql b/tests/queries/0_stateless/00262_alter_alias.sql
index 56dbda65be7e..1c19f8636d1a 100644
--- a/tests/queries/0_stateless/00262_alter_alias.sql
+++ b/tests/queries/0_stateless/00262_alter_alias.sql
@@ -1,5 +1,6 @@
 drop table if exists aliases_test;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 create table aliases_test (date default today(), id default rand(), array default [0, 1, 2]) engine=MergeTree(date, id, 1);
 
 insert into aliases_test (id) values (0);
diff --git a/tests/queries/0_stateless/00276_sample.sql b/tests/queries/0_stateless/00276_sample.sql
index cd28f18b2b80..b75ed188ec4a 100644
--- a/tests/queries/0_stateless/00276_sample.sql
+++ b/tests/queries/0_stateless/00276_sample.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS sample_00276;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 SET min_insert_block_size_rows = 0, min_insert_block_size_bytes = 0;
 SET max_block_size = 10;
 
diff --git a/tests/queries/0_stateless/00278_insert_already_sorted.sql b/tests/queries/0_stateless/00278_insert_already_sorted.sql
index 735b46d22ddb..b3de48dc1552 100644
--- a/tests/queries/0_stateless/00278_insert_already_sorted.sql
+++ b/tests/queries/0_stateless/00278_insert_already_sorted.sql
@@ -1,4 +1,5 @@
 DROP TABLE IF EXISTS sorted;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE sorted (d Date DEFAULT '2000-01-01', x UInt64) ENGINE = MergeTree(d, x, 8192);
 
 INSERT INTO sorted (x) SELECT intDiv(number, 100000) AS x FROM system.numbers LIMIT 1000000;
diff --git a/tests/queries/0_stateless/00282_merging.sql b/tests/queries/0_stateless/00282_merging.sql
index 30aec1bc4394..f4a3708eedf3 100644
--- a/tests/queries/0_stateless/00282_merging.sql
+++ b/tests/queries/0_stateless/00282_merging.sql
@@ -1,4 +1,6 @@
 DROP TABLE IF EXISTS merge;
+
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE IF NOT EXISTS merge (d Date DEFAULT '2000-01-01', x UInt64) ENGINE = MergeTree(d, x, 5);
 
 INSERT INTO merge (x) VALUES (1), (2), (3);
@@ -73,6 +75,7 @@ SELECT * FROM merge ORDER BY _part_index, x;
 DROP TABLE merge;
 
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE IF NOT EXISTS merge (d Date DEFAULT '2000-01-01', x UInt64) ENGINE = MergeTree(d, x, 8192);
 
 SET min_insert_block_size_rows = 0, min_insert_block_size_bytes = 0;
diff --git a/tests/queries/0_stateless/00294_shard_enums.sql b/tests/queries/0_stateless/00294_shard_enums.sql
index 414b9cfad030..dcd74ac3e3a7 100644
--- a/tests/queries/0_stateless/00294_shard_enums.sql
+++ b/tests/queries/0_stateless/00294_shard_enums.sql
@@ -3,6 +3,7 @@
 set max_threads = 1;
 drop table if exists enums;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 create table enums (
     d Date default '2015-12-29', k default 0,
     e Enum8('world' = 2, 'hello' = 1), sign Enum8('minus' = -1, 'plus' = 1),
diff --git a/tests/queries/0_stateless/00311_array_primary_key.sql b/tests/queries/0_stateless/00311_array_primary_key.sql
index f6e21beab9b2..348ef2d1c6ff 100644
--- a/tests/queries/0_stateless/00311_array_primary_key.sql
+++ b/tests/queries/0_stateless/00311_array_primary_key.sql
@@ -1,5 +1,6 @@
 -- Tags: no-parallel
 
+set allow_deprecated_syntax_for_merge_tree=1;
 DROP TABLE IF EXISTS array_pk;
 CREATE TABLE array_pk (key Array(UInt8), s String, n UInt64, d Date MATERIALIZED '2000-01-01') ENGINE = MergeTree(d, (key, s, n), 1);
 
diff --git a/tests/queries/0_stateless/00314_sample_factor_virtual_column.sql b/tests/queries/0_stateless/00314_sample_factor_virtual_column.sql
index b0ed4fdedcba..6e3dc0190695 100644
--- a/tests/queries/0_stateless/00314_sample_factor_virtual_column.sql
+++ b/tests/queries/0_stateless/00314_sample_factor_virtual_column.sql
@@ -2,6 +2,7 @@ DROP TABLE IF EXISTS sample_00314_1;
 DROP TABLE IF EXISTS sample_00314_2;
 DROP TABLE IF EXISTS sample_merge_00314;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE sample_00314_1 (x UInt64, d Date DEFAULT today()) ENGINE = MergeTree(d, intHash64(x), intHash64(x), 10);
 CREATE TABLE sample_00314_2 (x UInt64, d Date DEFAULT today()) ENGINE = MergeTree(d, intHash64(x), intHash64(x), 10);
 
diff --git a/tests/queries/0_stateless/00318_pk_tuple_order.sql b/tests/queries/0_stateless/00318_pk_tuple_order.sql
index 8e2992167ee5..585f35d2f3ca 100644
--- a/tests/queries/0_stateless/00318_pk_tuple_order.sql
+++ b/tests/queries/0_stateless/00318_pk_tuple_order.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS pk;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE pk (d Date DEFAULT '2000-01-01', x UInt64, y UInt64, z UInt64) ENGINE = MergeTree(d, (x, y, z), 1);
 
 INSERT INTO pk (x, y, z) VALUES (1, 11, 1235), (1, 11, 4395), (1, 22, 3545), (1, 22, 6984), (1, 33, 4596), (2, 11, 4563), (2, 11, 4578), (2, 11, 3572), (2, 22, 5786), (2, 22, 5786), (2, 22, 2791), (2, 22, 2791), (3, 33, 2791), (3, 33, 2791), (3, 33, 1235), (3, 44, 4935), (3, 44, 4578), (3, 55, 5786), (3, 55, 2791), (3, 55, 1235);
diff --git a/tests/queries/0_stateless/00319_index_for_like.sql b/tests/queries/0_stateless/00319_index_for_like.sql
index 57ebce439f33..e490e5951421 100644
--- a/tests/queries/0_stateless/00319_index_for_like.sql
+++ b/tests/queries/0_stateless/00319_index_for_like.sql
@@ -1,4 +1,5 @@
 DROP TABLE IF EXISTS index_for_like;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE index_for_like (s String, d Date DEFAULT today()) ENGINE = MergeTree(d, (s, d), 1);
 
 INSERT INTO index_for_like (s) VALUES ('Hello'), ('Hello, World'), ('Hello, World 1'), ('Hello 1'), ('Goodbye'), ('Goodbye, World'), ('Goodbye 1'), ('Goodbye, World 1'); 
diff --git a/tests/queries/0_stateless/00321_pk_set.sql b/tests/queries/0_stateless/00321_pk_set.sql
index 073a87a6e13b..bf61a684ac7e 100644
--- a/tests/queries/0_stateless/00321_pk_set.sql
+++ b/tests/queries/0_stateless/00321_pk_set.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS pk_set;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE pk_set (d Date, n UInt64, host String, code UInt64) ENGINE = MergeTree(d, (n, host, code), 1);
 INSERT INTO pk_set (n, host, code) VALUES (1, 'market', 100), (11, 'news', 100);
 
diff --git a/tests/queries/0_stateless/00327_summing_composite_nested.sql b/tests/queries/0_stateless/00327_summing_composite_nested.sql
index f9b251ebd8fa..701735a71684 100644
--- a/tests/queries/0_stateless/00327_summing_composite_nested.sql
+++ b/tests/queries/0_stateless/00327_summing_composite_nested.sql
@@ -1,6 +1,7 @@
 SET optimize_on_insert = 0;
 
 DROP TABLE IF EXISTS summing_composite_key;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE summing_composite_key (d Date, k UInt64, FirstMap Nested(k1 UInt32, k2ID Int8, s Float64), SecondMap Nested(k1ID UInt64, k2Key String, k3Type Int32, s Int64)) ENGINE = SummingMergeTree(d, k, 1);
 
 INSERT INTO summing_composite_key VALUES ('2000-01-01', 1, [1,2], ['3','4'], [10,11], [0,1,2], [3,4,5], [-1,-2,-3], [1,10,100]), ('2000-01-01', 1, [2,1], ['4','3'], [20,22], [2,2,1], [5,5,0], [-3,-3,-33], [10,100,1000]), ('2000-01-01', 2, [1,2], ['3','4'], [10,11], [0,1,2], [3,4,5], [-1,-2,-3], [1,10,100]), ('2000-01-01', 2, [2,1,1], ['4','3','3'], [20,22,33], [2,2], [5,5], [-3,-3], [10,100]), ('2000-01-01', 2, [1,2], ['3','4'], [10,11], [0,1,2], [3,4,5], [-1,-2,-3], [1,10,100]);
diff --git a/tests/queries/0_stateless/00331_final_and_prewhere.sql b/tests/queries/0_stateless/00331_final_and_prewhere.sql
index 02af6d9b4500..5d0b80d63630 100644
--- a/tests/queries/0_stateless/00331_final_and_prewhere.sql
+++ b/tests/queries/0_stateless/00331_final_and_prewhere.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS replace;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE replace ( EventDate Date,  Id UInt64,  Data String,  Version UInt32) ENGINE = ReplacingMergeTree(EventDate, Id, 8192, Version);
 INSERT INTO replace VALUES ('2016-06-02', 1, 'version 1', 1);
 INSERT INTO replace VALUES ('2016-06-02', 2, 'version 1', 1);
diff --git a/tests/queries/0_stateless/00345_index_accurate_comparison.sql b/tests/queries/0_stateless/00345_index_accurate_comparison.sql
index 138a93990cf3..aafe2a0ae69f 100644
--- a/tests/queries/0_stateless/00345_index_accurate_comparison.sql
+++ b/tests/queries/0_stateless/00345_index_accurate_comparison.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS index;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE index
 (
     key Int32,
diff --git a/tests/queries/0_stateless/00361_shared_array_offsets_and_squash_blocks.sql b/tests/queries/0_stateless/00361_shared_array_offsets_and_squash_blocks.sql
index 6160edd05b7c..7815a35259a6 100644
--- a/tests/queries/0_stateless/00361_shared_array_offsets_and_squash_blocks.sql
+++ b/tests/queries/0_stateless/00361_shared_array_offsets_and_squash_blocks.sql
@@ -1,6 +1,7 @@
 DROP TABLE IF EXISTS nested1;
 DROP TABLE IF EXISTS nested2;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE nested1 (d Date DEFAULT '2000-01-01', x UInt64, n Nested(a String, b String)) ENGINE = MergeTree(d, x, 1);
 INSERT INTO nested1 (x, n.a, n.b) VALUES (1, ['Hello', 'World'], ['abc', 'def']), (2, [], []);
 
diff --git a/tests/queries/0_stateless/00363_defaults.sql b/tests/queries/0_stateless/00363_defaults.sql
index 4ebcc7b0f61c..1ec3b13a130d 100644
--- a/tests/queries/0_stateless/00363_defaults.sql
+++ b/tests/queries/0_stateless/00363_defaults.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS prewhere_defaults;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE prewhere_defaults (d Date DEFAULT '2000-01-01', k UInt64 DEFAULT 0, x UInt16) ENGINE = MergeTree(d, k, 1);
 
 INSERT INTO prewhere_defaults (x) VALUES (1);
diff --git a/tests/queries/0_stateless/00384_column_aggregate_function_insert_from.sql b/tests/queries/0_stateless/00384_column_aggregate_function_insert_from.sql
index 0c6146028668..a723bc9b59cf 100644
--- a/tests/queries/0_stateless/00384_column_aggregate_function_insert_from.sql
+++ b/tests/queries/0_stateless/00384_column_aggregate_function_insert_from.sql
@@ -1,4 +1,5 @@
 DROP TABLE IF EXISTS aggregates;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE aggregates (d Date, s AggregateFunction(uniq, UInt64)) ENGINE = MergeTree(d, d, 8192);
 
 INSERT INTO aggregates
diff --git a/tests/queries/0_stateless/00386_enum_in_pk.sql b/tests/queries/0_stateless/00386_enum_in_pk.sql
index 75b8a1665235..4fc79b5ef1be 100644
--- a/tests/queries/0_stateless/00386_enum_in_pk.sql
+++ b/tests/queries/0_stateless/00386_enum_in_pk.sql
@@ -1,4 +1,5 @@
 DROP TABLE IF EXISTS enum_pk;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE enum_pk (date Date DEFAULT '0000-00-00', x Enum8('0' = 0, '1' = 1, '2' = 2), d Enum8('0' = 0, '1' = 1, '2' = 2)) ENGINE = MergeTree(date, x, 1);
 INSERT INTO enum_pk (x, d) VALUES ('0', '0')('1', '1')('0', '0')('1', '1')('1', '1')('0', '0')('0', '0')('2', '2')('0', '0')('1', '1')('1', '1')('1', '1')('1', '1')('0', '0');
 
diff --git a/tests/queries/0_stateless/00392_enum_nested_alter.sql b/tests/queries/0_stateless/00392_enum_nested_alter.sql
index 205b9a7fec04..b5989885de47 100644
--- a/tests/queries/0_stateless/00392_enum_nested_alter.sql
+++ b/tests/queries/0_stateless/00392_enum_nested_alter.sql
@@ -1,4 +1,5 @@
 DROP TABLE IF EXISTS enum_nested_alter;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE enum_nested_alter
 (d Date DEFAULT '2000-01-01', x UInt64, n Nested(a String, e Enum8('Hello' = 1), b UInt8)) 
 ENGINE = MergeTree(d, x, 1);
diff --git a/tests/queries/0_stateless/00394_new_nested_column_keeps_offsets.sql b/tests/queries/0_stateless/00394_new_nested_column_keeps_offsets.sql
index 7c3775294168..f058a852e918 100644
--- a/tests/queries/0_stateless/00394_new_nested_column_keeps_offsets.sql
+++ b/tests/queries/0_stateless/00394_new_nested_column_keeps_offsets.sql
@@ -1,4 +1,5 @@
 DROP TABLE IF EXISTS alter_00394;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE alter_00394 (d Date, k UInt64, i32 Int32, n Nested(ui8 UInt8, s String)) ENGINE=MergeTree(d, k, 8192);
 
 INSERT INTO alter_00394 VALUES ('2015-01-01', 3, 30, [1,2,3], ['1','12','123']);
diff --git a/tests/queries/0_stateless/00394_replaceall_vector_fixed.sql b/tests/queries/0_stateless/00394_replaceall_vector_fixed.sql
index 47ab3fe4a1c9..ada48add4033 100644
--- a/tests/queries/0_stateless/00394_replaceall_vector_fixed.sql
+++ b/tests/queries/0_stateless/00394_replaceall_vector_fixed.sql
@@ -14,6 +14,7 @@ ORDER BY str ASC;
 
 DROP TABLE replaceall;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE replaceall (date Date DEFAULT today(), fs FixedString(16)) ENGINE = MergeTree(date, (date, fs), 8192);
 INSERT INTO replaceall (fs) VALUES ('54db0d43009d\0\0\0\0'), ('fe2b58224766cf10'), ('54db0d43009d\0\0\0\0'), ('fe2b58224766cf10');
 
diff --git a/tests/queries/0_stateless/00395_nullable.sql b/tests/queries/0_stateless/00395_nullable.sql
index 71dc045ad098..83d27830f4ee 100644
--- a/tests/queries/0_stateless/00395_nullable.sql
+++ b/tests/queries/0_stateless/00395_nullable.sql
@@ -8,6 +8,7 @@ SELECT NULL + NULL;
 SELECT '----- MergeTree engine -----';
 
 DROP TABLE IF EXISTS test1_00395;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE test1_00395(
 col1 UInt64, col2 Nullable(UInt64),
 col3 String, col4 Nullable(String),
diff --git a/tests/queries/0_stateless/00411_merge_tree_where_const_in_set.sql b/tests/queries/0_stateless/00411_merge_tree_where_const_in_set.sql
index 614f838c2ebc..22779509a3db 100644
--- a/tests/queries/0_stateless/00411_merge_tree_where_const_in_set.sql
+++ b/tests/queries/0_stateless/00411_merge_tree_where_const_in_set.sql
@@ -1,4 +1,5 @@
 DROP TABLE IF EXISTS const_in_const;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE const_in_const (id UInt64, date Date, uid UInt32, name String, Sign Int8) ENGINE = CollapsingMergeTree(date, intHash32(uid), (id, date, intHash32(uid)), 8192, Sign);
 INSERT INTO const_in_const VALUES(1, now(), 1, 'test1', 1);
 INSERT INTO const_in_const VALUES(2, now(), 1, 'test2', 1);
diff --git a/tests/queries/0_stateless/00412_logical_expressions_optimizer.sql b/tests/queries/0_stateless/00412_logical_expressions_optimizer.sql
index 5f8b15e980a7..c4fad7d50647 100644
--- a/tests/queries/0_stateless/00412_logical_expressions_optimizer.sql
+++ b/tests/queries/0_stateless/00412_logical_expressions_optimizer.sql
@@ -1,4 +1,5 @@
 DROP TABLE IF EXISTS merge_tree;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE merge_tree (x UInt64, date Date) ENGINE = MergeTree(date, x, 1);
 
 INSERT INTO merge_tree VALUES (1, '2000-01-01');
diff --git a/tests/queries/0_stateless/00427_alter_primary_key.sh b/tests/queries/0_stateless/00427_alter_primary_key.sh
index 4ad1166bfa4b..1269e2ad6e3f 100755
--- a/tests/queries/0_stateless/00427_alter_primary_key.sh
+++ b/tests/queries/0_stateless/00427_alter_primary_key.sh
@@ -8,6 +8,7 @@ function perform()
 {
     local query=$1
     TZ=UTC $CLICKHOUSE_CLIENT \
+         --allow_deprecated_syntax_for_merge_tree=1 \
         --use_client_time_zone=1 \
         --input_format_values_interpret_expressions=0 \
         --query "$query" 2>/dev/null
diff --git a/tests/queries/0_stateless/00432_aggregate_function_scalars_and_constants.sql b/tests/queries/0_stateless/00432_aggregate_function_scalars_and_constants.sql
index c74b4f03371f..a6f31b9357cb 100644
--- a/tests/queries/0_stateless/00432_aggregate_function_scalars_and_constants.sql
+++ b/tests/queries/0_stateless/00432_aggregate_function_scalars_and_constants.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS agg_func_col;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE agg_func_col (p Date, k UInt8, d AggregateFunction(sum, UInt64) DEFAULT arrayReduce('sumState', [toUInt64(200)])) ENGINE = AggregatingMergeTree(p, k, 1);
 INSERT INTO agg_func_col (k) VALUES (0);
 INSERT INTO agg_func_col (k, d) SELECT 1 AS k, arrayReduce('sumState', [toUInt64(100)]) AS d;
diff --git a/tests/queries/0_stateless/00440_nulls_merge_tree.sql b/tests/queries/0_stateless/00440_nulls_merge_tree.sql
index 7281f9605097..dd9473027b45 100644
--- a/tests/queries/0_stateless/00440_nulls_merge_tree.sql
+++ b/tests/queries/0_stateless/00440_nulls_merge_tree.sql
@@ -1,4 +1,5 @@
 DROP TABLE IF EXISTS nulls;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE nulls (d Date, x Nullable(UInt64)) ENGINE = MergeTree(d, d, 8192);
 INSERT INTO nulls SELECT toDate('2000-01-01'), number % 10 != 0 ? number : NULL FROM system.numbers LIMIT 10000;
 SELECT count() FROM nulls WHERE x IS NULL;
diff --git a/tests/queries/0_stateless/00443_optimize_final_vertical_merge.sh b/tests/queries/0_stateless/00443_optimize_final_vertical_merge.sh
index a32dde581649..3bdc5892ceda 100755
--- a/tests/queries/0_stateless/00443_optimize_final_vertical_merge.sh
+++ b/tests/queries/0_stateless/00443_optimize_final_vertical_merge.sh
@@ -16,7 +16,7 @@ function get_num_parts {
 
 $CLICKHOUSE_CLIENT -q "DROP TABLE IF EXISTS $name"
 
-$CLICKHOUSE_CLIENT -q "CREATE TABLE $name (
+$CLICKHOUSE_CLIENT --allow_deprecated_syntax_for_merge_tree=1 -q "CREATE TABLE $name (
 date Date,
 Sign Int8,
 ki UInt64,
diff --git a/tests/queries/0_stateless/00446_clear_column_in_partition_concurrent_zookeeper.sh b/tests/queries/0_stateless/00446_clear_column_in_partition_concurrent_zookeeper.sh
index a441c9a6761a..2f79365f756d 100755
--- a/tests/queries/0_stateless/00446_clear_column_in_partition_concurrent_zookeeper.sh
+++ b/tests/queries/0_stateless/00446_clear_column_in_partition_concurrent_zookeeper.sh
@@ -6,7 +6,7 @@ CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
 # shellcheck source=../shell_config.sh
 . "$CURDIR"/../shell_config.sh
 
-ch="$CLICKHOUSE_CLIENT --stacktrace -q"
+ch="$CLICKHOUSE_CLIENT  --allow_deprecated_syntax_for_merge_tree=1 --stacktrace -q"
 
 $ch "DROP TABLE IF EXISTS clear_column1"
 $ch "DROP TABLE IF EXISTS clear_column2"
diff --git a/tests/queries/0_stateless/00453_cast_enum.sql b/tests/queries/0_stateless/00453_cast_enum.sql
index 70b7e2b1d6d7..384db50c7c45 100644
--- a/tests/queries/0_stateless/00453_cast_enum.sql
+++ b/tests/queries/0_stateless/00453_cast_enum.sql
@@ -1,4 +1,5 @@
 DROP TABLE IF EXISTS cast_enums;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE cast_enums
 (
     type Enum8('session' = 1, 'pageview' = 2, 'click' = 3),
diff --git a/tests/queries/0_stateless/00456_alter_nullable.sql b/tests/queries/0_stateless/00456_alter_nullable.sql
index 703d1a551a7d..0fa3837767de 100644
--- a/tests/queries/0_stateless/00456_alter_nullable.sql
+++ b/tests/queries/0_stateless/00456_alter_nullable.sql
@@ -1,4 +1,6 @@
 DROP TABLE IF EXISTS nullable_alter;
+
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE nullable_alter (d Date DEFAULT '2000-01-01', x String) ENGINE = MergeTree(d, d, 1);
 
 INSERT INTO nullable_alter (x) VALUES ('Hello'), ('World');
diff --git a/tests/queries/0_stateless/00481_reading_from_last_granula.sql b/tests/queries/0_stateless/00481_reading_from_last_granula.sql
index 29d42e41e141..c98068e466b7 100644
--- a/tests/queries/0_stateless/00481_reading_from_last_granula.sql
+++ b/tests/queries/0_stateless/00481_reading_from_last_granula.sql
@@ -1,4 +1,5 @@
 DROP TABLE IF EXISTS tab_00481;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE tab_00481 (date Date, value UInt64, s String, m FixedString(16)) ENGINE = MergeTree(date, (date, value), 8);
 INSERT INTO tab_00481 SELECT today() as date, number as value, '' as s, toFixedString('', 16) as m from system.numbers limit 42;
 SET preferred_max_column_in_block_size_bytes = 32;
diff --git a/tests/queries/0_stateless/00483_reading_from_array_structure.sql b/tests/queries/0_stateless/00483_reading_from_array_structure.sql
index 5ba152ef9b64..bab0dcd37072 100644
--- a/tests/queries/0_stateless/00483_reading_from_array_structure.sql
+++ b/tests/queries/0_stateless/00483_reading_from_array_structure.sql
@@ -1,4 +1,6 @@
 drop table if exists `table_00483`;
+
+set allow_deprecated_syntax_for_merge_tree=1;
 create table `table_00483` (date Date, `Struct.Key1` Array(UInt64), `Struct.Key2` Array(UInt64), padding FixedString(16)) engine = MergeTree(date, (date), 16);
 insert into `table_00483` select today() as date, [number], [number + 1], toFixedString('', 16) from system.numbers limit 100;
 set preferred_max_column_in_block_size_bytes = 96;
diff --git a/tests/queries/0_stateless/00489_pk_subexpression.sql b/tests/queries/0_stateless/00489_pk_subexpression.sql
index 41499f0bd1ba..6f76a13609ca 100644
--- a/tests/queries/0_stateless/00489_pk_subexpression.sql
+++ b/tests/queries/0_stateless/00489_pk_subexpression.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS pk;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE pk (d Date DEFAULT '2000-01-01', x DateTime, y UInt64, z UInt64) ENGINE = MergeTree(d, (toStartOfMinute(x), y, z), 1);
 
 INSERT INTO pk (x, y, z) VALUES (1, 11, 1235), (2, 11, 4395), (3, 22, 3545), (4, 22, 6984), (5, 33, 4596), (61, 11, 4563), (62, 11, 4578), (63, 11, 3572), (64, 22, 5786), (65, 22, 5786), (66, 22, 2791), (67, 22, 2791), (121, 33, 2791), (122, 33, 2791), (123, 33, 1235), (124, 44, 4935), (125, 44, 4578), (126, 55, 5786), (127, 55, 2791), (128, 55, 1235);
diff --git a/tests/queries/0_stateless/00495_reading_const_zero_column.sql b/tests/queries/0_stateless/00495_reading_const_zero_column.sql
index da529c5b9b75..0af201b66e90 100644
--- a/tests/queries/0_stateless/00495_reading_const_zero_column.sql
+++ b/tests/queries/0_stateless/00495_reading_const_zero_column.sql
@@ -1,4 +1,5 @@
 drop table if exists one_table;
+set allow_deprecated_syntax_for_merge_tree=1;
 create table one_table (date Date, one UInt64) engine = MergeTree(date, (date, one), 8192);
 insert into one_table select today(), toUInt64(1) from system.numbers limit 100000;
 SET preferred_block_size_bytes = 8192;
diff --git a/tests/queries/0_stateless/00504_insert_miss_columns.sh b/tests/queries/0_stateless/00504_insert_miss_columns.sh
index ea699ab58a5e..fa2cc9d0b22c 100755
--- a/tests/queries/0_stateless/00504_insert_miss_columns.sh
+++ b/tests/queries/0_stateless/00504_insert_miss_columns.sh
@@ -8,8 +8,8 @@ CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
 
 $CLICKHOUSE_CLIENT -q "DROP TABLE IF EXISTS advertiser";
 $CLICKHOUSE_CLIENT -q "DROP TABLE IF EXISTS advertiser_test";
-$CLICKHOUSE_CLIENT -q "CREATE TABLE advertiser ( action_date Date, adblock UInt8, imps Int64 ) Engine = SummingMergeTree( action_date, ( adblock ), 8192, ( imps ) )";
-$CLICKHOUSE_CLIENT -q "CREATE TABLE advertiser_test ( action_date Date, adblock UInt8, imps Int64, Hash UInt64 ) Engine = SummingMergeTree( action_date, ( adblock, Hash ), 8192, ( imps ) )";
+$CLICKHOUSE_CLIENT --allow_deprecated_syntax_for_merge_tree=1 -q "CREATE TABLE advertiser ( action_date Date, adblock UInt8, imps Int64 ) Engine = SummingMergeTree( action_date, ( adblock ), 8192, ( imps ) )";
+$CLICKHOUSE_CLIENT --allow_deprecated_syntax_for_merge_tree=1 -q "CREATE TABLE advertiser_test ( action_date Date, adblock UInt8, imps Int64, Hash UInt64 ) Engine = SummingMergeTree( action_date, ( adblock, Hash ), 8192, ( imps ) )";
 
 # This test will fail. It's ok.
 $CLICKHOUSE_CLIENT -q "INSERT INTO advertiser_test SELECT *, sipHash64( CAST(adblock  AS String) ), CAST(1 AS Int8) FROM advertiser;" 2>/dev/null
diff --git a/tests/queries/0_stateless/00504_mergetree_arrays_rw.sql b/tests/queries/0_stateless/00504_mergetree_arrays_rw.sql
index 766f9dfb3680..7c939d060eae 100644
--- a/tests/queries/0_stateless/00504_mergetree_arrays_rw.sql
+++ b/tests/queries/0_stateless/00504_mergetree_arrays_rw.sql
@@ -1,4 +1,5 @@
 
+set allow_deprecated_syntax_for_merge_tree=1;
 drop table if exists test_ins_arr;
 create table test_ins_arr (date Date, val Array(UInt64)) engine = MergeTree(date, (date), 8192);
 insert into test_ins_arr select toDate('2017-10-02'), [number, 42] from system.numbers limit 10000;
diff --git a/tests/queries/0_stateless/00505_distributed_secure.data b/tests/queries/0_stateless/00505_distributed_secure.data
index 96a96ef4b686..7f73c803ec2d 100644
--- a/tests/queries/0_stateless/00505_distributed_secure.data
+++ b/tests/queries/0_stateless/00505_distributed_secure.data
@@ -2,6 +2,7 @@ DROP TABLE IF EXISTS secure1;
 DROP TABLE IF EXISTS secure2;
 DROP TABLE IF EXISTS secure3;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE secure1 ( date Date, a Int32, b Int32, c Int32, d Int32) ENGINE = MergeTree(date, (a, date), 8192);
 CREATE TABLE secure2 ( date Date, a Int32, b Int32, c Int32, d Int32) ENGINE = Distributed(test_shard_localhost_secure, currentDatabase(), 'secure1');
 CREATE TABLE secure3 ( date Date, a Int32, b Int32, c Int32, d Int32) ENGINE = Distributed(test_shard_localhost_secure, currentDatabase(), 'secure2');
diff --git a/tests/queries/0_stateless/00506_union_distributed.sql b/tests/queries/0_stateless/00506_union_distributed.sql
index 08282d94d8b8..8a5dba00c272 100644
--- a/tests/queries/0_stateless/00506_union_distributed.sql
+++ b/tests/queries/0_stateless/00506_union_distributed.sql
@@ -8,6 +8,7 @@ DROP TABLE IF EXISTS union1;
 DROP TABLE IF EXISTS union2;
 DROP TABLE IF EXISTS union3;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE union1 ( date Date, a Int32, b Int32, c Int32, d Int32) ENGINE = MergeTree(date, (a, date), 8192);
 CREATE TABLE union2 ( date Date, a Int32, b Int32, c Int32, d Int32) ENGINE = Distributed(test_shard_localhost, currentDatabase(), 'union1');
 CREATE TABLE union3 ( date Date, a Int32, b Int32, c Int32, d Int32) ENGINE = Distributed(test_shard_localhost, currentDatabase(), 'union2');
diff --git a/tests/queries/0_stateless/00515_shard_desc_table_functions_and_subqueries.sql b/tests/queries/0_stateless/00515_shard_desc_table_functions_and_subqueries.sql
index 64ceb394b17e..e358072248a4 100644
--- a/tests/queries/0_stateless/00515_shard_desc_table_functions_and_subqueries.sql
+++ b/tests/queries/0_stateless/00515_shard_desc_table_functions_and_subqueries.sql
@@ -1,6 +1,7 @@
 -- Tags: shard
 
 drop table if exists tab;
+set allow_deprecated_syntax_for_merge_tree=1;
 create table tab (date Date, val UInt64, val2 UInt8 default 42, val3 UInt8 default val2 + 1, val4 UInt64 alias val) engine = MergeTree(date, (date, val), 8192);
 desc tab;
 select '-';
diff --git a/tests/queries/0_stateless/00516_deduplication_after_drop_partition_zookeeper.sql b/tests/queries/0_stateless/00516_deduplication_after_drop_partition_zookeeper.sql
index 6c76adb86d08..08dccac9d255 100644
--- a/tests/queries/0_stateless/00516_deduplication_after_drop_partition_zookeeper.sql
+++ b/tests/queries/0_stateless/00516_deduplication_after_drop_partition_zookeeper.sql
@@ -2,6 +2,7 @@
 -- Tag no-replicated-database: Old syntax is not allowed
 
 DROP TABLE IF EXISTS deduplication_by_partition;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE deduplication_by_partition(d Date, x UInt32) ENGINE =
     ReplicatedMergeTree('/clickhouse/tables/{database}/test_00516/deduplication_by_partition', 'r1', d, x, 8192);
 
diff --git a/tests/queries/0_stateless/00531_aggregate_over_nullable.sql b/tests/queries/0_stateless/00531_aggregate_over_nullable.sql
index ff485b4251ab..1680bb90bb10 100644
--- a/tests/queries/0_stateless/00531_aggregate_over_nullable.sql
+++ b/tests/queries/0_stateless/00531_aggregate_over_nullable.sql
@@ -1,4 +1,5 @@
 DROP TABLE IF EXISTS agg_over_nullable;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE agg_over_nullable (
 	partition Date,
 	timestamp DateTime,
diff --git a/tests/queries/0_stateless/00542_materialized_view_and_time_zone_tag.sql b/tests/queries/0_stateless/00542_materialized_view_and_time_zone_tag.sql
index 5e9277c90b66..88808ac20f92 100644
--- a/tests/queries/0_stateless/00542_materialized_view_and_time_zone_tag.sql
+++ b/tests/queries/0_stateless/00542_materialized_view_and_time_zone_tag.sql
@@ -2,6 +2,7 @@ DROP TABLE IF EXISTS m3;
 DROP TABLE IF EXISTS m1;
 DROP TABLE IF EXISTS x;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE x (d Date, t DateTime) ENGINE = MergeTree(d, (d, t), 1);
 
 CREATE MATERIALIZED VIEW m1 (d Date, t DateTime, c UInt64) ENGINE = SummingMergeTree(d, (d, t), 1) AS SELECT d, toStartOfMinute(x.t) as t, count() as c FROM x GROUP BY d, t;
diff --git a/tests/queries/0_stateless/00543_null_and_prewhere.sql b/tests/queries/0_stateless/00543_null_and_prewhere.sql
index 793d65925a1d..5f50397862a3 100644
--- a/tests/queries/0_stateless/00543_null_and_prewhere.sql
+++ b/tests/queries/0_stateless/00543_null_and_prewhere.sql
@@ -1,3 +1,5 @@
+
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE test
 (
     dt Date,
diff --git a/tests/queries/0_stateless/00561_storage_join.sql b/tests/queries/0_stateless/00561_storage_join.sql
index 913ecec6f4af..9927592465a2 100644
--- a/tests/queries/0_stateless/00561_storage_join.sql
+++ b/tests/queries/0_stateless/00561_storage_join.sql
@@ -1,5 +1,6 @@
 drop table IF EXISTS joinbug;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE joinbug (
   event_date Date MATERIALIZED toDate(created, 'Asia/Istanbul'),
   id UInt64,
diff --git a/tests/queries/0_stateless/00563_complex_in_expression.sql b/tests/queries/0_stateless/00563_complex_in_expression.sql
index cd80b9c3a7a5..bd053e0d0205 100644
--- a/tests/queries/0_stateless/00563_complex_in_expression.sql
+++ b/tests/queries/0_stateless/00563_complex_in_expression.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS test_00563;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE test_00563 ( dt Date, site_id Int32, site_key String ) ENGINE = MergeTree(dt, (site_id, site_key, dt), 8192);
 INSERT INTO test_00563 (dt,site_id, site_key) VALUES ('2018-1-29', 100, 'key');
 SELECT * FROM test_00563 WHERE toInt32(site_id) IN (100);
diff --git a/tests/queries/0_stateless/00564_initial_column_values_with_default_expression.sql b/tests/queries/0_stateless/00564_initial_column_values_with_default_expression.sql
index d26621dce7a8..3fff20a1fe16 100644
--- a/tests/queries/0_stateless/00564_initial_column_values_with_default_expression.sql
+++ b/tests/queries/0_stateless/00564_initial_column_values_with_default_expression.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS test;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE IF NOT EXISTS test( id UInt32, track UInt8, codec String, content String, rdate Date DEFAULT '2018-02-03', track_id String DEFAULT concat(concat(concat(toString(track), '-'), codec), content) ) ENGINE=MergeTree(rdate, (id, track_id), 8192);
 
 INSERT INTO test(id, track, codec) VALUES(1, 0, 'h264');
diff --git a/tests/queries/0_stateless/00564_versioned_collapsing_merge_tree.sql b/tests/queries/0_stateless/00564_versioned_collapsing_merge_tree.sql
index 66bbb02183c1..fdee9390642c 100644
--- a/tests/queries/0_stateless/00564_versioned_collapsing_merge_tree.sql
+++ b/tests/queries/0_stateless/00564_versioned_collapsing_merge_tree.sql
@@ -1,5 +1,6 @@
 -- Tags: no-parallel
 
+set allow_deprecated_syntax_for_merge_tree=1;
 set optimize_on_insert = 0;
 
 drop table if exists mult_tab;
diff --git a/tests/queries/0_stateless/00565_enum_order.sh b/tests/queries/0_stateless/00565_enum_order.sh
index 6958a403246e..fedd81b91f81 100755
--- a/tests/queries/0_stateless/00565_enum_order.sh
+++ b/tests/queries/0_stateless/00565_enum_order.sh
@@ -10,7 +10,7 @@ $CLICKHOUSE_CLIENT <<"EOF"
 DROP TABLE IF EXISTS `test_log`
 EOF
 
-$CLICKHOUSE_CLIENT <<"EOF"
+$CLICKHOUSE_CLIENT --allow_deprecated_syntax_for_merge_tree=1 <<"EOF"
 CREATE TABLE `test_log` (
     date Date,
     datetime DateTime,
diff --git a/tests/queries/0_stateless/00571_non_exist_database_when_create_materializ_view.sql b/tests/queries/0_stateless/00571_non_exist_database_when_create_materializ_view.sql
index c384ef37fc7b..46fc0dd586dd 100644
--- a/tests/queries/0_stateless/00571_non_exist_database_when_create_materializ_view.sql
+++ b/tests/queries/0_stateless/00571_non_exist_database_when_create_materializ_view.sql
@@ -8,6 +8,7 @@ DROP DATABASE IF EXISTS none;
 DROP TABLE IF EXISTS test_00571;
 DROP TABLE IF EXISTS test_materialized_00571;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE DATABASE none;
 CREATE TABLE test_00571 ( date Date, platform Enum8('a' = 0, 'b' = 1, 'c' = 2), app Enum8('a' = 0, 'b' = 1) ) ENGINE = MergeTree(date, (platform, app), 8192);
 CREATE MATERIALIZED VIEW test_materialized_00571 ENGINE = MergeTree(date, (platform, app), 8192) POPULATE AS SELECT date, platform, app FROM (SELECT * FROM test_00571);
diff --git a/tests/queries/0_stateless/00575_illegal_column_exception_when_drop_depen_column.sh b/tests/queries/0_stateless/00575_illegal_column_exception_when_drop_depen_column.sh
index 42bf37cbda53..706c08191258 100755
--- a/tests/queries/0_stateless/00575_illegal_column_exception_when_drop_depen_column.sh
+++ b/tests/queries/0_stateless/00575_illegal_column_exception_when_drop_depen_column.sh
@@ -9,7 +9,7 @@ CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
 exception_pattern="Code: 44.*Cannot drop column \`id\`, because column \`id2\` depends on it"
 
 ${CLICKHOUSE_CLIENT} --query "DROP TABLE IF EXISTS test_00575;"
-${CLICKHOUSE_CLIENT} --query "CREATE TABLE test_00575 (dt Date DEFAULT now(), id UInt32, id2 UInt32 DEFAULT id + 1) ENGINE = MergeTree(dt, dt, 8192);"
+${CLICKHOUSE_CLIENT} --allow_deprecated_syntax_for_merge_tree=1 --query "CREATE TABLE test_00575 (dt Date DEFAULT now(), id UInt32, id2 UInt32 DEFAULT id + 1) ENGINE = MergeTree(dt, dt, 8192);"
 ${CLICKHOUSE_CLIENT} --query "INSERT INTO test_00575(dt,id) VALUES ('2018-02-22',3), ('2018-02-22',4), ('2018-02-22',5);"
 ${CLICKHOUSE_CLIENT} --query "SELECT * FROM test_00575 ORDER BY id;"
 echo "$(${CLICKHOUSE_CLIENT} --query "ALTER TABLE test_00575 DROP COLUMN id;" --server_logs_file=/dev/null 2>&1 | grep -c "$exception_pattern")"
diff --git a/tests/queries/0_stateless/00575_merge_and_index_with_function_in_in.sql b/tests/queries/0_stateless/00575_merge_and_index_with_function_in_in.sql
index e491ef37adac..6f0ddd9fae30 100644
--- a/tests/queries/0_stateless/00575_merge_and_index_with_function_in_in.sql
+++ b/tests/queries/0_stateless/00575_merge_and_index_with_function_in_in.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS t_00575;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 create table t_00575(d Date) engine MergeTree(d, d, 8192);
 
 insert into t_00575 values ('2018-02-20');
diff --git a/tests/queries/0_stateless/00579_virtual_column_and_lazy.sql b/tests/queries/0_stateless/00579_virtual_column_and_lazy.sql
index b1f1ec4cfb21..ca58a5fc93bb 100644
--- a/tests/queries/0_stateless/00579_virtual_column_and_lazy.sql
+++ b/tests/queries/0_stateless/00579_virtual_column_and_lazy.sql
@@ -2,6 +2,7 @@ DROP TABLE IF EXISTS sample_00579_1;
 DROP TABLE IF EXISTS sample_00579_2;
 DROP TABLE IF EXISTS sample_merge_00579;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE sample_00579_1 (x UInt64, d Date DEFAULT today()) ENGINE = MergeTree(d, intHash64(x), intHash64(x), 10);
 CREATE TABLE sample_00579_2 (x UInt64, d Date DEFAULT today()) ENGINE = MergeTree(d, intHash64(x), intHash64(x), 10);
 
diff --git a/tests/queries/0_stateless/00584_view_union_all.sql b/tests/queries/0_stateless/00584_view_union_all.sql
index 2e4d7ea66db7..a86dfaec6c85 100644
--- a/tests/queries/0_stateless/00584_view_union_all.sql
+++ b/tests/queries/0_stateless/00584_view_union_all.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS Test_00584;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE Test_00584 (
     createdDate Date,
     str String,
diff --git a/tests/queries/0_stateless/00594_alias_in_distributed.sql b/tests/queries/0_stateless/00594_alias_in_distributed.sql
index b75dfdf79670..250ede2bb10a 100644
--- a/tests/queries/0_stateless/00594_alias_in_distributed.sql
+++ b/tests/queries/0_stateless/00594_alias_in_distributed.sql
@@ -3,6 +3,7 @@
 DROP TABLE IF EXISTS alias_local10;
 DROP TABLE IF EXISTS alias10;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE alias_local10 (
   Id Int8,
   EventDate Date DEFAULT '2000-01-01',
diff --git a/tests/queries/0_stateless/00597_push_down_predicate_long.sql b/tests/queries/0_stateless/00597_push_down_predicate_long.sql
index 40ea8b48caab..a77f3730ac24 100644
--- a/tests/queries/0_stateless/00597_push_down_predicate_long.sql
+++ b/tests/queries/0_stateless/00597_push_down_predicate_long.sql
@@ -7,6 +7,7 @@ SET joined_subquery_requires_alias = 0;
 DROP TABLE IF EXISTS test_00597;
 DROP TABLE IF EXISTS test_view_00597;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE test_00597(date Date, id Int8, name String, value Int64) ENGINE = MergeTree(date, (id, date), 8192);
 CREATE VIEW test_view_00597 AS SELECT * FROM test_00597;
 
diff --git a/tests/queries/0_stateless/00609_mv_index_in_in.sql b/tests/queries/0_stateless/00609_mv_index_in_in.sql
index 002c94dd576e..bd9f35350c1f 100644
--- a/tests/queries/0_stateless/00609_mv_index_in_in.sql
+++ b/tests/queries/0_stateless/00609_mv_index_in_in.sql
@@ -6,6 +6,7 @@ DROP TABLE IF EXISTS test_mv_00609;
 create table test_00609 (a Int8) engine=Memory;
 
 insert into test_00609 values (1);
+set allow_deprecated_syntax_for_merge_tree=1;
 create materialized view test_mv_00609 uuid '00000609-1000-4000-8000-000000000001' Engine=MergeTree(date, (a), 8192) populate as select a, toDate('2000-01-01') date from test_00609;
 
 select * from test_mv_00609; -- OK
diff --git a/tests/queries/0_stateless/00610_materialized_view_forward_alter_partition_statements.sql b/tests/queries/0_stateless/00610_materialized_view_forward_alter_partition_statements.sql
index 6f5ba07e5dbf..8830204ecb59 100644
--- a/tests/queries/0_stateless/00610_materialized_view_forward_alter_partition_statements.sql
+++ b/tests/queries/0_stateless/00610_materialized_view_forward_alter_partition_statements.sql
@@ -1,6 +1,7 @@
 DROP TABLE IF EXISTS tab_00610;
 DROP TABLE IF EXISTS mv_00610;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE tab_00610(d Date, x UInt32) ENGINE MergeTree(d, x, 8192);
 CREATE MATERIALIZED VIEW mv_00610(d Date, y UInt64) ENGINE MergeTree(d, y, 8192) AS SELECT d, x + 1 AS y FROM tab_00610;
 
diff --git a/tests/queries/0_stateless/00614_array_nullable.sql b/tests/queries/0_stateless/00614_array_nullable.sql
index d62ddb8242c4..1cbfbf128cbe 100644
--- a/tests/queries/0_stateless/00614_array_nullable.sql
+++ b/tests/queries/0_stateless/00614_array_nullable.sql
@@ -1,4 +1,5 @@
 DROP TABLE IF EXISTS test;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE test(date Date, keys Array(Nullable(UInt8))) ENGINE = MergeTree(date, date, 1);
 INSERT INTO test VALUES ('2017-09-10', [1, 2, 3, 4, 5, 6, 7, NULL]);
 SELECT * FROM test LIMIT 1;
diff --git a/tests/queries/0_stateless/00614_shard_same_header_for_local_and_remote_node_in_distributed_query.sql b/tests/queries/0_stateless/00614_shard_same_header_for_local_and_remote_node_in_distributed_query.sql
index 5d3739277148..17cc76670b34 100644
--- a/tests/queries/0_stateless/00614_shard_same_header_for_local_and_remote_node_in_distributed_query.sql
+++ b/tests/queries/0_stateless/00614_shard_same_header_for_local_and_remote_node_in_distributed_query.sql
@@ -1,6 +1,7 @@
 -- Tags: distributed
 
 drop table if exists tab;
+set allow_deprecated_syntax_for_merge_tree=1;
 create table tab (date Date,  time DateTime, data String) ENGINE = MergeTree(date, (time, data), 8192);
 insert into tab values ('2018-01-21','2018-01-21 15:12:13','test');
 select time FROM remote('127.0.0.{1,2}', currentDatabase(), tab)  WHERE date = '2018-01-21' limit 2;
diff --git a/tests/queries/0_stateless/00615_nullable_alter_optimize.sql b/tests/queries/0_stateless/00615_nullable_alter_optimize.sql
index 5c0a192e8268..26ff3b78d5e7 100644
--- a/tests/queries/0_stateless/00615_nullable_alter_optimize.sql
+++ b/tests/queries/0_stateless/00615_nullable_alter_optimize.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS test_00615;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE test_00615
 (
     dt Date,
diff --git a/tests/queries/0_stateless/00616_final_single_part.sql b/tests/queries/0_stateless/00616_final_single_part.sql
index 6618d0b12524..8c7720f89601 100644
--- a/tests/queries/0_stateless/00616_final_single_part.sql
+++ b/tests/queries/0_stateless/00616_final_single_part.sql
@@ -3,6 +3,7 @@ SET optimize_on_insert = 0;
 DROP TABLE IF EXISTS test_00616;
 DROP TABLE IF EXISTS replacing_00616;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE test_00616
 (
     date Date,
@@ -12,6 +13,7 @@ CREATE TABLE test_00616
 ENGINE = MergeTree(date, x, 4096);
 
 INSERT INTO test_00616 VALUES ('2018-03-21', 1, 1), ('2018-03-21', 1, 2);
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE replacing_00616 ENGINE = ReplacingMergeTree(date, x, 4096, ver) AS SELECT * FROM test_00616;
 
 SELECT * FROM test_00616 ORDER BY ver;
diff --git a/tests/queries/0_stateless/00621_regression_for_in_operator.sql b/tests/queries/0_stateless/00621_regression_for_in_operator.sql
index 84355a04df43..273f930a90fb 100644
--- a/tests/queries/0_stateless/00621_regression_for_in_operator.sql
+++ b/tests/queries/0_stateless/00621_regression_for_in_operator.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS regression_for_in_operator_view;
 DROP TABLE IF EXISTS regression_for_in_operator;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE regression_for_in_operator (d Date, v UInt32, g String) ENGINE=MergeTree(d, d, 8192);
 CREATE MATERIALIZED VIEW regression_for_in_operator_view ENGINE=AggregatingMergeTree(d, (d,g), 8192) AS SELECT d, g, maxState(v) FROM regression_for_in_operator GROUP BY d, g;
 
diff --git a/tests/queries/0_stateless/00623_in_partition_key.sql b/tests/queries/0_stateless/00623_in_partition_key.sql
index 0141151e369a..6cb33f96f130 100644
--- a/tests/queries/0_stateless/00623_in_partition_key.sql
+++ b/tests/queries/0_stateless/00623_in_partition_key.sql
@@ -1,4 +1,5 @@
 drop table if exists test54378;
+set allow_deprecated_syntax_for_merge_tree=1;
 create table test54378 (part_date Date, pk_date Date, date Date) Engine=MergeTree(part_date, pk_date, 8192);
 insert into test54378 values ('2018-04-19', '2018-04-19', '2018-04-19');
 
diff --git a/tests/queries/0_stateless/00623_replicated_truncate_table_zookeeper_long.sql b/tests/queries/0_stateless/00623_replicated_truncate_table_zookeeper_long.sql
index 4a3640e2dd7c..44a7d8ca60f5 100644
--- a/tests/queries/0_stateless/00623_replicated_truncate_table_zookeeper_long.sql
+++ b/tests/queries/0_stateless/00623_replicated_truncate_table_zookeeper_long.sql
@@ -4,6 +4,7 @@
 DROP TABLE IF EXISTS replicated_truncate1;
 DROP TABLE IF EXISTS replicated_truncate2;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE replicated_truncate1 (d Date, k UInt64, i32 Int32) ENGINE=ReplicatedMergeTree('/clickhouse/tables/{database}/test_00623/truncate', 'r1', d, k, 8192);
 CREATE TABLE replicated_truncate2 (d Date, k UInt64, i32 Int32) ENGINE=ReplicatedMergeTree('/clickhouse/tables/{database}/test_00623/truncate', 'r2', d, k, 8192);
 
diff --git a/tests/queries/0_stateless/00623_truncate_table.sql b/tests/queries/0_stateless/00623_truncate_table.sql
index 80369ff2bbc4..16bc87ea2130 100644
--- a/tests/queries/0_stateless/00623_truncate_table.sql
+++ b/tests/queries/0_stateless/00623_truncate_table.sql
@@ -1,5 +1,7 @@
 -- Tags: no-parallel
 
+set allow_deprecated_syntax_for_merge_tree=1;
+
 DROP DATABASE IF EXISTS truncate_test;
 DROP TABLE IF EXISTS truncate_test_log;
 DROP TABLE IF EXISTS truncate_test_memory;
diff --git a/tests/queries/0_stateless/00625_summing_merge_tree_merge.sql b/tests/queries/0_stateless/00625_summing_merge_tree_merge.sql
index a214347a3a77..235048ad18b8 100644
--- a/tests/queries/0_stateless/00625_summing_merge_tree_merge.sql
+++ b/tests/queries/0_stateless/00625_summing_merge_tree_merge.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS tab_00625;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE tab_00625
 (
     date Date,
diff --git a/tests/queries/0_stateless/00632_get_sample_block_cache.sql b/tests/queries/0_stateless/00632_get_sample_block_cache.sql
index f9b241bbf1e9..cbb89387dd1a 100644
--- a/tests/queries/0_stateless/00632_get_sample_block_cache.sql
+++ b/tests/queries/0_stateless/00632_get_sample_block_cache.sql
@@ -7,6 +7,7 @@ DROP TABLE IF EXISTS dict_string;
 DROP TABLE IF EXISTS dict_ui64;
 DROP TABLE IF EXISTS video_views;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE video_views
 (
     entityIri String,
diff --git a/tests/queries/0_stateless/00648_replacing_empty_set_from_prewhere.sql b/tests/queries/0_stateless/00648_replacing_empty_set_from_prewhere.sql
index 1f873c94b18f..bbeb4dd31483 100644
--- a/tests/queries/0_stateless/00648_replacing_empty_set_from_prewhere.sql
+++ b/tests/queries/0_stateless/00648_replacing_empty_set_from_prewhere.sql
@@ -1,4 +1,5 @@
 DROP TABLE IF EXISTS final_test;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE final_test (id String, version Date) ENGINE = ReplacingMergeTree(version, id, 8192);
 INSERT INTO final_test (id, version) VALUES ('2018-01-01', '2018-01-01');
 SELECT * FROM final_test FINAL PREWHERE id == '2018-01-02';
diff --git a/tests/queries/0_stateless/00652_mergetree_mutations.sh b/tests/queries/0_stateless/00652_mergetree_mutations.sh
index 0cba8b940408..535cbe99dfe9 100755
--- a/tests/queries/0_stateless/00652_mergetree_mutations.sh
+++ b/tests/queries/0_stateless/00652_mergetree_mutations.sh
@@ -10,7 +10,7 @@ CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
 
 ${CLICKHOUSE_CLIENT} --query="DROP TABLE IF EXISTS mutations"
 
-${CLICKHOUSE_CLIENT} --query="CREATE TABLE mutations(d Date, x UInt32, s String, a UInt32 ALIAS x + 1, m MATERIALIZED x + 2) ENGINE MergeTree(d, intDiv(x, 10), 8192)"
+${CLICKHOUSE_CLIENT} --allow_deprecated_syntax_for_merge_tree=1 --query="CREATE TABLE mutations(d Date, x UInt32, s String, a UInt32 ALIAS x + 1, m MATERIALIZED x + 2) ENGINE MergeTree(d, intDiv(x, 10), 8192)"
 
 # Test a mutation on empty table
 ${CLICKHOUSE_CLIENT} --query="ALTER TABLE mutations DELETE WHERE x = 1"
diff --git a/tests/queries/0_stateless/00652_replicated_mutations_zookeeper.sh b/tests/queries/0_stateless/00652_replicated_mutations_zookeeper.sh
index f070e34f2a1b..7a6c76096608 100755
--- a/tests/queries/0_stateless/00652_replicated_mutations_zookeeper.sh
+++ b/tests/queries/0_stateless/00652_replicated_mutations_zookeeper.sh
@@ -12,8 +12,8 @@ CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
 ${CLICKHOUSE_CLIENT} --query="DROP TABLE IF EXISTS mutations_r1"
 ${CLICKHOUSE_CLIENT} --query="DROP TABLE IF EXISTS mutations_r2"
 
-${CLICKHOUSE_CLIENT} --query="CREATE TABLE mutations_r1(d Date, x UInt32, s String, m MATERIALIZED x + 2) ENGINE ReplicatedMergeTree('/clickhouse/tables/$CLICKHOUSE_TEST_ZOOKEEPER_PREFIX/mutations', 'r1', d, intDiv(x, 10), 8192)"
-${CLICKHOUSE_CLIENT} --query="CREATE TABLE mutations_r2(d Date, x UInt32, s String, m MATERIALIZED x + 2) ENGINE ReplicatedMergeTree('/clickhouse/tables/$CLICKHOUSE_TEST_ZOOKEEPER_PREFIX/mutations', 'r2', d, intDiv(x, 10), 8192)"
+${CLICKHOUSE_CLIENT} --allow_deprecated_syntax_for_merge_tree=1 --query="CREATE TABLE mutations_r1(d Date, x UInt32, s String, m MATERIALIZED x + 2) ENGINE ReplicatedMergeTree('/clickhouse/tables/$CLICKHOUSE_TEST_ZOOKEEPER_PREFIX/mutations', 'r1', d, intDiv(x, 10), 8192)"
+${CLICKHOUSE_CLIENT} --allow_deprecated_syntax_for_merge_tree=1 --query="CREATE TABLE mutations_r2(d Date, x UInt32, s String, m MATERIALIZED x + 2) ENGINE ReplicatedMergeTree('/clickhouse/tables/$CLICKHOUSE_TEST_ZOOKEEPER_PREFIX/mutations', 'r2', d, intDiv(x, 10), 8192)"
 
 # Test a mutation on empty table
 ${CLICKHOUSE_CLIENT} --query="ALTER TABLE mutations_r1 DELETE WHERE x = 1 SETTINGS mutations_sync = 2"
diff --git a/tests/queries/0_stateless/00678_shard_funnel_window.sql b/tests/queries/0_stateless/00678_shard_funnel_window.sql
index 8ea07a1c4ba7..73e489232839 100644
--- a/tests/queries/0_stateless/00678_shard_funnel_window.sql
+++ b/tests/queries/0_stateless/00678_shard_funnel_window.sql
@@ -1,6 +1,7 @@
 -- Tags: shard
 
 DROP TABLE IF EXISTS remote_test;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE remote_test(uid String, its UInt32,  action_code String, day Date) ENGINE = MergeTree(day, (uid, its), 8192);
 INSERT INTO remote_test SELECT toString(number) AS uid, number % 3 AS its, toString(number % 3) AS action_code, '2000-01-01' FROM system.numbers LIMIT 10000;
 SELECT level, COUNT() FROM (SELECT uid, windowFunnel(3600)(toUInt32(its), action_code != '', action_code = '2') AS level FROM remote('127.0.0.{2,3}', currentDatabase(), remote_test) GROUP BY uid) GROUP BY level;
diff --git a/tests/queries/0_stateless/00709_virtual_column_partition_id.sql b/tests/queries/0_stateless/00709_virtual_column_partition_id.sql
index 084ab904d871..48a3a3fad6a3 100644
--- a/tests/queries/0_stateless/00709_virtual_column_partition_id.sql
+++ b/tests/queries/0_stateless/00709_virtual_column_partition_id.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS partition_id;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE IF NOT EXISTS partition_id (d Date DEFAULT '2000-01-01', x UInt64) ENGINE = MergeTree(d, x, 5);
 
 INSERT INTO partition_id VALUES (100, 1), (200, 2), (300, 3);
diff --git a/tests/queries/0_stateless/00712_prewhere_with_alias_bug_2.sql b/tests/queries/0_stateless/00712_prewhere_with_alias_bug_2.sql
index 97d5e33633a7..beb986adebc4 100644
--- a/tests/queries/0_stateless/00712_prewhere_with_alias_bug_2.sql
+++ b/tests/queries/0_stateless/00712_prewhere_with_alias_bug_2.sql
@@ -1,5 +1,6 @@
 drop table if exists table;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE table (a UInt32,  date Date, b UInt64,  c UInt64, str String, d Int8, arr Array(UInt64), arr_alias Array(UInt64) ALIAS arr) ENGINE = MergeTree(date, intHash32(c), (a, date, intHash32(c), b), 8192);
 
 SELECT alias2 AS alias3
diff --git a/tests/queries/0_stateless/00712_prewhere_with_final.sql b/tests/queries/0_stateless/00712_prewhere_with_final.sql
index 4528d4f61f05..6b49e523f70c 100644
--- a/tests/queries/0_stateless/00712_prewhere_with_final.sql
+++ b/tests/queries/0_stateless/00712_prewhere_with_final.sql
@@ -1,4 +1,5 @@
 drop table if exists trepl;
+set allow_deprecated_syntax_for_merge_tree=1;
 create table trepl(d Date,a Int32, b Int32) engine = ReplacingMergeTree(d, (a,b), 8192);
 insert into trepl values ('2018-09-19', 1, 1);
 select b from trepl FINAL prewhere a < 1000;
diff --git a/tests/queries/0_stateless/00712_prewhere_with_sampling_and_alias.sql b/tests/queries/0_stateless/00712_prewhere_with_sampling_and_alias.sql
index d011e1b368d9..7c8ae4eed7c7 100644
--- a/tests/queries/0_stateless/00712_prewhere_with_sampling_and_alias.sql
+++ b/tests/queries/0_stateless/00712_prewhere_with_sampling_and_alias.sql
@@ -1,4 +1,5 @@
 drop table if exists t_00712_2;
+set allow_deprecated_syntax_for_merge_tree=1;
 create table t_00712_2 (date Date, counter UInt64, sampler UInt64, alias_col alias date + 1) engine = MergeTree(date, intHash32(sampler), (counter, date, intHash32(sampler)), 8192);
 insert into t_00712_2 values ('2018-01-01', 1, 1);
 select alias_col from t_00712_2 sample 1 / 2 where date = '2018-01-01' and counter = 1 and sampler = 1;
diff --git a/tests/queries/0_stateless/00717_merge_and_distributed.sql b/tests/queries/0_stateless/00717_merge_and_distributed.sql
index f7b4a2b24d3c..f27f6a756889 100644
--- a/tests/queries/0_stateless/00717_merge_and_distributed.sql
+++ b/tests/queries/0_stateless/00717_merge_and_distributed.sql
@@ -7,6 +7,7 @@ DROP TABLE IF EXISTS test_local_2;
 DROP TABLE IF EXISTS test_distributed_1;
 DROP TABLE IF EXISTS test_distributed_2;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE test_local_1 (date Date, value UInt32) ENGINE = MergeTree(date, date, 8192);
 CREATE TABLE test_local_2 (date Date, value UInt32) ENGINE = MergeTree(date, date, 8192);
 CREATE TABLE test_distributed_1 AS test_local_1 ENGINE = Distributed('test_shard_localhost', currentDatabase(), test_local_1, rand());
diff --git a/tests/queries/0_stateless/00729_prewhere_array_join.sql b/tests/queries/0_stateless/00729_prewhere_array_join.sql
index ba10dd38bd2c..5ac79c150c6a 100644
--- a/tests/queries/0_stateless/00729_prewhere_array_join.sql
+++ b/tests/queries/0_stateless/00729_prewhere_array_join.sql
@@ -1,6 +1,7 @@
 SET send_logs_level = 'fatal';
 
 drop table if exists t1_00729;
+set allow_deprecated_syntax_for_merge_tree=1;
 create table t1_00729 (id UInt64, val Array(String),nid UInt64, eDate Date)ENGINE = MergeTree(eDate, (id, eDate), 8192);
 
 insert into t1_00729 (id,val,nid,eDate) values (1,['background','foreground','heading','image'],1,'2018-09-27');
diff --git a/tests/queries/0_stateless/00731_long_merge_tree_select_opened_files.sh b/tests/queries/0_stateless/00731_long_merge_tree_select_opened_files.sh
index d9a3631a7ddc..2510517a7404 100755
--- a/tests/queries/0_stateless/00731_long_merge_tree_select_opened_files.sh
+++ b/tests/queries/0_stateless/00731_long_merge_tree_select_opened_files.sh
@@ -7,7 +7,7 @@ CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
 # shellcheck source=../shell_config.sh
 . "$CURDIR"/../shell_config.sh
 
-settings="--log_queries=1 --log_query_threads=1 --log_profile_events=1 --log_query_settings=1"
+settings="--log_queries=1 --log_query_threads=1 --log_profile_events=1 --log_query_settings=1 --allow_deprecated_syntax_for_merge_tree=1"
 
 # Test insert logging on each block and checkPacket() method
 
diff --git a/tests/queries/0_stateless/00732_decimal_summing_merge_tree.sql b/tests/queries/0_stateless/00732_decimal_summing_merge_tree.sql
index 1524776c16e5..96e16a1300e2 100644
--- a/tests/queries/0_stateless/00732_decimal_summing_merge_tree.sql
+++ b/tests/queries/0_stateless/00732_decimal_summing_merge_tree.sql
@@ -1,4 +1,5 @@
 DROP TABLE IF EXISTS decimal_sum;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE decimal_sum
 (
     date Date,
diff --git a/tests/queries/0_stateless/00748_insert_array_with_null.sql b/tests/queries/0_stateless/00748_insert_array_with_null.sql
index 78c564abad37..ca36352c2cfa 100644
--- a/tests/queries/0_stateless/00748_insert_array_with_null.sql
+++ b/tests/queries/0_stateless/00748_insert_array_with_null.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS arraytest;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE arraytest ( created_date Date DEFAULT toDate(created_at), created_at DateTime DEFAULT now(), strings Array(String) DEFAULT emptyArrayString()) ENGINE = MergeTree(created_date, cityHash64(created_at), (created_date, cityHash64(created_at)), 8192);
 
 INSERT INTO arraytest (created_at, strings) VALUES (now(), ['aaaaa', 'bbbbb', 'ccccc']);
diff --git a/tests/queries/0_stateless/00752_low_cardinality_mv_2.sql b/tests/queries/0_stateless/00752_low_cardinality_mv_2.sql
index 71950469a470..83c6b1c1a6b5 100644
--- a/tests/queries/0_stateless/00752_low_cardinality_mv_2.sql
+++ b/tests/queries/0_stateless/00752_low_cardinality_mv_2.sql
@@ -1,6 +1,7 @@
 drop table if exists radacct;
 drop table if exists mv_traffic_by_tadig15min;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE radacct ( radacctid UInt64, f3gppchargingid Nullable(String), f3gppggsnaddress Nullable(String), f3gppggsnmccmnc Nullable(String), f3gppgprsqos Nullable(String), f3gppimeisv Nullable(String), f3gppimsi Nullable(UInt64), f3gppimsimccmnc Nullable(String), f3gpploci Nullable(String), f3gppnsapi Nullable(String), f3gpprattype Nullable(String), f3gppsgsnaddress Nullable(String), f3gppsgsnmccmnc Nullable(String), acctdelaytime Nullable(UInt32), acctinputoctets Nullable(UInt64), acctinputpackets Nullable(UInt64), acctoutputoctets Nullable(UInt64), acctoutputpackets Nullable(UInt64), acctsessionid String, acctstatustype Nullable(String), acctuniqueid String, calledstationid Nullable(String), callingstationid Nullable(String), framedipaddress Nullable(String), nasidentifier Nullable(String), nasipaddress Nullable(String), acctstarttime Nullable(DateTime), acctstoptime Nullable(DateTime), acctsessiontime Nullable(UInt32), acctterminatecause Nullable(String), acctstartdelay Nullable(UInt32), acctstopdelay Nullable(UInt32), connectinfo_start Nullable(String), connectinfo_stop Nullable(String), timestamp DateTime, username Nullable(String), realm Nullable(String), f3gppimsi_int UInt64, f3gppsgsnaddress_int Nullable(UInt32), timestamp_date Date, tac Nullable(String), mnc Nullable(String), tadig LowCardinality(String), country LowCardinality(String), tadig_op_ip Nullable(String) DEFAULT CAST('TADIG NOT FOUND', 'Nullable(String)'), mcc Nullable(UInt16) MATERIALIZED toUInt16OrNull(substring(f3gppsgsnmccmnc, 1, 6))) ENGINE = MergeTree(timestamp_date, (timestamp, radacctid, acctuniqueid), 8192);
 
 insert into radacct values (1, 'a', 'b', 'c', 'd', 'e', 2, 'a', 'b', 'c', 'd', 'e', 'f', 3, 4, 5, 6, 7, 'a', 'Stop', 'c', 'd', 'e', 'f', 'g', 'h', '2018-10-10 15:54:21', '2018-10-10 15:54:21', 8, 'a', 9, 10, 'a', 'b', '2018-10-10 15:54:21', 'a', 'b', 11, 12, '2018-10-10', 'a', 'b', 'c', 'd', 'e');
diff --git a/tests/queries/0_stateless/00753_system_columns_and_system_tables_long.sql b/tests/queries/0_stateless/00753_system_columns_and_system_tables_long.sql
index a2d19c225005..e1392d299dc4 100644
--- a/tests/queries/0_stateless/00753_system_columns_and_system_tables_long.sql
+++ b/tests/queries/0_stateless/00753_system_columns_and_system_tables_long.sql
@@ -49,6 +49,7 @@ FORMAT PrettyCompactNoEscapes;
 DROP TABLE IF EXISTS check_system_tables;
 
 -- Check MergeTree declaration in old format
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE check_system_tables
   (
     Event Date,
diff --git a/tests/queries/0_stateless/00754_alter_modify_order_by.sql b/tests/queries/0_stateless/00754_alter_modify_order_by.sql
index cb81f868e7b4..234bd61902b2 100644
--- a/tests/queries/0_stateless/00754_alter_modify_order_by.sql
+++ b/tests/queries/0_stateless/00754_alter_modify_order_by.sql
@@ -2,6 +2,7 @@ SET send_logs_level = 'fatal';
 SET optimize_on_insert = 0;
 
 DROP TABLE IF EXISTS old_style;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE old_style(d Date, x UInt32) ENGINE MergeTree(d, x, 8192);
 ALTER TABLE old_style ADD COLUMN y UInt32, MODIFY ORDER BY (x, y); -- { serverError 36}
 DROP TABLE old_style;
diff --git a/tests/queries/0_stateless/00754_alter_modify_order_by_replicated_zookeeper_long.sql b/tests/queries/0_stateless/00754_alter_modify_order_by_replicated_zookeeper_long.sql
index c859c7b99212..29d0ef79b915 100644
--- a/tests/queries/0_stateless/00754_alter_modify_order_by_replicated_zookeeper_long.sql
+++ b/tests/queries/0_stateless/00754_alter_modify_order_by_replicated_zookeeper_long.sql
@@ -6,6 +6,7 @@ SET optimize_on_insert = 0;
 SET send_logs_level = 'fatal';
 
 DROP TABLE IF EXISTS old_style;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE old_style(d Date, x UInt32) ENGINE ReplicatedMergeTree('/clickhouse/tables/{database}/test_00754/old_style', 'r1', d, x, 8192);
 ALTER TABLE old_style ADD COLUMN y UInt32, MODIFY ORDER BY (x, y); -- { serverError 36 }
 DROP TABLE old_style;
diff --git a/tests/queries/0_stateless/00794_materialized_view_with_column_defaults.sql b/tests/queries/0_stateless/00794_materialized_view_with_column_defaults.sql
index a756f5c35376..43dcb322f1c3 100644
--- a/tests/queries/0_stateless/00794_materialized_view_with_column_defaults.sql
+++ b/tests/queries/0_stateless/00794_materialized_view_with_column_defaults.sql
@@ -1,6 +1,7 @@
 DROP TABLE IF EXISTS table_view;
 DROP TABLE IF EXISTS source_table;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE source_table (
   date Date,
   datetime DateTime,
diff --git a/tests/queries/0_stateless/00800_low_cardinality_distributed_insert.sql b/tests/queries/0_stateless/00800_low_cardinality_distributed_insert.sql
index 600793853ca1..7ddf1caa85fb 100644
--- a/tests/queries/0_stateless/00800_low_cardinality_distributed_insert.sql
+++ b/tests/queries/0_stateless/00800_low_cardinality_distributed_insert.sql
@@ -5,6 +5,7 @@ SET insert_distributed_sync = 1;
 DROP TABLE IF EXISTS low_cardinality;
 DROP TABLE IF EXISTS low_cardinality_all;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE low_cardinality (d Date, x UInt32, s LowCardinality(String)) ENGINE = MergeTree(d, x, 8192);
 CREATE TABLE low_cardinality_all (d Date, x UInt32, s LowCardinality(String)) ENGINE = Distributed(test_shard_localhost, currentDatabase(), low_cardinality, sipHash64(s));
 
diff --git a/tests/queries/0_stateless/00806_alter_update.sql b/tests/queries/0_stateless/00806_alter_update.sql
index c4fe3969df3a..c9b1bfb2d9d7 100644
--- a/tests/queries/0_stateless/00806_alter_update.sql
+++ b/tests/queries/0_stateless/00806_alter_update.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS alter_update_00806;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE alter_update_00806 (d Date, e Enum8('foo'=1, 'bar'=2)) Engine = MergeTree(d, (d), 8192);
 INSERT INTO alter_update_00806 (d, e) VALUES ('2018-01-01', 'foo');
 INSERT INTO alter_update_00806 (d, e) VALUES ('2018-01-02', 'bar');
diff --git a/tests/queries/0_stateless/00829_bitmap_function.sql b/tests/queries/0_stateless/00829_bitmap_function.sql
index fde0176de5b5..6a21f5caf0ff 100644
--- a/tests/queries/0_stateless/00829_bitmap_function.sql
+++ b/tests/queries/0_stateless/00829_bitmap_function.sql
@@ -71,6 +71,7 @@ SELECT bitmapToArray(bitmapAnd(groupBitmapState(uid), bitmapBuild(CAST([1, 2, 3]
 
 -- bitmap state test
 DROP TABLE IF EXISTS bitmap_state_test;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE bitmap_state_test
 (
 	pickup_date Date,
diff --git a/tests/queries/0_stateless/00834_hints_for_type_function_typos.sh b/tests/queries/0_stateless/00834_hints_for_type_function_typos.sh
index 6640e0003cdb..41a35d908d1d 100755
--- a/tests/queries/0_stateless/00834_hints_for_type_function_typos.sh
+++ b/tests/queries/0_stateless/00834_hints_for_type_function_typos.sh
@@ -26,5 +26,5 @@ $CLICKHOUSE_CLIENT -q "select * FROM numberss(10);" 2>&1 | grep "Maybe you meant
 $CLICKHOUSE_CLIENT -q "select * FROM anothernumbers(10);" 2>&1 | grep -v "Maybe you meant: \['numbers'\,'numbers_mt'\]." &>/dev/null
 $CLICKHOUSE_CLIENT -q "select * FROM mynumbers(10);" 2>&1 | grep "Maybe you meant: \['numbers'\]." &>/dev/null
 
-$CLICKHOUSE_CLIENT -q "CREATE TABLE stored_aggregates (d Date, Uniq AggregateFunction(uniq, UInt64)) ENGINE = MergeTre(d, d, 8192);" 2>&1 | grep "Maybe you meant: \['MergeTree'\]." &>/dev/null
-$CLICKHOUSE_CLIENT -q "CREATE TABLE stored_aggregates (d Date, Uniq AgregateFunction(uniq, UInt64)) ENGINE = MergeTree(d, d, 8192);" 2>&1 | grep "Maybe you meant: \['AggregateFunction'\]." &>/dev/null
+$CLICKHOUSE_CLIENT --allow_deprecated_syntax_for_merge_tree=1 -q "CREATE TABLE stored_aggregates (d Date, Uniq AggregateFunction(uniq, UInt64)) ENGINE = MergeTre(d, d, 8192);" 2>&1 | grep "Maybe you meant: \['MergeTree'\]." &>/dev/null
+$CLICKHOUSE_CLIENT --allow_deprecated_syntax_for_merge_tree=1 -q "CREATE TABLE stored_aggregates (d Date, Uniq AgregateFunction(uniq, UInt64)) ENGINE = MergeTree(d, d, 8192);" 2>&1 | grep "Maybe you meant: \['AggregateFunction'\]." &>/dev/null
diff --git a/tests/queries/0_stateless/00910_crash_when_distributed_modify_order_by.sql b/tests/queries/0_stateless/00910_crash_when_distributed_modify_order_by.sql
index 6dea97d1f277..00811d8ab89e 100644
--- a/tests/queries/0_stateless/00910_crash_when_distributed_modify_order_by.sql
+++ b/tests/queries/0_stateless/00910_crash_when_distributed_modify_order_by.sql
@@ -2,6 +2,7 @@
 
 DROP TABLE IF EXISTS union1;
 DROP TABLE IF EXISTS union2;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE union1 ( date Date, a Int32, b Int32, c Int32, d Int32) ENGINE = MergeTree(date, (a, date), 8192);
 CREATE TABLE union2 ( date Date, a Int32, b Int32, c Int32, d Int32) ENGINE = Distributed(test_shard_localhost, currentDatabase(), 'union1');
 ALTER TABLE union2 MODIFY ORDER BY a; -- { serverError 48 }
diff --git a/tests/queries/0_stateless/00925_zookeeper_empty_replicated_merge_tree_optimize_final_long.sh b/tests/queries/0_stateless/00925_zookeeper_empty_replicated_merge_tree_optimize_final_long.sh
index b07578294249..9e82cb4d30bf 100755
--- a/tests/queries/0_stateless/00925_zookeeper_empty_replicated_merge_tree_optimize_final_long.sh
+++ b/tests/queries/0_stateless/00925_zookeeper_empty_replicated_merge_tree_optimize_final_long.sh
@@ -8,8 +8,8 @@ CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
 
 $CLICKHOUSE_CLIENT -q "DROP TABLE IF EXISTS replicated_optimize1;"
 $CLICKHOUSE_CLIENT -q "DROP TABLE IF EXISTS replicated_optimize2;"
-$CLICKHOUSE_CLIENT -q "CREATE TABLE replicated_optimize1 (d Date, k UInt64, i32 Int32) ENGINE=ReplicatedMergeTree('/clickhouse/tables/$CLICKHOUSE_TEST_ZOOKEEPER_PREFIX/test_00925/optimize', 'r1', d, k, 8192);"
-$CLICKHOUSE_CLIENT -q "CREATE TABLE replicated_optimize2 (d Date, k UInt64, i32 Int32) ENGINE=ReplicatedMergeTree('/clickhouse/tables/$CLICKHOUSE_TEST_ZOOKEEPER_PREFIX/test_00925/optimize', 'r2', d, k, 8192);"
+$CLICKHOUSE_CLIENT --allow_deprecated_syntax_for_merge_tree=1 -q "CREATE TABLE replicated_optimize1 (d Date, k UInt64, i32 Int32) ENGINE=ReplicatedMergeTree('/clickhouse/tables/$CLICKHOUSE_TEST_ZOOKEEPER_PREFIX/test_00925/optimize', 'r1', d, k, 8192);"
+$CLICKHOUSE_CLIENT --allow_deprecated_syntax_for_merge_tree=1 -q "CREATE TABLE replicated_optimize2 (d Date, k UInt64, i32 Int32) ENGINE=ReplicatedMergeTree('/clickhouse/tables/$CLICKHOUSE_TEST_ZOOKEEPER_PREFIX/test_00925/optimize', 'r2', d, k, 8192);"
 
 num_tries=0
 while [[ $($CLICKHOUSE_CLIENT -q "SELECT is_leader FROM system.replicas WHERE database=currentDatabase() AND table='replicated_optimize1'") -ne 1 ]]; do
diff --git a/tests/queries/0_stateless/00952_insert_into_distributed_with_materialized_column.sql b/tests/queries/0_stateless/00952_insert_into_distributed_with_materialized_column.sql
index 3a9a9154abe3..05382b855b19 100644
--- a/tests/queries/0_stateless/00952_insert_into_distributed_with_materialized_column.sql
+++ b/tests/queries/0_stateless/00952_insert_into_distributed_with_materialized_column.sql
@@ -15,6 +15,7 @@ SET insert_allow_materialized_columns=0;
 SELECT 'insert_distributed_sync=0';
 SET insert_distributed_sync=0;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE local_00952 (date Date, value Date MATERIALIZED toDate('2017-08-01')) ENGINE = MergeTree(date, date, 8192);
 CREATE TABLE distributed_00952 AS local_00952 ENGINE = Distributed('test_cluster_two_shards', currentDatabase(), local_00952, rand());
 
diff --git a/tests/queries/0_stateless/00974_final_predicate_push_down.sql b/tests/queries/0_stateless/00974_final_predicate_push_down.sql
index 96bcbf9aae66..7a6378692f28 100644
--- a/tests/queries/0_stateless/00974_final_predicate_push_down.sql
+++ b/tests/queries/0_stateless/00974_final_predicate_push_down.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS test_00974;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE test_00974
 (
     date Date,
diff --git a/tests/queries/0_stateless/00981_in_subquery_with_tuple.sh b/tests/queries/0_stateless/00981_in_subquery_with_tuple.sh
index 99173062595f..a899886e4637 100755
--- a/tests/queries/0_stateless/00981_in_subquery_with_tuple.sh
+++ b/tests/queries/0_stateless/00981_in_subquery_with_tuple.sh
@@ -5,7 +5,7 @@ CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
 . "$CURDIR"/../shell_config.sh
 
 $CLICKHOUSE_CLIENT --query="DROP TABLE IF EXISTS bug";
-$CLICKHOUSE_CLIENT --query="CREATE TABLE bug (d Date, s String) ENGINE = MergeTree(d, s, 8192)";
+$CLICKHOUSE_CLIENT --allow_deprecated_syntax_for_merge_tree=1 --query="CREATE TABLE bug (d Date, s String) ENGINE = MergeTree(d, s, 8192)";
 $CLICKHOUSE_CLIENT --query="INSERT INTO bug VALUES ('2019-08-09', 'hello'), ('2019-08-10', 'world'), ('2019-08-11', 'world'), ('2019-08-12', 'hello')";
 
 #SET force_primary_key = 1;
diff --git a/tests/queries/0_stateless/01008_materialized_view_henyihanwobushi.sql b/tests/queries/0_stateless/01008_materialized_view_henyihanwobushi.sql
index 8def546cd2ec..1e91f6daf65e 100644
--- a/tests/queries/0_stateless/01008_materialized_view_henyihanwobushi.sql
+++ b/tests/queries/0_stateless/01008_materialized_view_henyihanwobushi.sql
@@ -2,6 +2,7 @@ DROP TABLE IF EXISTS foo;
 DROP TABLE IF EXISTS bar;
 DROP TABLE IF EXISTS view_foo_bar;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 create table foo (ddate Date, id Int64, n String) ENGINE = ReplacingMergeTree(ddate, (id), 8192);
 create table bar (ddate Date, id Int64, n String, foo_id Int64) ENGINE = ReplacingMergeTree(ddate, (id), 8192);
 insert into bar (id, n, foo_id) values (1, 'bar_n_1', 1);
diff --git a/tests/queries/0_stateless/01047_window_view_parser_inner_table.sql b/tests/queries/0_stateless/01047_window_view_parser_inner_table.sql
index 8b978e6094c6..2d9911287a3a 100644
--- a/tests/queries/0_stateless/01047_window_view_parser_inner_table.sql
+++ b/tests/queries/0_stateless/01047_window_view_parser_inner_table.sql
@@ -2,6 +2,7 @@
 
 SET allow_experimental_window_view = 1;
 DROP DATABASE IF EXISTS test_01047;
+set allow_deprecated_database_ordinary=1;
 CREATE DATABASE test_01047 ENGINE=Ordinary;
 
 DROP TABLE IF EXISTS test_01047.mt;
diff --git a/tests/queries/0_stateless/01048_window_view_parser.sql b/tests/queries/0_stateless/01048_window_view_parser.sql
index 95190ddafa11..4c329f99f6ee 100644
--- a/tests/queries/0_stateless/01048_window_view_parser.sql
+++ b/tests/queries/0_stateless/01048_window_view_parser.sql
@@ -2,6 +2,7 @@
 
 SET allow_experimental_window_view = 1;
 DROP DATABASE IF EXISTS test_01048;
+set allow_deprecated_database_ordinary=1;
 CREATE DATABASE test_01048 ENGINE=Ordinary;
 
 DROP TABLE IF EXISTS test_01048.mt;
diff --git a/tests/queries/0_stateless/01053_drop_database_mat_view.sql b/tests/queries/0_stateless/01053_drop_database_mat_view.sql
index 67a488f7245e..7651ac4885cb 100644
--- a/tests/queries/0_stateless/01053_drop_database_mat_view.sql
+++ b/tests/queries/0_stateless/01053_drop_database_mat_view.sql
@@ -1,8 +1,10 @@
 -- Tags: no-parallel
 
 DROP DATABASE IF EXISTS some_tests;
+set allow_deprecated_database_ordinary=1;
 CREATE DATABASE some_tests ENGINE=Ordinary; -- Different inner table name with Atomic
 
+set allow_deprecated_syntax_for_merge_tree=1;
 create table some_tests.my_table ENGINE = MergeTree(day, (day), 8192) as select today() as day, 'mystring' as str;
 show tables from some_tests;
 create materialized view some_tests.my_materialized_view ENGINE = MergeTree(day, (day), 8192) as select * from some_tests.my_table;
diff --git a/tests/queries/0_stateless/01053_ssd_dictionary.sh b/tests/queries/0_stateless/01053_ssd_dictionary.sh
index dc5002eaf173..cf1a55b29420 100755
--- a/tests/queries/0_stateless/01053_ssd_dictionary.sh
+++ b/tests/queries/0_stateless/01053_ssd_dictionary.sh
@@ -8,7 +8,7 @@ CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
 
 USER_FILES_PATH=$(clickhouse-client --query "select _path,_file from file('nonexist.txt', 'CSV', 'val1 char')" 2>&1 | grep Exception | awk '{gsub("/nonexist.txt","",$9); print $9}')
 
-$CLICKHOUSE_CLIENT -n --query="
+$CLICKHOUSE_CLIENT --allow_deprecated_database_ordinary=1 -n --query="
   DROP DATABASE IF EXISTS 01053_db;
 
   CREATE DATABASE 01053_db Engine = Ordinary;
diff --git a/tests/queries/0_stateless/01062_alter_on_mutataion_zookeeper_long.sql b/tests/queries/0_stateless/01062_alter_on_mutataion_zookeeper_long.sql
index aba84f43033a..3777ebb1af37 100644
--- a/tests/queries/0_stateless/01062_alter_on_mutataion_zookeeper_long.sql
+++ b/tests/queries/0_stateless/01062_alter_on_mutataion_zookeeper_long.sql
@@ -61,6 +61,7 @@ DROP TABLE IF EXISTS test_alter_on_mutation;
 
 DROP TABLE IF EXISTS nested_alter;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE nested_alter (`d` Date, `k` UInt64, `i32` Int32, `dt` DateTime, `n.ui8` Array(UInt8), `n.s` Array(String), `n.d` Array(Date), `s` String DEFAULT '0') ENGINE = ReplicatedMergeTree('/clickhouse/tables/{database}/test_01062/nested_alter', 'r2', d, k, 8192);
 
 INSERT INTO nested_alter VALUES ('2015-01-01', 6,38,'2014-07-15 13:26:50',[10,20,30],['asd','qwe','qwe'],['2000-01-01','2000-01-01','2000-01-03'],'100500');
diff --git a/tests/queries/0_stateless/01071_prohibition_secondary_index_with_old_format_merge_tree.sql b/tests/queries/0_stateless/01071_prohibition_secondary_index_with_old_format_merge_tree.sql
index bbb607fe89f9..992973c97e8c 100644
--- a/tests/queries/0_stateless/01071_prohibition_secondary_index_with_old_format_merge_tree.sql
+++ b/tests/queries/0_stateless/01071_prohibition_secondary_index_with_old_format_merge_tree.sql
@@ -1,5 +1,6 @@
 -- Tags: no-parallel
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE old_syntax_01071_test (date Date, id UInt8) ENGINE = MergeTree(date, id, 8192);
 ALTER TABLE old_syntax_01071_test ADD INDEX  id_minmax id TYPE minmax GRANULARITY 1; -- { serverError 36 }
 CREATE TABLE new_syntax_01071_test (date Date, id UInt8) ENGINE = MergeTree() ORDER BY id;
diff --git a/tests/queries/0_stateless/01076_predicate_optimizer_with_view.sql b/tests/queries/0_stateless/01076_predicate_optimizer_with_view.sql
index d652cbeea5dd..cfa25179d057 100644
--- a/tests/queries/0_stateless/01076_predicate_optimizer_with_view.sql
+++ b/tests/queries/0_stateless/01076_predicate_optimizer_with_view.sql
@@ -1,6 +1,7 @@
 DROP TABLE IF EXISTS test;
 DROP TABLE IF EXISTS test_view;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE test(date Date, id Int8, name String, value Int64) ENGINE = MergeTree(date, (id, date), 8192);
 CREATE VIEW test_view AS SELECT * FROM test;
 
diff --git a/tests/queries/0_stateless/01085_window_view_attach.sql b/tests/queries/0_stateless/01085_window_view_attach.sql
index 604bf5dd1989..bb47e0dc6b99 100644
--- a/tests/queries/0_stateless/01085_window_view_attach.sql
+++ b/tests/queries/0_stateless/01085_window_view_attach.sql
@@ -3,6 +3,7 @@
 SET allow_experimental_window_view = 1;
 
 DROP DATABASE IF EXISTS test_01085;
+set allow_deprecated_database_ordinary=1;
 CREATE DATABASE test_01085 ENGINE=Ordinary;
 
 DROP TABLE IF EXISTS test_01085.mt;
diff --git a/tests/queries/0_stateless/01086_window_view_cleanup.sh b/tests/queries/0_stateless/01086_window_view_cleanup.sh
index a7b976bf4e02..c85455616e1c 100755
--- a/tests/queries/0_stateless/01086_window_view_cleanup.sh
+++ b/tests/queries/0_stateless/01086_window_view_cleanup.sh
@@ -5,7 +5,7 @@ CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
 # shellcheck source=../shell_config.sh
 . "$CURDIR"/../shell_config.sh
 
-$CLICKHOUSE_CLIENT --multiquery <<EOF
+$CLICKHOUSE_CLIENT --allow_deprecated_database_ordinary=1 --multiquery <<EOF
 SET allow_experimental_window_view = 1;
 SET window_view_clean_interval = 1;
 
diff --git a/tests/queries/0_stateless/01089_alter_settings_old_format.sql b/tests/queries/0_stateless/01089_alter_settings_old_format.sql
index 15d3ac508cbb..7e7674f4d438 100644
--- a/tests/queries/0_stateless/01089_alter_settings_old_format.sql
+++ b/tests/queries/0_stateless/01089_alter_settings_old_format.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS old_format_mt;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE old_format_mt (
   event_date Date,
   key UInt64,
diff --git a/tests/queries/0_stateless/01101_prewhere_after_alter.sql b/tests/queries/0_stateless/01101_prewhere_after_alter.sql
index 11ebac7448df..976eb586a9a9 100644
--- a/tests/queries/0_stateless/01101_prewhere_after_alter.sql
+++ b/tests/queries/0_stateless/01101_prewhere_after_alter.sql
@@ -1,6 +1,7 @@
 DROP TABLE IF EXISTS test_a;
 DROP TABLE IF EXISTS test_b;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE test_a
 (
     OldColumn String DEFAULT '',
diff --git a/tests/queries/0_stateless/01109_exchange_tables.sql b/tests/queries/0_stateless/01109_exchange_tables.sql
index 09edf4a1de4f..c118945887be 100644
--- a/tests/queries/0_stateless/01109_exchange_tables.sql
+++ b/tests/queries/0_stateless/01109_exchange_tables.sql
@@ -29,10 +29,9 @@ SELECT * FROM t2;
 
 DROP DATABASE IF EXISTS test_01109_other_atomic;
 DROP DATABASE IF EXISTS test_01109_ordinary;
-SET default_database_engine='Atomic';
 CREATE DATABASE test_01109_other_atomic;
-SET default_database_engine='Ordinary';
-CREATE DATABASE test_01109_ordinary;
+set allow_deprecated_database_ordinary=1;
+CREATE DATABASE test_01109_ordinary ENGINE=Ordinary;
 
 CREATE TABLE test_01109_other_atomic.t3 ENGINE=MergeTree() ORDER BY tuple()
     AS SELECT rowNumberInAllBlocks() + (SELECT max((*,*).1.1) + 1 FROM (SELECT (*,) FROM t1 UNION ALL SELECT (*,) FROM t2)), *
diff --git a/tests/queries/0_stateless/01114_database_atomic.sh b/tests/queries/0_stateless/01114_database_atomic.sh
index b21f88ea2156..e31841b27a0c 100755
--- a/tests/queries/0_stateless/01114_database_atomic.sh
+++ b/tests/queries/0_stateless/01114_database_atomic.sh
@@ -14,8 +14,8 @@ DROP DATABASE IF EXISTS test_01114_3;
 "
 
 $CLICKHOUSE_CLIENT -q "CREATE DATABASE test_01114_1 ENGINE=Atomic"
-$CLICKHOUSE_CLIENT --default_database_engine=Atomic -q "CREATE DATABASE test_01114_2"
-$CLICKHOUSE_CLIENT --default_database_engine=Ordinary -q "CREATE DATABASE test_01114_3"
+$CLICKHOUSE_CLIENT -q "CREATE DATABASE test_01114_2"
+$CLICKHOUSE_CLIENT --allow_deprecated_database_ordinary=1 -q "CREATE DATABASE test_01114_3 ENGINE=Ordinary"
 
 $CLICKHOUSE_CLIENT --show_table_uuid_in_table_create_query_if_not_nil=0 -q "SHOW CREATE DATABASE test_01114_1"
 $CLICKHOUSE_CLIENT --show_table_uuid_in_table_create_query_if_not_nil=0 -q "SHOW CREATE DATABASE test_01114_2"
diff --git a/tests/queries/0_stateless/01125_generate_random_qoega.sql b/tests/queries/0_stateless/01125_generate_random_qoega.sql
index 7fb586ad2b5e..9088e411a80d 100644
--- a/tests/queries/0_stateless/01125_generate_random_qoega.sql
+++ b/tests/queries/0_stateless/01125_generate_random_qoega.sql
@@ -1,4 +1,5 @@
 DROP TABLE IF EXISTS mass_table_117;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE mass_table_117 (`dt` Date, `site_id` Int32, `site_key` String) ENGINE = MergeTree(dt, (site_id, site_key, dt), 8192);
 INSERT INTO mass_table_117 SELECT * FROM generateRandom('`dt` Date,`site_id` Int32,`site_key` String', 1, 10, 2) LIMIT 100;
 SELECT count(), sum(cityHash64(*)) FROM mass_table_117;
diff --git a/tests/queries/0_stateless/01126_month_partitioning_consistent_code.sql b/tests/queries/0_stateless/01126_month_partitioning_consistent_code.sql
index c9bfbbe5111b..f5f04178d5eb 100644
--- a/tests/queries/0_stateless/01126_month_partitioning_consistent_code.sql
+++ b/tests/queries/0_stateless/01126_month_partitioning_consistent_code.sql
@@ -1,4 +1,5 @@
 DROP TABLE IF EXISTS mt;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE mt (d Date, x UInt8) ENGINE = MergeTree(d, x, 8192);
 INSERT INTO mt VALUES (52392, 1), (62677, 2);
 DROP TABLE mt;
diff --git a/tests/queries/0_stateless/01127_month_partitioning_consistency_select.sql b/tests/queries/0_stateless/01127_month_partitioning_consistency_select.sql
index eb5ea091ca3b..2a1d04e60740 100644
--- a/tests/queries/0_stateless/01127_month_partitioning_consistency_select.sql
+++ b/tests/queries/0_stateless/01127_month_partitioning_consistency_select.sql
@@ -1,6 +1,7 @@
 -- Tags: no-parallel
 
 DROP TABLE IF EXISTS mt;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE mt (d Date, x String) ENGINE = MergeTree(d, x, 8192);
 INSERT INTO mt VALUES ('2106-02-07', 'Hello'), ('1970-01-01', 'World');
 
diff --git a/tests/queries/0_stateless/01128_generate_random_nested.sql b/tests/queries/0_stateless/01128_generate_random_nested.sql
index 2af52e69893e..8098db894915 100644
--- a/tests/queries/0_stateless/01128_generate_random_nested.sql
+++ b/tests/queries/0_stateless/01128_generate_random_nested.sql
@@ -1,4 +1,6 @@
 DROP TABLE IF EXISTS mass_table_312;
+
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE mass_table_312 (d Date DEFAULT '2000-01-01', x UInt64, n Nested(a String, b String)) ENGINE = MergeTree(d, x, 1);
 INSERT INTO mass_table_312 SELECT * FROM generateRandom('`d` Date,`x` UInt64,`n.a` Array(String),`n.b` Array(String)', 1, 10, 2) LIMIT 100;
 
diff --git a/tests/queries/0_stateless/01148_zookeeper_path_macros_unfolding.sql b/tests/queries/0_stateless/01148_zookeeper_path_macros_unfolding.sql
index 16d3dc741138..7234cee96e0e 100644
--- a/tests/queries/0_stateless/01148_zookeeper_path_macros_unfolding.sql
+++ b/tests/queries/0_stateless/01148_zookeeper_path_macros_unfolding.sql
@@ -31,6 +31,7 @@ RENAME TABLE test_01148_atomic.rmt4 to test_01148_atomic.rmt3;
 SHOW CREATE TABLE test_01148_atomic.rmt3;
 
 DROP DATABASE IF EXISTS test_01148_ordinary;
+set allow_deprecated_database_ordinary=1;
 CREATE DATABASE test_01148_ordinary ENGINE=Ordinary;
 RENAME TABLE test_01148_atomic.rmt3 to test_01148_ordinary.rmt3; -- { serverError 48 }
 DROP DATABASE test_01148_ordinary;
diff --git a/tests/queries/0_stateless/01155_rename_move_materialized_view.sql b/tests/queries/0_stateless/01155_rename_move_materialized_view.sql
index e0546ec8117f..b3234e03a8f6 100644
--- a/tests/queries/0_stateless/01155_rename_move_materialized_view.sql
+++ b/tests/queries/0_stateless/01155_rename_move_materialized_view.sql
@@ -5,6 +5,7 @@ SET prefer_localhost_replica = 1;
 DROP DATABASE IF EXISTS test_01155_ordinary;
 DROP DATABASE IF EXISTS test_01155_atomic;
 
+set allow_deprecated_database_ordinary=1;
 CREATE DATABASE test_01155_ordinary ENGINE=Ordinary;
 CREATE DATABASE test_01155_atomic ENGINE=Atomic;
 
@@ -66,6 +67,7 @@ SELECT database, substr(name, 1, 10) FROM system.tables WHERE database like 'tes
 -- Move tables back
 RENAME DATABASE test_01155_ordinary TO test_01155_atomic;
 
+set allow_deprecated_database_ordinary=1;
 CREATE DATABASE test_01155_ordinary ENGINE=Ordinary;
 SHOW CREATE DATABASE test_01155_atomic;
 
diff --git a/tests/queries/0_stateless/01162_strange_mutations.sh b/tests/queries/0_stateless/01162_strange_mutations.sh
index e480a653b74c..eea9ea5f7e5d 100755
--- a/tests/queries/0_stateless/01162_strange_mutations.sh
+++ b/tests/queries/0_stateless/01162_strange_mutations.sh
@@ -28,15 +28,15 @@ do
     $CLICKHOUSE_CLIENT -q "CREATE TABLE test ENGINE=$engine AS SELECT number + 100 AS n, 0 AS test FROM numbers(50)" 2>&1| grep -Ev "Removing leftovers from table|removed by another replica"
     $CLICKHOUSE_CLIENT -q "select count(), sum(n), sum(test) from test"
     if [[ $engine == *"ReplicatedMergeTree"* ]]; then
-        $CLICKHOUSE_CLIENT --enable_positional_arguments 0 -q "ALTER TABLE test
-            UPDATE test = (SELECT groupArray(id) FROM t1)[n - 99] WHERE 1" 2>&1| grep -Fa "DB::Exception: " | grep -Fv "statement with subquery may be nondeterministic"
-        $CLICKHOUSE_CLIENT --enable_positional_arguments 0 --allow_nondeterministic_mutations=1 --mutations_sync=1 -q "ALTER TABLE test
+        $CLICKHOUSE_CLIENT -q "ALTER TABLE test
+            UPDATE test = (SELECT groupArray(id) FROM t1 GROUP BY 'dummy')[n - 99] WHERE 1" 2>&1| grep -Fa "DB::Exception: " | grep -Fv "statement with subquery may be nondeterministic"
+        $CLICKHOUSE_CLIENT --allow_nondeterministic_mutations=1 --mutations_sync=1 -q "ALTER TABLE test
                     UPDATE test = (SELECT groupArray(id) FROM t1)[n - 99] WHERE 1"
     elif [[ $engine == *"Join"* ]]; then
-        $CLICKHOUSE_CLIENT --enable_positional_arguments 0 -q "ALTER TABLE test
+        $CLICKHOUSE_CLIENT -q "ALTER TABLE test
             UPDATE test = (SELECT groupArray(id) FROM t1)[n - 99] WHERE 1" 2>&1| grep -Fa "DB::Exception: " | grep -Fv "Table engine Join supports only DELETE mutations"
     else
-        $CLICKHOUSE_CLIENT --enable_positional_arguments 0 --mutations_sync=1 -q "ALTER TABLE test
+        $CLICKHOUSE_CLIENT --mutations_sync=1 -q "ALTER TABLE test
             UPDATE test = (SELECT groupArray(id) FROM t1)[n - 99] WHERE 1"
     fi
     $CLICKHOUSE_CLIENT -q "select count(), sum(n), sum(test) from test"
diff --git a/tests/queries/0_stateless/01190_full_attach_syntax.sql b/tests/queries/0_stateless/01190_full_attach_syntax.sql
index ed05950ff983..e66978e22e1d 100644
--- a/tests/queries/0_stateless/01190_full_attach_syntax.sql
+++ b/tests/queries/0_stateless/01190_full_attach_syntax.sql
@@ -1,6 +1,8 @@
 -- Tags: no-parallel
 
 DROP DATABASE IF EXISTS test_01190;
+set allow_deprecated_database_ordinary=1;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE DATABASE test_01190 ENGINE=Ordinary;     -- Full ATTACH requires UUID with Atomic
 USE test_01190;
 
diff --git a/tests/queries/0_stateless/01192_rename_database_zookeeper.sh b/tests/queries/0_stateless/01192_rename_database_zookeeper.sh
index c6686bde6723..641e26870d4d 100755
--- a/tests/queries/0_stateless/01192_rename_database_zookeeper.sh
+++ b/tests/queries/0_stateless/01192_rename_database_zookeeper.sh
@@ -11,8 +11,8 @@ $CLICKHOUSE_CLIENT --check_table_dependencies=0 -q "DROP DATABASE IF EXISTS test
 $CLICKHOUSE_CLIENT --check_table_dependencies=0 -q "DROP DATABASE IF EXISTS test_01192_renamed"
 $CLICKHOUSE_CLIENT --check_table_dependencies=0 -q "DROP DATABASE IF EXISTS test_01192_atomic"
 
-$CLICKHOUSE_CLIENT --default_database_engine=Ordinary -q "CREATE DATABASE test_01192 UUID '00001192-0000-4000-8000-000000000001'" 2>&1| grep -F "does not support" > /dev/null && echo "ok"
-$CLICKHOUSE_CLIENT --default_database_engine=Atomic -q "CREATE DATABASE test_01192 UUID '00001192-0000-4000-8000-000000000001'"
+$CLICKHOUSE_CLIENT --allow_deprecated_database_ordinary=1 -q "CREATE DATABASE test_01192 UUID '00001192-0000-4000-8000-000000000001' ENGINE=Ordinary" 2>&1| grep -F "does not support" > /dev/null && echo "ok"
+$CLICKHOUSE_CLIENT -q "CREATE DATABASE test_01192 UUID '00001192-0000-4000-8000-000000000001'"
 
 # 2. check metadata
 $CLICKHOUSE_CLIENT --show_table_uuid_in_table_create_query_if_not_nil=1 -q "SHOW CREATE DATABASE test_01192"
@@ -35,14 +35,14 @@ $CLICKHOUSE_CLIENT -q "SHOW CREATE DATABASE test_01192_renamed"
 $CLICKHOUSE_CLIENT -q "SELECT count(n), sum(n) FROM test_01192_renamed.mt"
 
 # 5. check moving tables from Ordinary to Atomic (can be used to "alter" database engine)
-$CLICKHOUSE_CLIENT --default_database_engine=Ordinary -q "CREATE DATABASE test_01192"
+$CLICKHOUSE_CLIENT --allow_deprecated_database_ordinary=1 -q "CREATE DATABASE test_01192 ENGINE=Ordinary"
 $CLICKHOUSE_CLIENT -q "CREATE TABLE test_01192.mt AS test_01192_renamed.mt ENGINE=MergeTree ORDER BY n"
 $CLICKHOUSE_CLIENT -q "CREATE TABLE test_01192.rmt AS test_01192_renamed.mt ENGINE=ReplicatedMergeTree('/test/$CLICKHOUSE_TEST_ZOOKEEPER_PREFIX/', '1') ORDER BY n"
 $CLICKHOUSE_CLIENT -q "CREATE MATERIALIZED VIEW test_01192.mv TO test_01192.rmt AS SELECT * FROM test_01192.mt"
 
 $CLICKHOUSE_CLIENT -q "INSERT INTO test_01192.mt SELECT number FROM numbers(10)" && echo "inserted"
 
-$CLICKHOUSE_CLIENT --default_database_engine=Atomic -q "CREATE DATABASE test_01192_atomic"
+$CLICKHOUSE_CLIENT -q "CREATE DATABASE test_01192_atomic"
 $CLICKHOUSE_CLIENT -q "DROP DATABASE test_01192_renamed"
 # it's blocking
 $CLICKHOUSE_CLIENT -q "RENAME TABLE test_01192.mt TO test_01192_atomic.mt, test_01192.rmt TO test_01192_atomic.rmt, test_01192.mv TO test_01192_atomic.mv" && echo "renamed"
diff --git a/tests/queries/0_stateless/01224_no_superfluous_dict_reload.sql b/tests/queries/0_stateless/01224_no_superfluous_dict_reload.sql
index 6f5deb91ee46..5db92e706509 100644
--- a/tests/queries/0_stateless/01224_no_superfluous_dict_reload.sql
+++ b/tests/queries/0_stateless/01224_no_superfluous_dict_reload.sql
@@ -2,6 +2,7 @@
 
 DROP DATABASE IF EXISTS dict_db_01224;
 DROP DATABASE IF EXISTS dict_db_01224_dictionary;
+set allow_deprecated_database_ordinary=1;
 CREATE DATABASE dict_db_01224 ENGINE=Ordinary;  -- Different internal dictionary name with Atomic
 CREATE DATABASE dict_db_01224_dictionary Engine=Dictionary;
 
diff --git a/tests/queries/0_stateless/01225_show_create_table_from_dictionary.sql b/tests/queries/0_stateless/01225_show_create_table_from_dictionary.sql
index 006ff952ee9a..09cde642ed22 100644
--- a/tests/queries/0_stateless/01225_show_create_table_from_dictionary.sql
+++ b/tests/queries/0_stateless/01225_show_create_table_from_dictionary.sql
@@ -2,6 +2,7 @@
 
 DROP DATABASE IF EXISTS dict_db_01225;
 DROP DATABASE IF EXISTS dict_db_01225_dictionary;
+set allow_deprecated_database_ordinary=1;
 CREATE DATABASE dict_db_01225 ENGINE=Ordinary;    -- Different internal dictionary name with Atomic
 CREATE DATABASE dict_db_01225_dictionary Engine=Dictionary;
 
diff --git a/tests/queries/0_stateless/01233_check_table_with_metadata_cache.sh b/tests/queries/0_stateless/01233_check_table_with_metadata_cache.sh
index 68b62b623515..8736bc474b15 100755
--- a/tests/queries/0_stateless/01233_check_table_with_metadata_cache.sh
+++ b/tests/queries/0_stateless/01233_check_table_with_metadata_cache.sh
@@ -24,7 +24,7 @@ for table_engine in "${table_engines[@]}"; do
 
                     ${CLICKHOUSE_CLIENT} --query "DROP TABLE IF EXISTS test_metadata_cache.check_part_metadata_cache SYNC;"
                     ${CLICKHOUSE_CLIENT} --query "DROP DATABASE IF EXISTS test_metadata_cache;"
-                    ${CLICKHOUSE_CLIENT} --query "CREATE DATABASE test_metadata_cache ENGINE = ${database_engine};"
+                    ${CLICKHOUSE_CLIENT} --allow_deprecated_database_ordinary=1 --query "CREATE DATABASE test_metadata_cache ENGINE = ${database_engine};"
 
                     table_engine_clause=""
                     if [[ "$table_engine" == "ReplicatedMergeTree" ]]; then
diff --git a/tests/queries/0_stateless/01249_bad_arguments_for_bloom_filter.sql b/tests/queries/0_stateless/01249_bad_arguments_for_bloom_filter.sql
index c2be4d04e5f2..d187a2e4d4ec 100644
--- a/tests/queries/0_stateless/01249_bad_arguments_for_bloom_filter.sql
+++ b/tests/queries/0_stateless/01249_bad_arguments_for_bloom_filter.sql
@@ -1,6 +1,7 @@
 -- Tags: no-parallel
 
 DROP DATABASE IF EXISTS test_01249;
+set allow_deprecated_database_ordinary=1;
 CREATE DATABASE test_01249 ENGINE=Ordinary;     -- Full ATTACH requires UUID with Atomic
 USE test_01249;
 
diff --git a/tests/queries/0_stateless/01253_subquery_in_aggregate_function_JustStranger.sql b/tests/queries/0_stateless/01253_subquery_in_aggregate_function_JustStranger.sql
index 9659db7973dd..97b0182f06f3 100644
--- a/tests/queries/0_stateless/01253_subquery_in_aggregate_function_JustStranger.sql
+++ b/tests/queries/0_stateless/01253_subquery_in_aggregate_function_JustStranger.sql
@@ -1,6 +1,7 @@
 DROP TABLE IF EXISTS test_table;
 DROP TABLE IF EXISTS test_table_sharded;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 create table
   test_table_sharded(
     date Date,
diff --git a/tests/queries/0_stateless/01280_ssd_complex_key_dictionary.sh b/tests/queries/0_stateless/01280_ssd_complex_key_dictionary.sh
index 0de8b3a1a25f..28e8e8386cf2 100755
--- a/tests/queries/0_stateless/01280_ssd_complex_key_dictionary.sh
+++ b/tests/queries/0_stateless/01280_ssd_complex_key_dictionary.sh
@@ -8,6 +8,7 @@ CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
 USER_FILES_PATH=$(clickhouse-client --query "select _path,_file from file('nonexist.txt', 'CSV', 'val1 char')" 2>&1 | grep Exception | awk '{gsub("/nonexist.txt","",$9); print $9}')
 
 $CLICKHOUSE_CLIENT -n --query="
+    set allow_deprecated_database_ordinary=1;
     DROP DATABASE IF EXISTS 01280_db;
     CREATE DATABASE 01280_db Engine = Ordinary;
     DROP TABLE IF EXISTS 01280_db.table_for_dict;
diff --git a/tests/queries/0_stateless/01297_alter_distributed.sql b/tests/queries/0_stateless/01297_alter_distributed.sql
index cec64278d478..c79d98b7b3bf 100644
--- a/tests/queries/0_stateless/01297_alter_distributed.sql
+++ b/tests/queries/0_stateless/01297_alter_distributed.sql
@@ -3,6 +3,7 @@
 drop table if exists merge_distributed;
 drop table if exists merge_distributed1;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 create table merge_distributed1 ( CounterID UInt32,  StartDate Date,  Sign Int8,  VisitID UInt64,  UserID UInt64,  StartTime DateTime,   ClickLogID UInt64) ENGINE = CollapsingMergeTree(StartDate, intHash32(UserID), tuple(CounterID, StartDate, intHash32(UserID), VisitID, ClickLogID), 8192, Sign);
 insert into merge_distributed1 values (1, '2013-09-19', 1, 0, 2, '2013-09-19 12:43:06', 3);
 
diff --git a/tests/queries/0_stateless/01298_alter_merge.sql b/tests/queries/0_stateless/01298_alter_merge.sql
index 86c89c38c8ce..24547086e0b6 100644
--- a/tests/queries/0_stateless/01298_alter_merge.sql
+++ b/tests/queries/0_stateless/01298_alter_merge.sql
@@ -2,6 +2,7 @@ drop table if exists merge;
 drop table if exists merge1;
 drop table if exists merge2;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 create table merge1 ( CounterID UInt32,  StartDate Date,  Sign Int8,  VisitID UInt64,  UserID UInt64,  StartTime DateTime,   ClickLogID UInt64) ENGINE = CollapsingMergeTree(StartDate, intHash32(UserID), tuple(CounterID, StartDate, intHash32(UserID), VisitID, ClickLogID), 8192, Sign);
 insert into merge1 values (1, '2013-09-19', 1, 0, 2, '2013-09-19 12:43:06', 3);
 
diff --git a/tests/queries/0_stateless/01299_alter_merge_tree.sql b/tests/queries/0_stateless/01299_alter_merge_tree.sql
index 87608e6d15a8..3c4467926f85 100644
--- a/tests/queries/0_stateless/01299_alter_merge_tree.sql
+++ b/tests/queries/0_stateless/01299_alter_merge_tree.sql
@@ -1,5 +1,6 @@
 drop table if exists merge_tree;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 create table merge_tree ( CounterID UInt32,  StartDate Date,  Sign Int8,  VisitID UInt64,  UserID UInt64,  StartTime DateTime,   ClickLogID UInt64) ENGINE = CollapsingMergeTree(StartDate, intHash32(UserID), tuple(CounterID, StartDate, intHash32(UserID), VisitID, ClickLogID), 8192, Sign);
 
 insert into merge_tree values (1, '2013-09-19', 1, 0, 2, '2013-09-19 12:43:06', 3)
diff --git a/tests/queries/0_stateless/01320_create_sync_race_condition_zookeeper.sh b/tests/queries/0_stateless/01320_create_sync_race_condition_zookeeper.sh
index 758ec4825e0d..ef45e8e63bc6 100755
--- a/tests/queries/0_stateless/01320_create_sync_race_condition_zookeeper.sh
+++ b/tests/queries/0_stateless/01320_create_sync_race_condition_zookeeper.sh
@@ -8,7 +8,7 @@ CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
 set -e
 
 $CLICKHOUSE_CLIENT --query "DROP DATABASE IF EXISTS test_01320"
-$CLICKHOUSE_CLIENT --query "CREATE DATABASE test_01320 ENGINE=Ordinary"   # Different bahaviour of DROP with Atomic
+$CLICKHOUSE_CLIENT --allow_deprecated_database_ordinary=1 --query "CREATE DATABASE test_01320 ENGINE=Ordinary"   # Different bahaviour of DROP with Atomic
 
 function thread1()
 {
diff --git a/tests/queries/0_stateless/01355_alter_column_with_order.sql b/tests/queries/0_stateless/01355_alter_column_with_order.sql
index c0c85e389ea8..0b1b4c42ccee 100644
--- a/tests/queries/0_stateless/01355_alter_column_with_order.sql
+++ b/tests/queries/0_stateless/01355_alter_column_with_order.sql
@@ -2,6 +2,7 @@
 
 DROP TABLE IF EXISTS alter_test;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE alter_test (CounterID UInt32, StartDate Date, UserID UInt32, VisitID UInt32, NestedColumn Nested(A UInt8, S String), ToDrop UInt32) ENGINE = MergeTree(StartDate, intHash32(UserID), (CounterID, StartDate, intHash32(UserID), VisitID), 8192);
 
 ALTER TABLE alter_test ADD COLUMN Added1 UInt32 FIRST;
diff --git a/tests/queries/0_stateless/01387_clear_column_default_depends.sql b/tests/queries/0_stateless/01387_clear_column_default_depends.sql
index 21a41f09df6c..733daafa91c8 100644
--- a/tests/queries/0_stateless/01387_clear_column_default_depends.sql
+++ b/tests/queries/0_stateless/01387_clear_column_default_depends.sql
@@ -31,6 +31,7 @@ DROP TABLE test;
 
 -- The original report from Mikhail Petrov
 DROP TABLE IF EXISTS Test;
+set allow_deprecated_syntax_for_merge_tree=1;
 create table Test (impression_id String,impression_id_compressed FixedString(16) DEFAULT UUIDStringToNum(substring(impression_id, 1, 36)), impression_id_hashed UInt16 DEFAULT reinterpretAsUInt16(impression_id_compressed), event_date Date ) ENGINE = MergeTree(event_date, impression_id_hashed, (event_date, impression_id_hashed), 8192);
 alter table Test clear column impression_id in partition '202001';
 DROP TABLE Test;
diff --git a/tests/queries/0_stateless/01417_freeze_partition_verbose.sh b/tests/queries/0_stateless/01417_freeze_partition_verbose.sh
index 1f67100a4b67..12f104b53379 100755
--- a/tests/queries/0_stateless/01417_freeze_partition_verbose.sh
+++ b/tests/queries/0_stateless/01417_freeze_partition_verbose.sh
@@ -17,7 +17,7 @@ ${CLICKHOUSE_CLIENT} --query "INSERT INTO table_for_freeze SELECT number, toStri
 
 # also for old syntax
 ${CLICKHOUSE_CLIENT} --query "DROP TABLE IF EXISTS table_for_freeze_old_syntax;"
-${CLICKHOUSE_CLIENT} --query "CREATE TABLE table_for_freeze_old_syntax (dt Date, value String) ENGINE = MergeTree(dt, (value), 8192);"
+${CLICKHOUSE_CLIENT} --allow_deprecated_syntax_for_merge_tree=1 --query "CREATE TABLE table_for_freeze_old_syntax (dt Date, value String) ENGINE = MergeTree(dt, (value), 8192);"
 ${CLICKHOUSE_CLIENT} --query "INSERT INTO table_for_freeze_old_syntax SELECT toDate('2021-03-01'), toString(number) from numbers(10);"
 
 ${CLICKHOUSE_CLIENT} --query "ALTER TABLE table_for_freeze FREEZE WITH NAME 'test_01417' FORMAT TSVWithNames SETTINGS alter_partition_verbose_result = 1;" \
diff --git a/tests/queries/0_stateless/01430_modify_sample_by_zookeeper_long.sql b/tests/queries/0_stateless/01430_modify_sample_by_zookeeper_long.sql
index 223c27804df2..752bc6b377fb 100644
--- a/tests/queries/0_stateless/01430_modify_sample_by_zookeeper_long.sql
+++ b/tests/queries/0_stateless/01430_modify_sample_by_zookeeper_long.sql
@@ -37,6 +37,7 @@ ATTACH TABLE modify_sample_replicated;
 
 SELECT count(), min(y), max(y), sum(y), uniqExact(y) FROM modify_sample_replicated SAMPLE 0.1;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE modify_sample_old (d Date DEFAULT '2000-01-01', x UInt8, y UInt64) ENGINE = MergeTree(d, (x, y), 8192);
 
 ALTER TABLE modify_sample_old MODIFY SAMPLE BY x; -- { serverError 36 }
diff --git a/tests/queries/0_stateless/01455_shard_leaf_max_rows_bytes_to_read.sql b/tests/queries/0_stateless/01455_shard_leaf_max_rows_bytes_to_read.sql
index a271295a0cd0..620daeb9f358 100644
--- a/tests/queries/0_stateless/01455_shard_leaf_max_rows_bytes_to_read.sql
+++ b/tests/queries/0_stateless/01455_shard_leaf_max_rows_bytes_to_read.sql
@@ -20,6 +20,7 @@ SELECT count() FROM (SELECT * FROM remote('127.0.0.2', system.numbers) LIMIT 100
 DROP TABLE IF EXISTS test_local;
 DROP TABLE IF EXISTS test_distributed;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE test_local (date Date, value UInt32) ENGINE = MergeTree(date, date, 8192);
 CREATE TABLE test_distributed AS test_local ENGINE = Distributed(test_cluster_two_shards, currentDatabase(), test_local, rand());
 
diff --git a/tests/queries/0_stateless/01516_create_table_primary_key.sql b/tests/queries/0_stateless/01516_create_table_primary_key.sql
index b3c4acd50ffa..b2b9f288eab1 100644
--- a/tests/queries/0_stateless/01516_create_table_primary_key.sql
+++ b/tests/queries/0_stateless/01516_create_table_primary_key.sql
@@ -1,6 +1,7 @@
 -- Tags: no-parallel
 
 DROP DATABASE IF EXISTS test_01516;
+set allow_deprecated_database_ordinary=1;
 CREATE DATABASE test_01516 ENGINE=Ordinary;     -- Full ATTACH requires UUID with Atomic
 USE test_01516;
 
diff --git a/tests/queries/0_stateless/01517_drop_mv_with_inner_table.sql b/tests/queries/0_stateless/01517_drop_mv_with_inner_table.sql
index 5e31faa70da1..67a2009b913c 100644
--- a/tests/queries/0_stateless/01517_drop_mv_with_inner_table.sql
+++ b/tests/queries/0_stateless/01517_drop_mv_with_inner_table.sql
@@ -32,6 +32,7 @@ show tables from db_01517_atomic_sync;
 -- Ordinary
 ---
 drop database if exists db_01517_ordinary;
+set allow_deprecated_database_ordinary=1;
 create database db_01517_ordinary Engine=Ordinary;
 
 create table db_01517_ordinary.source (key Int) engine=Null;
diff --git a/tests/queries/0_stateless/01528_clickhouse_local_prepare_parts.sh b/tests/queries/0_stateless/01528_clickhouse_local_prepare_parts.sh
index 95ecbf09cf54..538d712ad9cf 100755
--- a/tests/queries/0_stateless/01528_clickhouse_local_prepare_parts.sh
+++ b/tests/queries/0_stateless/01528_clickhouse_local_prepare_parts.sh
@@ -8,7 +8,7 @@ WORKING_FOLDER_01528="${CLICKHOUSE_TMP}/01528_clickhouse_local_prepare_parts"
 rm -rf "${WORKING_FOLDER_01528}"
 
 mkdir -p "${WORKING_FOLDER_01528}/metadata/local"
-
+echo "ATTACH DATABASE local ENGINE=Ordinary" > "${WORKING_FOLDER_01528}/metadata/local.sql"
 ## Checks scenario of preparing parts offline by clickhouse-local
 
 ## that is the metadata for the table we want to fill
diff --git a/tests/queries/0_stateless/01600_detach_permanently.sh b/tests/queries/0_stateless/01600_detach_permanently.sh
index 949fe0e6ea27..c32a255448e0 100755
--- a/tests/queries/0_stateless/01600_detach_permanently.sh
+++ b/tests/queries/0_stateless/01600_detach_permanently.sh
@@ -15,7 +15,7 @@ mkdir -p "${WORKING_FOLDER_01600}"
 clickhouse_local() {
     local query="$1"
     shift
-    ${CLICKHOUSE_LOCAL} --query "$query" "$@" --path="${WORKING_FOLDER_01600}"
+    ${CLICKHOUSE_LOCAL} --allow_deprecated_database_ordinary=1 --query "$query" "$@" --path="${WORKING_FOLDER_01600}"
 }
 
 test_detach_attach_sequence() {
diff --git a/tests/queries/0_stateless/01601_detach_permanently.sql b/tests/queries/0_stateless/01601_detach_permanently.sql
index 97797a59af55..95c80e77213e 100644
--- a/tests/queries/0_stateless/01601_detach_permanently.sql
+++ b/tests/queries/0_stateless/01601_detach_permanently.sql
@@ -72,6 +72,7 @@ SELECT '-----------------------';
 SELECT 'database ordinary tests';
 
 DROP DATABASE IF EXISTS test1601_detach_permanently_ordinary;
+set allow_deprecated_database_ordinary=1;
 CREATE DATABASE test1601_detach_permanently_ordinary Engine=Ordinary;
 
 create table test1601_detach_permanently_ordinary.test_name_reuse (number UInt64) engine=MergeTree order by tuple();
diff --git a/tests/queries/0_stateless/01603_rename_overwrite_bug.sql b/tests/queries/0_stateless/01603_rename_overwrite_bug.sql
index 82f9996991f9..acf9f5207092 100644
--- a/tests/queries/0_stateless/01603_rename_overwrite_bug.sql
+++ b/tests/queries/0_stateless/01603_rename_overwrite_bug.sql
@@ -1,6 +1,7 @@
 -- Tags: no-parallel
 
 DROP database IF EXISTS test_1603_rename_bug_ordinary;
+set allow_deprecated_database_ordinary=1;
 create database test_1603_rename_bug_ordinary engine=Ordinary;
 create table test_1603_rename_bug_ordinary.foo engine=Memory as select * from numbers(100);
 create table test_1603_rename_bug_ordinary.bar engine=Log as select * from numbers(200);
diff --git a/tests/queries/0_stateless/01648_mutations_and_escaping.sql b/tests/queries/0_stateless/01648_mutations_and_escaping.sql
index 689da842f163..18bd0b8ee3b6 100644
--- a/tests/queries/0_stateless/01648_mutations_and_escaping.sql
+++ b/tests/queries/0_stateless/01648_mutations_and_escaping.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS mutations_and_escaping_1648;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE mutations_and_escaping_1648 (d Date, e Enum8('foo'=1, 'bar'=2)) Engine = MergeTree(d, (d), 8192);
 INSERT INTO mutations_and_escaping_1648 (d, e) VALUES ('2018-01-01', 'foo');
 INSERT INTO mutations_and_escaping_1648 (d, e) VALUES ('2018-01-02', 'bar');
diff --git a/tests/queries/0_stateless/01652_ttl_old_syntax.sql b/tests/queries/0_stateless/01652_ttl_old_syntax.sql
index 05c391b85e5e..7b11247d9686 100644
--- a/tests/queries/0_stateless/01652_ttl_old_syntax.sql
+++ b/tests/queries/0_stateless/01652_ttl_old_syntax.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS ttl_old_syntax;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE ttl_old_syntax (d Date, i Int) ENGINE = MergeTree(d, i, 8291);
 ALTER TABLE ttl_old_syntax MODIFY TTL toDate('2020-01-01'); -- { serverError 36 }
 
diff --git a/tests/queries/0_stateless/01713_table_ttl_old_syntax_zookeeper.sql b/tests/queries/0_stateless/01713_table_ttl_old_syntax_zookeeper.sql
index 1709a2d412a5..11346a812f23 100644
--- a/tests/queries/0_stateless/01713_table_ttl_old_syntax_zookeeper.sql
+++ b/tests/queries/0_stateless/01713_table_ttl_old_syntax_zookeeper.sql
@@ -2,6 +2,7 @@
 
 DROP TABLE IF EXISTS ttl_table;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE ttl_table
 (
     date Date,
diff --git a/tests/queries/0_stateless/01778_test_LowCardinality_FixedString_pk.sql b/tests/queries/0_stateless/01778_test_LowCardinality_FixedString_pk.sql
index 1a0a1d35f763..78a9b35a40e6 100644
--- a/tests/queries/0_stateless/01778_test_LowCardinality_FixedString_pk.sql
+++ b/tests/queries/0_stateless/01778_test_LowCardinality_FixedString_pk.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS test_01778;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE test_01778
 (
     `key` LowCardinality(FixedString(3)),
diff --git a/tests/queries/0_stateless/01798_uniq_theta_sketch.sql b/tests/queries/0_stateless/01798_uniq_theta_sketch.sql
index eace83d5cfa0..59d5888c0a11 100644
--- a/tests/queries/0_stateless/01798_uniq_theta_sketch.sql
+++ b/tests/queries/0_stateless/01798_uniq_theta_sketch.sql
@@ -107,6 +107,7 @@ EXPLAIN SYNTAX select uniqTheta(-bitNot(-x)) from (select number % 2 as x from n
 DROP TABLE IF EXISTS stored_aggregates;
 
 -- simple
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE stored_aggregates
 (
     d Date,
diff --git a/tests/queries/0_stateless/01810_max_part_removal_threads_long.sh b/tests/queries/0_stateless/01810_max_part_removal_threads_long.sh
index f5ab71d8d348..b1f30a419247 100755
--- a/tests/queries/0_stateless/01810_max_part_removal_threads_long.sh
+++ b/tests/queries/0_stateless/01810_max_part_removal_threads_long.sh
@@ -10,7 +10,7 @@ CUR_DIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
 # shellcheck source=../shell_config.sh
 . "$CUR_DIR"/../shell_config.sh
 
-$CLICKHOUSE_CLIENT -nm -q "create database ordinary_$CLICKHOUSE_DATABASE engine=Ordinary"
+$CLICKHOUSE_CLIENT --allow_deprecated_database_ordinary=1 -nm -q "create database ordinary_$CLICKHOUSE_DATABASE engine=Ordinary"
 
 # MergeTree
 $CLICKHOUSE_CLIENT -nm -q """
diff --git a/tests/queries/0_stateless/01907_multiple_aliases.sql b/tests/queries/0_stateless/01907_multiple_aliases.sql
index 611960a52052..5e8efba7ab7a 100644
--- a/tests/queries/0_stateless/01907_multiple_aliases.sql
+++ b/tests/queries/0_stateless/01907_multiple_aliases.sql
@@ -1,4 +1,5 @@
 DROP TABLE IF EXISTS t;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE t (d Date, z UInt32) ENGINE = MergeTree(d, (z), 1);
 
 INSERT INTO t VALUES ('2017-01-01', 1);
diff --git a/tests/queries/0_stateless/01925_broken_partition_id_zookeeper.sql b/tests/queries/0_stateless/01925_broken_partition_id_zookeeper.sql
index 7d151f063e1c..9c6aa3146ee4 100644
--- a/tests/queries/0_stateless/01925_broken_partition_id_zookeeper.sql
+++ b/tests/queries/0_stateless/01925_broken_partition_id_zookeeper.sql
@@ -19,6 +19,7 @@ DROP TABLE IF EXISTS broken_partition;
 
 DROP TABLE IF EXISTS old_partition_key;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE old_partition_key (sd Date, dh UInt64, ak UInt32, ed Date) ENGINE=MergeTree(sd, dh, (ak, ed, dh), 8192);
 
 ALTER TABLE old_partition_key DROP PARTITION ID '20210325_0_13241_6_12747'; --{serverError 248}
diff --git a/tests/queries/0_stateless/02021_create_database_with_comment.sh b/tests/queries/0_stateless/02021_create_database_with_comment.sh
index ce7a7bef0661..11e62e790b7b 100755
--- a/tests/queries/0_stateless/02021_create_database_with_comment.sh
+++ b/tests/queries/0_stateless/02021_create_database_with_comment.sh
@@ -18,7 +18,7 @@ function test_db_comments()
     local ENGINE_NAME="$1"
     echo "engine : ${ENGINE_NAME}"
 
-    $CLICKHOUSE_CLIENT -nm <<EOF
+    $CLICKHOUSE_CLIENT --allow_deprecated_database_ordinary=1 -nm <<EOF
 DROP DATABASE IF EXISTS ${DB_NAME};
 CREATE DATABASE ${DB_NAME} ENGINE = ${ENGINE_NAME} COMMENT 'Test DB with comment';
 EOF
diff --git a/tests/queries/0_stateless/02096_rename_atomic_hang.sql b/tests/queries/0_stateless/02096_rename_atomic_hang.sql
index 96261bfe127c..dec5f3f95067 100644
--- a/tests/queries/0_stateless/02096_rename_atomic_hang.sql
+++ b/tests/queries/0_stateless/02096_rename_atomic_hang.sql
@@ -2,6 +2,7 @@
 
 drop database if exists db_hang;
 drop database if exists db_hang_temp;
+set allow_deprecated_database_ordinary=1;
 create database db_hang engine=Ordinary;
 use db_hang;
 create table db_hang.test(A Int64) Engine=MergeTree order by A;
diff --git a/tests/queries/0_stateless/02135_local_create_db.sh b/tests/queries/0_stateless/02135_local_create_db.sh
index 2a0105e554e1..5004cd35f993 100755
--- a/tests/queries/0_stateless/02135_local_create_db.sh
+++ b/tests/queries/0_stateless/02135_local_create_db.sh
@@ -5,7 +5,7 @@ CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
 . "$CURDIR"/../shell_config.sh
 
 for Engine in Atomic Ordinary; do
-    $CLICKHOUSE_LOCAL --query """
+    $CLICKHOUSE_LOCAL --allow_deprecated_database_ordinary=1 --query """
     CREATE DATABASE foo_$Engine Engine=$Engine;
     DROP DATABASE foo_$Engine;
     """
diff --git a/tests/queries/0_stateless/02250_hints_for_columns.sh b/tests/queries/0_stateless/02250_hints_for_columns.sh
index 45fd2f238b1d..ea08d8c55351 100755
--- a/tests/queries/0_stateless/02250_hints_for_columns.sh
+++ b/tests/queries/0_stateless/02250_hints_for_columns.sh
@@ -6,7 +6,7 @@ CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
 
 $CLICKHOUSE_CLIENT --query="DROP TABLE IF EXISTS t"
 
-$CLICKHOUSE_CLIENT --query="CREATE TABLE t (CounterID UInt32, StartDate Date, UserID UInt32, VisitID UInt32, NestedColumn Nested(A UInt8, S String), ToDrop UInt32) ENGINE = MergeTree(StartDate, intHash32(UserID), (CounterID, StartDate, intHash32(UserID), VisitID), 8192)"
+$CLICKHOUSE_CLIENT --allow_deprecated_syntax_for_merge_tree=1 --query="CREATE TABLE t (CounterID UInt32, StartDate Date, UserID UInt32, VisitID UInt32, NestedColumn Nested(A UInt8, S String), ToDrop UInt32) ENGINE = MergeTree(StartDate, intHash32(UserID), (CounterID, StartDate, intHash32(UserID), VisitID), 8192)"
 
 $CLICKHOUSE_CLIENT --query="ALTER TABLE t DROP COLUMN ToDro" 2>&1 | grep -q "Maybe you meant: \['ToDrop'\]" && echo 'OK' || echo 'FAIL'
 
diff --git a/tests/queries/0_stateless/02265_rename_join_ordinary_to_atomic.sql b/tests/queries/0_stateless/02265_rename_join_ordinary_to_atomic.sql
index 3ec995a6a245..041cb8876479 100644
--- a/tests/queries/0_stateless/02265_rename_join_ordinary_to_atomic.sql
+++ b/tests/queries/0_stateless/02265_rename_join_ordinary_to_atomic.sql
@@ -1,5 +1,6 @@
 -- Tags: no-parallel
 
+set allow_deprecated_database_ordinary=1;
 DROP DATABASE IF EXISTS 02265_atomic_db;
 DROP DATABASE IF EXISTS 02265_ordinary_db;
 
diff --git a/tests/queries/1_stateful/00040_aggregating_materialized_view.sql b/tests/queries/1_stateful/00040_aggregating_materialized_view.sql
index 555a8b64d752..99fed62683f0 100644
--- a/tests/queries/1_stateful/00040_aggregating_materialized_view.sql
+++ b/tests/queries/1_stateful/00040_aggregating_materialized_view.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS test.basic_00040;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE MATERIALIZED VIEW test.basic_00040
 ENGINE = AggregatingMergeTree(StartDate, (CounterID, StartDate), 8192)
 POPULATE AS
diff --git a/tests/queries/1_stateful/00041_aggregating_materialized_view.sql b/tests/queries/1_stateful/00041_aggregating_materialized_view.sql
index 0e59d2a88a9c..ea99b78902cd 100644
--- a/tests/queries/1_stateful/00041_aggregating_materialized_view.sql
+++ b/tests/queries/1_stateful/00041_aggregating_materialized_view.sql
@@ -9,6 +9,7 @@ CREATE TABLE test.visits_null
     UserID UInt64
 ) ENGINE = Null;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE MATERIALIZED VIEW test.basic
 ENGINE = AggregatingMergeTree(StartDate, (CounterID, StartDate), 8192)
 AS SELECT
diff --git a/tests/queries/1_stateful/00054_merge_tree_partitions.sql b/tests/queries/1_stateful/00054_merge_tree_partitions.sql
index 730209529774..33f7e4e8666f 100644
--- a/tests/queries/1_stateful/00054_merge_tree_partitions.sql
+++ b/tests/queries/1_stateful/00054_merge_tree_partitions.sql
@@ -1,4 +1,5 @@
 DROP TABLE IF EXISTS test.partitions;
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE test.partitions (EventDate Date, CounterID UInt32) ENGINE = MergeTree(EventDate, CounterID, 8192);
 INSERT INTO test.partitions SELECT EventDate + UserID % 365 AS EventDate, CounterID FROM test.hits WHERE CounterID = 1704509;
 
diff --git a/tests/queries/1_stateful/00071_merge_tree_optimize_aio.sql b/tests/queries/1_stateful/00071_merge_tree_optimize_aio.sql
index 16c0097bf216..e05751226442 100644
--- a/tests/queries/1_stateful/00071_merge_tree_optimize_aio.sql
+++ b/tests/queries/1_stateful/00071_merge_tree_optimize_aio.sql
@@ -1,5 +1,6 @@
 DROP TABLE IF EXISTS test.hits_snippet;
 
+set allow_deprecated_syntax_for_merge_tree=1;
 CREATE TABLE test.hits_snippet(EventTime DateTime('Asia/Dubai'),  EventDate Date,  CounterID UInt32,  UserID UInt64,  URL String,  Referer String) ENGINE = MergeTree(EventDate, intHash32(UserID), (CounterID, EventDate, intHash32(UserID), EventTime), 8192);
 
 SET min_insert_block_size_rows = 0, min_insert_block_size_bytes = 0;
