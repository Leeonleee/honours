diff --git a/tests/queries/0_stateless/00700_decimal_math.reference b/tests/queries/0_stateless/00700_decimal_math.reference
index 389b428e27bd..613fbc1ecd52 100644
--- a/tests/queries/0_stateless/00700_decimal_math.reference
+++ b/tests/queries/0_stateless/00700_decimal_math.reference
@@ -28,3 +28,6 @@
 0	0	1	0
 3.14159265358979	0	-1	-0
 1	1.5707963267948966	0	0.7853981633974483
+4.2	17.64	2.04939015319192
+4.2	17.64	2.04939015319192
+4.2	17.64	2.04939015319192
diff --git a/tests/queries/0_stateless/00700_decimal_math.sql b/tests/queries/0_stateless/00700_decimal_math.sql
index 7f695a5b0173..5dc8f800334b 100644
--- a/tests/queries/0_stateless/00700_decimal_math.sql
+++ b/tests/queries/0_stateless/00700_decimal_math.sql
@@ -40,6 +40,6 @@ SELECT toDecimal128(pi(), 14) AS x, round(sin(x), 8), round(cos(x), 8), round(ta
 SELECT toDecimal128('1.0', 2) AS x, asin(x), acos(x), atan(x);
 
 
-SELECT toDecimal32('4.2', 1) AS x, pow(x, 2), pow(x, 0.5); -- { serverError ILLEGAL_TYPE_OF_ARGUMENT }
-SELECT toDecimal64('4.2', 1) AS x, pow(x, 2), pow(x, 0.5); -- { serverError ILLEGAL_TYPE_OF_ARGUMENT }
-SELECT toDecimal128('4.2', 1) AS x, pow(x, 2), pow(x, 0.5); -- { serverError ILLEGAL_TYPE_OF_ARGUMENT }
+SELECT toDecimal32('4.2', 1) AS x, pow(x, 2), pow(x, 0.5);
+SELECT toDecimal64('4.2', 1) AS x, pow(x, 2), pow(x, 0.5);
+SELECT toDecimal128('4.2', 1) AS x, pow(x, 2), pow(x, 0.5);
diff --git a/tests/queries/0_stateless/02011_tuple_vector_functions.sql b/tests/queries/0_stateless/02011_tuple_vector_functions.sql
index d0cd89dc4640..8bfe5e53a72b 100644
--- a/tests/queries/0_stateless/02011_tuple_vector_functions.sql
+++ b/tests/queries/0_stateless/02011_tuple_vector_functions.sql
@@ -78,7 +78,7 @@ SELECT max2(NULL, 1) - min2(NULL, 1);
 SELECT L1Norm(1); -- { serverError ILLEGAL_TYPE_OF_ARGUMENT }
 SELECT (1, 1) / toString(1); -- { serverError ILLEGAL_TYPE_OF_ARGUMENT }
 SELECT -(1, toString(1)); -- { serverError ILLEGAL_TYPE_OF_ARGUMENT }
-SELECT LpNorm((1, 2), toDecimal32(2, 4)); -- { serverError ILLEGAL_TYPE_OF_ARGUMENT }
+SELECT LpNorm((1, 2), toDecimal32(2, 4)); -- { serverError ILLEGAL_COLUMN }
 SELECT (1, 2) * toDecimal32(3.1, 8);
 
 SELECT cosineDistance((1, 2), (2, 3, 4)); -- { serverError ILLEGAL_TYPE_OF_ARGUMENT }
diff --git a/tests/queries/0_stateless/03161_decimal_binary_math.reference b/tests/queries/0_stateless/03161_decimal_binary_math.reference
new file mode 100644
index 000000000000..f7d9761c7c5d
--- /dev/null
+++ b/tests/queries/0_stateless/03161_decimal_binary_math.reference
@@ -0,0 +1,75 @@
+42.4242	2.42	8686.104718
+42.4242	2.42	8686.104718
+42.4242	2.42	8686.104718
+42.4242	2.42	8686.104718
+42.4242	2.42	8686.104718
+42.4242	2.42	8686.104718
+42.4242	2.42	8686.104718
+42.4242	2.42	8686.104718
+42.4242	2.42	8686.104718
+42.4242	2.42	8686.104718
+42.4242	2.42	8686.104718
+42.4242	2.42	8686.104718
+42.4242	2.42	8686.104718
+42.4242	2.42	8686.104718
+42.4242	2.42	8686.104718
+0.4242	0.24	0.514871
+0.4242	0.24	0.514871
+0.4242	0.24	0.514871
+0.4242	0.24	0.514871
+0.4242	0.24	0.514871
+0.4242	0.24	0.514871
+0.4242	0.24	0.514871
+0.4242	0.24	0.514871
+0.4242	0.24	0.514871
+0.4242	0.24	0.514871
+0.4242	0.24	0.514871
+0.4242	0.24	0.514871
+0.4242	0.24	0.514871
+0.4242	0.24	0.514871
+0.4242	0.24	0.514871
+42.4242	2.42	2.42
+42.4242	2.42	2.42
+42.4242	2.42	2.42
+42.4242	2.42	2.42
+42.4242	2.42	2.42
+42.4242	2.42	2.42
+42.4242	2.42	2.42
+42.4242	2.42	2.42
+42.4242	2.42	2.42
+42.4242	2.42	2.42
+42.4242	2.42	2.42
+42.4242	2.42	2.42
+42.4242	2.42	2.42
+42.4242	2.42	2.42
+42.4242	2.42	2.42
+42.4242	2.42	42.4242
+42.4242	2.42	42.4242
+42.4242	2.42	42.4242
+42.4242	2.42	42.4242
+42.4242	2.42	42.4242
+42.4242	2.42	42.4242
+42.4242	2.42	42.4242
+42.4242	2.42	42.4242
+42.4242	2.42	42.4242
+42.4242	2.42	42.4242
+42.4242	2.42	42.4242
+42.4242	2.42	42.4242
+42.4242	2.42	42.4242
+42.4242	2.42	42.4242
+42.4242	2.42	42.4242
+0.4242	0.4242	0.599909
+0.4242	0.4242	0.599909
+0.4242	0.4242	0.599909
+0.4242	0.4242	0.599909
+0.4242	0.4242	0.599909
+0.4242	0.4242	0.599909
+0.4242	0.4242	0.599909
+0.4242	0.4242	0.599909
+0.4242	0.4242	0.599909
+0.4242	0.4242	0.599909
+0.4242	0.4242	0.599909
+0.4242	0.4242	0.599909
+0.4242	0.4242	0.599909
+0.4242	0.4242	0.599909
+0.4242	0.4242	0.599909
diff --git a/tests/queries/0_stateless/03161_decimal_binary_math.sql b/tests/queries/0_stateless/03161_decimal_binary_math.sql
new file mode 100644
index 000000000000..5484cc6a9bb0
--- /dev/null
+++ b/tests/queries/0_stateless/03161_decimal_binary_math.sql
@@ -0,0 +1,79 @@
+SELECT toDecimal32('42.4242', 4) AS x, toDecimal32('2.42', 2) AS y, round(pow(x, y), 6);
+SELECT toDecimal64('42.4242', 4) AS x, toDecimal32('2.42', 2) AS y, round(pow(x, y), 6);
+SELECT toDecimal32('42.4242', 4) AS x, toDecimal64('2.42', 2) AS y, round(pow(x, y), 6);
+SELECT toDecimal64('42.4242', 4) AS x, toDecimal32('2.42', 2) AS y, round(pow(x, y), 6);
+SELECT toDecimal32('42.4242', 4) AS x, materialize(toDecimal32('2.42', 2)) AS y, round(pow(x, y), 6);
+SELECT materialize(toDecimal32('42.4242', 4)) AS x, toDecimal32('2.42', 2) AS y, round(pow(x, y), 6);
+SELECT materialize(toDecimal32('42.4242', 4)) AS x, materialize(toDecimal32('2.42', 2)) AS y, round(pow(x, y), 6);
+SELECT 42.4242 AS x, toDecimal32('2.42', 2) AS y, round(pow(x, y), 6);
+SELECT toDecimal32('42.4242', 4) AS x, 2.42 AS y, round(pow(x, y), 6);
+SELECT materialize(42.4242) AS x, toDecimal32('2.42', 2) AS y, round(pow(x, y), 6);
+SELECT 42.4242 AS x, materialize(toDecimal32('2.42', 2)) AS y, round(pow(x, y), 6);
+SELECT materialize(42.4242) AS x, materialize(toDecimal32('2.42', 2)) AS y, round(pow(x, y), 6);
+SELECT materialize(toDecimal32('42.4242', 4)) AS x, 2.42 AS y, round(pow(x, y), 6);
+SELECT toDecimal32('42.4242', 4) AS x, materialize(2.42) AS y, round(pow(x, y), 6);
+SELECT materialize(toDecimal32('42.4242', 4)) AS x, materialize(2.42) AS y, round(pow(x, y), 6);
+
+SELECT toDecimal32('0.4242', 4) AS x, toDecimal32('0.24', 2) AS y, round(atan2(y, x), 6);
+SELECT toDecimal64('0.4242', 4) AS x, toDecimal32('0.24', 2) AS y, round(atan2(y, x), 6);
+SELECT toDecimal32('0.4242', 4) AS x, toDecimal64('0.24', 2) AS y, round(atan2(y, x), 6);
+SELECT toDecimal64('0.4242', 4) AS x, toDecimal64('0.24', 2) AS y, round(atan2(y, x), 6);
+SELECT toDecimal32('0.4242', 4) AS x, materialize(toDecimal32('0.24', 2)) AS y, round(atan2(y, x), 6);
+SELECT materialize(toDecimal32('0.4242', 4)) AS x, toDecimal32('0.24', 2) AS y, round(atan2(y, x), 6);
+SELECT materialize(toDecimal32('0.4242', 4)) AS x, materialize(toDecimal32('0.24', 2)) AS y, round(atan2(y, x), 6);
+SELECT 0.4242 AS x, toDecimal32('0.24', 2) AS y, round(atan2(y, x), 6);
+SELECT toDecimal32('0.4242', 4) AS x, 0.24 AS y, round(atan2(y, x), 6);
+SELECT materialize(0.4242) AS x, toDecimal32('0.24', 2) AS y, round(atan2(y, x), 6);
+SELECT 0.4242 AS x, materialize(toDecimal32('0.24', 2)) AS y, round(atan2(y, x), 6);
+SELECT materialize(0.4242) AS x, materialize(toDecimal32('0.24', 2)) AS y, round(atan2(y, x), 6);
+SELECT materialize(toDecimal32('0.4242', 4)) AS x, 0.24 AS y, round(atan2(y, x), 6);
+SELECT toDecimal32('0.4242', 4) AS x, materialize(0.24) AS y, round(atan2(y, x), 6);
+SELECT materialize(toDecimal32('0.4242', 4)) AS x, materialize(0.24) AS y, round(atan2(y, x), 6);
+
+SELECT toDecimal32('42.4242', 4) AS x, toDecimal32('2.42', 2) AS y, round(min2(x, y), 6);
+SELECT toDecimal64('42.4242', 4) AS x, toDecimal32('2.42', 2) AS y, round(min2(x, y), 6);
+SELECT toDecimal32('42.4242', 4) AS x, toDecimal64('2.42', 2) AS y, round(min2(x, y), 6);
+SELECT toDecimal64('42.4242', 4) AS x, toDecimal64('2.42', 2) AS y, round(min2(x, y), 6);
+SELECT toDecimal32('42.4242', 4) AS x, materialize(toDecimal32('2.42', 2)) AS y, round(min2(x, y), 6);
+SELECT materialize(toDecimal32('42.4242', 4)) AS x, toDecimal32('2.42', 2) AS y, round(min2(x, y), 6);
+SELECT materialize(toDecimal32('42.4242', 4)) AS x, materialize(toDecimal32('2.42', 2)) AS y, round(min2(x, y), 6);
+SELECT 42.4242 AS x, toDecimal32('2.42', 2) AS y, round(min2(x, y), 6);
+SELECT toDecimal32('42.4242', 4) AS x, 2.42 AS y, round(min2(x, y), 6);
+SELECT materialize(42.4242) AS x, toDecimal32('2.42', 2) AS y, round(min2(x, y), 6);
+SELECT 42.4242 AS x, materialize(toDecimal32('2.42', 2)) AS y, round(min2(x, y), 6);
+SELECT materialize(42.4242) AS x, materialize(toDecimal32('2.42', 2)) AS y, round(min2(x, y), 6);
+SELECT materialize(toDecimal32('42.4242', 4)) AS x, 2.42 AS y, round(min2(x, y), 6);
+SELECT toDecimal32('42.4242', 4) AS x, materialize(2.42) AS y, round(min2(x, y), 6);
+SELECT materialize(toDecimal32('42.4242', 4)) AS x, materialize(2.42) AS y, round(min2(x, y), 6);
+
+SELECT toDecimal32('42.4242', 4) AS x, toDecimal32('2.42', 2) AS y, round(max2(x, y), 6);
+SELECT toDecimal64('42.4242', 4) AS x, toDecimal32('2.42', 2) AS y, round(max2(x, y), 6);
+SELECT toDecimal32('42.4242', 4) AS x, toDecimal64('2.42', 2) AS y, round(max2(x, y), 6);
+SELECT toDecimal64('42.4242', 4) AS x, toDecimal64('2.42', 2) AS y, round(max2(x, y), 6);
+SELECT toDecimal32('42.4242', 4) AS x, materialize(toDecimal32('2.42', 2)) AS y, round(max2(x, y), 6);
+SELECT materialize(toDecimal32('42.4242', 4)) AS x, toDecimal32('2.42', 2) AS y, round(max2(x, y), 6);
+SELECT materialize(toDecimal32('42.4242', 4)) AS x, materialize(toDecimal32('2.42', 2)) AS y, round(max2(x, y), 6);
+SELECT 42.4242 AS x, toDecimal32('2.42', 2) AS y, round(max2(x, y), 6);
+SELECT toDecimal32('42.4242', 4) AS x, 2.42 AS y, round(max2(x, y), 6);
+SELECT materialize(42.4242) AS x, toDecimal32('2.42', 2) AS y, round(max2(x, y), 6);
+SELECT 42.4242 AS x, materialize(toDecimal32('2.42', 2)) AS y, round(max2(x, y), 6);
+SELECT materialize(42.4242) AS x, materialize(toDecimal32('2.42', 2)) AS y, round(max2(x, y), 6);
+SELECT materialize(toDecimal32('42.4242', 4)) AS x, 2.42 AS y, round(max2(x, y), 6);
+SELECT toDecimal32('42.4242', 4) AS x, materialize(2.42) AS y, round(max2(x, y), 6);
+SELECT materialize(toDecimal32('42.4242', 4)) AS x, materialize(2.42) AS y, round(max2(x, y), 6);
+
+SELECT toDecimal32('0.4242', 4) AS x, toDecimal32('0.4242', 4) AS y, round(hypot(x, y), 6);
+SELECT toDecimal64('0.4242', 4) AS x, toDecimal32('0.4242', 4) AS y, round(hypot(x, y), 6);
+SELECT toDecimal32('0.4242', 4) AS x, toDecimal64('0.4242', 4) AS y, round(hypot(x, y), 6);
+SELECT toDecimal64('0.4242', 4) AS x, toDecimal64('0.4242', 4) AS y, round(hypot(x, y), 6);
+SELECT toDecimal32('0.4242', 4) AS x, materialize(toDecimal32('0.4242', 4)) AS y, round(hypot(x, y), 6);
+SELECT materialize(toDecimal32('0.4242', 4)) AS x, toDecimal32('0.4242', 4) AS y, round(hypot(x, y), 6);
+SELECT materialize(toDecimal32('0.4242', 4)) AS x, materialize(toDecimal32('0.4242', 4)) AS y, round(hypot(x, y), 6);
+SELECT 0.4242 AS x, toDecimal32('0.4242', 4) AS y, round(hypot(x, y), 6);
+SELECT toDecimal32('0.4242', 4) AS x, 0.4242 AS y, round(hypot(x, y), 6);
+SELECT materialize(0.4242) AS x, toDecimal32('0.4242', 4) AS y, round(hypot(x, y), 6);
+SELECT 0.4242 AS x, materialize(toDecimal32('0.4242', 4)) AS y, round(hypot(x, y), 6);
+SELECT materialize(0.4242) AS x, materialize(toDecimal32('0.4242', 4)) AS y, round(hypot(x, y), 6);
+SELECT materialize(toDecimal32('0.4242', 4)) AS x, 0.4242 AS y, round(hypot(x, y), 6);
+SELECT toDecimal32('0.4242', 4) AS x, materialize(0.4242) AS y, round(hypot(x, y), 6);
+SELECT materialize(toDecimal32('0.4242', 4)) AS x, materialize(0.4242) AS y, round(hypot(x, y), 6);
