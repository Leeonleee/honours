diff --git a/tests/queries/0_stateless/01942_dateTimeToSnowflake.reference b/tests/queries/0_stateless/01942_dateTimeToSnowflake.reference
new file mode 100644
index 000000000000..dfca3a10eeb3
--- /dev/null
+++ b/tests/queries/0_stateless/01942_dateTimeToSnowflake.reference
@@ -0,0 +1,6 @@
+const column
+2021-08-15 18:57:56	1426860702823350272
+2021-08-15 18:57:56.492	1426860704886947840
+non-const column
+2021-08-15 18:57:56	1426860702823350272
+2021-08-15 18:57:56.492	1426860704886947840
diff --git a/tests/queries/0_stateless/01942_dateTimeToSnowflake.sql b/tests/queries/0_stateless/01942_dateTimeToSnowflake.sql
new file mode 100644
index 000000000000..047d8be7be5d
--- /dev/null
+++ b/tests/queries/0_stateless/01942_dateTimeToSnowflake.sql
@@ -0,0 +1,23 @@
+-- Error cases
+SELECT dateTimeToSnowflake();  -- {serverError 42}
+SELECT dateTime64ToSnowflake();  -- {serverError 42}
+
+SELECT dateTimeToSnowflake('abc');  -- {serverError 43}
+SELECT dateTime64ToSnowflake('abc');  -- {serverError 43}
+
+SELECT dateTimeToSnowflake('abc', 123);  -- {serverError 42}
+SELECT dateTime64ToSnowflake('abc', 123);  -- {serverError 42}
+
+SELECT 'const column';
+WITH toDateTime('2021-08-15 18:57:56', 'Asia/Shanghai') AS dt
+SELECT dt, dateTimeToSnowflake(dt);
+
+WITH toDateTime64('2021-08-15 18:57:56.492', 3, 'Asia/Shanghai') AS dt64
+SELECT dt64, dateTime64ToSnowflake(dt64);
+
+SELECT 'non-const column';
+WITH toDateTime('2021-08-15 18:57:56', 'Asia/Shanghai') AS x
+SELECT materialize(x) as dt, dateTimeToSnowflake(dt);;
+
+WITH toDateTime64('2021-08-15 18:57:56.492', 3, 'Asia/Shanghai') AS x
+SELECT materialize(x) as dt64, dateTime64ToSnowflake(dt64);
diff --git a/tests/queries/0_stateless/01942_snowflakeToDateTime.reference b/tests/queries/0_stateless/01942_snowflakeToDateTime.reference
new file mode 100644
index 000000000000..bed18023f6a0
--- /dev/null
+++ b/tests/queries/0_stateless/01942_snowflakeToDateTime.reference
@@ -0,0 +1,3 @@
+const column
+UTC	1426860704886947840	2021-08-15 10:57:56	DateTime(\'UTC\')	2021-08-15 10:57:56.492	DateTime64(3, \'UTC\')
+Asia/Shanghai	1426860704886947840	2021-08-15 18:57:56	DateTime(\'Asia/Shanghai\')	2021-08-15 18:57:56.492	DateTime64(3, \'Asia/Shanghai\')
diff --git a/tests/queries/0_stateless/01942_snowflakeToDateTime.sql b/tests/queries/0_stateless/01942_snowflakeToDateTime.sql
new file mode 100644
index 000000000000..f6f171afabf6
--- /dev/null
+++ b/tests/queries/0_stateless/01942_snowflakeToDateTime.sql
@@ -0,0 +1,32 @@
+-- -- Error cases
+SELECT snowflakeToDateTime();  -- {serverError 42}
+SELECT snowflakeToDateTime64();  -- {serverError 42}
+
+SELECT snowflakeToDateTime('abc');  -- {serverError 43}
+SELECT snowflakeToDateTime64('abc');  -- {serverError 43}
+
+SELECT snowflakeToDateTime('abc', 123);  -- {serverError 43}
+SELECT snowflakeToDateTime64('abc', 123);  -- {serverError 43}
+
+SELECT 'const column';
+WITH
+	CAST(1426860704886947840 AS Int64) AS i64,
+	'UTC' AS tz
+SELECT
+	tz,
+	i64,
+	snowflakeToDateTime(i64, tz) as dt,
+	toTypeName(dt),
+	snowflakeToDateTime64(i64, tz) as dt64,
+	toTypeName(dt64);
+
+WITH
+	CAST(1426860704886947840 AS Int64) AS i64,
+	'Asia/Shanghai' AS tz
+SELECT
+	tz,
+	i64,
+	snowflakeToDateTime(i64, tz) as dt,
+	toTypeName(dt),
+	snowflakeToDateTime64(i64, tz) as dt64,
+	toTypeName(dt64);
\ No newline at end of file
