diff --git a/tests/queries/0_stateless/01553_settings_early_apply.reference b/tests/queries/0_stateless/01553_settings_early_apply.reference
new file mode 100644
index 000000000000..3dad208be5d2
--- /dev/null
+++ b/tests/queries/0_stateless/01553_settings_early_apply.reference
@@ -0,0 +1,43 @@
+ number
+
+      0 
+ number
+
+      1 
+0
+1
+2
+3
+4
+5
+6
+7
+8
+9
+{
+	"meta":
+	[
+		{
+			"name": "number",
+			"type": "UInt64"
+		}
+	],
+
+	"data":
+	[
+		["0"],
+		["1"],
+		["2"],
+		["3"],
+		["4"],
+		["5"],
+		["6"],
+		["7"],
+		["8"],
+		["9"]
+	],
+
+	"rows": 10,
+
+	"rows_before_limit_at_least": 10
+}
diff --git a/tests/queries/0_stateless/01553_settings_early_apply.sql b/tests/queries/0_stateless/01553_settings_early_apply.sql
new file mode 100644
index 000000000000..48178c38f334
--- /dev/null
+++ b/tests/queries/0_stateless/01553_settings_early_apply.sql
@@ -0,0 +1,8 @@
+select * from numbers(100) settings max_result_rows = 1; -- { serverError 396 }
+select * from numbers(100) FORMAT JSON settings max_result_rows = 1; -- { serverError 396 }
+
+SET max_result_rows = 1;
+select * from numbers(10); -- { serverError 396 }
+select * from numbers(10) SETTINGS result_overflow_mode = 'break', max_block_size = 1 FORMAT PrettySpaceNoEscapes;
+select * from numbers(10) settings max_result_rows = 10;
+select * from numbers(10) FORMAT JSONCompact settings max_result_rows = 10, output_format_write_statistics = 0;
