diff --git a/tests/queries/0_stateless/02842_largestTriangleThreeBuckets_aggregate_function.reference b/tests/queries/0_stateless/02842_largestTriangleThreeBuckets_aggregate_function.reference
index b4407dea13aa..cf7f77642531 100644
--- a/tests/queries/0_stateless/02842_largestTriangleThreeBuckets_aggregate_function.reference
+++ b/tests/queries/0_stateless/02842_largestTriangleThreeBuckets_aggregate_function.reference
@@ -1,7 +1,17 @@
 []
 [(1,10)]
 [(1,10),(10,70)]
-[(1,10),(3,15),(5,40),(10,70)]
-[(0.02,0.16),(0.06,0.73),(0.08,0.88),(0.09,0),(0.11,0.31),(0.15,0.09),(0.19,0.27),(0.2,0.24),(0.21,0.46),(0.23,0.23),(0.25,0.34),(0.29,0.16),(0.36,0.99),(0.37,0.86),(0.38,0.75),(0.39,0.86),(0.41,0.63),(0.45,0.86),(0.47,0.06),(0.98,0.09)]
-[('2023-01-14 00:00:00.000',35.96528042030847),('2023-03-15 00:00:00.000',98.77709508458238),('2023-06-05 00:00:00.000',8.107958052612418),('2023-09-29 00:00:00.000',80.05338096818797),('2023-12-31 00:00:00.000',98.52375935588333)]
-[('2023-01-14 00:00:00.000',35.96528042030847),('2023-03-15 00:00:00.000',98.77709508458238),('2023-06-05 00:00:00.000',8.107958052612418),('2023-09-29 00:00:00.000',80.05338096818797),('2023-12-31 00:00:00.000',98.52375935588333)]
+[(1,10),(3,15),(9,55),(10,70)]
+[(0.02,0.16),(0.08,0.88),(0.09,0),(0.15,0.09),(0.21,0.46),(0.23,0.23),(0.29,0.16),(0.37,0.86),(0.39,0.86),(0.47,0.06),(0.48,0.57),(0.52,0.11),(0.6,0.64),(0.63,0.25),(0.7,0.25),(0.73,0.95),(0.83,0.67),(0.87,0.15),(0.91,0.62),(0.98,0.09)]
+[('2023-01-14 00:00:00.000',35.96528042030847),('2023-03-15 00:00:00.000',98.77709508458238),('2023-06-05 00:00:00.000',8.107958052612418),('2023-12-18 00:00:00.000',12.832032764204616),('2023-12-31 00:00:00.000',98.52375935588333)]
+[('2023-01-14 00:00:00.000',35.96528042030847),('2023-03-15 00:00:00.000',98.77709508458238),('2023-06-05 00:00:00.000',8.107958052612418),('2023-12-18 00:00:00.000',12.832032764204616),('2023-12-31 00:00:00.000',98.52375935588333)]
+(9908,908)	9908	10
+(9918,918)	9918	10
+(9928,928)	9928	10
+(9938,938)	9938	10
+(9948,948)	9948	10
+(9958,958)	9958	10
+(9968,968)	9968	10
+(9978,978)	9978	10
+(9988,988)	9988	10
+(9999,999)	9999	11
diff --git a/tests/queries/0_stateless/02842_largestTriangleThreeBuckets_aggregate_function.sql b/tests/queries/0_stateless/02842_largestTriangleThreeBuckets_aggregate_function.sql
index 2eb8754cb64a..8a6a23589189 100644
--- a/tests/queries/0_stateless/02842_largestTriangleThreeBuckets_aggregate_function.sql
+++ b/tests/queries/0_stateless/02842_largestTriangleThreeBuckets_aggregate_function.sql
@@ -44,4 +44,20 @@ select largestTriangleThreeBuckets(5)(x, y) from largestTriangleThreeBucketsTest
 
 select lttb(5)(x, y) from largestTriangleThreeBucketsTestDateTime64Float64;
 
-drop table largestTriangleThreeBucketsTestDateTime64Float64;
\ No newline at end of file
+drop table largestTriangleThreeBucketsTestDateTime64Float64;
+
+CREATE TABLE largestTriangleTreeBucketsBucketSizeTest
+(
+    x UInt32,
+    y UInt32
+) ENGINE = MergeTree ORDER BY x;
+
+INSERT INTO largestTriangleTreeBucketsBucketSizeTest (x, y) SELECT (number + 1) AS x, (x % 1000) AS y FROM numbers(9999);
+
+SELECT 
+  arrayJoin(lttb(1000)(x, y)) AS point, 
+  tupleElement(point, 1) AS point_x, 
+  point_x - neighbor(point_x, -1) AS point_x_diff_with_previous_row 
+FROM largestTriangleTreeBucketsBucketSizeTest LIMIT 990, 10;
+
+DROP TABLE largestTriangleTreeBucketsBucketSizeTest;
\ No newline at end of file
