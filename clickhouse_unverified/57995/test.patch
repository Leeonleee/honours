diff --git a/tests/queries/0_stateless/02933_paste_join.reference b/tests/queries/0_stateless/02933_paste_join.reference
new file mode 100644
index 000000000000..84ae5987926a
--- /dev/null
+++ b/tests/queries/0_stateless/02933_paste_join.reference
@@ -0,0 +1,74 @@
+0	0
+1	1
+2	2
+3	3
+4	4
+5	5
+6	6
+7	7
+8	8
+9	9
+0	9
+1	8
+2	7
+3	6
+4	5
+5	4
+6	3
+7	2
+8	1
+9	0
+1	2
+0	0
+1	1
+2	2
+3	3
+4	4
+5	5
+6	0
+7	1
+8	2
+9	3
+10	4
+0	0
+1	1
+0	0	0	0
+1	1	1	1
+2	2	2	2
+3	3	3	3
+4	4	4	4
+5	5	5	5
+6	6	6	6
+7	7	7	7
+8	8	8	8
+9	9	9	9
+10	10	10	10
+11	11	11	11
+12	12	12	12
+13	13	13	13
+14	14	14	14
+15	15	15	15
+16	16	16	16
+17	17	17	17
+18	18	18	18
+19	19	19	19
+20	20	20	20
+21	21	21	21
+22	22	22	22
+23	23	23	23
+24	24	24	24
+25	25	25	25
+26	26	26	26
+27	27	27	27
+28	28	28	28
+29	29	29	29
+UInt64
+UInt64
+UInt64
+UInt64
+UInt64
+UInt64
+UInt64
+UInt64
+UInt64
+UInt64
diff --git a/tests/queries/0_stateless/02933_paste_join.sql b/tests/queries/0_stateless/02933_paste_join.sql
new file mode 100644
index 000000000000..1c346438d778
--- /dev/null
+++ b/tests/queries/0_stateless/02933_paste_join.sql
@@ -0,0 +1,37 @@
+select * from (SELECT number as a FROM numbers(10)) t1 PASTE JOIN (select number as a from numbers(10)) t2;
+select * from (SELECT number as a FROM numbers(10)) t1 PASTE JOIN (select number as a from numbers(10) order by a desc) t2;
+create table if not exists test (num UInt64) engine=Memory;
+insert into test select number from numbers(6);
+insert into test select number from numbers(5);
+SELECT * FROM (SELECT 1) t1 PASTE JOIN (SELECT 2) SETTINGS joined_subquery_requires_alias=0;
+select * from (SELECT number as a FROM numbers(11)) t1 PASTE JOIN test t2 SETTINGS max_threads=1;
+select * from (SELECT number as a FROM numbers(11)) t1 PASTE JOIN (select * from test limit 2) t2 SETTINGs max_threads=1;
+CREATE TABLE t1 (a UInt64, b UInt64) ENGINE = Memory;
+INSERT INTO t1 SELECT number, number FROM numbers(0, 3);
+INSERT INTO t1 SELECT number, number FROM numbers(3, 2);
+INSERT INTO t1 SELECT number, number FROM numbers(5, 7);
+INSERT INTO t1 SELECT number, number FROM numbers(12, 2);
+INSERT INTO t1 SELECT number, number FROM numbers(14, 1);
+INSERT INTO t1 SELECT number, number FROM numbers(15, 2);
+INSERT INTO t1 SELECT number, number FROM numbers(17, 1);
+INSERT INTO t1 SELECT number, number FROM numbers(18, 2);
+INSERT INTO t1 SELECT number, number FROM numbers(20, 2);
+INSERT INTO t1 SELECT number, number FROM numbers(22, 2);
+INSERT INTO t1 SELECT number, number FROM numbers(24, 2);
+INSERT INTO t1 SELECT number, number FROM numbers(26, 2);
+INSERT INTO t1 SELECT number, number FROM numbers(28, 2);
+
+
+CREATE TABLE t2 (a UInt64, b UInt64) ENGINE = Memory;
+INSERT INTO t2 SELECT number, number FROM numbers(0, 2);
+INSERT INTO t2 SELECT number, number FROM numbers(2, 3);
+INSERT INTO t2 SELECT number, number FROM numbers(5, 5);
+INSERT INTO t2 SELECT number, number FROM numbers(10, 5);
+INSERT INTO t2 SELECT number, number FROM numbers(15, 15);
+
+SELECT * FROM ( SELECT * from t1 ) t1 PASTE JOIN ( SELECT * from t2 ) t2 SETTINGS max_threads = 1;
+SELECT toTypeName(a) FROM (SELECT number as a FROM numbers(11)) t1 PASTE JOIN (select number as a from numbers(10)) t2 SETTINGS join_use_nulls = 1;
+SET max_threads = 2;
+select * from (SELECT number as a FROM numbers(10)) t1 ANY PASTE JOIN (select number as a from numbers(10)) t2; -- { clientError SYNTAX_ERROR }
+select * from (SELECT number as a FROM numbers(10)) t1 ALL PASTE JOIN (select number as a from numbers(10)) t2; -- { clientError SYNTAX_ERROR }
+select * from (SELECT number as a FROM numbers_mt(10)) t1 PASTE JOIN (select number as a from numbers(10) ORDER BY a DESC) t2 SETTINGS max_block_size=3; -- { serverError BAD_ARGUMENTS }
