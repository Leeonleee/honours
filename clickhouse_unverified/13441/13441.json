{
  "repo": "ClickHouse/ClickHouse",
  "pull_number": 13441,
  "instance_id": "ClickHouse__ClickHouse-13441",
  "issue_numbers": [
    "13362"
  ],
  "base_commit": "dcfadac00a41521b0c8c59f0fdcfb3389018cf96",
  "patch": "diff --git a/src/Common/BitHelpers.h b/src/Common/BitHelpers.h\nindex 639a0c026ff5..699e379b8d36 100644\n--- a/src/Common/BitHelpers.h\n+++ b/src/Common/BitHelpers.h\n@@ -1,6 +1,7 @@\n #pragma once\n \n #include <cstddef>\n+#include <cassert>\n #include <type_traits>\n #include <common/defines.h>\n \n@@ -11,6 +12,7 @@\n   */\n inline unsigned int bitScanReverse(unsigned int x)\n {\n+    assert(x != 0);\n     return sizeof(unsigned int) * 8 - 1 - __builtin_clz(x);\n }\n \ndiff --git a/src/IO/parseDateTimeBestEffort.cpp b/src/IO/parseDateTimeBestEffort.cpp\nindex c350bd1ddc17..d84ac76b1641 100644\n--- a/src/IO/parseDateTimeBestEffort.cpp\n+++ b/src/IO/parseDateTimeBestEffort.cpp\n@@ -104,6 +104,7 @@ ReturnType parseDateTimeBestEffortImpl(\n             return false;\n     };\n \n+    res = 0;\n     UInt16 year = 0;\n     UInt8 month = 0;\n     UInt8 day_of_month = 0;\n",
  "test_patch": "diff --git a/tests/queries/0_stateless/01432_parse_date_time_best_effort_timestamp.reference b/tests/queries/0_stateless/01432_parse_date_time_best_effort_timestamp.reference\nnew file mode 100644\nindex 000000000000..36cee487d548\n--- /dev/null\n+++ b/tests/queries/0_stateless/01432_parse_date_time_best_effort_timestamp.reference\n@@ -0,0 +1,3 @@\n+2020-08-07 01:29:00\n+1973-03-03 12:46:40\n+2020-08-07 00:00:00\ndiff --git a/tests/queries/0_stateless/01432_parse_date_time_best_effort_timestamp.sql b/tests/queries/0_stateless/01432_parse_date_time_best_effort_timestamp.sql\nnew file mode 100644\nindex 000000000000..071fefe04035\n--- /dev/null\n+++ b/tests/queries/0_stateless/01432_parse_date_time_best_effort_timestamp.sql\n@@ -0,0 +1,3 @@\n+SELECT parseDateTimeBestEffort('1596752940', 'Europe/Moscow');\n+SELECT parseDateTimeBestEffort('100000000', 'Europe/Moscow');\n+SELECT parseDateTimeBestEffort('20200807', 'Europe/Moscow');\n",
  "problem_statement": "parseDateTime64BestEffort can not parse timestamp correct\n(you don't have to strictly follow this form)\r\n\r\ni use parseDateTime64BestEffort function to parse string to datetime.\r\ni have met a stranger situation.\r\nwhen i use : \r\n```\r\nselect parseDateTime64BestEffortOrNull('1596538462') from test_file_1_tmp limit 1;\r\n```\r\nresult:\r\n```\r\n 2020-08-04 18:55:26.000\r\n```\r\nwhen i use \uff1a\r\n```\r\nselect parseDateTime64BestEffortOrNull(time) , time from test_file_1_tmp ;\r\n```\r\nresult:\r\n```\r\n\u2502               2020-07-18 10:00:00.000 \u2502 2020-07-18 10:00    \u2502\r\n\u2502               2020-01-01 00:00:00.000 \u2502 2020                \u2502\r\n\u2502               2020-08-01 00:00:00.000 \u2502 202008              \u2502\r\n\u2502               2020-09-01 00:00:00.000 \u2502 2020-09             \u2502\r\n\u2502               2020-10-01 00:00:00.000 \u2502 2020/10             \u2502\r\n\u2502               2020-11-01 00:00:00.000 \u2502 20201101            \u2502\r\n\u2502               2020-12-01 00:00:00.000 \u2502 2020-12-01          \u2502\r\n\u2502               2020-02-01 00:00:00.000 \u2502 2020/02/01          \u2502\r\n\u2502                                  \u1d3a\u1d41\u1d38\u1d38 \u2502 202003012200        \u2502\r\n\u2502               2020-07-28 22:00:00.000 \u2502 2020/07/28 22:00    \u2502\r\n\u2502               2020-04-01 22:00:55.000 \u2502 20200401220055      \u2502\r\n\u2502               2020-07-28 22:00:22.000 \u2502 2020/07/28 22:00:22 \u2502\r\n\u2502               2020-07-18 10:00:22.000 \u2502 2020-07-18 10:00:22 \u2502\r\n**\u2502               2071-02-19 20:54:44.000 \u2502 **1596538462**          \u2502**\r\n```\r\n\r\nthe function `parseDateTime64BestEffortOrNull` show different result in two querys.\r\nhow can i get the correct result of  `parseDateTime64BestEffortOrNull('1596538462')` ?\n",
  "hints_text": "",
  "created_at": "2020-08-06T23:54:52Z"
}