{
  "repo": "ClickHouse/ClickHouse",
  "pull_number": 49645,
  "instance_id": "ClickHouse__ClickHouse-49645",
  "issue_numbers": [
    "29039"
  ],
  "base_commit": "0830153a526e5f4582ceaf6cc5e61784dba7f0cc",
  "patch": "diff --git a/base/base/wide_integer_impl.h b/base/base/wide_integer_impl.h\nindex ed4570d5e3f1..4a80c176829e 100644\n--- a/base/base/wide_integer_impl.h\n+++ b/base/base/wide_integer_impl.h\n@@ -314,7 +314,14 @@ struct integer<Bits, Signed>::_impl\n \n         const T alpha = t / static_cast<T>(max_int);\n \n-        if (alpha <= static_cast<T>(max_int))\n+        /** Here we have to use strict comparison.\n+          * The max_int is 2^64 - 1.\n+          * When casted to floating point type, it will be rounded to the closest representable number,\n+          * which is 2^64.\n+          * But 2^64 is not representable in uint64_t,\n+          * so the maximum representable number will be strictly less.\n+          */\n+        if (alpha < static_cast<T>(max_int))\n             self = static_cast<uint64_t>(alpha);\n         else // max(double) / 2^64 will surely contain less than 52 precision bits, so speed up computations.\n             set_multiplier<double>(self, static_cast<double>(alpha));\n",
  "test_patch": "diff --git a/tests/queries/0_stateless/02734_big_int_from_float_ubsan.reference b/tests/queries/0_stateless/02734_big_int_from_float_ubsan.reference\nnew file mode 100644\nindex 000000000000..9972842f9827\n--- /dev/null\n+++ b/tests/queries/0_stateless/02734_big_int_from_float_ubsan.reference\n@@ -0,0 +1,1 @@\n+1\t1\ndiff --git a/tests/queries/0_stateless/02734_big_int_from_float_ubsan.sql b/tests/queries/0_stateless/02734_big_int_from_float_ubsan.sql\nnew file mode 100644\nindex 000000000000..9fbf54c1a4d1\n--- /dev/null\n+++ b/tests/queries/0_stateless/02734_big_int_from_float_ubsan.sql\n@@ -0,0 +1,9 @@\n+WITH\n+    18 AS precision,\n+    toUInt256(-1) AS int,\n+    toUInt256(toFloat64(int)) AS converted,\n+    toString(int) AS int_str,\n+    toString(converted) AS converted_str\n+SELECT\n+    length(int_str) = length(converted_str) AS have_same_length,\n+    substring(int_str, 1, precision) = substring(converted_str, 1, precision) AS have_same_prefix\n",
  "problem_statement": "../base/common/../common/wide_integer_impl.h:279:42: runtime error: 1.84467e+19 is outside the range of representable values of type 'unsigned long'\nhttps://clickhouse-test-reports.s3.yandex.net/28817/4993c7c527e82540694c1c1771b528cf17903f0a/fuzzer_ubsan/report.html#fail1\r\n```\r\n../base/common/../common/wide_integer_impl.h:279:42: runtime error: 1.84467e+19 is outside the range of representable values of type 'unsigned long'\r\n    #0 0x10f55a67 in void wide::integer<256ul, unsigned int>::_impl::set_multiplier<double>(wide::integer<256ul, unsigned int>&, double) (/workspace/clickhouse+0x10f55a67)\r\n    #1 0x10f55842 in void wide::integer<256ul, unsigned int>::_impl::set_multiplier<double>(wide::integer<256ul, unsigned int>&, double) (/workspace/clickhouse+0x10f55842)\r\n    #2 0x10f55555 in void wide::integer<256ul, unsigned int>::_impl::set_multiplier<long double>(wide::integer<256ul, unsigned int>&, long double) (/workspace/clickhouse+0x10f55555)\r\n    #3 0x10f55446 in wide::integer<256ul, unsigned int>::_impl::wide_integer_from_builtin(wide::integer<256ul, unsigned int>&, double) (/workspace/clickhouse+0x10f55446)\r\n    #4 0x10f600ad in COW<DB::IColumn>::immutable_ptr<DB::IColumn> DB::ConvertImpl<DB::DataTypeNumber<double>, DB::DataTypeNumber<wide::integer<256ul, unsigned int> >, DB::NameToUInt256, DB::ConvertDefaultBehaviorTag>::execute<void*>(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName> > const&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long, void*) (/workspace/clickhouse+0x10f600ad)\r\n    #5 0x10f5bcfb in bool DB::FunctionConvert<DB::DataTypeNumber<wide::integer<256ul, unsigned int> >, DB::NameToUInt256, DB::ToNumberMonotonicity<wide::integer<256ul, unsigned int> > >::executeInternal(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName> > const&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long) const::'lambda'(auto const&, auto const&)::operator()<DB::TypePair<DB::DataTypeNumber<double>, DB::DataTypeNumber<wide::integer<256ul, unsigned int> > >, DB::ConvertDefaultBehaviorTag>(auto const&, auto const&) const (/workspace/clickhouse+0x10f5bcfb)\r\n    #6 0x10f4f966 in bool DB::callOnIndexAndDataType<DB::DataTypeNumber<wide::integer<256ul, unsigned int> >, DB::FunctionConvert<DB::DataTypeNumber<wide::integer<256ul, unsigned int> >, DB::NameToUInt256, DB::ToNumberMonotonicity<wide::integer<256ul, unsigned int> > >::executeInternal(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName> > const&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long) const::'lambda'(auto const&, auto const&)&, DB::ConvertDefaultBehaviorTag>(DB::TypeIndex, auto&&, DB::ConvertDefaultBehaviorTag&&) (/workspace/clickhouse+0x10f4f966)\r\n    #7 0x10f4f20b in DB::FunctionConvert<DB::DataTypeNumber<wide::integer<256ul, unsigned int> >, DB::NameToUInt256, DB::ToNumberMonotonicity<wide::integer<256ul, unsigned int> > >::executeInternal(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName> > const&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long) const (/workspace/clickhouse+0x10f4f20b)\r\n    #8 0x10f4df62 in DB::FunctionConvert<DB::DataTypeNumber<wide::integer<256ul, unsigned int> >, DB::NameToUInt256, DB::ToNumberMonotonicity<wide::integer<256ul, unsigned int> > >::executeImpl(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName> > const&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long) const (/workspace/clickhouse+0x10f4df62)\r\n    #9 0x10cfb76f in DB::FunctionToExecutableFunctionAdaptor::executeImpl(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName> > const&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long) const (/workspace/clickhouse+0x10cfb76f)\r\n    #10 0x1a4eea74 in DB::IExecutableFunction::executeWithoutLowCardinalityColumns(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName> > const&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long, bool) const obj-x86_64-linux-gnu/../src/Functions/IFunction.cpp:217:15\r\n    #11 0x1a4ef7eb in DB::IExecutableFunction::execute(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName> > const&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long, bool) const obj-x86_64-linux-gnu/../src/Functions/IFunction.cpp:260:22\r\n    #12 0x1ac4340d in DB::executeAction(DB::ExpressionActions::Action const&, DB::(anonymous namespace)::ExecutionContext&, bool) obj-x86_64-linux-gnu/../src/Interpreters/ExpressionActions.cpp:601:60\r\n    #13 0x1ac414c1 in DB::ExpressionActions::execute(DB::Block&, unsigned long&, bool) const obj-x86_64-linux-gnu/../src/Interpreters/ExpressionActions.cpp:718:13\r\n    #14 0x1c45d7e5 in DB::ExpressionTransform::transform(DB::Chunk&) obj-x86_64-linux-gnu/../src/Processors/Transforms/ExpressionTransform.cpp:23:17\r\n    #15 0x170688ca in DB::ISimpleTransform::transform(DB::Chunk&, DB::Chunk&) obj-x86_64-linux-gnu/../src/Processors/ISimpleTransform.h:42:9\r\n    #16 0x1c1636ac in DB::ISimpleTransform::work() obj-x86_64-linux-gnu/../src/Processors/ISimpleTransform.cpp:89:9\r\n    #17 0x1c1b18f8 in DB::executeJob(DB::IProcessor*) obj-x86_64-linux-gnu/../src/Processors/Executors/PipelineExecutor.cpp:88:20\r\n    #18 0x1c1b17e6 in DB::PipelineExecutor::addJob(DB::ExecutingGraph::Node*)::$_0::operator()() const obj-x86_64-linux-gnu/../src/Processors/Executors/PipelineExecutor.cpp:105:13\r\n    #19 0x1c1b17e6 in decltype(std::__1::forward<DB::PipelineExecutor::addJob(DB::ExecutingGraph::Node*)::$_0&>(fp)()) std::__1::__invoke<DB::PipelineExecutor::addJob(DB::ExecutingGraph::Node*)::$_0&>(DB::PipelineExecutor::addJob(DB::ExecutingGraph::Node*)::$_0&) obj-x86_64-linux-gnu/../contrib/libcxx/include/type_traits:3676:1\r\n    #20 0x1c1afd87 in std::__1::__function::__policy_func<void ()>::operator()() const obj-x86_64-linux-gnu/../contrib/libcxx/include/functional:2221:16\r\n    #21 0x1c1afd87 in std::__1::function<void ()>::operator()() const obj-x86_64-linux-gnu/../contrib/libcxx/include/functional:2560:12\r\n    #22 0x1c1afd87 in DB::PipelineExecutor::executeStepImpl(unsigned long, unsigned long, std::__1::atomic<bool>*) obj-x86_64-linux-gnu/../src/Processors/Executors/PipelineExecutor.cpp:597:17\r\n    #23 0x1c1ae747 in DB::PipelineExecutor::executeSingleThread(unsigned long, unsigned long) obj-x86_64-linux-gnu/../src/Processors/Executors/PipelineExecutor.cpp:485:5\r\n    #24 0x1c1ae747 in DB::PipelineExecutor::executeImpl(unsigned long) obj-x86_64-linux-gnu/../src/Processors/Executors/PipelineExecutor.cpp:824:9\r\n    #25 0x1c1ae13c in DB::PipelineExecutor::execute(unsigned long) obj-x86_64-linux-gnu/../src/Processors/Executors/PipelineExecutor.cpp:407:9\r\n    #26 0x1c1be966 in DB::threadFunction(DB::PullingAsyncPipelineExecutor::Data&, std::__1::shared_ptr<DB::ThreadGroupStatus>, unsigned long) obj-x86_64-linux-gnu/../src/Processors/Executors/PullingAsyncPipelineExecutor.cpp:80:24\r\n    #27 0x1c1be8d3 in DB::PullingAsyncPipelineExecutor::pull(DB::Chunk&, unsigned long)::$_0::operator()() const obj-x86_64-linux-gnu/../src/Processors/Executors/PullingAsyncPipelineExecutor.cpp:107:13\r\n    #28 0x1c1be8d3 in decltype(std::__1::forward<DB::PullingAsyncPipelineExecutor::pull(DB::Chunk&, unsigned long)::$_0&>(fp)()) std::__1::__invoke_constexpr<DB::PullingAsyncPipelineExecutor::pull(DB::Chunk&, unsigned long)::$_0&>(DB::PullingAsyncPipelineExecutor::pull(DB::Chunk&, unsigned long)::$_0&) obj-x86_64-linux-gnu/../contrib/libcxx/include/type_traits:3682:1\r\n    #29 0x1c1be75a in decltype(auto) std::__1::__apply_tuple_impl<DB::PullingAsyncPipelineExecutor::pull(DB::Chunk&, unsigned long)::$_0&, std::__1::tuple<>&>(DB::PullingAsyncPipelineExecutor::pull(DB::Chunk&, unsigned long)::$_0&, std::__1::tuple<>&, std::__1::__tuple_indices<>) obj-x86_64-linux-gnu/../contrib/libcxx/include/tuple:1415:1\r\n    #30 0x1c1be75a in decltype(auto) std::__1::apply<DB::PullingAsyncPipelineExecutor::pull(DB::Chunk&, unsigned long)::$_0&, std::__1::tuple<>&>(DB::PullingAsyncPipelineExecutor::pull(DB::Chunk&, unsigned long)::$_0&, std::__1::tuple<>&) obj-x86_64-linux-gnu/../contrib/libcxx/include/tuple:1424:1\r\n    #31 0x1c1be75a in ThreadFromGlobalPool::ThreadFromGlobalPool<DB::PullingAsyncPipelineExecutor::pull(DB::Chunk&, unsigned long)::$_0>(DB::PullingAsyncPipelineExecutor::pull(DB::Chunk&, unsigned long)::$_0&&)::'lambda'()::operator()() obj-x86_64-linux-gnu/../src/Common/ThreadPool.h:188:13\r\n    #32 0x1c1be75a in decltype(std::__1::forward<DB::PullingAsyncPipelineExecutor::pull(DB::Chunk&, unsigned long)::$_0>(fp)()) std::__1::__invoke<ThreadFromGlobalPool::ThreadFromGlobalPool<DB::PullingAsyncPipelineExecutor::pull(DB::Chunk&, unsigned long)::$_0>(DB::PullingAsyncPipelineExecutor::pull(DB::Chunk&, unsigned long)::$_0&&)::'lambda'()&>(DB::PullingAsyncPipelineExecutor::pull(DB::Chunk&, unsigned long)::$_0&&) obj-x86_64-linux-gnu/../contrib/libcxx/include/type_traits:3676:1\r\n    #33 0xc6b0559 in std::__1::__function::__policy_func<void ()>::operator()() const obj-x86_64-linux-gnu/../contrib/libcxx/include/functional:2221:16\r\n    #34 0xc6b0559 in std::__1::function<void ()>::operator()() const obj-x86_64-linux-gnu/../contrib/libcxx/include/functional:2560:12\r\n    #35 0xc6b0559 in ThreadPoolImpl<std::__1::thread>::worker(std::__1::__list_iterator<std::__1::thread, void*>) obj-x86_64-linux-gnu/../src/Common/ThreadPool.cpp:273:17\r\n    #36 0xc6b2f61 in void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, int, std::__1::optional<unsigned long>)::'lambda0'()::operator()() const obj-x86_64-linux-gnu/../src/Common/ThreadPool.cpp:138:73\r\n    #37 0xc6b2f61 in decltype(std::__1::forward<void>(fp)()) std::__1::__invoke<void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, int, std::__1::optional<unsigned long>)::'lambda0'()>(void&&) obj-x86_64-linux-gnu/../contrib/libcxx/include/type_traits:3676:1\r\n    #38 0xc6b2f61 in void std::__1::__thread_execute<std::__1::unique_ptr<std::__1::__thread_struct, std::__1::default_delete<std::__1::__thread_struct> >, void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, int, std::__1::optional<unsigned long>)::'lambda0'()>(std::__1::tuple<void, void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, int, std::__1::optional<unsigned long>)::'lambda0'()>&, std::__1::__tuple_indices<>) obj-x86_64-linux-gnu/../contrib/libcxx/include/thread:280:5\r\n    #39 0xc6b2f61 in void* std::__1::__thread_proxy<std::__1::tuple<std::__1::unique_ptr<std::__1::__thread_struct, std::__1::default_delete<std::__1::__thread_struct> >, void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, int, std::__1::optional<unsigned long>)::'lambda0'()> >(void*) obj-x86_64-linux-gnu/../contrib/libcxx/include/thread:291:5\r\n    #40 0x7fdd2014c608 in start_thread /build/glibc-eX1tMB/glibc-2.31/nptl/pthread_create.c:477:8\r\n    #41 0x7fdd20073292 in __clone /build/glibc-eX1tMB/glibc-2.31/misc/../sysdeps/unix/sysv/linux/x86_64/clone.S:95\r\n\r\nSUMMARY: UndefinedBehaviorSanitizer: undefined-behavior ../base/common/../common/wide_integer_impl.h:279:42 in \r\n```\n",
  "hints_text": "You forgot to attach the info about the query.\nhttps://s3.amazonaws.com/clickhouse-test-reports/41044/63e992d52d3e71fc8e3491a995732e68c9be204f/fuzzer_astfuzzerubsan//report.html\r\n\r\nQuery:\r\n```\r\nselect toInt256(1.157920892373162e77)\r\n```\r\n\r\nStacktrace:\r\n```\r\n../base/base/../base/wide_integer_impl.h:304:42: runtime error: 1.84467e+19 is outside the range of representable values of type 'unsigned long'\r\n    #0 0x15df42c8 in void wide::integer<256ul, unsigned int>::_impl::set_multiplier<double>(wide::integer<256ul, unsigned int>&, double) (/workspace/clickhouse+0x15df42c8) (BuildId: b0085efb20fb57a62ad7dc6af9073342dd6ebb19)\r\n    #1 0x15df40a2 in void wide::integer<256ul, unsigned int>::_impl::set_multiplier<double>(wide::integer<256ul, unsigned int>&, double) (/workspace/clickhouse+0x15df40a2) (BuildId: b0085efb20fb57a62ad7dc6af9073342dd6ebb19)\r\n    #2 0x15df3db5 in void wide::integer<256ul, unsigned int>::_impl::set_multiplier<long double>(wide::integer<256ul, unsigned int>&, long double) (/workspace/clickhouse+0x15df3db5) (BuildId: b0085efb20fb57a62ad7dc6af9073342dd6ebb19)\r\n    #3 0x15df3cac in wide::integer<256ul, unsigned int>::_impl::wide_integer_from_builtin(wide::integer<256ul, unsigned int>&, double) (/workspace/clickhouse+0x15df3cac) (BuildId: b0085efb20fb57a62ad7dc6af9073342dd6ebb19)\r\n    #4 0x15e001ad in COW<DB::IColumn>::immutable_ptr<DB::IColumn> DB::ConvertImpl<DB::DataTypeNumber<double>, DB::DataTypeNumber<wide::integer<256ul, unsigned int> >, DB::NameToUInt256, DB::ConvertDefaultBehaviorTag>::execute<void*>(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName> > const&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long, void*) (/workspace/clickhouse+0x15e001ad) (BuildId: b0085efb20fb57a62ad7dc6af9073342dd6ebb19)\r\n    #5 0x15dfaec3 in bool DB::FunctionConvert<DB::DataTypeNumber<wide::integer<256ul, unsigned int> >, DB::NameToUInt256, DB::ToNumberMonotonicity<wide::integer<256ul, unsigned int> > >::executeInternal(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName> > const&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long) const::'lambda'(auto const&, auto const&)::operator()<DB::TypePair<DB::DataTypeNumber<double>, DB::DataTypeNumber<wide::integer<256ul, unsigned int> > >, DB::ConvertDefaultBehaviorTag>(auto const&, auto const&) const (/workspace/clickhouse+0x15dfaec3) (BuildId: b0085efb20fb57a62ad7dc6af9073342dd6ebb19)\r\n    #6 0x15decfe6 in bool DB::callOnIndexAndDataType<DB::DataTypeNumber<wide::integer<256ul, unsigned int> >, DB::FunctionConvert<DB::DataTypeNumber<wide::integer<256ul, unsigned int> >, DB::NameToUInt256, DB::ToNumberMonotonicity<wide::integer<256ul, unsigned int> > >::executeInternal(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName> > const&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long) const::'lambda'(auto const&, auto const&)&, DB::ConvertDefaultBehaviorTag>(DB::TypeIndex, auto&&, DB::ConvertDefaultBehaviorTag&&) (/workspace/clickhouse+0x15decfe6) (BuildId: b0085efb20fb57a62ad7dc6af9073342dd6ebb19)\r\n    #7 0x15dec875 in DB::FunctionConvert<DB::DataTypeNumber<wide::integer<256ul, unsigned int> >, DB::NameToUInt256, DB::ToNumberMonotonicity<wide::integer<256ul, unsigned int> > >::executeInternal(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName> > const&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long) const (/workspace/clickhouse+0x15dec875) (BuildId: b0085efb20fb57a62ad7dc6af9073342dd6ebb19)\r\n    #8 0x15deb522 in DB::FunctionConvert<DB::DataTypeNumber<wide::integer<256ul, unsigned int> >, DB::NameToUInt256, DB::ToNumberMonotonicity<wide::integer<256ul, unsigned int> > >::executeImpl(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName> > const&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long) const (/workspace/clickhouse+0x15deb522) (BuildId: b0085efb20fb57a62ad7dc6af9073342dd6ebb19)\r\n    #9 0x15c91585 in DB::FunctionToExecutableFunctionAdaptor::executeImpl(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName> > const&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long) const (/workspace/clickhouse+0x15c91585) (BuildId: b0085efb20fb57a62ad7dc6af9073342dd6ebb19)\r\n    #10 0x2451e2a8 in DB::IExecutableFunction::executeWithoutLowCardinalityColumns(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName> > const&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long, bool) const build_docker/../src/Functions/IFunction.cpp:248:15\r\n    #11 0x2451f32c in DB::IExecutableFunction::executeWithoutSparseColumns(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName> > const&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long, bool) const build_docker/../src/Functions/IFunction.cpp:302:22\r\n    #12 0x24520fca in DB::IExecutableFunction::execute(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName> > const&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long, bool) const build_docker/../src/Functions/IFunction.cpp:372:16\r\n    #13 0x252c38d7 in DB::executeAction(DB::ExpressionActions::Action const&, DB::(anonymous namespace)::ExecutionContext&, bool) build_docker/../src/Interpreters/ExpressionActions.cpp:607:60\r\n    #14 0x252c1736 in DB::ExpressionActions::execute(DB::Block&, unsigned long&, bool) const build_docker/../src/Interpreters/ExpressionActions.cpp:724:13\r\n    #15 0x274fbb47 in DB::ExpressionTransform::transform(DB::Chunk&) build_docker/../src/Processors/Transforms/ExpressionTransform.cpp:23:17\r\n    #16 0x1fce672a in DB::ISimpleTransform::transform(DB::Chunk&, DB::Chunk&) build_docker/../src/Processors/ISimpleTransform.h:32:9\r\n    #17 0x270fe99a in DB::ISimpleTransform::work() build_docker/../src/Processors/ISimpleTransform.cpp:89:9\r\n    #18 0x27129984 in DB::executeJob(DB::ExecutingGraph::Node*, DB::ReadProgressCallback*) build_docker/../src/Processors/Executors/ExecutionThreadContext.cpp:47:26\r\n    #19 0x271294eb in DB::ExecutionThreadContext::executeTask() build_docker/../src/Processors/Executors/ExecutionThreadContext.cpp:92:9\r\n    #20 0x2711959a in DB::PipelineExecutor::executeStepImpl(unsigned long, std::__1::atomic<bool>*) build_docker/../src/Processors/Executors/PipelineExecutor.cpp:228:26\r\n    #21 0x27118dd4 in DB::PipelineExecutor::executeSingleThread(unsigned long) build_docker/../src/Processors/Executors/PipelineExecutor.cpp:194:5\r\n    #22 0x27118dd4 in DB::PipelineExecutor::executeImpl(unsigned long) build_docker/../src/Processors/Executors/PipelineExecutor.cpp:367:9\r\n    #23 0x27118b89 in DB::PipelineExecutor::execute(unsigned long) build_docker/../src/Processors/Executors/PipelineExecutor.cpp:89:9\r\n    #24 0x2712e322 in DB::threadFunction(DB::PullingAsyncPipelineExecutor::Data&, std::__1::shared_ptr<DB::ThreadGroupStatus>, unsigned long) build_docker/../src/Processors/Executors/PullingAsyncPipelineExecutor.cpp:79:24\r\n    #25 0x2712e286 in DB::PullingAsyncPipelineExecutor::pull(DB::Chunk&, unsigned long)::$_0::operator()() const build_docker/../src/Processors/Executors/PullingAsyncPipelineExecutor.cpp:107:13\r\n    #26 0x2712e286 in decltype(static_cast<DB::PullingAsyncPipelineExecutor::pull(DB::Chunk&, unsigned long)::$_0&>(fp)()) std::__1::__invoke_constexpr<DB::PullingAsyncPipelineExecutor::pull(DB::Chunk&, unsigned long)::$_0&>(DB::PullingAsyncPipelineExecutor::pull(DB::Chunk&, unsigned long)::$_0&) build_docker/../contrib/libcxx/include/type_traits:3648:23\r\n    #27 0x2712e149 in decltype(auto) std::__1::__apply_tuple_impl<DB::PullingAsyncPipelineExecutor::pull(DB::Chunk&, unsigned long)::$_0&, std::__1::tuple<>&>(DB::PullingAsyncPipelineExecutor::pull(DB::Chunk&, unsigned long)::$_0&, std::__1::tuple<>&, std::__1::__tuple_indices<>) build_docker/../contrib/libcxx/include/tuple:1595:1\r\n    #28 0x2712e149 in decltype(auto) std::__1::apply<DB::PullingAsyncPipelineExecutor::pull(DB::Chunk&, unsigned long)::$_0&, std::__1::tuple<>&>(DB::PullingAsyncPipelineExecutor::pull(DB::Chunk&, unsigned long)::$_0&, std::__1::tuple<>&) build_docker/../contrib/libcxx/include/tuple:1604:1\r\n    #29 0x2712e149 in ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::PullingAsyncPipelineExecutor::pull(DB::Chunk&, unsigned long)::$_0>(DB::PullingAsyncPipelineExecutor::pull(DB::Chunk&, unsigned long)::$_0&&)::'lambda'()::operator()() build_docker/../src/Common/ThreadPool.h:193:13\r\n    #30 0x2712e149 in decltype(static_cast<DB::PullingAsyncPipelineExecutor::pull(DB::Chunk&, unsigned long)::$_0>(fp)()) std::__1::__invoke<ThreadFromGlobalPoolImpl<true>::ThreadFromGlobalPoolImpl<DB::PullingAsyncPipelineExecutor::pull(DB::Chunk&, unsigned long)::$_0>(DB::PullingAsyncPipelineExecutor::pull(DB::Chunk&, unsigned long)::$_0&&)::'lambda'()&>(DB::PullingAsyncPipelineExecutor::pull(DB::Chunk&, unsigned long)::$_0&&) build_docker/../contrib/libcxx/include/type_traits:3640:23\r\n    #31 0x103f3612 in std::__1::__function::__policy_func<void ()>::operator()() const build_docker/../contrib/libcxx/include/__functional/function.h:843:16\r\n    #32 0x103f3612 in std::__1::function<void ()>::operator()() const build_docker/../contrib/libcxx/include/__functional/function.h:1184:12\r\n    #33 0x103f3612 in ThreadPoolImpl<std::__1::thread>::worker(std::__1::__list_iterator<std::__1::thread, void*>) build_docker/../src/Common/ThreadPool.cpp:294:17\r\n    #34 0x103f6ee2 in void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, int, std::__1::optional<unsigned long>, bool)::'lambda0'()::operator()() const build_docker/../src/Common/ThreadPool.cpp:144:73\r\n    #35 0x103f6ee2 in decltype(static_cast<void>(fp)()) std::__1::__invoke<void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, int, std::__1::optional<unsigned long>, bool)::'lambda0'()>(void&&) build_docker/../contrib/libcxx/include/type_traits:3640:23\r\n    #36 0x103f6ee2 in void std::__1::__thread_execute<std::__1::unique_ptr<std::__1::__thread_struct, std::__1::default_delete<std::__1::__thread_struct> >, void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, int, std::__1::optional<unsigned long>, bool)::'lambda0'()>(std::__1::tuple<void, void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, int, std::__1::optional<unsigned long>, bool)::'lambda0'()>&, std::__1::__tuple_indices<>) build_docker/../contrib/libcxx/include/thread:282:5\r\n    #37 0x103f6ee2 in void* std::__1::__thread_proxy<std::__1::tuple<std::__1::unique_ptr<std::__1::__thread_struct, std::__1::default_delete<std::__1::__thread_struct> >, void ThreadPoolImpl<std::__1::thread>::scheduleImpl<void>(std::__1::function<void ()>, int, std::__1::optional<unsigned long>, bool)::'lambda0'()> >(void*) build_docker/../contrib/libcxx/include/thread:293:5\r\n    #38 0x7f44d82de608 in start_thread /build/glibc-SzIz7B/glibc-2.31/nptl/pthread_create.c:477:8\r\n    #39 0x7f44d8203132 in __clone /build/glibc-SzIz7B/glibc-2.31/misc/../sysdeps/unix/sysv/linux/x86_64/clone.S:95\r\n\r\n```\nGreat, now we have the query, but nothing stops us from waiting one more year and closing this issue again with no resolution and a comment like \"the report is too old and have not been reproduced for a long time, probably it was fixed somewhere\" :)",
  "created_at": "2023-05-08T02:14:01Z"
}