{
  "repo": "ClickHouse/ClickHouse",
  "pull_number": 31820,
  "instance_id": "ClickHouse__ClickHouse-31820",
  "issue_numbers": [
    "30856"
  ],
  "base_commit": "71ae890c597ac378db122f71c0a4ccf411af3bad",
  "patch": "diff --git a/src/Interpreters/UserDefinedSQLFunctionVisitor.cpp b/src/Interpreters/UserDefinedSQLFunctionVisitor.cpp\nindex d9ac53097ab1..3e82930af9d1 100644\n--- a/src/Interpreters/UserDefinedSQLFunctionVisitor.cpp\n+++ b/src/Interpreters/UserDefinedSQLFunctionVisitor.cpp\n@@ -1,6 +1,7 @@\n #include \"UserDefinedSQLFunctionVisitor.h\"\n \n #include <unordered_map>\n+#include <unordered_set>\n #include <stack>\n \n #include <Parsers/ASTFunction.h>\n@@ -18,19 +19,16 @@ namespace ErrorCodes\n     extern const int UNSUPPORTED_METHOD;\n }\n \n-void UserDefinedSQLFunctionMatcher::visit(ASTPtr & ast, Data & data)\n+void UserDefinedSQLFunctionMatcher::visit(ASTPtr & ast, Data &)\n {\n     auto * function = ast->as<ASTFunction>();\n     if (!function)\n         return;\n \n-    auto result = tryToReplaceFunction(*function);\n-\n-    if (result)\n-    {\n-        ast = result;\n-        visit(ast, data);\n-    }\n+    std::unordered_set<std::string> udf_in_replace_process;\n+    auto replace_result = tryToReplaceFunction(*function, udf_in_replace_process);\n+    if (replace_result)\n+        ast = replace_result;\n }\n \n bool UserDefinedSQLFunctionMatcher::needChildVisit(const ASTPtr &, const ASTPtr &)\n@@ -38,8 +36,13 @@ bool UserDefinedSQLFunctionMatcher::needChildVisit(const ASTPtr &, const ASTPtr\n     return true;\n }\n \n-ASTPtr UserDefinedSQLFunctionMatcher::tryToReplaceFunction(const ASTFunction & function)\n+ASTPtr UserDefinedSQLFunctionMatcher::tryToReplaceFunction(const ASTFunction & function, std::unordered_set<std::string> & udf_in_replace_process)\n {\n+    if (udf_in_replace_process.find(function.name) != udf_in_replace_process.end())\n+        throw Exception(ErrorCodes::UNSUPPORTED_METHOD,\n+            \"Recursive function call detected during function call {}\",\n+            function.name);\n+\n     auto user_defined_function = UserDefinedSQLFunctionFactory::instance().tryGet(function.name);\n     if (!user_defined_function)\n         return nullptr;\n@@ -71,10 +74,15 @@ ASTPtr UserDefinedSQLFunctionMatcher::tryToReplaceFunction(const ASTFunction & f\n         identifier_name_to_function_argument.emplace(identifier_name, function_argument);\n     }\n \n+    auto [it, _] = udf_in_replace_process.emplace(function.name);\n+\n     auto function_body_to_update = function_core_expression->children.at(1)->clone();\n \n+    auto expression_list = std::make_shared<ASTExpressionList>();\n+    expression_list->children.emplace_back(std::move(function_body_to_update));\n+\n     std::stack<ASTPtr> ast_nodes_to_update;\n-    ast_nodes_to_update.push(function_body_to_update);\n+    ast_nodes_to_update.push(expression_list);\n \n     while (!ast_nodes_to_update.empty())\n     {\n@@ -83,6 +91,13 @@ ASTPtr UserDefinedSQLFunctionMatcher::tryToReplaceFunction(const ASTFunction & f\n \n         for (auto & child : ast_node_to_update->children)\n         {\n+            if (auto * inner_function = child->as<ASTFunction>())\n+            {\n+                auto replace_result = tryToReplaceFunction(*inner_function, udf_in_replace_process);\n+                if (replace_result)\n+                    child = replace_result;\n+            }\n+\n             auto identifier_name_opt = tryGetIdentifierName(child);\n             if (identifier_name_opt)\n             {\n@@ -104,6 +119,10 @@ ASTPtr UserDefinedSQLFunctionMatcher::tryToReplaceFunction(const ASTFunction & f\n         }\n     }\n \n+    udf_in_replace_process.erase(it);\n+\n+    function_body_to_update = expression_list->children[0];\n+\n     auto function_alias = function.tryGetAlias();\n \n     if (!function_alias.empty())\ndiff --git a/src/Interpreters/UserDefinedSQLFunctionVisitor.h b/src/Interpreters/UserDefinedSQLFunctionVisitor.h\nindex 46f95f29ab90..686594c088f9 100644\n--- a/src/Interpreters/UserDefinedSQLFunctionVisitor.h\n+++ b/src/Interpreters/UserDefinedSQLFunctionVisitor.h\n@@ -34,7 +34,7 @@ class UserDefinedSQLFunctionMatcher\n private:\n     static void visit(ASTFunction & func, const Data & data);\n \n-    static ASTPtr tryToReplaceFunction(const ASTFunction & function);\n+    static ASTPtr tryToReplaceFunction(const ASTFunction & function, std::unordered_set<std::string> & udf_in_replace_process);\n \n };\n \n",
  "test_patch": "diff --git a/tests/queries/0_stateless/02125_recursive_sql_user_defined_functions.reference b/tests/queries/0_stateless/02125_recursive_sql_user_defined_functions.reference\nnew file mode 100644\nindex 000000000000..4792e70f3330\n--- /dev/null\n+++ b/tests/queries/0_stateless/02125_recursive_sql_user_defined_functions.reference\n@@ -0,0 +1,2 @@\n+2\n+3\ndiff --git a/tests/queries/0_stateless/02125_recursive_sql_user_defined_functions.sql b/tests/queries/0_stateless/02125_recursive_sql_user_defined_functions.sql\nnew file mode 100644\nindex 000000000000..1870521c2553\n--- /dev/null\n+++ b/tests/queries/0_stateless/02125_recursive_sql_user_defined_functions.sql\n@@ -0,0 +1,23 @@\n+-- Tags: no-parallel\n+\n+DROP FUNCTION IF EXISTS 02125_function;\n+CREATE FUNCTION 02125_function AS x -> 02125_function(x);\n+SELECT 02125_function(1); --{serverError 1};\n+DROP FUNCTION 02125_function;\n+\n+DROP FUNCTION IF EXISTS 02125_function_1;\n+CREATE FUNCTION 02125_function_1 AS x -> 02125_function_2(x);\n+\n+DROP FUNCTION IF EXISTS 02125_function_2;\n+CREATE FUNCTION 02125_function_2 AS x -> 02125_function_1(x);\n+\n+SELECT 02125_function_1(1); --{serverError 1};\n+SELECT 02125_function_2(2); --{serverError 1};\n+\n+CREATE OR REPLACE FUNCTION 02125_function_2 AS x -> x + 1;\n+\n+SELECT 02125_function_1(1);\n+SELECT 02125_function_2(2);\n+\n+DROP FUNCTION 02125_function_1;\n+DROP FUNCTION 02125_function_2;\ndiff --git a/tests/queries/0_stateless/02126_identity_user_defined_function.reference b/tests/queries/0_stateless/02126_identity_user_defined_function.reference\nnew file mode 100644\nindex 000000000000..26b37d07facf\n--- /dev/null\n+++ b/tests/queries/0_stateless/02126_identity_user_defined_function.reference\n@@ -0,0 +1,2 @@\n+1\n+5\ndiff --git a/tests/queries/0_stateless/02126_identity_user_defined_function.sql b/tests/queries/0_stateless/02126_identity_user_defined_function.sql\nnew file mode 100644\nindex 000000000000..a53c6e28a481\n--- /dev/null\n+++ b/tests/queries/0_stateless/02126_identity_user_defined_function.sql\n@@ -0,0 +1,14 @@\n+-- Tags: no-parallel\n+\n+DROP FUNCTION IF EXISTS 02126_function;\n+CREATE FUNCTION 02126_function AS x -> x;\n+SELECT 02126_function(1);\n+DROP FUNCTION 02126_function;\n+\n+CREATE FUNCTION 02126_function AS () -> x;\n+SELECT 02126_function(); --{ serverError 47 }\n+DROP FUNCTION 02126_function;\n+\n+CREATE FUNCTION 02126_function AS () -> 5;\n+SELECT 02126_function();\n+DROP FUNCTION 02126_function;\n",
  "problem_statement": "Segfault in recursive UDFs\n```\r\navtokmakov-dev.sas.yp-c.yandex.net :) create function f as x -> 1;\r\navtokmakov-dev.sas.yp-c.yandex.net :) create function g as x -> f(x);\r\navtokmakov-dev.sas.yp-c.yandex.net :) create or replace function f as x -> g(x);\r\n\r\navtokmakov-dev.sas.yp-c.yandex.net :) select f(1)\r\n\r\nSELECT f(1)\r\n\r\nQuery id: d73ee45a-36db-4809-bc4b-639298cbfdbb\r\n\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.130658 [ 25999 ] <Fatal> BaseDaemon: ########################################\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.130878 [ 25999 ] <Fatal> BaseDaemon: (version 21.11.1.8600 (official build), build id: 179ACA2B3FAC7AE9A7438EA7C9D1C0BCE98E392F) (from thread 25440) (query_id: d73ee45a-36db-4809-bc4b-639298cbfdbb) Received signal Segmentation fault (11)\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.131015 [ 25999 ] <Fatal> BaseDaemon: Address: 0x7fec1fbfff70 Access: write. Attempted access has violated the permissions assigned to the memory area.\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.131147 [ 25999 ] <Fatal> BaseDaemon: Stack trace: 0x98d4549 0x98d49c9 0x135a648b 0x135aae61 0x135ad778 0x135a7ee8 0x135a910d 0x1359fc8e 0x1359f819 0x135f1476 0x13584a9e 0x9895683 0x11c4f036 0x11c4ef8c 0x1110ef69 0x1110e963 0x1110e9c0 0x1110e9c0 0x1110e9c0 0x1110e9c0 0x1110e9c0 0x1110e9c0 0x1110e9c0 0x1110e9c0 0x1110e9c0 0x1110e9c0 0x1110e9c0 0x1110e9c0 0x1110e9c0 0x1110e9c0 0x1110e9c0 0x1110e9c0 0x1110e9c0 0x1110e9c0 0x1110e9c0 0x1110e9c0 0x1110e9c0 0x1110e9c0 0x1110e9c0 0x1110e9c0 0x1110e9c0 0x1110e9c0\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.135244 [ 25999 ] <Fatal> BaseDaemon: 3. /build/build_docker/../src/Common/ThreadFuzzer.cpp:190: DB::injection(double, double, double, double) @ 0x98d4549 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.138881 [ 25999 ] <Fatal> BaseDaemon: 4. /build/build_docker/../src/Common/ThreadFuzzer.cpp:293: pthread_mutex_unlock @ 0x98d49c9 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.140947 [ 25999 ] <Fatal> BaseDaemon: 5. /build/build_docker/../contrib/jemalloc/src/extent.c:185: extent_alloc @ 0x135a648b in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.144868 [ 25999 ] <Fatal> BaseDaemon: 6. /build/build_docker/../contrib/jemalloc/src/extent.c:2104: extent_split_impl @ 0x135aae61 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.147520 [ 25999 ] <Fatal> BaseDaemon: 7. /build/build_docker/../contrib/jemalloc/src/extent.c:1017: extent_split_interior @ 0x135ad778 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.149507 [ 25999 ] <Fatal> BaseDaemon: 8.1. inlined from /build/build_docker/../contrib/jemalloc/src/extent.c:1066: extent_recycle_split\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.149613 [ 25999 ] <Fatal> BaseDaemon: 8. ../contrib/jemalloc/src/extent.c:1148: extent_recycle @ 0x135a7ee8 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.153074 [ 25999 ] <Fatal> BaseDaemon: 9.1. inlined from /build/build_docker/../contrib/jemalloc/src/extent.c:1471: extent_alloc_retained\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.153160 [ 25999 ] <Fatal> BaseDaemon: 9. ../contrib/jemalloc/src/extent.c:1539: extent_alloc_wrapper @ 0x135a910d in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.155981 [ 25999 ] <Fatal> BaseDaemon: 10.1. inlined from /build/build_docker/../contrib/jemalloc/src/arena.c:1217: arena_slab_alloc_hard\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.156062 [ 25999 ] <Fatal> BaseDaemon: 10.2. inlined from ../contrib/jemalloc/src/arena.c:1247: arena_slab_alloc\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.156157 [ 25999 ] <Fatal> BaseDaemon: 10.3. inlined from ../contrib/jemalloc/src/arena.c:1283: arena_bin_nonfull_slab_get\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.156254 [ 25999 ] <Fatal> BaseDaemon: 10. ../contrib/jemalloc/src/arena.c:1319: arena_bin_malloc_hard @ 0x1359fc8e in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.158957 [ 25999 ] <Fatal> BaseDaemon: 11. /build/build_docker/../contrib/jemalloc/src/arena.c:1414: arena_tcache_fill_small @ 0x1359f819 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.160425 [ 25999 ] <Fatal> BaseDaemon: 12. /build/build_docker/../contrib/jemalloc/src/tcache.c:97: tcache_alloc_small_hard @ 0x135f1476 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.161478 [ 25999 ] <Fatal> BaseDaemon: 13.1. inlined from /build/build_docker/../contrib/jemalloc/include/jemalloc/internal/tcache_inlines.h:0: tcache_alloc_small\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.161559 [ 25999 ] <Fatal> BaseDaemon: 13.2. inlined from ../contrib/jemalloc/include/jemalloc/internal/arena_inlines_b.h:165: arena_malloc\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.161692 [ 25999 ] <Fatal> BaseDaemon: 13.3. inlined from ../contrib/jemalloc/include/jemalloc/internal/jemalloc_internal_inlines_c.h:53: iallocztm\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.161777 [ 25999 ] <Fatal> BaseDaemon: 13.4. inlined from ../contrib/jemalloc/src/jemalloc.c:1935: imalloc_no_sample\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.161878 [ 25999 ] <Fatal> BaseDaemon: 13.5. inlined from ../contrib/jemalloc/src/jemalloc.c:2135: imalloc_body\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.161979 [ 25999 ] <Fatal> BaseDaemon: 13.6. inlined from ../contrib/jemalloc/src/jemalloc.c:2244: imalloc\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.162065 [ 25999 ] <Fatal> BaseDaemon: 13. ../contrib/jemalloc/src/jemalloc.c:2275: malloc_default @ 0x13584a9e in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.162632 [ 25999 ] <Fatal> BaseDaemon: 14.1. inlined from /build/build_docker/../src/Common/memory.h:23: Memory::newImpl(unsigned long)\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.162712 [ 25999 ] <Fatal> BaseDaemon: 14. ../src/Common/new_delete.cpp:14: operator new(unsigned long) @ 0x9895683 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.170754 [ 25999 ] <Fatal> BaseDaemon: 15.1. inlined from /build/build_docker/../contrib/libcxx/include/new:235: void* std::__1::__libcpp_operator_new<unsigned long>(unsigned long)\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.170902 [ 25999 ] <Fatal> BaseDaemon: 15.2. inlined from ../contrib/libcxx/include/new:261: std::__1::__libcpp_allocate(unsigned long, unsigned long)\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.171005 [ 25999 ] <Fatal> BaseDaemon: 15.3. inlined from ../contrib/libcxx/include/memory:840: std::__1::allocator<std::__1::__shared_ptr_emplace<DB::ASTLiteral, std::__1::allocator<DB::ASTLiteral> > >::allocate(unsigned long)\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.171124 [ 25999 ] <Fatal> BaseDaemon: 15.4. inlined from ../contrib/libcxx/include/__memory/allocator_traits.h:468: std::__1::allocator_traits<std::__1::allocator<std::__1::__shared_ptr_emplace<DB::ASTLiteral, std::__1::allocator<DB::ASTLiteral> > > >::allocate(std::__1::allocator<std::__1::__shared_ptr_emplace<DB::ASTLiteral, std::__1::allocator<DB::ASTLiteral> > >&, unsigned long)\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.171234 [ 25999 ] <Fatal> BaseDaemon: 15.5. inlined from ../contrib/libcxx/include/__memory/utilities.h:56: __allocation_guard<std::__1::allocator<DB::ASTLiteral> >\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.171328 [ 25999 ] <Fatal> BaseDaemon: 15. ../contrib/libcxx/include/memory:3359: std::__1::shared_ptr<DB::ASTLiteral> std::__1::allocate_shared<DB::ASTLiteral, std::__1::allocator<DB::ASTLiteral>, DB::ASTLiteral const&, void>(std::__1::allocator<DB::ASTLiteral> const&, DB::ASTLiteral const&) @ 0x11c4f036 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.178244 [ 25999 ] <Fatal> BaseDaemon: 16. /build/build_docker/../src/Parsers/ASTLiteral.h:43: DB::ASTLiteral::clone() const @ 0x11c4ef8c in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.185052 [ 25999 ] <Fatal> BaseDaemon: 17.1. inlined from /build/build_docker/../contrib/libcxx/include/type_traits:3935: std::__1::enable_if<(is_move_constructible<DB::IAST*>::value) && (is_move_assignable<DB::IAST*>::value), void>::type std::__1::swap<DB::IAST*>(DB::IAST*&, DB::IAST*&)\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.185161 [ 25999 ] <Fatal> BaseDaemon: 17.2. inlined from ../contrib/libcxx/include/memory:3299: std::__1::shared_ptr<DB::IAST>::swap(std::__1::shared_ptr<DB::IAST>&)\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.185244 [ 25999 ] <Fatal> BaseDaemon: 17.3. inlined from ../contrib/libcxx/include/memory:3243: std::__1::shared_ptr<DB::IAST>::operator=(std::__1::shared_ptr<DB::IAST>&&)\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.185358 [ 25999 ] <Fatal> BaseDaemon: 17. ../src/Interpreters/UserDefinedSQLFunctionVisitor.cpp:95: DB::UserDefinedSQLFunctionMatcher::tryToReplaceFunction(DB::ASTFunction const&) @ 0x1110ef69 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.191102 [ 25999 ] <Fatal> BaseDaemon: 18. /build/build_docker/../src/Interpreters/UserDefinedSQLFunctionVisitor.cpp:27: DB::UserDefinedSQLFunctionMatcher::visit(std::__1::shared_ptr<DB::IAST>&, DB::UserDefinedSQLFunctionMatcher::Data&) @ 0x1110e963 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.196806 [ 25999 ] <Fatal> BaseDaemon: 19.1. inlined from /build/build_docker/../contrib/libcxx/include/memory:3211: ~shared_ptr\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.196940 [ 25999 ] <Fatal> BaseDaemon: 19. ../src/Interpreters/UserDefinedSQLFunctionVisitor.cpp:34: DB::UserDefinedSQLFunctionMatcher::visit(std::__1::shared_ptr<DB::IAST>&, DB::UserDefinedSQLFunctionMatcher::Data&) @ 0x1110e9c0 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.202581 [ 25999 ] <Fatal> BaseDaemon: 20.1. inlined from /build/build_docker/../contrib/libcxx/include/memory:3211: ~shared_ptr\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.202662 [ 25999 ] <Fatal> BaseDaemon: 20. ../src/Interpreters/UserDefinedSQLFunctionVisitor.cpp:34: DB::UserDefinedSQLFunctionMatcher::visit(std::__1::shared_ptr<DB::IAST>&, DB::UserDefinedSQLFunctionMatcher::Data&) @ 0x1110e9c0 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.208033 [ 25999 ] <Fatal> BaseDaemon: 21.1. inlined from /build/build_docker/../contrib/libcxx/include/memory:3211: ~shared_ptr\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.208112 [ 25999 ] <Fatal> BaseDaemon: 21. ../src/Interpreters/UserDefinedSQLFunctionVisitor.cpp:34: DB::UserDefinedSQLFunctionMatcher::visit(std::__1::shared_ptr<DB::IAST>&, DB::UserDefinedSQLFunctionMatcher::Data&) @ 0x1110e9c0 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.213505 [ 25999 ] <Fatal> BaseDaemon: 22.1. inlined from /build/build_docker/../contrib/libcxx/include/memory:3211: ~shared_ptr\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.213609 [ 25999 ] <Fatal> BaseDaemon: 22. ../src/Interpreters/UserDefinedSQLFunctionVisitor.cpp:34: DB::UserDefinedSQLFunctionMatcher::visit(std::__1::shared_ptr<DB::IAST>&, DB::UserDefinedSQLFunctionMatcher::Data&) @ 0x1110e9c0 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.218914 [ 25999 ] <Fatal> BaseDaemon: 23.1. inlined from /build/build_docker/../contrib/libcxx/include/memory:3211: ~shared_ptr\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.218991 [ 25999 ] <Fatal> BaseDaemon: 23. ../src/Interpreters/UserDefinedSQLFunctionVisitor.cpp:34: DB::UserDefinedSQLFunctionMatcher::visit(std::__1::shared_ptr<DB::IAST>&, DB::UserDefinedSQLFunctionMatcher::Data&) @ 0x1110e9c0 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.224253 [ 25999 ] <Fatal> BaseDaemon: 24.1. inlined from /build/build_docker/../contrib/libcxx/include/memory:3211: ~shared_ptr\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.224348 [ 25999 ] <Fatal> BaseDaemon: 24. ../src/Interpreters/UserDefinedSQLFunctionVisitor.cpp:34: DB::UserDefinedSQLFunctionMatcher::visit(std::__1::shared_ptr<DB::IAST>&, DB::UserDefinedSQLFunctionMatcher::Data&) @ 0x1110e9c0 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.229761 [ 25999 ] <Fatal> BaseDaemon: 25.1. inlined from /build/build_docker/../contrib/libcxx/include/memory:3211: ~shared_ptr\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.229841 [ 25999 ] <Fatal> BaseDaemon: 25. ../src/Interpreters/UserDefinedSQLFunctionVisitor.cpp:34: DB::UserDefinedSQLFunctionMatcher::visit(std::__1::shared_ptr<DB::IAST>&, DB::UserDefinedSQLFunctionMatcher::Data&) @ 0x1110e9c0 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.235219 [ 25999 ] <Fatal> BaseDaemon: 26.1. inlined from /build/build_docker/../contrib/libcxx/include/memory:3211: ~shared_ptr\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.235310 [ 25999 ] <Fatal> BaseDaemon: 26. ../src/Interpreters/UserDefinedSQLFunctionVisitor.cpp:34: DB::UserDefinedSQLFunctionMatcher::visit(std::__1::shared_ptr<DB::IAST>&, DB::UserDefinedSQLFunctionMatcher::Data&) @ 0x1110e9c0 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.240568 [ 25999 ] <Fatal> BaseDaemon: 27.1. inlined from /build/build_docker/../contrib/libcxx/include/memory:3211: ~shared_ptr\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.240647 [ 25999 ] <Fatal> BaseDaemon: 27. ../src/Interpreters/UserDefinedSQLFunctionVisitor.cpp:34: DB::UserDefinedSQLFunctionMatcher::visit(std::__1::shared_ptr<DB::IAST>&, DB::UserDefinedSQLFunctionMatcher::Data&) @ 0x1110e9c0 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.246117 [ 25999 ] <Fatal> BaseDaemon: 28.1. inlined from /build/build_docker/../contrib/libcxx/include/memory:3211: ~shared_ptr\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.246211 [ 25999 ] <Fatal> BaseDaemon: 28. ../src/Interpreters/UserDefinedSQLFunctionVisitor.cpp:34: DB::UserDefinedSQLFunctionMatcher::visit(std::__1::shared_ptr<DB::IAST>&, DB::UserDefinedSQLFunctionMatcher::Data&) @ 0x1110e9c0 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.251643 [ 25999 ] <Fatal> BaseDaemon: 29.1. inlined from /build/build_docker/../contrib/libcxx/include/memory:3211: ~shared_ptr\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.251743 [ 25999 ] <Fatal> BaseDaemon: 29. ../src/Interpreters/UserDefinedSQLFunctionVisitor.cpp:34: DB::UserDefinedSQLFunctionMatcher::visit(std::__1::shared_ptr<DB::IAST>&, DB::UserDefinedSQLFunctionMatcher::Data&) @ 0x1110e9c0 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.257189 [ 25999 ] <Fatal> BaseDaemon: 30.1. inlined from /build/build_docker/../contrib/libcxx/include/memory:3211: ~shared_ptr\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.257279 [ 25999 ] <Fatal> BaseDaemon: 30. ../src/Interpreters/UserDefinedSQLFunctionVisitor.cpp:34: DB::UserDefinedSQLFunctionMatcher::visit(std::__1::shared_ptr<DB::IAST>&, DB::UserDefinedSQLFunctionMatcher::Data&) @ 0x1110e9c0 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.262547 [ 25999 ] <Fatal> BaseDaemon: 31.1. inlined from /build/build_docker/../contrib/libcxx/include/memory:3211: ~shared_ptr\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.262641 [ 25999 ] <Fatal> BaseDaemon: 31. ../src/Interpreters/UserDefinedSQLFunctionVisitor.cpp:34: DB::UserDefinedSQLFunctionMatcher::visit(std::__1::shared_ptr<DB::IAST>&, DB::UserDefinedSQLFunctionMatcher::Data&) @ 0x1110e9c0 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.267910 [ 25999 ] <Fatal> BaseDaemon: 32.1. inlined from /build/build_docker/../contrib/libcxx/include/memory:3211: ~shared_ptr\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.268010 [ 25999 ] <Fatal> BaseDaemon: 32. ../src/Interpreters/UserDefinedSQLFunctionVisitor.cpp:34: DB::UserDefinedSQLFunctionMatcher::visit(std::__1::shared_ptr<DB::IAST>&, DB::UserDefinedSQLFunctionMatcher::Data&) @ 0x1110e9c0 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.273263 [ 25999 ] <Fatal> BaseDaemon: 33.1. inlined from /build/build_docker/../contrib/libcxx/include/memory:3211: ~shared_ptr\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.273350 [ 25999 ] <Fatal> BaseDaemon: 33. ../src/Interpreters/UserDefinedSQLFunctionVisitor.cpp:34: DB::UserDefinedSQLFunctionMatcher::visit(std::__1::shared_ptr<DB::IAST>&, DB::UserDefinedSQLFunctionMatcher::Data&) @ 0x1110e9c0 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.278683 [ 25999 ] <Fatal> BaseDaemon: 34.1. inlined from /build/build_docker/../contrib/libcxx/include/memory:3211: ~shared_ptr\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.278785 [ 25999 ] <Fatal> BaseDaemon: 34. ../src/Interpreters/UserDefinedSQLFunctionVisitor.cpp:34: DB::UserDefinedSQLFunctionMatcher::visit(std::__1::shared_ptr<DB::IAST>&, DB::UserDefinedSQLFunctionMatcher::Data&) @ 0x1110e9c0 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.284066 [ 25999 ] <Fatal> BaseDaemon: 35.1. inlined from /build/build_docker/../contrib/libcxx/include/memory:3211: ~shared_ptr\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.284156 [ 25999 ] <Fatal> BaseDaemon: 35. ../src/Interpreters/UserDefinedSQLFunctionVisitor.cpp:34: DB::UserDefinedSQLFunctionMatcher::visit(std::__1::shared_ptr<DB::IAST>&, DB::UserDefinedSQLFunctionMatcher::Data&) @ 0x1110e9c0 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.289497 [ 25999 ] <Fatal> BaseDaemon: 36.1. inlined from /build/build_docker/../contrib/libcxx/include/memory:3211: ~shared_ptr\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.289583 [ 25999 ] <Fatal> BaseDaemon: 36. ../src/Interpreters/UserDefinedSQLFunctionVisitor.cpp:34: DB::UserDefinedSQLFunctionMatcher::visit(std::__1::shared_ptr<DB::IAST>&, DB::UserDefinedSQLFunctionMatcher::Data&) @ 0x1110e9c0 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.294899 [ 25999 ] <Fatal> BaseDaemon: 37.1. inlined from /build/build_docker/../contrib/libcxx/include/memory:3211: ~shared_ptr\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.294988 [ 25999 ] <Fatal> BaseDaemon: 37. ../src/Interpreters/UserDefinedSQLFunctionVisitor.cpp:34: DB::UserDefinedSQLFunctionMatcher::visit(std::__1::shared_ptr<DB::IAST>&, DB::UserDefinedSQLFunctionMatcher::Data&) @ 0x1110e9c0 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.300419 [ 25999 ] <Fatal> BaseDaemon: 38.1. inlined from /build/build_docker/../contrib/libcxx/include/memory:3211: ~shared_ptr\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.300511 [ 25999 ] <Fatal> BaseDaemon: 38. ../src/Interpreters/UserDefinedSQLFunctionVisitor.cpp:34: DB::UserDefinedSQLFunctionMatcher::visit(std::__1::shared_ptr<DB::IAST>&, DB::UserDefinedSQLFunctionMatcher::Data&) @ 0x1110e9c0 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.305738 [ 25999 ] <Fatal> BaseDaemon: 39.1. inlined from /build/build_docker/../contrib/libcxx/include/memory:3211: ~shared_ptr\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.305832 [ 25999 ] <Fatal> BaseDaemon: 39. ../src/Interpreters/UserDefinedSQLFunctionVisitor.cpp:34: DB::UserDefinedSQLFunctionMatcher::visit(std::__1::shared_ptr<DB::IAST>&, DB::UserDefinedSQLFunctionMatcher::Data&) @ 0x1110e9c0 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.311029 [ 25999 ] <Fatal> BaseDaemon: 40.1. inlined from /build/build_docker/../contrib/libcxx/include/memory:3211: ~shared_ptr\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.311123 [ 25999 ] <Fatal> BaseDaemon: 40. ../src/Interpreters/UserDefinedSQLFunctionVisitor.cpp:34: DB::UserDefinedSQLFunctionMatcher::visit(std::__1::shared_ptr<DB::IAST>&, DB::UserDefinedSQLFunctionMatcher::Data&) @ 0x1110e9c0 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.316350 [ 25999 ] <Fatal> BaseDaemon: 41.1. inlined from /build/build_docker/../contrib/libcxx/include/memory:3211: ~shared_ptr\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.316444 [ 25999 ] <Fatal> BaseDaemon: 41. ../src/Interpreters/UserDefinedSQLFunctionVisitor.cpp:34: DB::UserDefinedSQLFunctionMatcher::visit(std::__1::shared_ptr<DB::IAST>&, DB::UserDefinedSQLFunctionMatcher::Data&) @ 0x1110e9c0 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.321708 [ 25999 ] <Fatal> BaseDaemon: 42.1. inlined from /build/build_docker/../contrib/libcxx/include/memory:3211: ~shared_ptr\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.321805 [ 25999 ] <Fatal> BaseDaemon: 42. ../src/Interpreters/UserDefinedSQLFunctionVisitor.cpp:34: DB::UserDefinedSQLFunctionMatcher::visit(std::__1::shared_ptr<DB::IAST>&, DB::UserDefinedSQLFunctionMatcher::Data&) @ 0x1110e9c0 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.326977 [ 25999 ] <Fatal> BaseDaemon: 43.1. inlined from /build/build_docker/../contrib/libcxx/include/memory:3211: ~shared_ptr\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.327076 [ 25999 ] <Fatal> BaseDaemon: 43. ../src/Interpreters/UserDefinedSQLFunctionVisitor.cpp:34: DB::UserDefinedSQLFunctionMatcher::visit(std::__1::shared_ptr<DB::IAST>&, DB::UserDefinedSQLFunctionMatcher::Data&) @ 0x1110e9c0 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.332220 [ 25999 ] <Fatal> BaseDaemon: 44.1. inlined from /build/build_docker/../contrib/libcxx/include/memory:3211: ~shared_ptr\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.332312 [ 25999 ] <Fatal> BaseDaemon: 44. ../src/Interpreters/UserDefinedSQLFunctionVisitor.cpp:34: DB::UserDefinedSQLFunctionMatcher::visit(std::__1::shared_ptr<DB::IAST>&, DB::UserDefinedSQLFunctionMatcher::Data&) @ 0x1110e9c0 in /home/avtokmakov/ch/tmp/clickhouse\r\n[avtokmakov-dev.sas.yp-c.yandex.net] 2021.10.29 16:24:50.516068 [ 25999 ] <Fatal> BaseDaemon: Checksum of the binary: 62775825C240240D0C8C1D384736C782, integrity check passed.\r\n\r\n```\n",
  "hints_text": "Btw, do we have tests with complex UDFs that use functions like `dictGet(...)`, `joinGet(...)` and `globalIn(...)`? (it's surprising for me that we do not have test with simple mutual recursion)\nAlso I've just noticed that it's possible to use UDF in `ORDER BY`/`PARTITION BY` when creating *MergeTree table and UDF is not substituted before writing metadata. It looks really dangerous, see, for example #23508. Should we add some restrictions on UDFs usage while it's not too late?\nWe should allow UDFs in CREATE TABLE but we need to completely unwrap them.\nPing! Is this issue any progress? I'm suffered some similar problems in recusive UDFs.\r\nWhich do not crash, but never stoped...eat all my memory until killed by system OOM killer.\r\n\r\n```SQL\r\nCREATE OR REPLACE FUNCTION _fib2 as (n) -> 1;\r\nCREATE OR REPLACE FUNCTION _fib1 as (n) -> multiIf(n <= 0, 0, n <= 1, 1, _fib2(n-1) + _fib2(n-2));\r\nCREATE OR REPLACE FUNCTION _fib2 as (n) -> multiIf(n <= 0, 0, n <= 1, 1, _fib1(n-1) + _fib1(n-2));\r\nCREATE OR REPLACE FUNCTION fib as (n) -> _fib1(n);\r\nselect fib(number) from numbers(1);\r\n```\r\n\r\n```\r\n2021.11.24 23:47:16.000741 [ 23464 ] {} <Debug> AsynchronousMetrics: Hardware monitor 'iwlwifi_1', sensor '' exists but could not be read, error 61.\r\n2021.11.24 23:47:16.236061 [ 23348 ] {} <Debug> DNSResolver: Updating DNS cache\r\n2021.11.24 23:47:16.236090 [ 23348 ] {} <Debug> DNSResolver: Updated DNS cache\r\n2021.11.24 23:47:17.000113 [ 23464 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 24.23 GiB, peak 24.23 GiB, will set to 24.25 GiB (RSS), difference: 18.96 MiB\r\n2021.11.24 23:47:17.000630 [ 23464 ] {} <Trace> AsynchronousMetrics: Scanning /sys/class/thermal\r\n2021.11.24 23:47:17.000838 [ 23464 ] {} <Debug> AsynchronousMetrics: Hardware monitor 'iwlwifi_1', sensor '' exists but could not be read, error 61.\r\n2021.11.24 23:47:18.000112 [ 23464 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 25.12 GiB, peak 25.12 GiB, will set to 25.13 GiB (RSS), difference: 17.29 MiB\r\n2021.11.24 23:47:18.000630 [ 23464 ] {} <Trace> AsynchronousMetrics: Scanning /sys/class/thermal\r\n2021.11.24 23:47:18.000731 [ 23464 ] {} <Debug> AsynchronousMetrics: Hardware monitor 'iwlwifi_1', sensor '' exists but could not be read, error 61.\r\n2021.11.24 23:47:19.000119 [ 23464 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 25.99 GiB, peak 25.99 GiB, will set to 26.01 GiB (RSS), difference: 20.26 MiB\r\n2021.11.24 23:47:19.000142 [ 23464 ] {} <Debug> MemoryTracker: Current memory usage (total): 26.01 GiB.\r\n2021.11.24 23:47:19.000754 [ 23464 ] {} <Trace> AsynchronousMetrics: Scanning /sys/class/thermal\r\n2021.11.24 23:47:19.000999 [ 23464 ] {} <Debug> AsynchronousMetrics: Hardware monitor 'iwlwifi_1', sensor '' exists but could not be read, error 61.\r\n2021.11.24 23:47:20.006991 [ 23464 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 26.55 GiB, peak 26.55 GiB, will set to 26.43 GiB (RSS), difference: -126.24 MiB\r\n2021.11.24 23:47:20.016869 [ 23464 ] {} <Trace> AsynchronousMetrics: Scanning /sys/class/thermal\r\n2021.11.24 23:47:20.018061 [ 23464 ] {} <Debug> AsynchronousMetrics: Hardware monitor 'iwlwifi_1', sensor '' exists but could not be read, error 61.\r\n2021.11.24 23:47:21.000151 [ 23464 ] {} <Trace> AsynchronousMetrics: MemoryTracking: was 26.78 GiB, peak 26.78 GiB, will set to 26.55 GiB (RSS), difference: -234.92 MiB\r\n2021.11.24 23:47:21.009470 [ 23464 ] {} <Trace> AsynchronousMetrics: Scanning /sys/class/thermal\r\n2021.11.24 23:47:21.009604 [ 23464 ] {} <Debug> AsynchronousMetrics: Hardware monitor 'iwlwifi_1', sensor '' exists but could not be read, error 61.\r\n2021.11.24 23:47:23.959754 [ 23464 ] {} <Trace> AsynchronousMetrics: Scanning /sys/class/thermal\r\n2021.11.24 23:47:27.369988 [ 23464 ] {} <Debug> AsynchronousMetrics: Hardware monitor 'iwlwifi_1', sensor '' exists but could not be read, error 61.[1]    23284 killed     ../programs/clickhouse server\r\n```\r\n\nRecursive UDFs won't work.\r\n\r\nWe will fix the issue with OOM.",
  "created_at": "2021-11-25T16:19:41Z",
  "modified_files": [
    "src/Interpreters/UserDefinedSQLFunctionVisitor.cpp",
    "src/Interpreters/UserDefinedSQLFunctionVisitor.h"
  ],
  "modified_test_files": [
    "b/tests/queries/0_stateless/02125_recursive_sql_user_defined_functions.reference",
    "b/tests/queries/0_stateless/02125_recursive_sql_user_defined_functions.sql",
    "b/tests/queries/0_stateless/02126_identity_user_defined_function.reference",
    "b/tests/queries/0_stateless/02126_identity_user_defined_function.sql"
  ]
}