diff --git a/tests/queries/0_stateless/01104_distributed_numbers_test.reference b/tests/queries/0_stateless/01104_distributed_numbers_test.reference
index c5079fa2cfd0..c7e52eb2a2fe 100644
--- a/tests/queries/0_stateless/01104_distributed_numbers_test.reference
+++ b/tests/queries/0_stateless/01104_distributed_numbers_test.reference
@@ -2,3 +2,6 @@
 100
 100
 100
+300
+100
+100
diff --git a/tests/queries/0_stateless/01104_distributed_numbers_test.sql b/tests/queries/0_stateless/01104_distributed_numbers_test.sql
index bb2db88f23f0..07237223bad4 100644
--- a/tests/queries/0_stateless/01104_distributed_numbers_test.sql
+++ b/tests/queries/0_stateless/01104_distributed_numbers_test.sql
@@ -1,9 +1,25 @@
 -- Tags: distributed
 
+SELECT *
+FROM
+(
+    SELECT *
+    FROM system.numbers
+    WHERE number = 100
+    UNION ALL
+    SELECT *
+    FROM system.numbers
+    WHERE number = 100
+)
+LIMIT 2
+SETTINGS max_threads = 1 FORMAT Null;
+
 DROP TABLE IF EXISTS d_numbers;
 CREATE TABLE d_numbers (number UInt32) ENGINE = Distributed(test_cluster_two_shards, system, numbers, rand());
 
 SELECT '100' AS number FROM d_numbers AS n WHERE n.number = 100 LIMIT 2;
+SELECT '100' AS number FROM d_numbers AS n WHERE n.number = 100 LIMIT 2 SETTINGS max_threads = 1, prefer_localhost_replica=1;
+SELECT sum(number) FROM (select * from remote('127.0.0.{1,1,1}', system.numbers) AS n WHERE n.number = 100 LIMIT 3) SETTINGS max_threads = 2, prefer_localhost_replica=1;
 
 SET distributed_product_mode = 'local';
 
