diff --git a/tests/integration/test_s3_storage_class/__init__.py b/tests/integration/test_s3_storage_class/__init__.py
new file mode 100644
index 000000000000..e69de29bb2d1
diff --git a/tests/integration/test_s3_storage_class/configs/config.d/minio.xml b/tests/integration/test_s3_storage_class/configs/config.d/minio.xml
new file mode 100644
index 000000000000..6a7c2d684be4
--- /dev/null
+++ b/tests/integration/test_s3_storage_class/configs/config.d/minio.xml
@@ -0,0 +1,25 @@
+<?xml version="1.0"?>
+
+<!-- Using named collections 22.4+ -->
+<clickhouse>
+    <storage_configuration>
+        <disks>
+            <use_s3_storage_class>
+                <type>s3</type>
+                <endpoint>http://minio1:9001/root/data/</endpoint>
+                <access_key_id>minio</access_key_id>
+                <secret_access_key>minio123</secret_access_key>
+                <s3_storage_class>STANDARD</s3_storage_class>
+            </use_s3_storage_class>
+        </disks>
+        <policies>
+            <use_s3_storage_class>
+                <volumes>
+                    <main>
+                        <disk>use_s3_storage_class</disk>
+                    </main>
+                </volumes>
+            </use_s3_storage_class>
+        </policies>
+    </storage_configuration>
+</clickhouse>
diff --git a/tests/integration/test_s3_storage_class/test.py b/tests/integration/test_s3_storage_class/test.py
new file mode 100644
index 000000000000..f28ae189c921
--- /dev/null
+++ b/tests/integration/test_s3_storage_class/test.py
@@ -0,0 +1,52 @@
+import os
+import logging
+
+import pytest
+from helpers.cluster import ClickHouseCluster
+
+logging.getLogger().setLevel(logging.INFO)
+logging.getLogger().addHandler(logging.StreamHandler())
+
+cluster = ClickHouseCluster(__file__)
+node = cluster.add_instance(
+    "node",
+    main_configs=["configs/config.d/minio.xml"],
+    stay_alive=True,
+    with_minio=True,
+)
+
+
+@pytest.fixture(scope="module")
+def started_cluster():
+    try:
+        cluster.start()
+        yield cluster
+    finally:
+        cluster.shutdown()
+
+
+def test_s3_storage_class_right(started_cluster):
+    node.query(
+        """
+            CREATE TABLE test_s3_storage_class
+            (
+                `id` UInt64,
+                `value` String
+            )
+            ENGINE = MergeTree
+            ORDER BY id
+            SETTINGS storage_policy='use_s3_storage_class';
+        """,
+    )
+    node.query(
+        """
+            INSERT INTO test_s3_storage_class VALUES (1, 'a');
+        """,
+    )
+    result = node.query(
+        """
+            SELECT id FROM test_s3_storage_class;
+        """
+    )
+
+    assert result == "1
"
