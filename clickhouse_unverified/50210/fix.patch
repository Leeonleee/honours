diff --git a/programs/client/Client.cpp b/programs/client/Client.cpp
index 5870327c3b5c..32a07284d268 100644
--- a/programs/client/Client.cpp
+++ b/programs/client/Client.cpp
@@ -1180,6 +1180,9 @@ void Client::processOptions(const OptionsDescription & options_description,
 
 void Client::processConfig()
 {
+    if (config().has("query") && config().has("queries-file"))
+        throw Exception(ErrorCodes::BAD_ARGUMENTS, "Options '--query' and '--queries-file' cannot be specified at the same time");
+
     /// Batch mode is enabled if one of the following is true:
     /// - -q (--query) command line option is present.
     ///   The value of the option is used as the text of query (or of multiple queries).
diff --git a/programs/local/LocalServer.cpp b/programs/local/LocalServer.cpp
index e026f87279ad..944a60d4e4c4 100644
--- a/programs/local/LocalServer.cpp
+++ b/programs/local/LocalServer.cpp
@@ -516,12 +516,12 @@ void LocalServer::updateLoggerLevel(const String & logs_level)
 
 void LocalServer::processConfig()
 {
+    if (config().has("query") && config().has("queries-file"))
+        throw Exception(ErrorCodes::BAD_ARGUMENTS, "Options '--query' and '--queries-file' cannot be specified at the same time");
+
     delayed_interactive = config().has("interactive") && (config().has("query") || config().has("queries-file"));
     if (is_interactive && !delayed_interactive)
     {
-        if (config().has("query") && config().has("queries-file"))
-            throw Exception(ErrorCodes::BAD_ARGUMENTS, "Specify either `query` or `queries-file` option");
-
         if (config().has("multiquery"))
             is_multiquery = true;
     }
