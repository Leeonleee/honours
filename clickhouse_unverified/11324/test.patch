diff --git a/tests/queries/0_stateless/00098_k_union_all.reference b/tests/queries/0_stateless/00098_k_union_all.reference
index 1b21a751afc4..a6921e228af4 100644
--- a/tests/queries/0_stateless/00098_k_union_all.reference
+++ b/tests/queries/0_stateless/00098_k_union_all.reference
@@ -1,18 +1,18 @@
-[1m1[0m
+ [1m1[0m
 
-1
-[1m1[0m
+ 1 
+ [1m1[0m
 
-1
-[1m1[0m
+ 1 
+ [1m1[0m
 
-1
-[1m1[0m
+ 1 
+ [1m1[0m
 
-1
-[1m1[0m
+ 1 
+ [1m1[0m
 
-1
-[1m1[0m
+ 1 
+ [1m1[0m
 
-1
+ 1 
diff --git a/tests/queries/0_stateless/00305_http_and_readonly.reference b/tests/queries/0_stateless/00305_http_and_readonly.reference
index f148cbbb93b4..4d0cb6bd6bc7 100644
--- a/tests/queries/0_stateless/00305_http_and_readonly.reference
+++ b/tests/queries/0_stateless/00305_http_and_readonly.reference
@@ -1,19 +1,19 @@
-name               value   changed
+ name               value   changed
 
-max_rows_to_read   10000         1
-readonly           0             0
-name               value   changed
+ max_rows_to_read   10000         1 
+ readonly           0             0 
+ name               value   changed
 
-max_rows_to_read   10000         1
-readonly           2             1
-name               value   changed
+ max_rows_to_read   10000         1 
+ readonly           2             1 
+ name               value   changed
 
-max_rows_to_read   10000         1
-readonly           1             1
-name               value   changed
+ max_rows_to_read   10000         1 
+ readonly           1             1 
+ name               value   changed
 
-max_rows_to_read   10000         1
-readonly           2             1
+ max_rows_to_read   10000         1 
+ readonly           2             1 
 Ok
 Ok
 0
diff --git a/tests/queries/0_stateless/00405_pretty_formats.reference b/tests/queries/0_stateless/00405_pretty_formats.reference
index 07dfd76339be..ef3184f28378 100644
--- a/tests/queries/0_stateless/00405_pretty_formats.reference
+++ b/tests/queries/0_stateless/00405_pretty_formats.reference
@@ -38,20 +38,20 @@
 â”‚     8 â”‚ 8     â”‚ (8,'8') â”‚               2 â”‚
 â”‚     9 â”‚ 9     â”‚ (9,'9') â”‚            á´ºáµá´¸á´¸ â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
-[1mhello[0m   [1mworld[0m   [1mtuple[0m     [1msometimes_nulls[0m
+ [1mhello[0m   [1mworld[0m   [1mtuple[0m     [1msometimes_nulls[0m
 
-    0   0       (0,'0')              á´ºáµá´¸á´¸
-    1   1       (1,'1')                 1
-    2   2       (2,'2')                 2
-    3   3       (3,'3')              á´ºáµá´¸á´¸
-    4   4       (4,'4')                 1
-[1mhello[0m   [1mworld[0m   [1mtuple[0m     [1msometimes_nulls[0m
+     0   0       (0,'0')              á´ºáµá´¸á´¸ 
+     1   1       (1,'1')                 1 
+     2   2       (2,'2')                 2 
+     3   3       (3,'3')              á´ºáµá´¸á´¸ 
+     4   4       (4,'4')                 1 
+ [1mhello[0m   [1mworld[0m   [1mtuple[0m     [1msometimes_nulls[0m
 
-    5   5       (5,'5')                 2
-    6   6       (6,'6')              á´ºáµá´¸á´¸
-    7   7       (7,'7')                 1
-    8   8       (8,'8')                 2
-    9   9       (9,'9')              á´ºáµá´¸á´¸
+     5   5       (5,'5')                 2 
+     6   6       (6,'6')              á´ºáµá´¸á´¸ 
+     7   7       (7,'7')                 1 
+     8   8       (8,'8')                 2 
+     9   9       (9,'9')              á´ºáµá´¸á´¸ 
 â”Œâ”€[1mhello[0mâ”€â”¬â”€[1mworld[0mâ”€â”¬â”€[1mtuple[0mâ”€â”€â”€â”¬â”€[1msometimes_nulls[0mâ”€â”
 â”‚     0 â”‚ 0     â”‚ (0,'0') â”‚            á´ºáµá´¸á´¸ â”‚
 â”‚     1 â”‚ 1     â”‚ (1,'1') â”‚               1 â”‚
@@ -104,20 +104,20 @@
 â”‚     8 â”‚ 8     â”‚ (8,'8') â”‚               2 â”‚
 â”‚     9 â”‚ 9     â”‚ (9,'9') â”‚            á´ºáµá´¸á´¸ â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
-hello   world   tuple     sometimes_nulls
+ hello   world   tuple     sometimes_nulls
 
-    0   0       (0,'0')              á´ºáµá´¸á´¸
-    1   1       (1,'1')                 1
-    2   2       (2,'2')                 2
-    3   3       (3,'3')              á´ºáµá´¸á´¸
-    4   4       (4,'4')                 1
-hello   world   tuple     sometimes_nulls
+     0   0       (0,'0')              á´ºáµá´¸á´¸ 
+     1   1       (1,'1')                 1 
+     2   2       (2,'2')                 2 
+     3   3       (3,'3')              á´ºáµá´¸á´¸ 
+     4   4       (4,'4')                 1 
+ hello   world   tuple     sometimes_nulls
 
-    5   5       (5,'5')                 2
-    6   6       (6,'6')              á´ºáµá´¸á´¸
-    7   7       (7,'7')                 1
-    8   8       (8,'8')                 2
-    9   9       (9,'9')              á´ºáµá´¸á´¸
+     5   5       (5,'5')                 2 
+     6   6       (6,'6')              á´ºáµá´¸á´¸ 
+     7   7       (7,'7')                 1 
+     8   8       (8,'8')                 2 
+     9   9       (9,'9')              á´ºáµá´¸á´¸ 
 â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
 â”ƒ [1mhello[0m â”ƒ [1mworld[0m â”ƒ [1mtuple  [0m â”ƒ [1msometimes_nulls[0m â”ƒ
 â”¡â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”©
@@ -148,16 +148,16 @@ hello   world   tuple     sometimes_nulls
 â”‚     5 â”‚ 5     â”‚ (5,'5') â”‚               2 â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   Showed first 6.
-[1mhello[0m   [1mworld[0m   [1mtuple[0m     [1msometimes_nulls[0m
+ [1mhello[0m   [1mworld[0m   [1mtuple[0m     [1msometimes_nulls[0m
 
-    0   0       (0,'0')              á´ºáµá´¸á´¸
-    1   1       (1,'1')                 1
-    2   2       (2,'2')                 2
-    3   3       (3,'3')              á´ºáµá´¸á´¸
-    4   4       (4,'4')                 1
-[1mhello[0m   [1mworld[0m   [1mtuple[0m     [1msometimes_nulls[0m
+     0   0       (0,'0')              á´ºáµá´¸á´¸ 
+     1   1       (1,'1')                 1 
+     2   2       (2,'2')                 2 
+     3   3       (3,'3')              á´ºáµá´¸á´¸ 
+     4   4       (4,'4')                 1 
+ [1mhello[0m   [1mworld[0m   [1mtuple[0m     [1msometimes_nulls[0m
 
-    5   5       (5,'5')                 2
+     5   5       (5,'5')                 2 
 
 Showed first 6.
 â”Œâ”€[1mhello[0mâ”€â”¬â”€[1mworld[0mâ”€â”¬â”€[1mtuple[0mâ”€â”€â”€â”¬â”€[1msometimes_nulls[0mâ”€â”
@@ -199,15 +199,15 @@ Showed first 6.
 â”‚     5 â”‚ 5     â”‚ (5,'5') â”‚               2 â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   Showed first 6.
-hello   world   tuple     sometimes_nulls
+ hello   world   tuple     sometimes_nulls
 
-    0   0       (0,'0')              á´ºáµá´¸á´¸
-    1   1       (1,'1')                 1
-    2   2       (2,'2')                 2
-    3   3       (3,'3')              á´ºáµá´¸á´¸
-    4   4       (4,'4')                 1
-hello   world   tuple     sometimes_nulls
+     0   0       (0,'0')              á´ºáµá´¸á´¸ 
+     1   1       (1,'1')                 1 
+     2   2       (2,'2')                 2 
+     3   3       (3,'3')              á´ºáµá´¸á´¸ 
+     4   4       (4,'4')                 1 
+ hello   world   tuple     sometimes_nulls
 
-    5   5       (5,'5')                 2
+     5   5       (5,'5')                 2 
 
 Showed first 6.
diff --git a/tests/queries/0_stateless/00476_pretty_formats_and_widths.reference b/tests/queries/0_stateless/00476_pretty_formats_and_widths.reference
index c97991ae0e97..eedaa4b5d8bd 100644
--- a/tests/queries/0_stateless/00476_pretty_formats_and_widths.reference
+++ b/tests/queries/0_stateless/00476_pretty_formats_and_widths.reference
@@ -33,18 +33,18 @@
 â”‚  100000000 â”‚ 100000000  â”‚
 â”‚ 1000000000 â”‚ 1000000000 â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
-         [1mx[0m   [1ms[0m         
+          [1mx[0m   [1ms[0m         
 
-         1   1         
-        10   10        
-       100   100       
-      1000   1000      
-     10000   10000     
-    100000   100000    
-   1000000   1000000   
-  10000000   10000000  
- 100000000   100000000 
-1000000000   1000000000
+          1   1          
+         10   10         
+        100   100        
+       1000   1000       
+      10000   10000      
+     100000   100000     
+    1000000   1000000    
+   10000000   10000000   
+  100000000   100000000  
+ 1000000000   1000000000 
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[1mx[0mâ”€â”¬â”€[1ms[0mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚          1 â”‚ 1          â”‚
 â”‚         10 â”‚ 10         â”‚
diff --git a/tests/queries/0_stateless/00569_parse_date_time_best_effort.reference b/tests/queries/0_stateless/00569_parse_date_time_best_effort.reference
index 8638c0b707f5..b873e8b848d5 100644
--- a/tests/queries/0_stateless/00569_parse_date_time_best_effort.reference
+++ b/tests/queries/0_stateless/00569_parse_date_time_best_effort.reference
@@ -1,106 +1,106 @@
-s                                                   a                     b
+ s                                                   a                     b
 
-0                                 2000-01-01 00:00:00   2000-01-01 00:00:00
-0000                              2000-01-01 00:00:00   2000-01-01 00:00:00
-00:00:00                          2000-01-01 00:00:00   2000-01-01 00:00:00
-01:00:00                          2000-01-01 01:00:00   2000-01-01 01:00:00
-02/01/17 010203 MSK               2017-01-01 22:02:03   2017-01-01 22:02:03
-02/01/17 010203 MSK+0100          2017-01-01 21:02:03   2017-01-01 21:02:03
-02/01/17 010203 UTC+0300          2017-01-01 22:02:03   2017-01-01 22:02:03
-02/01/17 010203Z                  2017-01-02 01:02:03   2017-01-02 01:02:03
-02/01/1970 010203Z                1970-01-02 01:02:03   1970-01-02 01:02:03
-02/01/70 010203Z                  1970-01-02 01:02:03   1970-01-02 01:02:03
-11 Feb 2018 06:40:50 +0300        2018-02-11 03:40:50   2018-02-11 03:40:50
-17 Apr 2 1:2:3                    2000-04-17 01:02:03   2000-04-17 01:02:03
-19700102 01:00:00                 1970-01-02 01:00:00   1970-01-02 01:00:00
-1970010201:00:00                  2032-06-06 02:03:21   2032-06-06 02:03:21
-19700102010203                    1970-01-02 01:02:03   1970-01-02 01:02:03
-19700102010203Z                   1970-01-02 01:02:03   1970-01-02 01:02:03
-1970/01/02 010203Z                1970-01-02 01:02:03   1970-01-02 01:02:03
-20                                2000-01-20 00:00:00   2000-01-20 00:00:00
-201                                              á´ºáµá´¸á´¸   0000-00-00 00:00:00
-20160101                          2016-01-01 00:00:00   2016-01-01 00:00:00
-2016-01-01                        2016-01-01 00:00:00   2016-01-01 00:00:00
-201601-01                         2016-01-01 01:00:00   2016-01-01 01:00:00
-2016-01-01MSD                     2015-12-31 20:00:00   2015-12-31 20:00:00
-2016-01-01 MSD                    2015-12-31 20:00:00   2015-12-31 20:00:00
-201601-01 MSD                     2016-01-01 04:00:00   2016-01-01 04:00:00
-2016-01-01UTC                     2016-01-01 00:00:00   2016-01-01 00:00:00
-2016-01-01Z                       2016-01-01 00:00:00   2016-01-01 00:00:00
-2017                              2017-01-01 00:00:00   2017-01-01 00:00:00
-2017/01/00                        2017-01-01 00:00:00   2017-01-01 00:00:00
-2017/01/00 MSD                    2016-12-31 20:00:00   2016-12-31 20:00:00
-2017/01/00 MSD Jun                2017-05-31 20:00:00   2017-05-31 20:00:00
-2017/01/01                        2017-01-01 00:00:00   2017-01-01 00:00:00
-201701 02 010203 UTC+0300         2017-01-01 22:02:03   2017-01-01 22:02:03
-2017-01-02 03:04:05               2017-01-02 03:04:05   2017-01-02 03:04:05
-2017-01-0203:04:05                               á´ºáµá´¸á´¸   0000-00-00 00:00:00
-2017-01-02 03:04:05+0             2017-01-02 03:04:05   2017-01-02 03:04:05
-2017-01-02 03:04:05+00            2017-01-02 03:04:05   2017-01-02 03:04:05
-2017-01-02 03:04:05+0000          2017-01-02 03:04:05   2017-01-02 03:04:05
-2017-01-02 03:04:05 -0100         2017-01-02 04:04:05   2017-01-02 04:04:05
-2017-01-02 03:04:05+030           2017-01-02 02:34:05   2017-01-02 02:34:05
-2017-01-02 03:04:05+0300          2017-01-02 00:04:05   2017-01-02 00:04:05
-2017-01-02 03:04:05+1             2017-01-02 02:04:05   2017-01-02 02:04:05
-2017-01-02 03:04:05+300           2017-01-02 00:04:05   2017-01-02 00:04:05
-2017-01-02 03:04:05+900           2017-01-01 18:04:05   2017-01-01 18:04:05
-2017-01-02 03:04:05GMT            2017-01-02 03:04:05   2017-01-02 03:04:05
-2017-01-02 03:04:05 MSD           2017-01-01 23:04:05   2017-01-01 23:04:05
-2017-01-02 03:04:05 MSD Feb       2017-02-01 23:04:05   2017-02-01 23:04:05
-2017-01-02 03:04:05 MSD Jun       2017-06-01 23:04:05   2017-06-01 23:04:05
-2017-01-02 03:04:05 MSK           2017-01-02 00:04:05   2017-01-02 00:04:05
-2017-01-02T03:04:05               2017-01-02 03:04:05   2017-01-02 03:04:05
-2017-01-02T03:04:05+00            2017-01-02 03:04:05   2017-01-02 03:04:05
-2017-01-02T03:04:05 -0100         2017-01-02 04:04:05   2017-01-02 04:04:05
-2017-01-02T03:04:05-0100          2017-01-02 04:04:05   2017-01-02 04:04:05
-2017-01-02T03:04:05+0100          2017-01-02 02:04:05   2017-01-02 02:04:05
-2017-01-02T03:04:05Z              2017-01-02 03:04:05   2017-01-02 03:04:05
-2017-01 03:04:05 MSD Jun          2017-05-31 23:04:05   2017-05-31 23:04:05
-2017-01 03:04 MSD Jun             2017-05-31 23:04:00   2017-05-31 23:04:00
-2017/01/31                        2017-01-31 00:00:00   2017-01-31 00:00:00
-2017/01/32                        0000-00-00 00:00:00   0000-00-00 00:00:00
-2017-01 MSD Jun                   2017-05-31 20:00:00   2017-05-31 20:00:00
-201701 MSD Jun                    2017-05-31 20:00:00   2017-05-31 20:00:00
-2017 25 1:2:3                     0000-00-00 00:00:00   0000-00-00 00:00:00
-2017 25 Apr 1:2:3                 2017-04-01 01:02:03   2017-04-01 01:02:03
-2017 Apr 01 11:22:33              2017-04-01 11:22:33   2017-04-01 11:22:33
-2017 Apr 02 01/02/03 UTC+0300                    á´ºáµá´¸á´¸   0000-00-00 00:00:00
-2017 Apr 02 010203 UTC+0300       2017-04-01 22:02:03   2017-04-01 22:02:03
-2017 Apr 02 01:2:3 UTC+0300       2017-04-01 22:02:03   2017-04-01 22:02:03
-2017 Apr 02 1:02:3                2017-04-02 01:02:03   2017-04-02 01:02:03
-2017 Apr 02 11:22:33              2017-04-02 11:22:33   2017-04-02 11:22:33
-2017 Apr 02 1:2:03                2017-04-02 01:02:03   2017-04-02 01:02:03
-2017 Apr 02 1:22:33               2017-04-02 01:22:33   2017-04-02 01:22:33
-2017 Apr 02 1:2:3                 2017-04-02 01:02:03   2017-04-02 01:02:03
-2017 Apr 02 1:2:33                2017-04-02 01:02:33   2017-04-02 01:02:33
-2017 Apr 02 1:2:3 MSK             2017-04-01 22:02:03   2017-04-01 22:02:03
-2017 Apr 02 1:2:3 MSK 2017        2017-04-01 22:02:03   2017-04-01 22:02:03
-2017 Apr 02 1:2:3 MSK 2018        2017-04-01 22:02:03   2017-04-01 22:02:03
-2017 Apr 02 1:2:3 UTC+0000        2017-04-02 01:02:03   2017-04-02 01:02:03
-2017 Apr 02 1:2:3 UTC+0300        2017-04-01 22:02:03   2017-04-01 22:02:03
-2017 Apr 02 1:2:3 UTC+0400        2017-04-01 21:02:03   2017-04-01 21:02:03
-2017 Apr 2 1:2:3                  2017-04-02 01:02:03   2017-04-02 01:02:03
-2017 Jan 02 010203 UTC+0300       2017-01-01 22:02:03   2017-01-01 22:02:03
-25 Apr 2017 01:02:03              2017-04-25 01:02:03   2017-04-25 01:02:03
-25 Apr 2017 1:2:3                 2017-04-25 01:02:03   2017-04-25 01:02:03
-25 Jan 2017 1:2:3                 2017-01-25 01:02:03   2017-01-25 01:02:03
-25 Jan 2017 1:2:3 MSK             2017-01-24 22:02:03   2017-01-24 22:02:03
-25 Jan 2017 1:2:3 PM              2017-01-25 13:02:03   2017-01-25 13:02:03
-25 Jan 2017 1:2:3Z                2017-01-25 01:02:03   2017-01-25 01:02:03
-25 Jan 2017 1:2:3 Z               2017-01-25 01:02:03   2017-01-25 01:02:03
-25 Jan 2017 1:2:3 Z +0300         2017-01-24 22:02:03   2017-01-24 22:02:03
-25 Jan 2017 1:2:3 Z+03:00         2017-01-24 22:02:03   2017-01-24 22:02:03
-25 Jan 2017 1:2:3 Z +0300 OM                     á´ºáµá´¸á´¸   0000-00-00 00:00:00
-25 Jan 2017 1:2:3 Z +03:00 PM     2017-01-25 10:02:03   2017-01-25 10:02:03
-25 Jan 2017 1:2:3 Z +0300 PM      2017-01-25 10:02:03   2017-01-25 10:02:03
-25 Jan 2017 1:2:3 Z+03:00 PM      2017-01-25 10:02:03   2017-01-25 10:02:03
-25 Jan 2017 1:2:3 Z +03:30 PM     2017-01-25 09:32:03   2017-01-25 09:32:03
-25 Jan 2017 1:2:3Z Mo                            á´ºáµá´¸á´¸   0000-00-00 00:00:00
-25 Jan 2017 1:2:3Z Mon            2017-01-25 01:02:03   2017-01-25 01:02:03
-25 Jan 2017 1:2:3Z Moo                           á´ºáµá´¸á´¸   0000-00-00 00:00:00
-25 Jan 2017 1:2:3 Z PM            2017-01-25 13:02:03   2017-01-25 13:02:03
-25 Jan 2017 1:2:3Z PM             2017-01-25 13:02:03   2017-01-25 13:02:03
-25 Jan 2017 1:2:3 Z PM +03:00     2017-01-25 10:02:03   2017-01-25 10:02:03
-Jun, 11 Feb 2018 06:40:50 +0300   2000-06-01 00:00:00   2000-06-01 00:00:00
-Sun 11 Feb 2018 06:40:50 +0300    2018-02-11 03:40:50   2018-02-11 03:40:50
-Sun, 11 Feb 2018 06:40:50 +0300   2018-02-11 03:40:50   2018-02-11 03:40:50
+ 0                                 2000-01-01 00:00:00   2000-01-01 00:00:00 
+ 0000                              2000-01-01 00:00:00   2000-01-01 00:00:00 
+ 00:00:00                          2000-01-01 00:00:00   2000-01-01 00:00:00 
+ 01:00:00                          2000-01-01 01:00:00   2000-01-01 01:00:00 
+ 02/01/17 010203 MSK               2017-01-01 22:02:03   2017-01-01 22:02:03 
+ 02/01/17 010203 MSK+0100          2017-01-01 21:02:03   2017-01-01 21:02:03 
+ 02/01/17 010203 UTC+0300          2017-01-01 22:02:03   2017-01-01 22:02:03 
+ 02/01/17 010203Z                  2017-01-02 01:02:03   2017-01-02 01:02:03 
+ 02/01/1970 010203Z                1970-01-02 01:02:03   1970-01-02 01:02:03 
+ 02/01/70 010203Z                  1970-01-02 01:02:03   1970-01-02 01:02:03 
+ 11 Feb 2018 06:40:50 +0300        2018-02-11 03:40:50   2018-02-11 03:40:50 
+ 17 Apr 2 1:2:3                    2000-04-17 01:02:03   2000-04-17 01:02:03 
+ 19700102 01:00:00                 1970-01-02 01:00:00   1970-01-02 01:00:00 
+ 1970010201:00:00                  2032-06-06 02:03:21   2032-06-06 02:03:21 
+ 19700102010203                    1970-01-02 01:02:03   1970-01-02 01:02:03 
+ 19700102010203Z                   1970-01-02 01:02:03   1970-01-02 01:02:03 
+ 1970/01/02 010203Z                1970-01-02 01:02:03   1970-01-02 01:02:03 
+ 20                                2000-01-20 00:00:00   2000-01-20 00:00:00 
+ 201                                              á´ºáµá´¸á´¸   0000-00-00 00:00:00 
+ 20160101                          2016-01-01 00:00:00   2016-01-01 00:00:00 
+ 2016-01-01                        2016-01-01 00:00:00   2016-01-01 00:00:00 
+ 201601-01                         2016-01-01 01:00:00   2016-01-01 01:00:00 
+ 2016-01-01MSD                     2015-12-31 20:00:00   2015-12-31 20:00:00 
+ 2016-01-01 MSD                    2015-12-31 20:00:00   2015-12-31 20:00:00 
+ 201601-01 MSD                     2016-01-01 04:00:00   2016-01-01 04:00:00 
+ 2016-01-01UTC                     2016-01-01 00:00:00   2016-01-01 00:00:00 
+ 2016-01-01Z                       2016-01-01 00:00:00   2016-01-01 00:00:00 
+ 2017                              2017-01-01 00:00:00   2017-01-01 00:00:00 
+ 2017/01/00                        2017-01-01 00:00:00   2017-01-01 00:00:00 
+ 2017/01/00 MSD                    2016-12-31 20:00:00   2016-12-31 20:00:00 
+ 2017/01/00 MSD Jun                2017-05-31 20:00:00   2017-05-31 20:00:00 
+ 2017/01/01                        2017-01-01 00:00:00   2017-01-01 00:00:00 
+ 201701 02 010203 UTC+0300         2017-01-01 22:02:03   2017-01-01 22:02:03 
+ 2017-01-02 03:04:05               2017-01-02 03:04:05   2017-01-02 03:04:05 
+ 2017-01-0203:04:05                               á´ºáµá´¸á´¸   0000-00-00 00:00:00 
+ 2017-01-02 03:04:05+0             2017-01-02 03:04:05   2017-01-02 03:04:05 
+ 2017-01-02 03:04:05+00            2017-01-02 03:04:05   2017-01-02 03:04:05 
+ 2017-01-02 03:04:05+0000          2017-01-02 03:04:05   2017-01-02 03:04:05 
+ 2017-01-02 03:04:05 -0100         2017-01-02 04:04:05   2017-01-02 04:04:05 
+ 2017-01-02 03:04:05+030           2017-01-02 02:34:05   2017-01-02 02:34:05 
+ 2017-01-02 03:04:05+0300          2017-01-02 00:04:05   2017-01-02 00:04:05 
+ 2017-01-02 03:04:05+1             2017-01-02 02:04:05   2017-01-02 02:04:05 
+ 2017-01-02 03:04:05+300           2017-01-02 00:04:05   2017-01-02 00:04:05 
+ 2017-01-02 03:04:05+900           2017-01-01 18:04:05   2017-01-01 18:04:05 
+ 2017-01-02 03:04:05GMT            2017-01-02 03:04:05   2017-01-02 03:04:05 
+ 2017-01-02 03:04:05 MSD           2017-01-01 23:04:05   2017-01-01 23:04:05 
+ 2017-01-02 03:04:05 MSD Feb       2017-02-01 23:04:05   2017-02-01 23:04:05 
+ 2017-01-02 03:04:05 MSD Jun       2017-06-01 23:04:05   2017-06-01 23:04:05 
+ 2017-01-02 03:04:05 MSK           2017-01-02 00:04:05   2017-01-02 00:04:05 
+ 2017-01-02T03:04:05               2017-01-02 03:04:05   2017-01-02 03:04:05 
+ 2017-01-02T03:04:05+00            2017-01-02 03:04:05   2017-01-02 03:04:05 
+ 2017-01-02T03:04:05 -0100         2017-01-02 04:04:05   2017-01-02 04:04:05 
+ 2017-01-02T03:04:05-0100          2017-01-02 04:04:05   2017-01-02 04:04:05 
+ 2017-01-02T03:04:05+0100          2017-01-02 02:04:05   2017-01-02 02:04:05 
+ 2017-01-02T03:04:05Z              2017-01-02 03:04:05   2017-01-02 03:04:05 
+ 2017-01 03:04:05 MSD Jun          2017-05-31 23:04:05   2017-05-31 23:04:05 
+ 2017-01 03:04 MSD Jun             2017-05-31 23:04:00   2017-05-31 23:04:00 
+ 2017/01/31                        2017-01-31 00:00:00   2017-01-31 00:00:00 
+ 2017/01/32                        0000-00-00 00:00:00   0000-00-00 00:00:00 
+ 2017-01 MSD Jun                   2017-05-31 20:00:00   2017-05-31 20:00:00 
+ 201701 MSD Jun                    2017-05-31 20:00:00   2017-05-31 20:00:00 
+ 2017 25 1:2:3                     0000-00-00 00:00:00   0000-00-00 00:00:00 
+ 2017 25 Apr 1:2:3                 2017-04-01 01:02:03   2017-04-01 01:02:03 
+ 2017 Apr 01 11:22:33              2017-04-01 11:22:33   2017-04-01 11:22:33 
+ 2017 Apr 02 01/02/03 UTC+0300                    á´ºáµá´¸á´¸   0000-00-00 00:00:00 
+ 2017 Apr 02 010203 UTC+0300       2017-04-01 22:02:03   2017-04-01 22:02:03 
+ 2017 Apr 02 01:2:3 UTC+0300       2017-04-01 22:02:03   2017-04-01 22:02:03 
+ 2017 Apr 02 1:02:3                2017-04-02 01:02:03   2017-04-02 01:02:03 
+ 2017 Apr 02 11:22:33              2017-04-02 11:22:33   2017-04-02 11:22:33 
+ 2017 Apr 02 1:2:03                2017-04-02 01:02:03   2017-04-02 01:02:03 
+ 2017 Apr 02 1:22:33               2017-04-02 01:22:33   2017-04-02 01:22:33 
+ 2017 Apr 02 1:2:3                 2017-04-02 01:02:03   2017-04-02 01:02:03 
+ 2017 Apr 02 1:2:33                2017-04-02 01:02:33   2017-04-02 01:02:33 
+ 2017 Apr 02 1:2:3 MSK             2017-04-01 22:02:03   2017-04-01 22:02:03 
+ 2017 Apr 02 1:2:3 MSK 2017        2017-04-01 22:02:03   2017-04-01 22:02:03 
+ 2017 Apr 02 1:2:3 MSK 2018        2017-04-01 22:02:03   2017-04-01 22:02:03 
+ 2017 Apr 02 1:2:3 UTC+0000        2017-04-02 01:02:03   2017-04-02 01:02:03 
+ 2017 Apr 02 1:2:3 UTC+0300        2017-04-01 22:02:03   2017-04-01 22:02:03 
+ 2017 Apr 02 1:2:3 UTC+0400        2017-04-01 21:02:03   2017-04-01 21:02:03 
+ 2017 Apr 2 1:2:3                  2017-04-02 01:02:03   2017-04-02 01:02:03 
+ 2017 Jan 02 010203 UTC+0300       2017-01-01 22:02:03   2017-01-01 22:02:03 
+ 25 Apr 2017 01:02:03              2017-04-25 01:02:03   2017-04-25 01:02:03 
+ 25 Apr 2017 1:2:3                 2017-04-25 01:02:03   2017-04-25 01:02:03 
+ 25 Jan 2017 1:2:3                 2017-01-25 01:02:03   2017-01-25 01:02:03 
+ 25 Jan 2017 1:2:3 MSK             2017-01-24 22:02:03   2017-01-24 22:02:03 
+ 25 Jan 2017 1:2:3 PM              2017-01-25 13:02:03   2017-01-25 13:02:03 
+ 25 Jan 2017 1:2:3Z                2017-01-25 01:02:03   2017-01-25 01:02:03 
+ 25 Jan 2017 1:2:3 Z               2017-01-25 01:02:03   2017-01-25 01:02:03 
+ 25 Jan 2017 1:2:3 Z +0300         2017-01-24 22:02:03   2017-01-24 22:02:03 
+ 25 Jan 2017 1:2:3 Z+03:00         2017-01-24 22:02:03   2017-01-24 22:02:03 
+ 25 Jan 2017 1:2:3 Z +0300 OM                     á´ºáµá´¸á´¸   0000-00-00 00:00:00 
+ 25 Jan 2017 1:2:3 Z +03:00 PM     2017-01-25 10:02:03   2017-01-25 10:02:03 
+ 25 Jan 2017 1:2:3 Z +0300 PM      2017-01-25 10:02:03   2017-01-25 10:02:03 
+ 25 Jan 2017 1:2:3 Z+03:00 PM      2017-01-25 10:02:03   2017-01-25 10:02:03 
+ 25 Jan 2017 1:2:3 Z +03:30 PM     2017-01-25 09:32:03   2017-01-25 09:32:03 
+ 25 Jan 2017 1:2:3Z Mo                            á´ºáµá´¸á´¸   0000-00-00 00:00:00 
+ 25 Jan 2017 1:2:3Z Mon            2017-01-25 01:02:03   2017-01-25 01:02:03 
+ 25 Jan 2017 1:2:3Z Moo                           á´ºáµá´¸á´¸   0000-00-00 00:00:00 
+ 25 Jan 2017 1:2:3 Z PM            2017-01-25 13:02:03   2017-01-25 13:02:03 
+ 25 Jan 2017 1:2:3Z PM             2017-01-25 13:02:03   2017-01-25 13:02:03 
+ 25 Jan 2017 1:2:3 Z PM +03:00     2017-01-25 10:02:03   2017-01-25 10:02:03 
+ Jun, 11 Feb 2018 06:40:50 +0300   2000-06-01 00:00:00   2000-06-01 00:00:00 
+ Sun 11 Feb 2018 06:40:50 +0300    2018-02-11 03:40:50   2018-02-11 03:40:50 
+ Sun, 11 Feb 2018 06:40:50 +0300   2018-02-11 03:40:50   2018-02-11 03:40:50 
diff --git a/tests/queries/0_stateless/00813_parse_date_time_best_effort_more.reference b/tests/queries/0_stateless/00813_parse_date_time_best_effort_more.reference
index 921400838d0e..3acae55e8462 100644
--- a/tests/queries/0_stateless/00813_parse_date_time_best_effort_more.reference
+++ b/tests/queries/0_stateless/00813_parse_date_time_best_effort_more.reference
@@ -1,22 +1,22 @@
-s                                               a                     b
+ s                                               a                     b
 
-24.12.2018                    2018-12-24 00:00:00   2018-12-24 00:00:00
-24-12-2018                    2018-12-24 00:00:00   2018-12-24 00:00:00
-24.12.18                      2018-12-24 00:00:00   2018-12-24 00:00:00
-24-12-18                      2018-12-24 00:00:00   2018-12-24 00:00:00
-24-Dec-18                     2018-12-24 00:00:00   2018-12-24 00:00:00
-24/DEC/18                     2018-12-24 00:00:00   2018-12-24 00:00:00
-24/DEC/2018                   2018-12-24 00:00:00   2018-12-24 00:00:00
-01-OCT-2015                   2015-10-01 00:00:00   2015-10-01 00:00:00
-24.12.2018                    2018-12-24 00:00:00   2018-12-24 00:00:00
-24-12-2018                    2018-12-24 00:00:00   2018-12-24 00:00:00
-24.12.18                      2018-12-24 00:00:00   2018-12-24 00:00:00
-24-12-18                      2018-12-24 00:00:00   2018-12-24 00:00:00
-24-Dec-18                     2018-12-24 00:00:00   2018-12-24 00:00:00
-24/DEC/18                     2018-12-24 00:00:00   2018-12-24 00:00:00
-24/DEC/2018                   2018-12-24 00:00:00   2018-12-24 00:00:00
-01-OCT-2015                   2015-10-01 00:00:00   2015-10-01 00:00:00
-24.12.18 010203               2018-12-24 01:02:03   2018-12-24 01:02:03
-24.12.18 01:02:03             2018-12-24 01:02:03   2018-12-24 01:02:03
-24.DEC.18T01:02:03.000+0300   2018-12-23 22:02:03   2018-12-23 22:02:03
-01-September-2018 11:22       2018-09-01 11:22:00   2018-09-01 11:22:00
+ 24.12.2018                    2018-12-24 00:00:00   2018-12-24 00:00:00 
+ 24-12-2018                    2018-12-24 00:00:00   2018-12-24 00:00:00 
+ 24.12.18                      2018-12-24 00:00:00   2018-12-24 00:00:00 
+ 24-12-18                      2018-12-24 00:00:00   2018-12-24 00:00:00 
+ 24-Dec-18                     2018-12-24 00:00:00   2018-12-24 00:00:00 
+ 24/DEC/18                     2018-12-24 00:00:00   2018-12-24 00:00:00 
+ 24/DEC/2018                   2018-12-24 00:00:00   2018-12-24 00:00:00 
+ 01-OCT-2015                   2015-10-01 00:00:00   2015-10-01 00:00:00 
+ 24.12.2018                    2018-12-24 00:00:00   2018-12-24 00:00:00 
+ 24-12-2018                    2018-12-24 00:00:00   2018-12-24 00:00:00 
+ 24.12.18                      2018-12-24 00:00:00   2018-12-24 00:00:00 
+ 24-12-18                      2018-12-24 00:00:00   2018-12-24 00:00:00 
+ 24-Dec-18                     2018-12-24 00:00:00   2018-12-24 00:00:00 
+ 24/DEC/18                     2018-12-24 00:00:00   2018-12-24 00:00:00 
+ 24/DEC/2018                   2018-12-24 00:00:00   2018-12-24 00:00:00 
+ 01-OCT-2015                   2015-10-01 00:00:00   2015-10-01 00:00:00 
+ 24.12.18 010203               2018-12-24 01:02:03   2018-12-24 01:02:03 
+ 24.12.18 01:02:03             2018-12-24 01:02:03   2018-12-24 01:02:03 
+ 24.DEC.18T01:02:03.000+0300   2018-12-23 22:02:03   2018-12-23 22:02:03 
+ 01-September-2018 11:22       2018-09-01 11:22:00   2018-09-01 11:22:00 
diff --git a/tests/queries/0_stateless/01293_pretty_max_value_width.reference b/tests/queries/0_stateless/01293_pretty_max_value_width.reference
new file mode 100644
index 000000000000..9887169f7af7
--- /dev/null
+++ b/tests/queries/0_stateless/01293_pretty_max_value_width.reference
@@ -0,0 +1,114 @@
+â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”“
+â”ƒ [1mx     [0m â”ƒ [1my  [0m â”ƒ
+â”¡â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”©
+â”‚ Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚ â”‚ Ğ¼Ğ¸Ñ€ â”‚
+â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
+â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”“
+â”ƒ [1mx    [0m â”ƒ [1my  [0m â”ƒ
+â”¡â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”©
+â”‚ Ğ¿Ñ€Ğ¸Ğ²Ğµ[31;1mâ‹¯[0mâ”‚ Ğ¼Ğ¸Ñ€ â”‚
+â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
+â”Œâ”€[1mx[0mâ”€â”€â”€â”€â”€â”¬â”€[1my[0mâ”€â”€â”€â”
+â”‚ Ğ¿Ñ€Ğ¸Ğ²Ğµ[31;1mâ‹¯[0mâ”‚ Ğ¼Ğ¸Ñ€ â”‚
+â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
+ [1mx[0m       [1my[0m  
+
+ Ğ¿Ñ€Ğ¸Ğ²Ğµ[31;1mâ‹¯[0m  Ğ¼Ğ¸Ñ€ 
+â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”“
+â”ƒ [1mx    [0m â”ƒ [1my    [0m â”ƒ
+â”¡â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”©
+â”‚ Ğ¿Ñ€Ğ¸Ğ²Ğµ[31;1mâ‹¯[0mâ”‚ Ğ¼Ğ¸Ñ€   â”‚
+â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
+â”‚ Ğ¼Ğ¸Ñ€   â”‚ Ğ¿Ñ€Ğ¸Ğ²Ğµ[31;1mâ‹¯[0mâ”‚
+â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
+â”Œâ”€[1mx[0mâ”€â”€â”€â”€â”€â”¬â”€[1my[0mâ”€â”€â”€â”€â”€â”
+â”‚ Ğ¿Ñ€Ğ¸Ğ²Ğµ[31;1mâ‹¯[0mâ”‚ Ğ¼Ğ¸Ñ€   â”‚
+â”‚ Ğ¼Ğ¸Ñ€   â”‚ Ğ¿Ñ€Ğ¸Ğ²Ğµ[31;1mâ‹¯[0mâ”‚
+â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
+ [1mx[0m       [1my[0m    
+
+ Ğ¿Ñ€Ğ¸Ğ²Ğµ[31;1mâ‹¯[0m  Ğ¼Ğ¸Ñ€   
+ Ğ¼Ğ¸Ñ€     Ğ¿Ñ€Ğ¸Ğ²Ğµ[31;1mâ‹¯[0m
+â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”“
+â”ƒ [1mx     [0m â”ƒ [1my  [0m â”ƒ
+â”¡â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”©
+â”‚ Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚ â”‚ Ğ¼Ğ¸Ñ€ â”‚
+â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
+â”Œâ”€[1mx[0mâ”€â”€â”€â”€â”€â”€â”¬â”€[1my[0mâ”€â”€â”€â”
+â”‚ Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚ â”‚ Ğ¼Ğ¸Ñ€ â”‚
+â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
+ [1mx[0m        [1my[0m  
+
+ Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚   Ğ¼Ğ¸Ñ€ 
+â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
+â”ƒ [1mx     [0m â”ƒ [1my     [0m â”ƒ
+â”¡â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
+â”‚ Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚ â”‚ Ğ¼Ğ¸Ñ€    â”‚
+â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
+â”‚ Ğ¼Ğ¸Ñ€    â”‚ Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚ â”‚
+â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+â”Œâ”€[1mx[0mâ”€â”€â”€â”€â”€â”€â”¬â”€[1my[0mâ”€â”€â”€â”€â”€â”€â”
+â”‚ Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚ â”‚ Ğ¼Ğ¸Ñ€    â”‚
+â”‚ Ğ¼Ğ¸Ñ€    â”‚ Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚ â”‚
+â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+ [1mx[0m        [1my[0m     
+
+ Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚   Ğ¼Ğ¸Ñ€    
+ Ğ¼Ğ¸Ñ€      Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚ 
+â”â”â”â”â”³â”â”â”â”“
+â”ƒ [1mx[0m â”ƒ [1my[0m â”ƒ
+â”¡â”â”â”â•‡â”â”â”â”©
+â”‚ Ğ¿[31;1mâ‹¯[0mâ”‚ Ğ¼[31;1mâ‹¯[0mâ”‚
+â””â”€â”€â”€â”´â”€â”€â”€â”˜
+â”Œâ”€[1mx[0mâ”€â”¬â”€[1my[0mâ”€â”
+â”‚ Ğ¿[31;1mâ‹¯[0mâ”‚ Ğ¼[31;1mâ‹¯[0mâ”‚
+â””â”€â”€â”€â”´â”€â”€â”€â”˜
+ [1mx[0m   [1my[0m
+
+ Ğ¿[31;1mâ‹¯[0m  Ğ¼[31;1mâ‹¯[0m
+â”â”â”â”â”³â”â”â”â”“
+â”ƒ [1mx[0m â”ƒ [1my[0m â”ƒ
+â”¡â”â”â”â•‡â”â”â”â”©
+â”‚ Ğ¿[31;1mâ‹¯[0mâ”‚ Ğ¼[31;1mâ‹¯[0mâ”‚
+â”œâ”€â”€â”€â”¼â”€â”€â”€â”¤
+â”‚ Ğ¼[31;1mâ‹¯[0mâ”‚ Ğ¿[31;1mâ‹¯[0mâ”‚
+â””â”€â”€â”€â”´â”€â”€â”€â”˜
+â”Œâ”€[1mx[0mâ”€â”¬â”€[1my[0mâ”€â”
+â”‚ Ğ¿[31;1mâ‹¯[0mâ”‚ Ğ¼[31;1mâ‹¯[0mâ”‚
+â”‚ Ğ¼[31;1mâ‹¯[0mâ”‚ Ğ¿[31;1mâ‹¯[0mâ”‚
+â””â”€â”€â”€â”´â”€â”€â”€â”˜
+ [1mx[0m   [1my[0m
+
+ Ğ¿[31;1mâ‹¯[0m  Ğ¼[31;1mâ‹¯[0m
+ Ğ¼[31;1mâ‹¯[0m  Ğ¿[31;1mâ‹¯[0m
+â”â”â”â”â”³â”â”â”â”“
+â”ƒ [1mx[0m â”ƒ [1my[0m â”ƒ
+â”¡â”â”â”â•‡â”â”â”â”©
+â”‚ [31;1mâ‹¯[0m â”‚ [31;1mâ‹¯[0m â”‚
+â””â”€â”€â”€â”´â”€â”€â”€â”˜
+â”Œâ”€[1mx[0mâ”€â”¬â”€[1my[0mâ”€â”
+â”‚ [31;1mâ‹¯[0m â”‚ [31;1mâ‹¯[0m â”‚
+â””â”€â”€â”€â”´â”€â”€â”€â”˜
+ [1mx[0m   [1my[0m
+
+ [31;1mâ‹¯[0m   [31;1mâ‹¯[0m 
+â”â”â”â”â”³â”â”â”â”“
+â”ƒ [1mx[0m â”ƒ [1my[0m â”ƒ
+â”¡â”â”â”â•‡â”â”â”â”©
+â”‚ [31;1mâ‹¯[0m â”‚ [31;1mâ‹¯[0m â”‚
+â”œâ”€â”€â”€â”¼â”€â”€â”€â”¤
+â”‚ [31;1mâ‹¯[0m â”‚ [31;1mâ‹¯[0m â”‚
+â””â”€â”€â”€â”´â”€â”€â”€â”˜
+â”Œâ”€[1mx[0mâ”€â”¬â”€[1my[0mâ”€â”
+â”‚ [31;1mâ‹¯[0m â”‚ [31;1mâ‹¯[0m â”‚
+â”‚ [31;1mâ‹¯[0m â”‚ [31;1mâ‹¯[0m â”‚
+â””â”€â”€â”€â”´â”€â”€â”€â”˜
+ [1mx[0m   [1my[0m
+
+ [31;1mâ‹¯[0m   [31;1mâ‹¯[0m 
+ [31;1mâ‹¯[0m   [31;1mâ‹¯[0m 
+â”â”â”â”â”³â”â”â”â”“
+â”ƒ x â”ƒ y â”ƒ
+â”¡â”â”â”â•‡â”â”â”â”©
+â”‚ â‹¯ â”‚ â‹¯ â”‚
+â””â”€â”€â”€â”´â”€â”€â”€â”˜
diff --git a/tests/queries/0_stateless/01293_pretty_max_value_width.sql b/tests/queries/0_stateless/01293_pretty_max_value_width.sql
new file mode 100644
index 000000000000..992aec06f0a2
--- /dev/null
+++ b/tests/queries/0_stateless/01293_pretty_max_value_width.sql
@@ -0,0 +1,43 @@
+SELECT 'Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚' AS x, 'Ğ¼Ğ¸Ñ€' AS y FORMAT Pretty;
+
+SET output_format_pretty_max_value_width = 5;
+SELECT 'Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚' AS x, 'Ğ¼Ğ¸Ñ€' AS y FORMAT Pretty;
+SELECT 'Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚' AS x, 'Ğ¼Ğ¸Ñ€' AS y FORMAT PrettyCompact;
+SELECT 'Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚' AS x, 'Ğ¼Ğ¸Ñ€' AS y FORMAT PrettySpace;
+
+SELECT * FROM VALUES('x String, y String', ('Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚', 'Ğ¼Ğ¸Ñ€'), ('Ğ¼Ğ¸Ñ€', 'Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚')) FORMAT Pretty;
+SELECT * FROM VALUES('x String, y String', ('Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚', 'Ğ¼Ğ¸Ñ€'), ('Ğ¼Ğ¸Ñ€', 'Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚')) FORMAT PrettyCompact;
+SELECT * FROM VALUES('x String, y String', ('Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚', 'Ğ¼Ğ¸Ñ€'), ('Ğ¼Ğ¸Ñ€', 'Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚')) FORMAT PrettySpace;
+
+SET output_format_pretty_max_value_width = 6;
+
+SELECT 'Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚' AS x, 'Ğ¼Ğ¸Ñ€' AS y FORMAT Pretty;
+SELECT 'Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚' AS x, 'Ğ¼Ğ¸Ñ€' AS y FORMAT PrettyCompact;
+SELECT 'Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚' AS x, 'Ğ¼Ğ¸Ñ€' AS y FORMAT PrettySpace;
+
+SELECT * FROM VALUES('x String, y String', ('Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚', 'Ğ¼Ğ¸Ñ€'), ('Ğ¼Ğ¸Ñ€', 'Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚')) FORMAT Pretty;
+SELECT * FROM VALUES('x String, y String', ('Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚', 'Ğ¼Ğ¸Ñ€'), ('Ğ¼Ğ¸Ñ€', 'Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚')) FORMAT PrettyCompact;
+SELECT * FROM VALUES('x String, y String', ('Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚', 'Ğ¼Ğ¸Ñ€'), ('Ğ¼Ğ¸Ñ€', 'Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚')) FORMAT PrettySpace;
+
+SET output_format_pretty_max_value_width = 1;
+
+SELECT 'Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚' AS x, 'Ğ¼Ğ¸Ñ€' AS y FORMAT Pretty;
+SELECT 'Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚' AS x, 'Ğ¼Ğ¸Ñ€' AS y FORMAT PrettyCompact;
+SELECT 'Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚' AS x, 'Ğ¼Ğ¸Ñ€' AS y FORMAT PrettySpace;
+
+SELECT * FROM VALUES('x String, y String', ('Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚', 'Ğ¼Ğ¸Ñ€'), ('Ğ¼Ğ¸Ñ€', 'Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚')) FORMAT Pretty;
+SELECT * FROM VALUES('x String, y String', ('Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚', 'Ğ¼Ğ¸Ñ€'), ('Ğ¼Ğ¸Ñ€', 'Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚')) FORMAT PrettyCompact;
+SELECT * FROM VALUES('x String, y String', ('Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚', 'Ğ¼Ğ¸Ñ€'), ('Ğ¼Ğ¸Ñ€', 'Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚')) FORMAT PrettySpace;
+
+SET output_format_pretty_max_value_width = 0;
+
+SELECT 'Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚' AS x, 'Ğ¼Ğ¸Ñ€' AS y FORMAT Pretty;
+SELECT 'Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚' AS x, 'Ğ¼Ğ¸Ñ€' AS y FORMAT PrettyCompact;
+SELECT 'Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚' AS x, 'Ğ¼Ğ¸Ñ€' AS y FORMAT PrettySpace;
+
+SELECT * FROM VALUES('x String, y String', ('Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚', 'Ğ¼Ğ¸Ñ€'), ('Ğ¼Ğ¸Ñ€', 'Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚')) FORMAT Pretty;
+SELECT * FROM VALUES('x String, y String', ('Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚', 'Ğ¼Ğ¸Ñ€'), ('Ğ¼Ğ¸Ñ€', 'Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚')) FORMAT PrettyCompact;
+SELECT * FROM VALUES('x String, y String', ('Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚', 'Ğ¼Ğ¸Ñ€'), ('Ğ¼Ğ¸Ñ€', 'Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚')) FORMAT PrettySpace;
+
+SET output_format_pretty_color = 0;
+SELECT 'Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚' AS x, 'Ğ¼Ğ¸Ñ€' AS y FORMAT Pretty;
