diff --git a/dbms/tests/queries/0_stateless/01107_join_right_table_totals.reference b/dbms/tests/queries/0_stateless/01107_join_right_table_totals.reference
new file mode 100644
index 000000000000..77db8015b0ea
--- /dev/null
+++ b/dbms/tests/queries/0_stateless/01107_join_right_table_totals.reference
@@ -0,0 +1,10 @@
+
+0
+
+0
+
+0
+
+0
+
+0	0	0
diff --git a/dbms/tests/queries/0_stateless/01107_join_right_table_totals.sql b/dbms/tests/queries/0_stateless/01107_join_right_table_totals.sql
new file mode 100644
index 000000000000..77e8848c9572
--- /dev/null
+++ b/dbms/tests/queries/0_stateless/01107_join_right_table_totals.sql
@@ -0,0 +1,38 @@
+DROP TABLE IF EXISTS t;
+CREATE TABLE t (item_id UInt64, price_sold Float32, date Date) ENGINE MergeTree ORDER BY item_id;
+
+SELECT item_id
+FROM (SELECT item_id FROM t GROUP BY item_id WITH TOTALS) l
+FULL JOIN (SELECT item_id FROM t GROUP BY item_id WITH TOTALS) r
+USING (item_id);
+
+SELECT id
+FROM (SELECT item_id AS id FROM t GROUP BY id WITH TOTALS) l
+FULL JOIN (SELECT item_id AS id FROM t GROUP BY id WITH TOTALS) r
+USING (id);
+
+SELECT item_id
+FROM (SELECT item_id FROM t GROUP BY item_id WITH TOTALS) l
+INNER JOIN (SELECT item_id FROM t GROUP BY item_id WITH TOTALS) r
+USING (item_id);
+
+SELECT id
+FROM (SELECT item_id AS id FROM t GROUP BY id WITH TOTALS) l
+INNER JOIN (SELECT item_id AS id FROM t GROUP BY id WITH TOTALS) r
+USING (id);
+
+SELECT id, yago, recent
+FROM (
+    SELECT item_id AS id, SUM(price_sold) AS recent
+    FROM t WHERE (date BETWEEN '2019-12-16' AND '2020-03-08')
+    GROUP BY id WITH TOTALS
+) ll
+FULL JOIN
+(
+    SELECT item_id AS id, SUM(price_sold) AS yago
+    FROM t WHERE (date BETWEEN '2018-12-17' AND '2019-03-10')
+    GROUP BY id WITH TOTALS
+) rr
+USING (id);
+
+DROP TABLE t;
