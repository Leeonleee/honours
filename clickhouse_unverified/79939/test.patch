diff --git a/tests/queries/0_stateless/03448_topk_merging.reference b/tests/queries/0_stateless/03448_topk_merging.reference
new file mode 100644
index 000000000000..781066625b86
--- /dev/null
+++ b/tests/queries/0_stateless/03448_topk_merging.reference
@@ -0,0 +1,39 @@
+6	a	30	0
+6	b	30	0
+6	c	30	0
+6	d	20	0
+6	e	20	0
+8	i	30	0
+8	j	30	0
+8	k	30	0
+8	d	20	0
+8	e	20	0
+9	l	30	0
+9	m	30	0
+9	n	30	0
+9	d	20	0
+9	e	20	0
+10	w	30	0
+10	y	30	0
+10	z	30	0
+10	d	20	0
+10	e	20	0
+11	i	30	0
+11	j	30	0
+11	k	30	0
+11	d	20	0
+11	e	20	0
+d	100	0
+e	100	0
+i	60	0
+j	60	0
+k	60	0
+a	30	0
+b	30	0
+c	30	0
+l	30	0
+m	30	0
+n	30	0
+w	30	0
+y	30	0
+z	30	0
diff --git a/tests/queries/0_stateless/03448_topk_merging.sql b/tests/queries/0_stateless/03448_topk_merging.sql
new file mode 100644
index 000000000000..416f2bcd2dbb
--- /dev/null
+++ b/tests/queries/0_stateless/03448_topk_merging.sql
@@ -0,0 +1,66 @@
+DROP TABLE IF EXISTS topk_test;
+
+CREATE TABLE topk_test (
+    foo UInt64,
+    top_items AggregateFunction(topKWeighted(100, 3, 'counts'), String, UInt64)
+)
+ENGINE = AggregatingMergeTree()
+ORDER BY (foo);
+
+INSERT INTO topk_test
+SELECT
+    6 AS foo,
+    topKWeightedState(100, 3, 'counts')(item, toUInt64(10))
+FROM (
+    SELECT arrayJoin(['a','a','a','b','b','b','c','c','c','d','d','e','e']) AS item
+);
+
+INSERT INTO topk_test
+SELECT
+    8 AS foo,
+    topKWeightedState(100, 3, 'counts')(item, toUInt64(10))
+FROM (
+    SELECT arrayJoin(['i','i','i','j','j','j','k','k','k','d','d','e','e']) AS item
+);
+
+INSERT INTO topk_test
+SELECT
+    9 AS foo,
+    topKWeightedState(100, 3, 'counts')(item, toUInt64(10))
+FROM (
+    SELECT arrayJoin(['l','l','l','m','m','m','n','n','n','d','d','e','e']) AS item
+);
+
+INSERT INTO topk_test
+SELECT
+    10 AS foo,
+    topKWeightedState(100, 3, 'counts')(item, toUInt64(10))
+FROM (
+    SELECT arrayJoin(['z','z','z','w','w','w','y','y','y','d','d','e','e']) AS item
+);
+
+INSERT INTO topk_test
+SELECT
+    11 AS foo,
+    topKWeightedState(100, 3, 'counts')(item, toUInt64(10))
+FROM (
+    SELECT arrayJoin(['i','i','i','j','j','j','k','k','k','d','d','e','e']) AS item
+);
+
+SELECT * FROM (
+    SELECT
+        foo,
+        untuple(arrayJoin(topKWeightedMerge(100, 3, 'counts')(top_items))) AS top
+    FROM topk_test
+    GROUP BY foo
+)
+ORDER BY foo, top.count DESC, top.item;
+
+SELECT * FROM (
+    SELECT
+        untuple(arrayJoin(topKWeightedMerge(100, 3, 'counts')(top_items))) AS top
+    FROM topk_test FINAL
+)
+ORDER BY top.count DESC, top.item;
+
+DROP TABLE topk_test;
