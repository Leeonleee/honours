You will be provided with a partial code base and an issue statement explaining a problem to resolve.

<issue>
AggregatingMergeTree topK merging across buckets has unexpected results

**Company or project name**
Company is on Clickhouse Cloud (LangChain). 

**Describe the unexpected behaviour**
TopK not merging correctly across different aggregation buckets when using AggregatedMergeTree.  

**How to reproduce**
https://fiddle.clickhouse.com/9b4a0d4f-9ec4-4689-8b75-392a0ccdb7bb

```
CREATE TABLE topk_test
(
    tenant_id UUID,
    hour DateTime,
    top_items AggregateFunction(topK(10), String)
)
ENGINE = AggregatingMergeTree()
ORDER BY (tenant_id, hour);


INSERT INTO topk_test
SELECT
    '00000000-0000-0000-0000-000000000000' AS tenant_id,
    toDateTime('2024-12-14 06:00:00') AS hour,
    topKState(10)(item)
FROM (
    SELECT arrayJoin(['a','a','a','b','b','b','c','c','c','d','d','e','e']) AS item
);

INSERT INTO topk_test
SELECT
    '00000000-0000-0000-0000-000000000000' AS tenant_id,
    toDateTime('2024-12-14 07:00:00') AS hour,
    topKState(10)(item)
FROM (
    SELECT arrayJoin(['f','f','f','g','g','g','h','h','h','d','d','e','e']) AS item
);

INSERT INTO topk_test_4
SELECT
    '00000000-0000-0000-0000-000000000000' AS tenant_id,
    toDateTime('2024-12-14 08:00:00') AS hour,
    topKState(10)(item)
FROM (
    SELECT arrayJoin(['i','i','i','j','j','j','k','k','k','d','d','e','e']) AS item
);

INSERT INTO topk_test
SELECT
    '00000000-0000-0000-0000-000000000000' AS tenant_id,
    toDateTime('2024-12-14 09:00:00') AS hour,
    topKState(10)(item)
FROM (
    SELECT arrayJoin(['l','l','l','m','m','m','n','n','n','d','d','e','e']) AS item
);

INSERT INTO topk_test
SELECT
    '00000000-0000-0000-0000-000000000000' AS tenant_id,
    toDateTime('2024-12-14 10:00:00') AS hour,
    topKState(10)(item)
FROM (
    SELECT arrayJoin(['z','z','z','w','w','w','y','y','y','d','d','e','e']) AS item
);

INSERT INTO topk_test
SELECT
    '00000000-0000-0000-0000-000000000000' AS tenant_id,
    toDateTime('2024-12-14 11:00:00') AS hour,
    topKState(10)(item)
FROM (
    SELECT arrayJoin(['i','i','i','j','j','j','k','k','k','d','d','e','e']) AS item
);

SELECT
    hour,
    topKMerge(10)(top_items) AS top3
FROM topk_test
WHERE tenant_id = '00000000-0000-0000-0000-000000000000'
GROUP BY hour
ORDER BY hour;

-- global merge: this is wrong
SELECT
    topKMerge(10)(top_items) AS global_top3
FROM topk_test
WHERE tenant_id = '00000000-0000-0000-0000-000000000000';
```

**Expected behavior**
For the global merge, shouldShould merge the topK stats correctly, global top 3 should be:  ['d', 'e', _]

**Additional context**
Trying to improve performance for topK stats -  currently this is calculated via raw table but performance is not good for large datasets. So trying to move to aggregate this and bucket it per hour using AggregatedMergeTree and then query the aggregated table. However, that requires merging across time periods.
</issue>

I need you to solve the provided issue by generating a code fix that can be applied directly to the repository

Respond below:
