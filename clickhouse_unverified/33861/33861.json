{
  "repo": "ClickHouse/ClickHouse",
  "pull_number": 33861,
  "instance_id": "ClickHouse__ClickHouse-33861",
  "issue_numbers": [
    "33736"
  ],
  "base_commit": "b2945766d0cfb7efc23ce094b5b4a2703815552c",
  "patch": "diff --git a/docs/en/sql-reference/functions/array-functions.md b/docs/en/sql-reference/functions/array-functions.md\nindex 3f96f75e7b8c..4fe7e44aad77 100644\n--- a/docs/en/sql-reference/functions/array-functions.md\n+++ b/docs/en/sql-reference/functions/array-functions.md\n@@ -620,9 +620,9 @@ arraySlice(array, offset[, length])\n \n **Arguments**\n \n--   `array` \u2013 Array of data.\n--   `offset` \u2013 Indent from the edge of the array. A positive value indicates an offset on the left, and a negative value is an indent on the right. Numbering of the array items begins with 1.\n--   `length` \u2013 The length of the required slice. If you specify a negative value, the function returns an open slice `[offset, array_length - length)`. If you omit the value, the function returns the slice `[offset, the_end_of_array]`.\n+- `array` \u2013 Array of data.\n+- `offset` \u2013 Indent from the edge of the array. A positive value indicates an offset on the left, and a negative value is an indent on the right. Numbering of the array items begins with 1.\n+- `length` \u2013 The length of the required slice. If you specify a negative value, the function returns an open slice `[offset, array_length - length]`. If you omit the value, the function returns the slice `[offset, the_end_of_array]`.\n \n **Example**\n \ndiff --git a/docs/en/sql-reference/functions/bit-functions.md b/docs/en/sql-reference/functions/bit-functions.md\nindex c23c5ac54310..4a3c1b5ecd50 100644\n--- a/docs/en/sql-reference/functions/bit-functions.md\n+++ b/docs/en/sql-reference/functions/bit-functions.md\n@@ -130,13 +130,9 @@ bitSlice(s, offset[, length])\n \n **Arguments**\n \n-- `s` \u2014 s is [String](../../sql-reference/data-types/string.md)\n-  or [FixedString](../../sql-reference/data-types/fixedstring.md).\n-- `offset` \u2014 The start index with bit, A positive value indicates an offset on the left, and a negative value is an\n-  indent on the right. Numbering of the bits begins with 1.\n-- `length` \u2014 The length of substring with bit. If you specify a negative value, the function returns an open substring [\n-  offset, array_length - length). If you omit the value, the function returns the substring [offset, the_end_string]. \n-  If length exceeds s, it will be truncate.If length isn't multiple of 8, will fill 0 on the right.\n+- `s` \u2014 s is [String](../../sql-reference/data-types/string.md) or [FixedString](../../sql-reference/data-types/fixedstring.md).\n+- `offset` \u2014 The start index with bit, A positive value indicates an offset on the left, and a negative value is an indent on the right. Numbering of the bits begins with 1.\n+- `length` \u2014 The length of substring with bit. If you specify a negative value, the function returns an open substring \\[offset, array_length - length\\]. If you omit the value, the function returns the substring \\[offset, the_end_string\\]. If length exceeds s, it will be truncate.If length isn't multiple of 8, will fill 0 on the right.\n \n **Returned value**\n \ndiff --git a/docs/en/sql-reference/functions/string-functions.md b/docs/en/sql-reference/functions/string-functions.md\nindex d63e466a8363..0c1c738f6632 100644\n--- a/docs/en/sql-reference/functions/string-functions.md\n+++ b/docs/en/sql-reference/functions/string-functions.md\n@@ -480,7 +480,7 @@ Result:\n \n ## substring(s, offset, length), mid(s, offset, length), substr(s, offset, length) {#substring}\n \n-Returns a substring starting with the byte from the \u2018offset\u2019 index that is \u2018length\u2019 bytes long. Character indexing starts from one (as in standard SQL). The \u2018offset\u2019 and \u2018length\u2019 arguments must be constants.\n+Returns a substring starting with the byte from the \u2018offset\u2019 index that is \u2018length\u2019 bytes long. Character indexing starts from one (as in standard SQL).\n \n ## substringUTF8(s, offset, length) {#substringutf8}\n \ndiff --git a/docs/ru/sql-reference/functions/array-functions.md b/docs/ru/sql-reference/functions/array-functions.md\nindex 5a32df4318a0..dcc539a35940 100644\n--- a/docs/ru/sql-reference/functions/array-functions.md\n+++ b/docs/ru/sql-reference/functions/array-functions.md\n@@ -574,9 +574,9 @@ arraySlice(array, offset[, length])\n \n **\u0410\u0440\u0433\u0443\u043c\u0435\u043d\u0442\u044b**\n \n--   `array` \u2013 \u043c\u0430\u0441\u0441\u0438\u0432 \u0434\u0430\u043d\u043d\u044b\u0445.\n--   `offset` \u2013 \u043e\u0442\u0441\u0442\u0443\u043f \u043e\u0442 \u043a\u0440\u0430\u044f \u043c\u0430\u0441\u0441\u0438\u0432\u0430. \u041f\u043e\u043b\u043e\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 - \u043e\u0442\u0441\u0442\u0443\u043f \u0441\u043b\u0435\u0432\u0430, \u043e\u0442\u0440\u0438\u0446\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 - \u043e\u0442\u0441\u0442\u0443\u043f \u0441\u043f\u0440\u0430\u0432\u0430. \u041e\u0442\u0441\u0447\u0435\u0442 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u043e\u0432 \u043c\u0430\u0441\u0441\u0438\u0432\u0430 \u043d\u0430\u0447\u0438\u043d\u0430\u0435\u0442\u0441\u044f \u0441 1.\n--   `length` \u2013 \u0434\u043b\u0438\u043d\u0430 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0433\u043e \u0441\u0440\u0435\u0437\u0430. \u0415\u0441\u043b\u0438 \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u043e\u0442\u0440\u0438\u0446\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435, \u0442\u043e \u0444\u0443\u043d\u043a\u0446\u0438\u044f \u0432\u0435\u0440\u043d\u0451\u0442 \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0439 \u0441\u0440\u0435\u0437 `[offset, array_length - length)`. \u0415\u0441\u043b\u0438 \u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435, \u0442\u043e \u0444\u0443\u043d\u043a\u0446\u0438\u044f \u0432\u0435\u0440\u043d\u0451\u0442 \u0441\u0440\u0435\u0437 `[offset, the_end_of_array]`.\n+- `array` \u2013 \u043c\u0430\u0441\u0441\u0438\u0432 \u0434\u0430\u043d\u043d\u044b\u0445.\n+- `offset` \u2013 \u043e\u0442\u0441\u0442\u0443\u043f \u043e\u0442 \u043a\u0440\u0430\u044f \u043c\u0430\u0441\u0441\u0438\u0432\u0430. \u041f\u043e\u043b\u043e\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 - \u043e\u0442\u0441\u0442\u0443\u043f \u0441\u043b\u0435\u0432\u0430, \u043e\u0442\u0440\u0438\u0446\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 - \u043e\u0442\u0441\u0442\u0443\u043f \u0441\u043f\u0440\u0430\u0432\u0430. \u041e\u0442\u0441\u0447\u0451\u0442 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u043e\u0432 \u043c\u0430\u0441\u0441\u0438\u0432\u0430 \u043d\u0430\u0447\u0438\u043d\u0430\u0435\u0442\u0441\u044f \u0441 1.\n+- `length` \u2013 \u0434\u043b\u0438\u043d\u0430 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0433\u043e \u0441\u0440\u0435\u0437\u0430. \u0415\u0441\u043b\u0438 \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u043e\u0442\u0440\u0438\u0446\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435, \u0442\u043e \u0444\u0443\u043d\u043a\u0446\u0438\u044f \u0432\u0435\u0440\u043d\u0451\u0442 \u043e\u0442\u043a\u0440\u044b\u0442\u044b\u0439 \u0441\u0440\u0435\u0437 `[offset, array_length - length]`. \u0415\u0441\u043b\u0438 \u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435, \u0442\u043e \u0444\u0443\u043d\u043a\u0446\u0438\u044f \u0432\u0435\u0440\u043d\u0451\u0442 \u0441\u0440\u0435\u0437 `[offset, the_end_of_array]`.\n \n **\u041f\u0440\u0438\u043c\u0435\u0440**\n \ndiff --git a/docs/zh/sql-reference/functions/array-functions.md b/docs/zh/sql-reference/functions/array-functions.md\nindex 2a2b34da7e1c..6ec6d8fe3524 100644\n--- a/docs/zh/sql-reference/functions/array-functions.md\n+++ b/docs/zh/sql-reference/functions/array-functions.md\n@@ -397,9 +397,9 @@ SELECT arrayPushFront(['b'], 'a') AS res\n \n **\u53c2\u6570**\n \n--   `array` \u2013 \u6570\u7ec4\u3002\n--   `offset` \u2013 \u6570\u7ec4\u7684\u504f\u79fb\u3002\u6b63\u503c\u8868\u793a\u5de6\u4fa7\u7684\u504f\u79fb\u91cf\uff0c\u8d1f\u503c\u8868\u793a\u53f3\u4fa7\u7684\u7f29\u8fdb\u503c\u3002\u6570\u7ec4\u4e0b\u6807\u4ece1\u5f00\u59cb\u3002\n--   `length` - \u5b50\u6570\u7ec4\u7684\u957f\u5ea6\u3002\u5982\u679c\u6307\u5b9a\u8d1f\u503c\uff0c\u5219\u8be5\u51fd\u6570\u8fd4\u56de`[offset\uff0carray_length  -  length`\u3002\u5982\u679c\u7701\u7565\u8be5\u503c\uff0c\u5219\u8be5\u51fd\u6570\u8fd4\u56de`[offset\uff0cthe_end_of_array]`\u3002\n+- `array` \u2013 \u6570\u7ec4\u3002\n+- `offset` \u2013 \u6570\u7ec4\u7684\u504f\u79fb\u3002\u6b63\u503c\u8868\u793a\u5de6\u4fa7\u7684\u504f\u79fb\u91cf\uff0c\u8d1f\u503c\u8868\u793a\u53f3\u4fa7\u7684\u7f29\u8fdb\u503c\u3002\u6570\u7ec4\u4e0b\u6807\u4ece1\u5f00\u59cb\u3002\n+- `length` - \u5b50\u6570\u7ec4\u7684\u957f\u5ea6\u3002\u5982\u679c\u6307\u5b9a\u8d1f\u503c\uff0c\u5219\u8be5\u51fd\u6570\u8fd4\u56de`[offset\uff0carray_length - length]`\u3002\u5982\u679c\u7701\u7565\u8be5\u503c\uff0c\u5219\u8be5\u51fd\u6570\u8fd4\u56de`[offset\uff0cthe_end_of_array]`\u3002\n \n **\u793a\u4f8b**\n \ndiff --git a/src/Functions/GatherUtils/Algorithms.h b/src/Functions/GatherUtils/Algorithms.h\nindex c148b773ba75..dd23a40d2af0 100644\n--- a/src/Functions/GatherUtils/Algorithms.h\n+++ b/src/Functions/GatherUtils/Algorithms.h\n@@ -308,7 +308,7 @@ void NO_INLINE sliceFromRightConstantOffsetBounded(Source && src, Sink && sink,\n     {\n         ssize_t size = length;\n         if (size < 0)\n-            size += static_cast<ssize_t>(src.getElementSize()) - offset;\n+            size += offset;\n \n         if (size > 0)\n             writeSlice(src.getSliceFromRight(offset, size), sink);\n",
  "test_patch": "diff --git a/tests/queries/0_stateless/00498_array_functions_concat_slice_push_pop.reference b/tests/queries/0_stateless/00498_array_functions_concat_slice_push_pop.reference\nindex f757a86aeee0..f0d66bd49eb8 100644\n--- a/tests/queries/0_stateless/00498_array_functions_concat_slice_push_pop.reference\n+++ b/tests/queries/0_stateless/00498_array_functions_concat_slice_push_pop.reference\n@@ -217,12 +217,12 @@ arraySlice(arr1, -4, 2)\n arraySlice(arr1, -4, -1)\n []\t2\t4\t[]\n []\t2\t4\t[]\n-[1,2,3,4,5]\t2\t4\t[]\n-[1,2,3,4,5,6,7]\t2\t4\t[4,5]\n-[1,2,3,4,5,6,7]\t2\t4\t[4,5]\n-[1,2,3,4,5,6,7]\t2\t4\t[4,5]\n-[1,2,3,4,5,6,7]\t2\t4\t[4,5]\n-[1,2,3,4,5,6,7]\t2\t4\t[4,5]\n+[1,2,3,4,5]\t2\t4\t[2,3,4]\n+[1,2,3,4,5,6,7]\t2\t4\t[4,5,6]\n+[1,2,3,4,5,6,7]\t2\t4\t[4,5,6]\n+[1,2,3,4,5,6,7]\t2\t4\t[4,5,6]\n+[1,2,3,4,5,6,7]\t2\t4\t[4,5,6]\n+[1,2,3,4,5,6,7]\t2\t4\t[4,5,6]\n arrayPushFront(arr1, 1)\n []\t[1]\n []\t[1]\n@@ -504,12 +504,12 @@ arraySlice(arr1, -4, 2)\n arraySlice(arr1, -4, -1)\n []\t2\t4\t[]\n []\t2\t4\t[]\n-[1,2,3,4,5]\t2\t4\t[]\n-[1,NULL,3,4,NULL,6,7]\t2\t4\t[4,NULL]\n-[1,2,3,NULL,5,6,7]\t2\t4\t[NULL,5]\n-[1,2,3,4,5,NULL,7]\t2\t4\t[4,5]\n-[1,2,3,4,5,6,7]\t2\t4\t[4,5]\n-[1,NULL,3,NULL,5,6,7]\t2\t4\t[NULL,5]\n+[1,2,3,4,5]\t2\t4\t[2,3,4]\n+[1,NULL,3,4,NULL,6,7]\t2\t4\t[4,NULL,6]\n+[1,2,3,NULL,5,6,7]\t2\t4\t[NULL,5,6]\n+[1,2,3,4,5,NULL,7]\t2\t4\t[4,5,NULL]\n+[1,2,3,4,5,6,7]\t2\t4\t[4,5,6]\n+[1,NULL,3,NULL,5,6,7]\t2\t4\t[NULL,5,6]\n arrayPushFront(arr1, 1)\n []\t[1]\n []\t[1]\n@@ -817,12 +817,12 @@ arraySlice(arr1, -4, 2)\n arraySlice(arr1, -4, -1)\n []\t2\t4\t[]\n []\t2\t4\t[]\n-[1,2,3,4,5]\t2\t4\t[]\n-[1,NULL,3,4,NULL,6,7]\t2\t4\t[4,NULL]\n-[1,2,3,NULL,5,6,7]\t2\t4\t[NULL,5]\n-[1,2,3,4,5,NULL,7]\t2\t4\t[4,5]\n-[1,2,3,4,5,6,7]\t2\t4\t[4,5]\n-[1,NULL,3,NULL,5,6,7]\t2\t4\t[NULL,5]\n+[1,2,3,4,5]\t2\t4\t[2,3,4]\n+[1,NULL,3,4,NULL,6,7]\t2\t4\t[4,NULL,6]\n+[1,2,3,NULL,5,6,7]\t2\t4\t[NULL,5,6]\n+[1,2,3,4,5,NULL,7]\t2\t4\t[4,5,NULL]\n+[1,2,3,4,5,6,7]\t2\t4\t[4,5,6]\n+[1,NULL,3,NULL,5,6,7]\t2\t4\t[NULL,5,6]\n arrayPushFront(arr1, 1)\n []\t[1]\n []\t[1]\n@@ -1104,12 +1104,12 @@ arraySlice(arr1, -4, 2)\n arraySlice(arr1, -4, -1)\n []\t2\t4\t[]\n []\t2\t4\t[]\n-['1','2','3','4','5']\t2\t4\t[]\n-['1',NULL,'3','4',NULL,'6','7']\t2\t4\t['4',NULL]\n-['1','2','3',NULL,'5','6','7']\t2\t4\t[NULL,'5']\n-['1','2','3','4','5',NULL,'7']\t2\t4\t['4','5']\n-['1','2','3','4','5','6','7']\t2\t4\t['4','5']\n-['1',NULL,'3',NULL,'5','6','7']\t2\t4\t[NULL,'5']\n+['1','2','3','4','5']\t2\t4\t['2','3','4']\n+['1',NULL,'3','4',NULL,'6','7']\t2\t4\t['4',NULL,'6']\n+['1','2','3',NULL,'5','6','7']\t2\t4\t[NULL,'5','6']\n+['1','2','3','4','5',NULL,'7']\t2\t4\t['4','5',NULL]\n+['1','2','3','4','5','6','7']\t2\t4\t['4','5','6']\n+['1',NULL,'3',NULL,'5','6','7']\t2\t4\t[NULL,'5','6']\n arrayPushFront(arr1, 1)\n []\t['1']\n []\t['1']\ndiff --git a/tests/queries/0_stateless/00970_substring_arg_validation.reference b/tests/queries/0_stateless/00970_substring_arg_validation.reference\nindex 13e7564ea0c8..8b137891791f 100644\n--- a/tests/queries/0_stateless/00970_substring_arg_validation.reference\n+++ b/tests/queries/0_stateless/00970_substring_arg_validation.reference\n@@ -1,1 +1,1 @@\n-o\n+\ndiff --git a/tests/queries/0_stateless/02185_arraySlice_negative_offset_size.reference b/tests/queries/0_stateless/02185_arraySlice_negative_offset_size.reference\nnew file mode 100644\nindex 000000000000..4e3701e4f868\n--- /dev/null\n+++ b/tests/queries/0_stateless/02185_arraySlice_negative_offset_size.reference\n@@ -0,0 +1,15 @@\n+[]\n+[]\n+[]\n+[7]\n+[7]\n+[7]\n+-\n+[]\n+[]\n+[]\n+[6]\n+[]\n+[]\n+[]\n+[]\ndiff --git a/tests/queries/0_stateless/02185_arraySlice_negative_offset_size.sql b/tests/queries/0_stateless/02185_arraySlice_negative_offset_size.sql\nnew file mode 100644\nindex 000000000000..7a6ac0417c72\n--- /dev/null\n+++ b/tests/queries/0_stateless/02185_arraySlice_negative_offset_size.sql\n@@ -0,0 +1,25 @@\n+select arraySlice([1, 2, 3, 4, 5, 6, 7, 8], -2, -2);\n+select arraySlice(materialize([1, 2, 3, 4, 5, 6, 7, 8]), -2, -2);\n+select arraySlice(materialize([1, 2, 3, 4, 5, 6, 7, 8]), materialize(-2), materialize(-2));\n+\n+select arraySlice([1, 2, 3, 4, 5, 6, 7, 8], -2, -1);\n+select arraySlice(materialize([1, 2, 3, 4, 5, 6, 7, 8]), -2, -1);\n+select arraySlice(materialize([1, 2, 3, 4, 5, 6, 7, 8]), materialize(-2), materialize(-1));\n+\n+select '-';\n+drop table if exists t;\n+create table t\n+(\n+    s Array(Int),\n+    l Int8,\n+    r Int8\n+) engine = Memory;\n+\n+insert into t values ([1, 2, 3, 4, 5, 6, 7, 8], -2, -2), ([1, 2, 3, 4, 5, 6, 7, 8], -3, -3);\n+\n+select arraySlice(s, -2, -2) from t;\n+select arraySlice(s, l, -2) from t;\n+select arraySlice(s, -2, r) from t;\n+select arraySlice(s, l, r) from t;\n+\n+drop table t;\ndiff --git a/tests/queries/0_stateless/02185_substring_negative_offset_size.reference b/tests/queries/0_stateless/02185_substring_negative_offset_size.reference\nnew file mode 100644\nindex 000000000000..107f083a4d8d\n--- /dev/null\n+++ b/tests/queries/0_stateless/02185_substring_negative_offset_size.reference\n@@ -0,0 +1,31 @@\n+\n+\n+\n+g\n+g\n+g\n+-\n+\n+\n+\n+g\n+g\n+g\n+-\n+\n+\n+\n+6\n+\n+\n+\n+\n+-\n+\n+\n+\n+6\n+\n+\n+\n+\ndiff --git a/tests/queries/0_stateless/02185_substring_negative_offset_size.sql b/tests/queries/0_stateless/02185_substring_negative_offset_size.sql\nnew file mode 100644\nindex 000000000000..715dff30369f\n--- /dev/null\n+++ b/tests/queries/0_stateless/02185_substring_negative_offset_size.sql\n@@ -0,0 +1,48 @@\n+select substring('abcdefgh', -2, -2);\n+select substring(materialize('abcdefgh'), -2, -2);\n+select substring(materialize('abcdefgh'), materialize(-2), materialize(-2));\n+\n+select substring('abcdefgh', -2, -1);\n+select substring(materialize('abcdefgh'), -2, -1);\n+select substring(materialize('abcdefgh'), materialize(-2), materialize(-1));\n+\n+select '-';\n+select substring(cast('abcdefgh' as FixedString(8)), -2, -2);\n+select substring(materialize(cast('abcdefgh' as FixedString(8))), -2, -2);\n+select substring(materialize(cast('abcdefgh' as FixedString(8))), materialize(-2), materialize(-2));\n+\n+select substring(cast('abcdefgh' as FixedString(8)), -2, -1);\n+select substring(materialize(cast('abcdefgh' as FixedString(8))), -2, -1);\n+select substring(materialize(cast('abcdefgh' as FixedString(8))), materialize(-2), materialize(-1));\n+\n+select '-';\n+drop table if exists t;\n+create table t\n+(\n+    s String,\n+    l Int8,\n+    r Int8\n+) engine = Memory;\n+\n+insert into t values ('abcdefgh', -2, -2),('12345678', -3, -3);\n+\n+select substring(s, -2, -2) from t;\n+select substring(s, l, -2) from t;\n+select substring(s, -2, r) from t;\n+select substring(s, l, r) from t;\n+\n+select '-';\n+drop table if exists t;\n+create table t(\n+                  s FixedString(8),\n+                  l Int8,\n+                  r Int8\n+) engine = Memory;\n+insert into t values ('abcdefgh', -2, -2),('12345678', -3, -3);\n+\n+select substring(s, -2, -2) from t;\n+select substring(s, l, -2) from t;\n+select substring(s, -2, r) from t;\n+select substring(s, l, r) from t;\n+\n+drop table if exists t;\n",
  "problem_statement": "Function subString Inconsistent behavior between constant and table\n**Describe what's wrong**\r\nFunction subString Inconsistent behavior between constant and table\r\n\r\n**Does it reproduce on recent release?**\r\nall\r\n\r\n**How to reproduce**\r\n\r\n```sql\r\ncreate table t (s String) ENGINE=MergeTree() order by s;\r\ninsert into t (s) values ('12345');\r\nselect subString(s, -1, -3) from t;\r\nselect subString('12345', -1, -3);\r\n```\r\n\r\n**Expected behavior**\r\n\r\n```\r\n\u250c\u2500substring(s, -1, -3)\u2500\u2510\r\n\u2502                      \u2502\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n\u250c\u2500substring('12345', -1, -3)\u2500\u2510\r\n\u2502                            \u2502\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n\r\n```\r\n\r\n\r\n**Error message and/or stacktrace**\r\n\r\n```\r\n\u250c\u2500substring(s, -1, -3)\u2500\u2510\r\n\u2502 5                    \u2502\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n\u250c\u2500substring('12345', -1, -3)\u2500\u2510\r\n\u2502                            \u2502\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n\r\n```\r\n\n",
  "hints_text": "This function may be wrong\r\n\r\nhttps://github.com/ClickHouse/ClickHouse/blob/master/src/Functions/GatherUtils/Algorithms.h#L303",
  "created_at": "2022-01-21T10:21:29Z"
}