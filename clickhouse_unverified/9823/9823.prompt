You will be provided with a partial code base and an issue statement explaining a problem to resolve.

<issue>
Logical error 'Got 0 in totals chunk, expected 1'
```
select * from system.one t1
join system.one t2
on t1.dummy = t2.dummy
limit 0
FORMAT TabSeparated;
```

```
Progress: 0.00 rows, 0.00 B (0.00 rows/s., 0.00 B/s.) Logical error: 'Got 0 in totals chunk, expected 1'.
clickhouse-client: /home/chertus/src/ClickHouse/dbms/src/Common/Exception.cpp:37: DB::Exception::Exception(const std::string &, int): Assertion `false' failed.
Aborted (core dumped)
```
</issue>

I need you to solve the provided issue by generating a code fix that can be applied directly to the repository

Respond below:
