You will be provided with a partial code base and an issue statement explaining a problem to resolve.

<issue>
clickhouse-client segfaults on a long query
The query is like `select coalesce(null, coalesce(null, ....repeat 1000x...., 1) ... )`:

```
$ { printf "select "; for x in {1..1000}; do printf "coalesce(null, "; done; printf "1"; for x in {1..1000}; do printf ")"; done; } | clickhouse-client
Segmentation fault (core dumped)
```
</issue>

I need you to solve the provided issue by generating a code fix that can be applied directly to the repository

Respond below:
