diff --git a/tests/queries/0_stateless/01786_explain_merge_tree.reference b/tests/queries/0_stateless/01786_explain_merge_tree.reference
index 794acc310ce2..46f89745ba32 100644
--- a/tests/queries/0_stateless/01786_explain_merge_tree.reference
+++ b/tests/queries/0_stateless/01786_explain_merge_tree.reference
@@ -24,12 +24,12 @@
       Name: t_minmax
       Description: minmax GRANULARITY 2
       Parts: 1/2
-      Granules: 4/6
+      Granules: 3/6
     Skip
       Name: t_set
       Description: set GRANULARITY 2
       Parts: 1/1
-      Granules: 2/4
+      Granules: 2/3
 -----------------
           "Node Type": "ReadFromMergeTree",
           "Description": "default.test_index",
@@ -68,7 +68,7 @@
               "Initial Parts": 2,
               "Selected Parts": 1,
               "Initial Granules": 6,
-              "Selected Granules": 4
+              "Selected Granules": 3
             },
             {
               "Type": "Skip",
@@ -76,7 +76,7 @@
               "Description": "set GRANULARITY 2",
               "Initial Parts": 1,
               "Selected Parts": 1,
-              "Initial Granules": 4,
+              "Initial Granules": 3,
               "Selected Granules": 2
             }
           ]
diff --git a/tests/queries/0_stateless/02354_annoy_index.reference b/tests/queries/0_stateless/02354_annoy_index.reference
index cf17a7a7eabf..a0ffb1e1f7ff 100644
--- a/tests/queries/0_stateless/02354_annoy_index.reference
+++ b/tests/queries/0_stateless/02354_annoy_index.reference
@@ -94,7 +94,7 @@ Expression ((Projection + Before ORDER BY))
         Name: annoy_index
         Description: annoy GRANULARITY 2
         Parts: 0/1
-        Granules: 2/4
+        Granules: 0/4
 ORDER BY type, L2Distance, check that index is used
 Expression (Projection)
   Limit (preliminary LIMIT (without OFFSET))
@@ -110,7 +110,7 @@ Expression (Projection)
             Name: annoy_index
             Description: annoy GRANULARITY 2
             Parts: 1/1
-            Granules: 4/4
+            Granules: 2/4
 --- Test with Array, GRANULARITY = 4, index_granularity = 4 ---
 WHERE type, L2Distance, check that index is used
 Expression ((Projection + Before ORDER BY))
@@ -125,7 +125,7 @@ Expression ((Projection + Before ORDER BY))
         Name: annoy_index
         Description: annoy GRANULARITY 4
         Parts: 0/1
-        Granules: 3/4
+        Granules: 0/4
 ORDER BY type, L2Distance, check that index is used
 Expression (Projection)
   Limit (preliminary LIMIT (without OFFSET))
@@ -141,7 +141,7 @@ Expression (Projection)
             Name: annoy_index
             Description: annoy GRANULARITY 4
             Parts: 1/1
-            Granules: 4/4
+            Granules: 1/4
 --- Test correctness of Annoy index with > 1 mark
 1	[1,0,0,0]
 9000	[9000,0,0,0]
diff --git a/tests/queries/0_stateless/02354_usearch_index.reference b/tests/queries/0_stateless/02354_usearch_index.reference
index 9896f149d453..a93209f6ba8c 100644
--- a/tests/queries/0_stateless/02354_usearch_index.reference
+++ b/tests/queries/0_stateless/02354_usearch_index.reference
@@ -93,7 +93,7 @@ Expression ((Projection + Before ORDER BY))
         Name: usearch_index
         Description: usearch GRANULARITY 2
         Parts: 0/1
-        Granules: 2/4
+        Granules: 0/4
 ORDER BY type, L2Distance, check that index is used
 Expression (Projection)
   Limit (preliminary LIMIT (without OFFSET))
@@ -109,7 +109,7 @@ Expression (Projection)
             Name: usearch_index
             Description: usearch GRANULARITY 2
             Parts: 1/1
-            Granules: 4/4
+            Granules: 2/4
 --- Test with Array, GRANULARITY = 4, index_granularity = 4 ---
 WHERE type, L2Distance, check that index is used
 Expression ((Projection + Before ORDER BY))
@@ -124,7 +124,7 @@ Expression ((Projection + Before ORDER BY))
         Name: usearch_index
         Description: usearch GRANULARITY 4
         Parts: 0/1
-        Granules: 3/4
+        Granules: 0/4
 ORDER BY type, L2Distance, check that index is used
 Expression (Projection)
   Limit (preliminary LIMIT (without OFFSET))
@@ -140,4 +140,4 @@ Expression (Projection)
             Name: usearch_index
             Description: usearch GRANULARITY 4
             Parts: 1/1
-            Granules: 4/4
+            Granules: 1/4
diff --git a/tests/queries/0_stateless/02866_size_of_marks_skip_idx_explain.reference b/tests/queries/0_stateless/02866_size_of_marks_skip_idx_explain.reference
new file mode 100644
index 000000000000..d3502e9893cf
--- /dev/null
+++ b/tests/queries/0_stateless/02866_size_of_marks_skip_idx_explain.reference
@@ -0,0 +1,28 @@
+Expression ((Project names + Projection))
+  Filter ((WHERE + Change column names to column identifiers))
+    ReadFromMergeTree (default.test_skip_idx)
+    Indexes:
+      Skip
+        Name: name_idx_g2
+        Description: minmax GRANULARITY 2
+        Parts: 1/1
+        Granules: 2/5
+      Skip
+        Name: name_idx_g1
+        Description: minmax GRANULARITY 1
+        Parts: 1/1
+        Granules: 1/2
+Expression ((Project names + Projection))
+  Filter ((WHERE + Change column names to column identifiers))
+    ReadFromMergeTree (default.test_skip_idx)
+    Indexes:
+      Skip
+        Name: name_idx_g2
+        Description: minmax GRANULARITY 2
+        Parts: 1/1
+        Granules: 2/5
+      Skip
+        Name: name_idx_g1
+        Description: minmax GRANULARITY 1
+        Parts: 1/1
+        Granules: 2/2
diff --git a/tests/queries/0_stateless/02866_size_of_marks_skip_idx_explain.sql b/tests/queries/0_stateless/02866_size_of_marks_skip_idx_explain.sql
new file mode 100644
index 000000000000..b916c5ca13da
--- /dev/null
+++ b/tests/queries/0_stateless/02866_size_of_marks_skip_idx_explain.sql
@@ -0,0 +1,24 @@
+-- Tags: no-random-merge-tree-settings
+
+SET optimize_move_to_prewhere = 1;
+SET convert_query_to_cnf = 0;
+SET optimize_read_in_order = 1;
+
+SET allow_experimental_analyzer = 1; -- slightly different operator names than w/o
+
+DROP TABLE IF EXISTS test_skip_idx;
+
+CREATE TABLE test_skip_idx (
+    id UInt32,
+    INDEX name_idx_g2 id TYPE minmax GRANULARITY 2,
+    INDEX name_idx_g1 id TYPE minmax GRANULARITY 1)
+ENGINE = MergeTree
+ORDER BY tuple()
+SETTINGS index_granularity = 1, index_granularity_bytes = 0, min_bytes_for_wide_part = 0;
+
+INSERT INTO test_skip_idx SELECT number FROM system.numbers LIMIT 5 OFFSET 1;
+
+EXPLAIN indexes = 1 SELECT * FROM test_skip_idx WHERE id < 2;
+EXPLAIN indexes = 1 SELECT * FROM test_skip_idx WHERE id < 3;
+
+DROP TABLE test_skip_idx;
