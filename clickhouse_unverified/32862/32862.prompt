You will be provided with a partial code base and an issue statement explaining a problem to resolve.

<issue>
"Single chunk is expected from view inner query" error in Materialized View since 21.11 update
Hello, 

My team and I were using ClickHouse 21.9 for 2 months, and we updated this weekend to 21.11.3.6, in order to fix the DivisionByZero bug with Decimal.

Almost everything is working properly after the update, except one existing MaterializedView which is throwing the following error when it is triggered: 
`Single chunk is expected from view inner query (LOGICAL_ERROR)`
This MV was working for 1 year, so we're a bit confused.
I'm going to try to reproduce the bug in a simple example, but I can already say our MV contains a GROUP BY clause.
</issue>

I need you to solve the provided issue by generating a code fix that can be applied directly to the repository

Respond below:
