diff --git a/tests/queries/0_stateless/02319_timeslots_dt64.reference b/tests/queries/0_stateless/02319_timeslots_dt64.reference
new file mode 100644
index 000000000000..83041581fe63
--- /dev/null
+++ b/tests/queries/0_stateless/02319_timeslots_dt64.reference
@@ -0,0 +1,3 @@
+['2000-01-02 03:00:00.00','2000-01-02 03:30:00.00','2000-01-02 04:00:00.00','2000-01-02 04:30:00.00','2000-01-02 05:00:00.00','2000-01-02 05:30:00.00']
+['2000-01-02 02:54:45.100','2000-01-02 03:05:19.200','2000-01-02 03:15:53.300','2000-01-02 03:26:27.400','2000-01-02 03:37:01.500','2000-01-02 03:47:35.600','2000-01-02 03:58:09.700','2000-01-02 04:08:43.800','2000-01-02 04:19:17.900','2000-01-02 04:29:52.000','2000-01-02 04:40:26.100','2000-01-02 04:51:00.200','2000-01-02 05:01:34.300','2000-01-02 05:12:08.400','2000-01-02 05:22:42.500','2000-01-02 05:33:16.600','2000-01-02 05:43:50.700']
+['2000-01-02 03:04:00.0000','2000-01-02 03:04:30.0000','2000-01-02 03:05:00.0000','2000-01-02 03:05:30.0000','2000-01-02 03:06:00.0000','2000-01-02 03:06:30.0000','2000-01-02 03:07:00.0000','2000-01-02 03:07:30.0000','2000-01-02 03:08:00.0000','2000-01-02 03:08:30.0000','2000-01-02 03:09:00.0000','2000-01-02 03:09:30.0000','2000-01-02 03:10:00.0000','2000-01-02 03:10:30.0000','2000-01-02 03:11:00.0000','2000-01-02 03:11:30.0000','2000-01-02 03:12:00.0000','2000-01-02 03:12:30.0000','2000-01-02 03:13:00.0000','2000-01-02 03:13:30.0000','2000-01-02 03:14:00.0000']
diff --git a/tests/queries/0_stateless/02319_timeslots_dt64.sql b/tests/queries/0_stateless/02319_timeslots_dt64.sql
new file mode 100644
index 000000000000..3d8f8a22e5a0
--- /dev/null
+++ b/tests/queries/0_stateless/02319_timeslots_dt64.sql
@@ -0,0 +1,9 @@
+SELECT timeSlots(toDateTime64('2000-01-02 03:04:05.12', 2, 'UTC'), toDecimal64(10000, 0));
+SELECT timeSlots(toDateTime64('2000-01-02 03:04:05.233', 3, 'UTC'), toDecimal64(10000.12, 2), toDecimal64(634.1, 1));
+SELECT timeSlots(toDateTime64('2000-01-02 03:04:05.3456', 4, 'UTC'), toDecimal64(600, 0), toDecimal64(30, 0));
+
+SELECT timeSlots(toDateTime64('2000-01-02 03:04:05.23', 2, 'UTC')); -- { serverError 42 }
+SELECT timeSlots(toDateTime64('2000-01-02 03:04:05.345', 3, 'UTC'), toDecimal64(62.3, 1), toDecimal64(12.34, 2), 'one more'); -- { serverError 42 }
+SELECT timeSlots(toDateTime64('2000-01-02 03:04:05.456', 3, 'UTC'), 'wrong argument'); -- { serverError 43 }
+SELECT timeSlots(toDateTime64('2000-01-02 03:04:05.123', 3, 'UTC'), toDecimal64(600, 0), 'wrong argument'); -- { serverError 43 }
+SELECT timeSlots(toDateTime64('2000-01-02 03:04:05.1232', 4, 'UTC'), toDecimal64(600, 0), toDecimal64(0, 0)); -- { serverError 44 }
\ No newline at end of file
