diff --git a/tests/integration/test_config_hide_in_preprocessed/__init__.py b/tests/integration/test_config_hide_in_preprocessed/__init__.py
new file mode 100644
index 000000000000..e69de29bb2d1
diff --git a/tests/integration/test_config_hide_in_preprocessed/configs/config.xml b/tests/integration/test_config_hide_in_preprocessed/configs/config.xml
new file mode 100644
index 000000000000..aac5f5729644
--- /dev/null
+++ b/tests/integration/test_config_hide_in_preprocessed/configs/config.xml
@@ -0,0 +1,12 @@
+<clickhouse>
+    <max_thread_pool_free_size hide_in_preprocessed="1">2000</max_thread_pool_free_size>
+    <max_table_size_to_drop hide_in_preprocessed="true">60000000000</max_table_size_to_drop>
+    <max_partition_size_to_drop hide_in_preprocessed="false">40000000000</max_partition_size_to_drop>
+    <named_collections hide_in_preprocessed="true">
+        <name>
+            <key_1>value</key_1>
+            <key_2>value_2</key_2>
+            <url>https://connection.url/</url>
+        </name>
+    </named_collections>
+</clickhouse>
diff --git a/tests/integration/test_config_hide_in_preprocessed/configs/users.xml b/tests/integration/test_config_hide_in_preprocessed/configs/users.xml
new file mode 100644
index 000000000000..7f196179f80e
--- /dev/null
+++ b/tests/integration/test_config_hide_in_preprocessed/configs/users.xml
@@ -0,0 +1,7 @@
+<clickhouse>
+    <users>
+        <default>
+            <named_collection_control>1</named_collection_control>
+        </default>
+    </users>
+</clickhouse>
diff --git a/tests/integration/test_config_hide_in_preprocessed/test.py b/tests/integration/test_config_hide_in_preprocessed/test.py
new file mode 100644
index 000000000000..fd237063b183
--- /dev/null
+++ b/tests/integration/test_config_hide_in_preprocessed/test.py
@@ -0,0 +1,57 @@
+import pytest
+import os
+from helpers.cluster import ClickHouseCluster
+
+
+cluster = ClickHouseCluster(__file__)
+node = cluster.add_instance(
+    "node", main_configs=["configs/config.xml"], user_configs=["configs/users.xml"]
+)
+
+
+@pytest.fixture(scope="module")
+def started_cluster():
+    try:
+        cluster.start()
+        yield cluster
+
+    finally:
+        cluster.shutdown()
+
+
+def test_hide_in_preprocessed(started_cluster):
+    assert (
+        node.query(
+            "select value from system.server_settings where name ='max_thread_pool_free_size'"
+        )
+        == "2000
"
+    )
+    assert (
+        node.query(
+            "select value from system.server_settings where name ='max_table_size_to_drop'"
+        )
+        == "60000000000
"
+    )
+    assert (
+        node.query(
+            "select value from system.server_settings where name ='max_partition_size_to_drop'"
+        )
+        == "40000000000
"
+    )
+    assert "key_1" in node.query("select collection from system.named_collections")
+    out = node.exec_in_container(
+        ["cat", "/var/lib/clickhouse/preprocessed_configs/config.xml"]
+    )
+    assert (
+        '<max_thread_pool_free_size hide_in_preprocessed="1">2000</max_thread_pool_free_size>'
+        not in out
+    )
+    assert (
+        '<max_table_size_to_drop hide_in_preprocessed="true">60000000000</max_table_size_to_drop>'
+        not in out
+    )
+    assert (
+        '<max_partition_size_to_drop hide_in_preprocessed="false">40000000000</max_partition_size_to_drop>'
+        in out
+    )
+    assert '<named_collections hide_in_preprocessed="true">' not in out
