diff --git a/tests/queries/0_stateless/02797_transform_narrow_types.reference b/tests/queries/0_stateless/02797_transform_narrow_types.reference
new file mode 100644
index 000000000000..5a2bd60ca833
--- /dev/null
+++ b/tests/queries/0_stateless/02797_transform_narrow_types.reference
@@ -0,0 +1,6 @@
+f
+s
+11
+11
+33
+3
diff --git a/tests/queries/0_stateless/02797_transform_narrow_types.sql b/tests/queries/0_stateless/02797_transform_narrow_types.sql
new file mode 100644
index 000000000000..56a02fb8af7a
--- /dev/null
+++ b/tests/queries/0_stateless/02797_transform_narrow_types.sql
@@ -0,0 +1,6 @@
+SELECT transform(-1, [-1, 2], ['f', 's'], 'g');
+SELECT transform(2, [-1, 2], ['f', 's'], 'g');
+SELECT transform(-1, [-1, 2], [11, 22], 33);
+SELECT transform(-1, [-1, 2], [11, 22]);
+SELECT transform(3, [-1, 2], [11, 22], 33);
+SELECT transform(3, [-1, 2], [11, 22]);
