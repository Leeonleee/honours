diff --git a/tests/queries/0_stateless/02895_npy_format.reference b/tests/queries/0_stateless/02895_npy_format.reference
new file mode 100644
index 000000000000..0c90fbfd418f
--- /dev/null
+++ b/tests/queries/0_stateless/02895_npy_format.reference
@@ -0,0 +1,86 @@
+1
+2
+3
+1.1
+2.2
+3.3
+1
+a
+c
+1
+a
+c
+[1,2,3]
+[4,5,6]
+[1.1,2.22,3.33]
+[4.4,5.5,6.6]
+['a','b','c']
+['e','f','g']
+['a','b','c']
+['e','f','g']
+[1]
+[0]
+[1]
+[0]
+[0,0,0]
+[0,0,0]
+[[1,2],[3,4]]
+[[5,6],[7,8]]
+array	Int64					
+array	Float64					
+array	String					
+array	String					
+array	Array(Int64)					
+array	Array(Float64)					
+array	Array(String)					
+array	Array(String)					
+array	Array(UInt8)					
+array	Array(Int64)					
+array	Array(Array(Int64))					
+1
+2
+3
+1
+2
+3
+1
+2
+3
+1
+2
+3
+1
+2
+3
+1
+2
+3
+1
+2
+3
+1
+2
+3
+1.1
+2.2
+3.3
+1.1
+2.2
+3.3
+1
+a
+c
+1
+a
+c
+[1,2,3]
+[4,5,6]
+[[1,2],[3,4]]
+[[5,6],[7,8]]
+0
+0
+0
+0
+0
+0
+1
diff --git a/tests/queries/0_stateless/02895_npy_format.sh b/tests/queries/0_stateless/02895_npy_format.sh
new file mode 100755
index 000000000000..1dbf62ceaa23
--- /dev/null
+++ b/tests/queries/0_stateless/02895_npy_format.sh
@@ -0,0 +1,58 @@
+#!/usr/bin/env bash
+# Tags: no-fasttest
+
+CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
+# shellcheck source=../shell_config.sh
+. "$CURDIR"/../shell_config.sh
+
+$CLICKHOUSE_LOCAL -q "select * from file('$CURDIR/data_npy/one_dim.npy')"
+$CLICKHOUSE_LOCAL -q "select * from file('$CURDIR/data_npy/one_dim_float.npy')"
+$CLICKHOUSE_LOCAL -q "select * from file('$CURDIR/data_npy/one_dim_str.npy')"
+$CLICKHOUSE_LOCAL -q "select * from file('$CURDIR/data_npy/one_dim_unicode.npy')"
+$CLICKHOUSE_LOCAL -q "select * from file('$CURDIR/data_npy/two_dim.npy')"
+$CLICKHOUSE_LOCAL -q "select * from file('$CURDIR/data_npy/two_dim_float.npy')"
+$CLICKHOUSE_LOCAL -q "select * from file('$CURDIR/data_npy/two_dim_str.npy')"
+$CLICKHOUSE_LOCAL -q "select * from file('$CURDIR/data_npy/two_dim_unicode.npy')"
+$CLICKHOUSE_LOCAL -q "select * from file('$CURDIR/data_npy/two_dim_bool.npy')"
+$CLICKHOUSE_LOCAL -q "select * from file('$CURDIR/data_npy/two_dim_null.npy')"
+$CLICKHOUSE_LOCAL -q "select * from file('$CURDIR/data_npy/three_dim.npy')"
+
+$CLICKHOUSE_LOCAL -q "describe file('$CURDIR/data_npy/one_dim.npy')"
+$CLICKHOUSE_LOCAL -q "describe file('$CURDIR/data_npy/one_dim_float.npy')"
+$CLICKHOUSE_LOCAL -q "describe file('$CURDIR/data_npy/one_dim_str.npy')"
+$CLICKHOUSE_LOCAL -q "describe file('$CURDIR/data_npy/one_dim_unicode.npy')"
+$CLICKHOUSE_LOCAL -q "describe file('$CURDIR/data_npy/two_dim.npy')"
+$CLICKHOUSE_LOCAL -q "describe file('$CURDIR/data_npy/two_dim_float.npy')"
+$CLICKHOUSE_LOCAL -q "describe file('$CURDIR/data_npy/two_dim_str.npy')"
+$CLICKHOUSE_LOCAL -q "describe file('$CURDIR/data_npy/two_dim_unicode.npy')"
+$CLICKHOUSE_LOCAL -q "describe file('$CURDIR/data_npy/two_dim_bool.npy')"
+$CLICKHOUSE_LOCAL -q "describe file('$CURDIR/data_npy/two_dim_null.npy')"
+$CLICKHOUSE_LOCAL -q "describe file('$CURDIR/data_npy/three_dim.npy')"
+
+$CLICKHOUSE_LOCAL -q "select * from file('$CURDIR/data_npy/one_dim.npy', Npy, 'value UInt8')"
+$CLICKHOUSE_LOCAL -q "select * from file('$CURDIR/data_npy/one_dim.npy', Npy, 'value UInt16')"
+$CLICKHOUSE_LOCAL -q "select * from file('$CURDIR/data_npy/one_dim.npy', Npy, 'value UInt32')"
+$CLICKHOUSE_LOCAL -q "select * from file('$CURDIR/data_npy/one_dim.npy', Npy, 'value UInt64')"
+$CLICKHOUSE_LOCAL -q "select * from file('$CURDIR/data_npy/one_dim.npy', Npy, 'value Int8')"
+$CLICKHOUSE_LOCAL -q "select * from file('$CURDIR/data_npy/one_dim.npy', Npy, 'value Int16')"
+$CLICKHOUSE_LOCAL -q "select * from file('$CURDIR/data_npy/one_dim.npy', Npy, 'value Int32')"
+$CLICKHOUSE_LOCAL -q "select * from file('$CURDIR/data_npy/one_dim.npy', Npy, 'value Int64')"
+
+$CLICKHOUSE_LOCAL -q "select * from file('$CURDIR/data_npy/one_dim_float.npy', Npy, 'value Float32')"
+$CLICKHOUSE_LOCAL -q "select * from file('$CURDIR/data_npy/one_dim_float.npy', Npy, 'value Float64')"
+
+$CLICKHOUSE_LOCAL -q "select * from file('$CURDIR/data_npy/one_dim_str.npy', Npy, 'value FixedString(1)')"
+$CLICKHOUSE_LOCAL -q "select * from file('$CURDIR/data_npy/one_dim_str.npy', Npy, 'value String')"
+
+$CLICKHOUSE_LOCAL -q "select * from file('$CURDIR/data_npy/two_dim.npy', Npy, 'value Array(Int8)')"
+$CLICKHOUSE_LOCAL -q "select * from file('$CURDIR/data_npy/three_dim.npy', Npy, 'value Array(Array(Int8))')"
+
+$CLICKHOUSE_LOCAL -q "select * from file('$CURDIR/data_npy/one_dim_float.npy', Npy, 'value Array(Float32)')" 2>&1 | grep -c "BAD_ARGUMENTS"
+$CLICKHOUSE_LOCAL -q "select * from file('$CURDIR/data_npy/one_dim_float.npy', Npy, 'value UUID')" 2>&1 | grep -c "BAD_ARGUMENTS"
+$CLICKHOUSE_LOCAL -q "select * from file('$CURDIR/data_npy/one_dim_float.npy', Npy, 'value Tuple(UInt8)')" 2>&1 | grep -c "BAD_ARGUMENTS"
+
+$CLICKHOUSE_LOCAL -q "select * from file('$CURDIR/data_npy/one_dim_float.npy', Npy, 'value Int8')" 2>&1 | grep -c "BAD_ARGUMENTS"
+$CLICKHOUSE_LOCAL -q "select * from file('$CURDIR/data_npy/one_dim_str.npy', Npy, 'value Int8')" 2>&1 | grep -c "BAD_ARGUMENTS"
+$CLICKHOUSE_LOCAL -q "select * from file('$CURDIR/data_npy/one_dim_unicode.npy', Npy, 'value Float32')" 2>&1 | grep -c "BAD_ARGUMENTS"
+
+$CLICKHOUSE_LOCAL -q "select * from file('$CURDIR/data_npy/complex.npy')" 2>&1 | grep -c "BAD_ARGUMENTS"
diff --git a/tests/queries/0_stateless/data_npy/complex.npy b/tests/queries/0_stateless/data_npy/complex.npy
new file mode 100644
index 000000000000..5777d593a7dd
Binary files /dev/null and b/tests/queries/0_stateless/data_npy/complex.npy differ
diff --git a/tests/queries/0_stateless/data_npy/one_dim.npy b/tests/queries/0_stateless/data_npy/one_dim.npy
new file mode 100644
index 000000000000..80c6ff86eba9
Binary files /dev/null and b/tests/queries/0_stateless/data_npy/one_dim.npy differ
diff --git a/tests/queries/0_stateless/data_npy/one_dim_float.npy b/tests/queries/0_stateless/data_npy/one_dim_float.npy
new file mode 100644
index 000000000000..0e7fc14e59e0
Binary files /dev/null and b/tests/queries/0_stateless/data_npy/one_dim_float.npy differ
diff --git a/tests/queries/0_stateless/data_npy/one_dim_str.npy b/tests/queries/0_stateless/data_npy/one_dim_str.npy
new file mode 100644
index 000000000000..010cb52787e8
Binary files /dev/null and b/tests/queries/0_stateless/data_npy/one_dim_str.npy differ
diff --git a/tests/queries/0_stateless/data_npy/one_dim_unicode.npy b/tests/queries/0_stateless/data_npy/one_dim_unicode.npy
new file mode 100644
index 000000000000..d0245df237cb
Binary files /dev/null and b/tests/queries/0_stateless/data_npy/one_dim_unicode.npy differ
diff --git a/tests/queries/0_stateless/data_npy/three_dim.npy b/tests/queries/0_stateless/data_npy/three_dim.npy
new file mode 100644
index 000000000000..07a6b2bec4ab
Binary files /dev/null and b/tests/queries/0_stateless/data_npy/three_dim.npy differ
diff --git a/tests/queries/0_stateless/data_npy/two_dim.npy b/tests/queries/0_stateless/data_npy/two_dim.npy
new file mode 100644
index 000000000000..70f4ed9ec170
Binary files /dev/null and b/tests/queries/0_stateless/data_npy/two_dim.npy differ
diff --git a/tests/queries/0_stateless/data_npy/two_dim_bool.npy b/tests/queries/0_stateless/data_npy/two_dim_bool.npy
new file mode 100644
index 000000000000..d2f28ce6fa37
Binary files /dev/null and b/tests/queries/0_stateless/data_npy/two_dim_bool.npy differ
diff --git a/tests/queries/0_stateless/data_npy/two_dim_float.npy b/tests/queries/0_stateless/data_npy/two_dim_float.npy
new file mode 100644
index 000000000000..2e2b58513cd9
Binary files /dev/null and b/tests/queries/0_stateless/data_npy/two_dim_float.npy differ
diff --git a/tests/queries/0_stateless/data_npy/two_dim_null.npy b/tests/queries/0_stateless/data_npy/two_dim_null.npy
new file mode 100644
index 000000000000..b78b95af03ea
Binary files /dev/null and b/tests/queries/0_stateless/data_npy/two_dim_null.npy differ
diff --git a/tests/queries/0_stateless/data_npy/two_dim_str.npy b/tests/queries/0_stateless/data_npy/two_dim_str.npy
new file mode 100644
index 000000000000..bda150c5f462
Binary files /dev/null and b/tests/queries/0_stateless/data_npy/two_dim_str.npy differ
diff --git a/tests/queries/0_stateless/data_npy/two_dim_unicode.npy b/tests/queries/0_stateless/data_npy/two_dim_unicode.npy
new file mode 100644
index 000000000000..f8558d810c57
Binary files /dev/null and b/tests/queries/0_stateless/data_npy/two_dim_unicode.npy differ
