{
  "repo": "ClickHouse/ClickHouse",
  "pull_number": 11533,
  "instance_id": "ClickHouse__ClickHouse-11533",
  "issue_numbers": [
    "11532"
  ],
  "base_commit": "6ddc67b55ac26a0c45a5f15616093ee9d7f7184e",
  "patch": "diff --git a/src/AggregateFunctions/AggregateFunctionNothing.h b/src/AggregateFunctions/AggregateFunctionNothing.h\nindex 511dbbecd385..259d14435cdb 100644\n--- a/src/AggregateFunctions/AggregateFunctionNothing.h\n+++ b/src/AggregateFunctions/AggregateFunctionNothing.h\n@@ -3,6 +3,8 @@\n #include <DataTypes/DataTypeNullable.h>\n #include <DataTypes/DataTypeNothing.h>\n #include <Columns/IColumn.h>\n+#include <IO/ReadBuffer.h>\n+#include <IO/WriteBuffer.h>\n #include <AggregateFunctions/IAggregateFunction.h>\n \n \n@@ -59,12 +61,16 @@ class AggregateFunctionNothing final : public IAggregateFunctionHelper<Aggregate\n     {\n     }\n \n-    void serialize(ConstAggregateDataPtr, WriteBuffer &) const override\n+    /// We have to serialize to at least one byte, because otherwise\n+    /// the reader cannot read expected number of serialized states.\n+    void serialize(ConstAggregateDataPtr, WriteBuffer & out) const override\n     {\n+        out.write(0);\n     }\n \n-    void deserialize(AggregateDataPtr, ReadBuffer &, Arena *) const override\n+    void deserialize(AggregateDataPtr, ReadBuffer & in, Arena *) const override\n     {\n+        in.ignore(1);\n     }\n \n     void insertResultInto(AggregateDataPtr, IColumn & to) const override\n",
  "test_patch": "diff --git a/tests/queries/0_stateless/01303_aggregate_function_nothing_serde.reference b/tests/queries/0_stateless/01303_aggregate_function_nothing_serde.reference\nnew file mode 100644\nindex 000000000000..dec7d2fabd2e\n--- /dev/null\n+++ b/tests/queries/0_stateless/01303_aggregate_function_nothing_serde.reference\n@@ -0,0 +1,1 @@\n+\\N\ndiff --git a/tests/queries/0_stateless/01303_aggregate_function_nothing_serde.sql b/tests/queries/0_stateless/01303_aggregate_function_nothing_serde.sql\nnew file mode 100644\nindex 000000000000..e3b9d7037964\n--- /dev/null\n+++ b/tests/queries/0_stateless/01303_aggregate_function_nothing_serde.sql\n@@ -0,0 +1,1 @@\n+select sum(NULL) from remote('127.0.0.{1,2}', system.one);\n",
  "problem_statement": "The query `select sum(NULL) from remote('127.0.0.{1,2}', system.one)` does not work.\n```\r\nmilovidov-desktop :) select sum(NULL) from remote('127.0.0.{1,2}', system.one)\r\n\r\nSELECT sum(NULL)\r\nFROM remote('127.0.0.{1,2}', system.one)\r\n\r\n\u2191 Progress: 1.00 rows, 1.00 B (9.83 rows/s., 9.83 B/s.) \r\nReceived exception from server (version 20.5.1):\r\nCode: 271. DB::Exception: Received from localhost:9000. DB::Exception: Data compressed with different methods, given method byte 0x83, previous method byte 0x82: while receiving packet from 127.0.0.2:9000: While executing SourceFromInputStream. \r\n```\n",
  "hints_text": "The bug exists at least since version 19.11.",
  "created_at": "2020-06-08T20:56:28Z"
}