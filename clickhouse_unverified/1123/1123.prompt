You will be provided with a partial code base and an issue statement explaining a problem to resolve.

<issue>
CREATE TABLE without Engine spec SIGSEGV
Hi, I was fiddling with MATERIALIZED VIEWs, and when I create a table by using MV schema without ENGINE spec it crashes. A minimal example would be something like:

```sql
CREATE TABLE tmp (date Date, name String) ENGINE ...;
CREATE MATERIALIZED VIEW tmp_mv ENGINE = AggregatingMergeTree(date, (name), 8192) AS SELECT date, name, countState() AS cc FROM tmp GROUP BY name;
CREATE TABLE IF NOT EXISTS tmp_mv_table AS tmp_mv;
```

Crashes with:

```
<Error> BaseDaemon: ########################################
<Error> BaseDaemon: (from thread 118) Received signal Segmentation fault (11).
<Error> BaseDaemon: Address: NULL pointer.
<Error> BaseDaemon: 1. /usr/bin/clickhouse-server(DB::StorageView::StorageView(std::string const&, std::string const&, DB::Context&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::NamesAndTypesList>, DB::NamesAndTypesList const&, DB::NamesAndTypesList const&, std::unordered_map<std::string, DB::ColumnDefault, std::hash<std::string>, std::equal_to<std::string>, std::allocator<std::pair<std::string const, DB::ColumnDefault> > > const&)+0x428) [0x12ef6a8]
<Error> BaseDaemon: 2. /usr/bin/clickhouse-server(Poco::ThreadImpl::runnableEntry(void*)+0x96) [0x325d216]
<Error> BaseDaemon: 3. /lib/x86_64-linux-gnu/libpthread.so.0(+0x8064) [0x7f4e62c7f064]
<Error> BaseDaemon: 4. /lib/x86_64-linux-gnu/libc.so.6(clone+0x6d) [0x7f4e622a762d]
```

It's the last stable 1.1.54180.

It works when I create the the table from MV as:

```sql
CREATE TABLE IF NOT EXISTS tmp_mv_table AS tmp_mv ENGINE = ...;
```
Segfault on CREATE VIEW query
Creating a new view based on another materialised view (based on MergeTree-Engine tables) results in a segmentation fault. The query looks like this:

> CREATE MATERIALIZED VIEW yt.videoid_lookup POPULATE AS SELECT DISTINCT id, channel_id from videos

The error log looks like this:
```
2017.08.17 10:41:18.804826 [ 1 ] <Warning> ConfigProcessor: Include not found: networks
2017.08.17 10:41:18.804876 [ 1 ] <Warning> ConfigProcessor: Include not found: networks
2017.08.17 10:41:20.804800 [ 7 ] <Warning> ConfigProcessor: Include not found: clickhouse_remote_servers
2017.08.17 10:41:20.804902 [ 7 ] <Warning> ConfigProcessor: Include not found: clickhouse_compression
2017.08.17 10:41:24.088431 [ 9 ] <Error> BaseDaemon: ########################################
2017.08.17 10:41:24.088517 [ 9 ] <Error> BaseDaemon: (from thread 8) Received signal Segmentation fault (11).
2017.08.17 10:41:24.088567 [ 9 ] <Error> BaseDaemon: Address: NULL pointer.
2017.08.17 10:41:24.093478 [ 9 ] <Error> BaseDaemon: 1. clickhouse-server(std::enable_if<std::is_reference<DB::ASTSelectQuery&>::value, DB::ASTSelectQuery&>::type typeid_cast<DB::ASTSelectQuery&, DB::IAST>(DB::IAST&)+0x13) [0x27cc6a3]
2017.08.17 10:41:24.093512 [ 9 ] <Error> BaseDaemon: 2. clickhouse-server(Poco::ThreadImpl::runnableEntry(void*)+0x96) [0x31c19c6]
2017.08.17 10:41:24.093529 [ 9 ] <Error> BaseDaemon: 3. /lib64/libpthread.so.0(+0x7dc5) [0x7f7f22fbcdc5]
2017.08.17 10:41:24.093556 [ 9 ] <Error> BaseDaemon: 4. /lib64/libc.so.6(clone+0x6d) [0x7f7f2088f76d]
```
</issue>

I need you to solve the provided issue by generating a code fix that can be applied directly to the repository

Respond below:
