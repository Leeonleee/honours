diff --git a/dbms/tests/queries/0_stateless/00101_materialized_views_and_insert_without_explicit_database.reference b/dbms/tests/queries/0_stateless/00101_materialized_views_and_insert_without_explicit_database.reference
index 8fb767d89d52..37514bc429b3 100644
--- a/dbms/tests/queries/0_stateless/00101_materialized_views_and_insert_without_explicit_database.reference
+++ b/dbms/tests/queries/0_stateless/00101_materialized_views_and_insert_without_explicit_database.reference
@@ -1,2 +1,6 @@
 2014-01-02	0	0	0000-00-00 00:00:00	2014-01-02 03:04:06
 1	2014-01-02 03:04:06
+0
+0
+0
+0
diff --git a/dbms/tests/queries/0_stateless/00101_materialized_views_and_insert_without_explicit_database.sql b/dbms/tests/queries/0_stateless/00101_materialized_views_and_insert_without_explicit_database.sql
index a3f475d2f25c..772ac54d830c 100644
--- a/dbms/tests/queries/0_stateless/00101_materialized_views_and_insert_without_explicit_database.sql
+++ b/dbms/tests/queries/0_stateless/00101_materialized_views_and_insert_without_explicit_database.sql
@@ -11,3 +11,28 @@ SELECT * FROM default.test_view;
 
 DROP TABLE default.test_table;
 DROP TABLE default.test_view;
+
+-- Check only sophisticated constructors and desctructors:
+
+USE test;
+DROP TABLE IF EXISTS tmp;
+DROP TABLE IF EXISTS tmp_mv;
+DROP TABLE IF EXISTS tmp_mv2;
+DROP TABLE IF EXISTS `.inner.tmp_mv`;
+DROP TABLE IF EXISTS `.inner.tmp_mv2`;
+
+CREATE TABLE tmp (date Date, name String) ENGINE = Memory;
+CREATE MATERIALIZED VIEW tmp_mv ENGINE = AggregatingMergeTree(date, (date, name), 8192) AS SELECT date, name, countState() AS cc FROM tmp GROUP BY date, name;
+CREATE TABLE tmp_mv2 AS tmp_mv;
+CREATE TABLE tmp_mv3 AS tmp_mv ENGINE = Memory;
+CREATE MATERIALIZED VIEW tmp_mv4 ENGINE = AggregatingMergeTree(date, date, 8192) POPULATE AS SELECT DISTINCT * FROM tmp_mv;
+
+DROP TABLE tmp_mv;
+DROP TABLE tmp_mv2;
+DROP TABLE tmp_mv3;
+DROP TABLE tmp_mv4;
+
+EXISTS TABLE `.inner.tmp_mv`;
+EXISTS TABLE `.inner.tmp_mv2`;
+EXISTS TABLE `.inner.tmp_mv3`;
+EXISTS TABLE `.inner.tmp_mv4`;
