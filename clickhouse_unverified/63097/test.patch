diff --git a/tests/queries/0_stateless/03130_abs_in_key_condition_bug.reference b/tests/queries/0_stateless/03130_abs_in_key_condition_bug.reference
new file mode 100644
index 000000000000..0cfbf08886fc
--- /dev/null
+++ b/tests/queries/0_stateless/03130_abs_in_key_condition_bug.reference
@@ -0,0 +1,1 @@
+2
diff --git a/tests/queries/0_stateless/03130_abs_in_key_condition_bug.sql b/tests/queries/0_stateless/03130_abs_in_key_condition_bug.sql
new file mode 100644
index 000000000000..eec0d034d10b
--- /dev/null
+++ b/tests/queries/0_stateless/03130_abs_in_key_condition_bug.sql
@@ -0,0 +1,10 @@
+DROP TABLE IF EXISTS t;
+
+CREATE TABLE t (id UInt64, ts DateTime) ENGINE = MergeTree() ORDER BY (id, ts) SETTINGS index_granularity = 2;
+
+INSERT INTO t VALUES
+    (1, toDateTime('2023-05-04 21:17:23', 'UTC')), (1, toDateTime('2023-05-04 22:17:23', 'UTC')), (2, toDateTime('2023-05-04 22:17:23', 'UTC')), (2, toDateTime('2023-05-04 23:17:23', 'UTC'));
+
+SELECT  count(abs(toUnixTimestamp(ts, 'UTC') - toUnixTimestamp('2023-05-04 22:17:23', 'UTC')) AS error) FROM t WHERE error < 3600;
+
+DROP TABLE IF EXISTS t;
