{
  "repo": "ClickHouse/ClickHouse",
  "pull_number": 38424,
  "instance_id": "ClickHouse__ClickHouse-38424",
  "issue_numbers": [
    "38423"
  ],
  "base_commit": "b28ded60402680bbd90bca816662ab421b15e6bc",
  "patch": "diff --git a/src/Functions/filesystem.cpp b/src/Functions/filesystem.cpp\nindex bea7ffdf818f..36db68617e9b 100644\n--- a/src/Functions/filesystem.cpp\n+++ b/src/Functions/filesystem.cpp\n@@ -36,7 +36,7 @@ class FilesystemImpl : public IFunction\n \n     static FunctionPtr create(ContextPtr context)\n     {\n-        return std::make_shared<FilesystemImpl<Impl>>(std::filesystem::space(context->getConfigRef().getString(\"path\")));\n+        return std::make_shared<FilesystemImpl<Impl>>(std::filesystem::space(context->getPath()));\n     }\n \n     bool isSuitableForShortCircuitArgumentsExecution(const DataTypesWithConstInfo & /*arguments*/) const override\n",
  "test_patch": "diff --git a/tests/queries/0_stateless/02345_filesystem_local.reference b/tests/queries/0_stateless/02345_filesystem_local.reference\nnew file mode 100644\nindex 000000000000..9972842f9827\n--- /dev/null\n+++ b/tests/queries/0_stateless/02345_filesystem_local.reference\n@@ -0,0 +1,1 @@\n+1\t1\ndiff --git a/tests/queries/0_stateless/02345_filesystem_local.sh b/tests/queries/0_stateless/02345_filesystem_local.sh\nnew file mode 100755\nindex 000000000000..6771df2ae2df\n--- /dev/null\n+++ b/tests/queries/0_stateless/02345_filesystem_local.sh\n@@ -0,0 +1,8 @@\n+#!/usr/bin/env bash\n+\n+CUR_DIR=$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" && pwd)\n+# shellcheck source=../shell_config.sh\n+. \"$CUR_DIR\"/../shell_config.sh\n+\n+# Checks that these functions are working inside clickhouse-local. Does not check specific values.\n+$CLICKHOUSE_LOCAL --query \"SELECT filesystemAvailable() > 0, filesystemFree() <= filesystemCapacity()\"\n",
  "problem_statement": "filesystem* functions don't work in `clickhouse-local`\n```\r\nmilovidov@milovidov-desktop:~/work/ClickHouse/benchmark/clickhouse-benchmark$ clickhouse-local \r\nClickHouse local version 22.7.1.1.\r\n\r\nmilovidov-desktop :) SELECT filesystemAvailable()\r\n\r\nSELECT filesystemAvailable()\r\n\r\nQuery id: 3ef2d5d8-b3e7-470d-a1e0-e6146f18b9b8\r\n\r\n\r\n0 rows in set. Elapsed: 0.145 sec. \r\n\r\nReceived exception:\r\nCode: 1001. DB::Exception: Poco::NotFoundException: Not found. (STD_EXCEPTION)\r\n```\r\n\r\nAnd they give inferior error message.\n",
  "hints_text": "",
  "created_at": "2022-06-25T04:11:57Z"
}