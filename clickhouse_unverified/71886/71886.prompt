You will be provided with a partial code base and an issue statement explaining a problem to resolve.

<issue>
LIMIT n, m WITH TIES returns less data than requested
```sql
WITH data AS (
    SELECT * FROM numbers(0, 10)
    UNION ALL
    SELECT * FROM numbers(10, 10)
)
SELECT number div 10 AS ten, number
FROM data
ORDER BY ten
LIMIT 8,6 WITH TIES
```
This query returns only two rows:
```
+-ten-+-number-+
|   0 |      8 |
|   0 |      9 |
+-----+--------+
```
Although I expect it to return numbers 8-9 and 10-19 because of `WITH TIES` and equal sorting key ten == 1 for last rows.
`UNION ALL` here is important to reproduce the issue, that way it creates multiple data blocks to read from. Without it, with data as `SELECT * FROM numbers(0, 20)`, query returns numbers 8-19 as expected.

Issue is reproduced in docker image `clickhouse/clickhouse-server:24.9.2.42-alpine`.
Also in fiddle: https://fiddle.clickhouse.com/2d6820e1-8b2b-4f4f-b677-c5d48acffdf5
</issue>

I need you to solve the provided issue by generating a code fix that can be applied directly to the repository

Respond below:
