diff --git a/tests/config/config.d/transactions.xml b/tests/config/config.d/transactions.xml
index 19810986ea10..9948b1f1865e 100644
--- a/tests/config/config.d/transactions.xml
+++ b/tests/config/config.d/transactions.xml
@@ -10,4 +10,12 @@
         <flush_interval_milliseconds>7500</flush_interval_milliseconds>
     </transactions_info_log>
 
+    <transaction_log>
+        <zookeeper_path>/test/clickhouse/txn</zookeeper_path>
+
+        <fault_probability_before_commit>0.0</fault_probability_before_commit>
+
+        <!-- Fault injection after commit should not affect tests, because default waiting mode is WAIT_UNKNOWN -->
+        <fault_probability_after_commit>0.01</fault_probability_after_commit>
+    </transaction_log>
 </yandex>
diff --git a/tests/queries/0_stateless/01133_begin_commit_race.reference b/tests/queries/0_stateless/01133_begin_commit_race.reference
new file mode 100644
index 000000000000..e69de29bb2d1
diff --git a/tests/queries/0_stateless/01133_begin_commit_race.sh b/tests/queries/0_stateless/01133_begin_commit_race.sh
new file mode 100755
index 000000000000..f64570950c71
--- /dev/null
+++ b/tests/queries/0_stateless/01133_begin_commit_race.sh
@@ -0,0 +1,58 @@
+#!/usr/bin/env bash
+# Tags: long
+
+CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
+# shellcheck source=../shell_config.sh
+. "$CURDIR"/../shell_config.sh
+
+set -e
+
+$CLICKHOUSE_CLIENT --query "DROP TABLE IF EXISTS mt";
+$CLICKHOUSE_CLIENT --query "CREATE TABLE mt (n Int64) ENGINE=MergeTree ORDER BY n SETTINGS old_parts_lifetime=0";
+
+
+function begin_commit_readonly()
+{
+    $CLICKHOUSE_CLIENT --multiquery --query "
+            SET wait_changes_become_visible_after_commit_mode='wait';
+            BEGIN TRANSACTION;
+            COMMIT;" 2>&1| grep -Fa "Exception: " | grep -Fv UNKNOWN_STATUS_OF_TRANSACTION
+}
+
+function begin_rollback_readonly()
+{
+    $CLICKHOUSE_CLIENT --wait_changes_become_visible_after_commit_mode=wait_unknown --multiquery --query "
+            BEGIN TRANSACTION;
+            SET TRANSACTION SNAPSHOT 42;
+            ROLLBACK;"
+}
+
+function begin_insert_commit()
+{
+    $CLICKHOUSE_CLIENT --wait_changes_become_visible_after_commit_mode=async --multiquery --query "
+            BEGIN TRANSACTION;
+            INSERT INTO mt VALUES ($RANDOM);
+            COMMIT;" 2>&1| grep -Fa "Exception: " | grep -Fv UNKNOWN_STATUS_OF_TRANSACTION
+}
+
+function introspection()
+{
+    $CLICKHOUSE_CLIENT -q "SELECT * FROM system.transactions FORMAT Null"
+    $CLICKHOUSE_CLIENT -q "SELECT transactionLatestSnapshot(), transactionOldestSnapshot() FORMAT Null"
+}
+
+export -f begin_commit_readonly
+export -f begin_rollback_readonly
+export -f begin_insert_commit
+export -f introspection
+
+TIMEOUT=20
+
+clickhouse_client_loop_timeout $TIMEOUT begin_commit_readonly &
+clickhouse_client_loop_timeout $TIMEOUT begin_rollback_readonly &
+clickhouse_client_loop_timeout $TIMEOUT begin_insert_commit &
+clickhouse_client_loop_timeout $TIMEOUT introspection &
+
+wait
+
+$CLICKHOUSE_CLIENT --query "DROP TABLE mt";
diff --git a/tests/queries/0_stateless/01172_transaction_counters.sql b/tests/queries/0_stateless/01172_transaction_counters.sql
index 5431673fd62a..b84a7b25c471 100644
--- a/tests/queries/0_stateless/01172_transaction_counters.sql
+++ b/tests/queries/0_stateless/01172_transaction_counters.sql
@@ -42,7 +42,13 @@ rollback;
 
 system flush logs;
 select indexOf((select arraySort(groupUniqArray(tid)) from system.transactions_info_log where database=currentDatabase() and table='txn_counters'), tid),
-       (toDecimal64(now64(6), 6) - toDecimal64(event_time, 6)) < 100, type, thread_id!=0, length(query_id)=length(queryID()), tid_hash!=0, csn=0, part
+       (toDecimal64(now64(6), 6) - toDecimal64(event_time, 6)) < 100,
+       type,
+       thread_id!=0,
+       length(query_id)=length(queryID()) or type='Commit' and query_id='',  -- ignore fault injection after commit
+       tid_hash!=0,
+       csn=0,
+       part
 from system.transactions_info_log
 where tid in (select tid from system.transactions_info_log where database=currentDatabase() and table='txn_counters' and not (tid.1=1 and tid.2=1))
 or (database=currentDatabase() and table='txn_counters') order by event_time;
diff --git a/tests/queries/0_stateless/02117_show_create_table_system.reference b/tests/queries/0_stateless/02117_show_create_table_system.reference
index ad18e38adcca..d4ada9ba5c8f 100644
--- a/tests/queries/0_stateless/02117_show_create_table_system.reference
+++ b/tests/queries/0_stateless/02117_show_create_table_system.reference
@@ -485,6 +485,7 @@ CREATE TABLE system.parts
     `projections` Array(String),
     `visible` UInt8,
     `creation_tid` Tuple(UInt64, UInt64, UUID),
+    `removal_tid_lock` UInt64,
     `removal_tid` Tuple(UInt64, UInt64, UUID),
     `creation_csn` UInt64,
     `removal_csn` UInt64,
