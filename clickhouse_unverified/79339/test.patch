diff --git a/tests/queries/0_stateless/03416_glue_chunks.reference b/tests/queries/0_stateless/03416_glue_chunks.reference
new file mode 100644
index 000000000000..925f3d952209
--- /dev/null
+++ b/tests/queries/0_stateless/03416_glue_chunks.reference
@@ -0,0 +1,218 @@
+   â”Œâ”€sleep(0.01)â”€â”¬â”€numberâ”€â”
+1. â”‚           0 â”‚      0 â”‚
+2. â”‚           0 â”‚      1 â”‚
+   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+[1A[2K[G3. â”‚           0 â”‚      2 â”‚
+4. â”‚           0 â”‚      3 â”‚
+   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+[1A[2K[G5. â”‚           0 â”‚      4 â”‚
+6. â”‚           0 â”‚      5 â”‚
+   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+[1A[2K[G7. â”‚           0 â”‚      6 â”‚
+8. â”‚           0 â”‚      7 â”‚
+   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+    â”Œâ”€sleep(0.01)â”€â”¬â”€numberâ”€â”
+ 9. â”‚           0 â”‚      8 â”‚
+10. â”‚           0 â”‚      9 â”‚
+    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+[1A[2K[G11. â”‚           0 â”‚     10 â”‚
+    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+    sleep(0.01)   number
+
+1.            0        0 
+2.            0        1 
+3.            0        2 
+4.            0        3 
+5.            0        4 
+6.            0        5 
+7.            0        6 
+8.            0        7 
+     sleep(0.01)   number
+
+ 9.            0        8 
+10.            0        9 
+11.            0       10 
+   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
+   â”ƒ sleep(0.01) â”ƒ number â”ƒ
+   â”¡â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
+1. â”‚           0 â”‚      0 â”‚
+   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
+2. â”‚           0 â”‚      1 â”‚
+   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+[1A[2K[G   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
+3. â”‚           0 â”‚      2 â”‚
+   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
+4. â”‚           0 â”‚      3 â”‚
+   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+[1A[2K[G   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
+5. â”‚           0 â”‚      4 â”‚
+   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
+6. â”‚           0 â”‚      5 â”‚
+   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+[1A[2K[G   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
+7. â”‚           0 â”‚      6 â”‚
+   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
+8. â”‚           0 â”‚      7 â”‚
+   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
+    â”ƒ sleep(0.01) â”ƒ number â”ƒ
+    â”¡â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
+ 9. â”‚           0 â”‚      8 â”‚
+    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
+10. â”‚           0 â”‚      9 â”‚
+    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+[1A[2K[G    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
+11. â”‚           0 â”‚     10 â”‚
+    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+â”Œâ”€sleep(0.01)â”€â”¬â”€numberâ”€â”
+â”‚           0 â”‚      0 â”‚
+â”‚           0 â”‚      1 â”‚
+â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+[1A[2K[Gâ”‚           0 â”‚      2 â”‚
+â”‚           0 â”‚      3 â”‚
+â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+[1A[2K[Gâ”‚           0 â”‚      4 â”‚
+â”‚           0 â”‚      5 â”‚
+â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+[1A[2K[Gâ”‚           0 â”‚      6 â”‚
+â”‚           0 â”‚      7 â”‚
+â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+[1A[2K[Gâ”‚           0 â”‚      8 â”‚
+â”‚           0 â”‚      9 â”‚
+â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+[1A[2K[Gâ”‚           0 â”‚     10 â”‚
+â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+ sleep(0.01)   number
+
+           0        0 
+           0        1 
+           0        2 
+           0        3 
+           0        4 
+           0        5 
+           0        6 
+           0        7 
+           0        8 
+           0        9 
+           0       10 
+â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
+â”ƒ sleep(0.01) â”ƒ number â”ƒ
+â”¡â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
+â”‚           0 â”‚      0 â”‚
+â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
+â”‚           0 â”‚      1 â”‚
+â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+[1A[2K[Gâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
+â”‚           0 â”‚      2 â”‚
+â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
+â”‚           0 â”‚      3 â”‚
+â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+[1A[2K[Gâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
+â”‚           0 â”‚      4 â”‚
+â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
+â”‚           0 â”‚      5 â”‚
+â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+[1A[2K[Gâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
+â”‚           0 â”‚      6 â”‚
+â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
+â”‚           0 â”‚      7 â”‚
+â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+[1A[2K[Gâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
+â”‚           0 â”‚      8 â”‚
+â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
+â”‚           0 â”‚      9 â”‚
+â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+[1A[2K[Gâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
+â”‚           0 â”‚     10 â”‚
+â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
+â”Œâ”€sleep(0.01)â”€â”¬â”€numberâ”€â”
+â”‚           0 â”‚      0 â”‚
+â”‚           0 â”‚      1 â”‚
+â””â”€sleep(0.01)â”€â”´â”€numberâ”€â”˜
+[1A[2K[Gâ”‚           0 â”‚      2 â”‚
+â”‚           0 â”‚      3 â”‚
+â””â”€sleep(0.01)â”€â”´â”€numberâ”€â”˜
+[1A[2K[Gâ”‚           0 â”‚      4 â”‚
+â”‚           0 â”‚      5 â”‚
+â””â”€sleep(0.01)â”€â”´â”€numberâ”€â”˜
+[1A[2K[Gâ”‚           0 â”‚      6 â”‚
+â”‚           0 â”‚      7 â”‚
+â””â”€sleep(0.01)â”€â”´â”€numberâ”€â”˜
+[1A[2K[Gâ”‚           0 â”‚      8 â”‚
+â”‚           0 â”‚      9 â”‚
+â””â”€sleep(0.01)â”€â”´â”€numberâ”€â”˜
+[1A[2K[Gâ”‚           0 â”‚     10 â”‚
+â””â”€sleep(0.01)â”€â”´â”€numberâ”€â”˜
+ sleep(0.01)   number
+
+           0        0 
+           0        1 
+
+ sleep(0.01)   number
+
+[1A[2K[G[1A[2K[G[1A[2K[G           0        2 
+           0        3 
+
+ sleep(0.01)   number
+
+[1A[2K[G[1A[2K[G[1A[2K[G           0        4 
+           0        5 
+
+ sleep(0.01)   number
+
+[1A[2K[G[1A[2K[G[1A[2K[G           0        6 
+           0        7 
+
+ sleep(0.01)   number
+
+[1A[2K[G[1A[2K[G[1A[2K[G           0        8 
+           0        9 
+
+ sleep(0.01)   number
+
+[1A[2K[G[1A[2K[G[1A[2K[G           0       10 
+
+ sleep(0.01)   number
+
+â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”“
+â”ƒ sleep(0.01) â”ƒ number â”ƒ
+â”¡â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”©
+â”‚           0 â”‚      0 â”‚
+â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
+â”‚           0 â”‚      1 â”‚
+â”¢â”â”â”â”â”â”â”â”â”â”â”â”â”â•ˆâ”â”â”â”â”â”â”â”â”ª
+â”ƒ sleep(0.01) â”ƒ number â”ƒ
+â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”»â”â”â”â”â”â”â”â”â”›
+[1A[2K[G[1A[2K[G[1A[2K[Gâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
+â”‚           0 â”‚      2 â”‚
+â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
+â”‚           0 â”‚      3 â”‚
+â”¢â”â”â”â”â”â”â”â”â”â”â”â”â”â•ˆâ”â”â”â”â”â”â”â”â”ª
+â”ƒ sleep(0.01) â”ƒ number â”ƒ
+â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”»â”â”â”â”â”â”â”â”â”›
+[1A[2K[G[1A[2K[G[1A[2K[Gâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
+â”‚           0 â”‚      4 â”‚
+â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
+â”‚           0 â”‚      5 â”‚
+â”¢â”â”â”â”â”â”â”â”â”â”â”â”â”â•ˆâ”â”â”â”â”â”â”â”â”ª
+â”ƒ sleep(0.01) â”ƒ number â”ƒ
+â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”»â”â”â”â”â”â”â”â”â”›
+[1A[2K[G[1A[2K[G[1A[2K[Gâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
+â”‚           0 â”‚      6 â”‚
+â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
+â”‚           0 â”‚      7 â”‚
+â”¢â”â”â”â”â”â”â”â”â”â”â”â”â”â•ˆâ”â”â”â”â”â”â”â”â”ª
+â”ƒ sleep(0.01) â”ƒ number â”ƒ
+â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”»â”â”â”â”â”â”â”â”â”›
+[1A[2K[G[1A[2K[G[1A[2K[Gâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
+â”‚           0 â”‚      8 â”‚
+â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
+â”‚           0 â”‚      9 â”‚
+â”¢â”â”â”â”â”â”â”â”â”â”â”â”â”â•ˆâ”â”â”â”â”â”â”â”â”ª
+â”ƒ sleep(0.01) â”ƒ number â”ƒ
+â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”»â”â”â”â”â”â”â”â”â”›
+[1A[2K[G[1A[2K[G[1A[2K[Gâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤
+â”‚           0 â”‚     10 â”‚
+â”¢â”â”â”â”â”â”â”â”â”â”â”â”â”â•ˆâ”â”â”â”â”â”â”â”â”ª
+â”ƒ sleep(0.01) â”ƒ number â”ƒ
+â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”»â”â”â”â”â”â”â”â”â”›
diff --git a/tests/queries/0_stateless/03416_glue_chunks.sql b/tests/queries/0_stateless/03416_glue_chunks.sql
new file mode 100644
index 000000000000..b4e76d1069b7
--- /dev/null
+++ b/tests/queries/0_stateless/03416_glue_chunks.sql
@@ -0,0 +1,20 @@
+SET output_format_pretty_row_numbers = 1;
+SET output_format_pretty_glue_chunks = 1;
+SET output_format_pretty_squash_consecutive_ms = 0;
+SET max_block_size = 2;
+
+SELECT sleep(0.01), number FROM numbers(11) FORMAT PrettyCompact;
+SELECT sleep(0.01), number FROM numbers(11) FORMAT PrettySpace;
+SELECT sleep(0.01), number FROM numbers(11) FORMAT Pretty;
+
+SET output_format_pretty_row_numbers = 0;
+
+SELECT sleep(0.01), number FROM numbers(11) FORMAT PrettyCompact;
+SELECT sleep(0.01), number FROM numbers(11) FORMAT PrettySpace;
+SELECT sleep(0.01), number FROM numbers(11) FORMAT Pretty;
+
+SET output_format_pretty_display_footer_column_names_min_rows = 1;
+
+SELECT sleep(0.01), number FROM numbers(11) FORMAT PrettyCompact;
+SELECT sleep(0.01), number FROM numbers(11) FORMAT PrettySpace;
+SELECT sleep(0.01), number FROM numbers(11) FORMAT Pretty;
