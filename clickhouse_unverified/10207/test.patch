diff --git a/tests/queries/0_stateless/01120_join_constants.reference b/tests/queries/0_stateless/01120_join_constants.reference
new file mode 100644
index 000000000000..a16427fbdf7e
--- /dev/null
+++ b/tests/queries/0_stateless/01120_join_constants.reference
@@ -0,0 +1,2 @@
+1	hello	1	world	world	1
+2	hello	0		world	1
diff --git a/tests/queries/0_stateless/01120_join_constants.sql b/tests/queries/0_stateless/01120_join_constants.sql
new file mode 100644
index 000000000000..443559c3ea11
--- /dev/null
+++ b/tests/queries/0_stateless/01120_join_constants.sql
@@ -0,0 +1,17 @@
+SELECT
+    t1.*,
+    t2.*,
+    'world',
+    isConstant('world')
+FROM
+(
+    SELECT
+        arrayJoin([1, 2]) AS k,
+        'hello'
+) AS t1
+LEFT JOIN
+(
+    SELECT
+        arrayJoin([1, 3]) AS k,
+        'world'
+) AS t2 ON t1.k = t2.k;
diff --git a/tests/queries/bugs/join_constants_on.sql b/tests/queries/bugs/join_constants_on.sql
new file mode 100644
index 000000000000..ae967e07adbb
--- /dev/null
+++ b/tests/queries/bugs/join_constants_on.sql
@@ -0,0 +1,2 @@
+select cast(1, 'UInt8') from (select arrayJoin([1, 2]) as a) t1 left join (select 1 as b) t2 on b = ignore('UInt8');
+select isConstant('UInt8'), toFixedString('hello', toUInt8(substring('UInt8', 5, 1))) from (select arrayJoin([1, 2]) as a) t1 left join (select 1 as b) t2 on b = ignore('UInt8');
