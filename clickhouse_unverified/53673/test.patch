diff --git a/tests/queries/0_stateless/01601_proxy_protocol.sh b/tests/queries/0_stateless/01601_proxy_protocol.sh
index 5f4ec6cc597d..c8ee3ad1f7b3 100755
--- a/tests/queries/0_stateless/01601_proxy_protocol.sh
+++ b/tests/queries/0_stateless/01601_proxy_protocol.sh
@@ -6,4 +6,4 @@ CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
 # shellcheck source=../shell_config.sh
 . "$CURDIR"/../shell_config.sh
 
-printf "PROXY TCP4 255.255.255.255 255.255.255.255 65535 65535\r
\0\21ClickHouse client\24\r\253\251\3\0\7default\0\4\1\0\1\0\0\t0.0.0.0:0\1\tmilovidov\21milovidov-desktop\vClickHouse \24\r\253\251\3\0\1\0\0\0\2\1\25SELECT 'Hello, world'\2\0\247\203\254l\325\\z|\265\254F\275\333\206\342\24\202\24\0\0\0
\0\0\0\240\1\0\2\377\377\377\377\0\0\0" | nc "${CLICKHOUSE_HOST}" "${CLICKHOUSE_PORT_TCP_WITH_PROXY}" | head -c150 | grep --text -o -F 'Hello, world'
+printf "PROXY TCP4 255.255.255.255 255.255.255.255 65535 65535\r
\0\21ClickHouse client\24\r\253\251\3\0\7default\0\4\1\0\1\0\0\t0.0.0.0:0\1\tmilovidov\21milovidov-desktop\21ClickHouse client\24\r\253\251\3\0\1\0\0\0\2\1\25SELECT 'Hello, world'\2\0\247\203\254l\325\\z|\265\254F\275\333\206\342\24\202\24\0\0\0
\0\0\0\240\1\0\2\377\377\377\377\0\0\0" | nc "${CLICKHOUSE_HOST}" "${CLICKHOUSE_PORT_TCP_WITH_PROXY}" | head -c150 | grep --text -o -F 'Hello, world'
diff --git a/tests/queries/0_stateless/02010_lc_native.python b/tests/queries/0_stateless/02010_lc_native.python
index a197d32a3b90..6c4220855c86 100755
--- a/tests/queries/0_stateless/02010_lc_native.python
+++ b/tests/queries/0_stateless/02010_lc_native.python
@@ -8,6 +8,7 @@ import uuid
 CLICKHOUSE_HOST = os.environ.get("CLICKHOUSE_HOST", "127.0.0.1")
 CLICKHOUSE_PORT = int(os.environ.get("CLICKHOUSE_PORT_TCP", "900000"))
 CLICKHOUSE_DATABASE = os.environ.get("CLICKHOUSE_DATABASE", "default")
+CLIENT_NAME = "simple native protocol"
 
 
 def writeVarUInt(x, ba):
@@ -86,7 +87,7 @@ def readStringBinary(s):
 def sendHello(s):
     ba = bytearray()
     writeVarUInt(0, ba)  # Hello
-    writeStringBinary("simple native protocol", ba)
+    writeStringBinary(CLIENT_NAME, ba)
     writeVarUInt(21, ba)
     writeVarUInt(9, ba)
     writeVarUInt(54449, ba)
@@ -123,7 +124,7 @@ def serializeClientInfo(ba, query_id):
     ba.append(1)  # TCP
     writeStringBinary("os_user", ba)  # os_user
     writeStringBinary("client_hostname", ba)  # client_hostname
-    writeStringBinary("client_name", ba)  # client_name
+    writeStringBinary(CLIENT_NAME, ba)  # client_name
     writeVarUInt(21, ba)
     writeVarUInt(9, ba)
     writeVarUInt(54449, ba)
diff --git a/tests/queries/0_stateless/02270_client_name.reference b/tests/queries/0_stateless/02270_client_name.reference
index fbb2921010e6..8d1f2863fade 100644
--- a/tests/queries/0_stateless/02270_client_name.reference
+++ b/tests/queries/0_stateless/02270_client_name.reference
@@ -1,1 +1,1 @@
-"ClickHouse"
+"ClickHouse client"
diff --git a/tests/queries/0_stateless/02458_insert_select_progress_tcp.python b/tests/queries/0_stateless/02458_insert_select_progress_tcp.python
index 696eb01ff7e0..92240e109c1e 100644
--- a/tests/queries/0_stateless/02458_insert_select_progress_tcp.python
+++ b/tests/queries/0_stateless/02458_insert_select_progress_tcp.python
@@ -8,6 +8,7 @@ import json
 CLICKHOUSE_HOST = os.environ.get("CLICKHOUSE_HOST", "127.0.0.1")
 CLICKHOUSE_PORT = int(os.environ.get("CLICKHOUSE_PORT_TCP", "900000"))
 CLICKHOUSE_DATABASE = os.environ.get("CLICKHOUSE_DATABASE", "default")
+CLIENT_NAME = "simple native protocol"
 
 
 def writeVarUInt(x, ba):
@@ -86,7 +87,7 @@ def readStringBinary(s):
 def sendHello(s):
     ba = bytearray()
     writeVarUInt(0, ba)  # Hello
-    writeStringBinary("simple native protocol", ba)
+    writeStringBinary(CLIENT_NAME, ba)
     writeVarUInt(21, ba)
     writeVarUInt(9, ba)
     writeVarUInt(54449, ba)
@@ -123,7 +124,7 @@ def serializeClientInfo(ba, query_id):
     ba.append(1)  # TCP
     writeStringBinary("os_user", ba)  # os_user
     writeStringBinary("client_hostname", ba)  # client_hostname
-    writeStringBinary("client_name", ba)  # client_name
+    writeStringBinary(CLIENT_NAME, ba)  # client_name
     writeVarUInt(21, ba)
     writeVarUInt(9, ba)
     writeVarUInt(54449, ba)
diff --git a/tests/queries/0_stateless/02750_settings_alias_tcp_protocol.python b/tests/queries/0_stateless/02750_settings_alias_tcp_protocol.python
index 768fb2144e34..48b27d434eca 100644
--- a/tests/queries/0_stateless/02750_settings_alias_tcp_protocol.python
+++ b/tests/queries/0_stateless/02750_settings_alias_tcp_protocol.python
@@ -8,6 +8,7 @@ import json
 CLICKHOUSE_HOST = os.environ.get("CLICKHOUSE_HOST", "127.0.0.1")
 CLICKHOUSE_PORT = int(os.environ.get("CLICKHOUSE_PORT_TCP", "900000"))
 CLICKHOUSE_DATABASE = os.environ.get("CLICKHOUSE_DATABASE", "default")
+CLIENT_NAME = "simple native protocol"
 
 
 def writeVarUInt(x, ba):
@@ -86,7 +87,7 @@ def readStringBinary(s):
 def sendHello(s):
     ba = bytearray()
     writeVarUInt(0, ba)  # Hello
-    writeStringBinary("simple native protocol", ba)
+    writeStringBinary(CLIENT_NAME, ba)
     writeVarUInt(21, ba)
     writeVarUInt(9, ba)
     writeVarUInt(54449, ba)
@@ -116,7 +117,7 @@ def serializeClientInfo(ba, query_id):
     ba.append(1)  # TCP
     writeStringBinary("os_user", ba)  # os_user
     writeStringBinary("client_hostname", ba)  # client_hostname
-    writeStringBinary("client_name", ba)  # client_name
+    writeStringBinary(CLIENT_NAME, ba)  # client_name
     writeVarUInt(21, ba)
     writeVarUInt(9, ba)
     writeVarUInt(54449, ba)
diff --git a/tests/queries/0_stateless/02865_tcp_proxy_query_packet_validation.reference b/tests/queries/0_stateless/02865_tcp_proxy_query_packet_validation.reference
new file mode 100644
index 000000000000..1f966c6731bd
--- /dev/null
+++ b/tests/queries/0_stateless/02865_tcp_proxy_query_packet_validation.reference
@@ -0,0 +1,2 @@
+client_name does not match
+version does not match
diff --git a/tests/queries/0_stateless/02865_tcp_proxy_query_packet_validation.sh b/tests/queries/0_stateless/02865_tcp_proxy_query_packet_validation.sh
new file mode 100755
index 000000000000..fbbb7d11ec0d
--- /dev/null
+++ b/tests/queries/0_stateless/02865_tcp_proxy_query_packet_validation.sh
@@ -0,0 +1,10 @@
+#!/usr/bin/env bash
+# Tags: no-fasttest
+# Tag no-fasttest: nc - command not found
+
+CURDIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
+# shellcheck source=../shell_config.sh
+. "$CURDIR"/../shell_config.sh
+
+printf "PROXY TCP4 255.255.255.255 255.255.255.255 65535 65535\r
\0\21ClickHouse client\24\r\253\251\3\0\7default\0\4\1\0\1\0\0\t0.0.0.0:0\1\6hacker\16hacker-desktop\15Hacker client\24\r\253\251\3\0\1\0\0\0\2\1\25SELECT 'Hello, world'\2\0\247\203\254l\325\\z|\265\254F\275\333\206\342\24\202\24\0\0\0
\0\0\0\240\1\0\2\377\377\377\377\0\0\0" | nc "${CLICKHOUSE_HOST}" "${CLICKHOUSE_PORT_TCP_WITH_PROXY}" | head -c250 | grep --text -o -F 'client_name does not match'
+printf "PROXY TCP4 255.255.255.255 255.255.255.255 65535 65535\r
\0\21ClickHouse client\24\r\253\251\3\0\7default\0\4\1\0\1\0\0\t0.0.0.0:0\1\6hacker\16hacker-desktop\21ClickHouse client\20\r\253\251\3\0\1\0\0\0\2\1\25SELECT 'Hello, world'\2\0\247\203\254l\325\\z|\265\254F\275\333\206\342\24\202\24\0\0\0
\0\0\0\240\1\0\2\377\377\377\377\0\0\0" | nc "${CLICKHOUSE_HOST}" "${CLICKHOUSE_PORT_TCP_WITH_PROXY}" | head -c250 | grep --text -o -F 'version does not match'
