You will be provided with a partial code base and an issue statement explaining a problem to resolve.

<issue>
Logical error: cannot capture column in lambda functions
https://s3.amazonaws.com/clickhouse-test-reports/45013/8ca1740c37d7b4f19cc00ec1ee108d5ba9c51bad/fuzzer_astfuzzerubsan/report.html

```
2023.01.07 05:41:59.938242 [ 142 ] {689f7c9b-be6f-477a-94e9-1b4b52a90545} <Fatal> : Logical error: 'Cannot capture column 3 because it has incompatible type: got Int256, but LowCardinality(Int256) is expected.'.
2023.01.07 05:41:59.939975 [ 442 ] {} <Fatal> BaseDaemon: ########################################
2023.01.07 05:41:59.940013 [ 442 ] {} <Fatal> BaseDaemon: (version 22.13.1.1, build id: 6DC020D880ABD19775A54A5DC6544FB36B991393) (from thread 142) (query_id: 689f7c9b-be6f-477a-94e9-1b4b52a90545) (query: SELECT arrayMap(x -> (x + (arrayMap(y -> ((x + y) + id), [NULL])[1])), [-2147483647, 65537, 100]) FROM test_table__fuzz_17) Received signal Aborted (6)
2023.01.07 05:41:59.940030 [ 442 ] {} <Fatal> BaseDaemon: 
2023.01.07 05:41:59.940069 [ 442 ] {} <Fatal> BaseDaemon: Stack trace: 0x7f56041ea00b 0x7f56041c9859 0x21890863 0x21890b6f 0x16fe11b5 0x2de9a331 0x2de95267 0x2de94fdb 0x2cb1c664 0x2cb1bd9f 0x2bf3b509 0x2bf3ca2c 0x2bf3e311 0x2ca960d4 0x2ca944a3 0x2ca97037 0x2cb1e028 0x2bf3b509 0x2bf3cd3b 0x2bf3e311 0x16fe0226 0x2de9b049 0x21079e22 0x16fe2b1f 0x16fe17a8 0x2bf3b499 0x2bf3cd3b 0x2bf3e311 0x2c869e1f 0x2f5255a5 0x2f79277c 0x2d6fa63c 0x2d6e7fb7 0x2d6e47d6 0x2d7bdc3b 0x2d7bf0fb 0x2dc269da 0x2dc2200c 0x2f08e870 0x2f0afdba 0x3010160c 0x30101afa
2023.01.07 05:41:59.940097 [ 442 ] {} <Fatal> BaseDaemon: 3. gsignal @ 0x7f56041ea00b in ?
2023.01.07 05:41:59.940114 [ 442 ] {} <Fatal> BaseDaemon: 4. abort @ 0x7f56041c9859 in ?
2023.01.07 05:41:59.963429 [ 442 ] {} <Fatal> BaseDaemon: 5. ./build_docker/../src/Common/Exception.cpp:48: DB::abortOnFailedAssertion(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>> const&) @ 0x21890863 in /workspace/clickhouse
2023.01.07 05:41:59.985394 [ 442 ] {} <Fatal> BaseDaemon: 6. ./build_docker/../src/Common/Exception.cpp:78: DB::Exception::Exception(DB::Exception::MessageMasked const&, int, bool) @ 0x21890b6f in /workspace/clickhouse
2023.01.07 05:42:01.097763 [ 442 ] {} <Fatal> BaseDaemon: 7. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>> const&, int, bool) @ 0x16fe11b5 in /workspace/clickhouse
2023.01.07 05:42:01.109678 [ 442 ] {} <Fatal> BaseDaemon: 8. ./build_docker/../src/Columns/ColumnFunction.cpp:0: DB::ColumnFunction::appendArgument(DB::ColumnWithTypeAndName const&) @ 0x2de9a331 in /workspace/clickhouse
2023.01.07 05:42:01.120874 [ 442 ] {} <Fatal> BaseDaemon: 9.1. inlined from ./build_docker/../contrib/llvm-project/libcxx/include/__iterator/wrap_iter.h:100: std::__1::__wrap_iter<DB::ColumnWithTypeAndName const*>::operator++[abi:v15000]()
2023.01.07 05:42:01.120936 [ 442 ] {} <Fatal> BaseDaemon: 9. ./build_docker/../src/Columns/ColumnFunction.cpp:256: DB::ColumnFunction::appendArguments(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName>> const&) @ 0x2de95267 in /workspace/clickhouse
2023.01.07 05:42:01.132016 [ 442 ] {} <Fatal> BaseDaemon: 10. ./build_docker/../src/Columns/ColumnFunction.cpp:0: DB::ColumnFunction::ColumnFunction(unsigned long, std::__1::shared_ptr<DB::IFunctionBase const>, std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName>> const&, bool, bool, bool) @ 0x2de94fdb in /workspace/clickhouse
2023.01.07 05:42:01.271562 [ 442 ] {} <Fatal> BaseDaemon: 11. ./build_docker/../src/Common/COW.h:284: COW<DB::IColumn>::mutable_ptr<DB::ColumnFunction> COWHelper<DB::IColumn, DB::ColumnFunction>::create<unsigned long&, std::__1::unique_ptr<DB::FunctionExpression, std::__1::default_delete<DB::FunctionExpression>>, std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName>> const&>(unsigned long&, std::__1::unique_ptr<DB::FunctionExpression, std::__1::default_delete<DB::FunctionExpression>>&&, std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName>> const&) @ 0x2cb1c664 in /workspace/clickhouse
2023.01.07 05:42:01.408473 [ 442 ] {} <Fatal> BaseDaemon: 12. ./build_docker/../src/Functions/FunctionsMiscellaneous.h:149: DB::ExecutableFunctionCapture::executeImpl(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName>> const&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long) const @ 0x2cb1bd9f in /workspace/clickhouse
2023.01.07 05:42:01.422477 [ 442 ] {} <Fatal> BaseDaemon: 13. ./build_docker/../src/Functions/IFunction.cpp:0: DB::IExecutableFunction::executeWithoutLowCardinalityColumns(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName>> const&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long, bool) const @ 0x2bf3b509 in /workspace/clickhouse
2023.01.07 05:42:01.437304 [ 442 ] {} <Fatal> BaseDaemon: 14.1. inlined from ./build_docker/../contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:115: intrusive_ptr
2023.01.07 05:42:01.437355 [ 442 ] {} <Fatal> BaseDaemon: 14.2. inlined from ./build_docker/../contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:122: boost::intrusive_ptr<DB::IColumn const>::operator=(boost::intrusive_ptr<DB::IColumn const>&&)
2023.01.07 05:42:01.437385 [ 442 ] {} <Fatal> BaseDaemon: 14.3. inlined from ./build_docker/../src/Common/COW.h:136: COW<DB::IColumn>::immutable_ptr<DB::IColumn>::operator=(COW<DB::IColumn>::immutable_ptr<DB::IColumn>&&)
2023.01.07 05:42:01.437416 [ 442 ] {} <Fatal> BaseDaemon: 14. ./build_docker/../src/Functions/IFunction.cpp:306: DB::IExecutableFunction::executeWithoutSparseColumns(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName>> const&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long, bool) const @ 0x2bf3ca2c in /workspace/clickhouse
2023.01.07 05:42:01.452773 [ 442 ] {} <Fatal> BaseDaemon: 15. ./build_docker/../src/Functions/IFunction.cpp:0: DB::IExecutableFunction::execute(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName>> const&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long, bool) const @ 0x2bf3e311 in /workspace/clickhouse
2023.01.07 05:42:01.516894 [ 442 ] {} <Fatal> BaseDaemon: 16.1. inlined from ./build_docker/../contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:115: intrusive_ptr
2023.01.07 05:42:01.516967 [ 442 ] {} <Fatal> BaseDaemon: 16.2. inlined from ./build_docker/../contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:122: boost::intrusive_ptr<DB::IColumn const>::operator=(boost::intrusive_ptr<DB::IColumn const>&&)
2023.01.07 05:42:01.516998 [ 442 ] {} <Fatal> BaseDaemon: 16.3. inlined from ./build_docker/../src/Common/COW.h:136: COW<DB::IColumn>::immutable_ptr<DB::IColumn>::operator=(COW<DB::IColumn>::immutable_ptr<DB::IColumn>&&)
2023.01.07 05:42:01.517029 [ 442 ] {} <Fatal> BaseDaemon: 16. ./build_docker/../src/Interpreters/ExpressionActions.cpp:607: DB::executeAction(DB::ExpressionActions::Action const&, DB::(anonymous namespace)::ExecutionContext&, bool) @ 0x2ca960d4 in /workspace/clickhouse
2023.01.07 05:42:01.570027 [ 442 ] {} <Fatal> BaseDaemon: 17. ./build_docker/../src/Interpreters/ExpressionActions.cpp:0: DB::ExpressionActions::execute(DB::Block&, unsigned long&, bool) const @ 0x2ca944a3 in /workspace/clickhouse
2023.01.07 05:42:01.623182 [ 442 ] {} <Fatal> BaseDaemon: 18.1. inlined from ./build_docker/../contrib/llvm-project/libcxx/include/vector:537: std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName>>::size[abi:v15000]() const
2023.01.07 05:42:01.623240 [ 442 ] {} <Fatal> BaseDaemon: 18.2. inlined from ./build_docker/../src/Core/Block.h:108: DB::Block::columns() const
2023.01.07 05:42:01.623273 [ 442 ] {} <Fatal> BaseDaemon: 18.3. inlined from ./build_docker/../src/Core/Block.h:119: DB::Block::operator bool() const
2023.01.07 05:42:01.623301 [ 442 ] {} <Fatal> BaseDaemon: 18.4. inlined from ./build_docker/../src/Core/Block.h:120: DB::Block::operator!() const
2023.01.07 05:42:01.623333 [ 442 ] {} <Fatal> BaseDaemon: 18. ./build_docker/../src/Interpreters/ExpressionActions.cpp:770: DB::ExpressionActions::execute(DB::Block&, bool) const @ 0x2ca97037 in /workspace/clickhouse
2023.01.07 05:42:01.760466 [ 442 ] {} <Fatal> BaseDaemon: 19. ./build_docker/../src/Functions/FunctionsMiscellaneous.h:50: DB::ExecutableFunctionExpression::executeImpl(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName>> const&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long) const @ 0x2cb1e028 in /workspace/clickhouse
2023.01.07 05:42:01.774399 [ 442 ] {} <Fatal> BaseDaemon: 20. ./build_docker/../src/Functions/IFunction.cpp:0: DB::IExecutableFunction::executeWithoutLowCardinalityColumns(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName>> const&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long, bool) const @ 0x2bf3b509 in /workspace/clickhouse
2023.01.07 05:42:01.789314 [ 442 ] {} <Fatal> BaseDaemon: 21.1. inlined from ./build_docker/../contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:115: intrusive_ptr
2023.01.07 05:42:01.789380 [ 442 ] {} <Fatal> BaseDaemon: 21.2. inlined from ./build_docker/../contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:122: boost::intrusive_ptr<DB::IColumn const>::operator=(boost::intrusive_ptr<DB::IColumn const>&&)
2023.01.07 05:42:01.789403 [ 442 ] {} <Fatal> BaseDaemon: 21.3. inlined from ./build_docker/../src/Common/COW.h:136: COW<DB::IColumn>::immutable_ptr<DB::IColumn>::operator=(COW<DB::IColumn>::immutable_ptr<DB::IColumn>&&)
2023.01.07 05:42:01.789417 [ 442 ] {} <Fatal> BaseDaemon: 21. ./build_docker/../src/Functions/IFunction.cpp:302: DB::IExecutableFunction::executeWithoutSparseColumns(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName>> const&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long, bool) const @ 0x2bf3cd3b in /workspace/clickhouse
2023.01.07 05:42:01.804840 [ 442 ] {} <Fatal> BaseDaemon: 22. ./build_docker/../src/Functions/IFunction.cpp:0: DB::IExecutableFunction::execute(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName>> const&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long, bool) const @ 0x2bf3e311 in /workspace/clickhouse
2023.01.07 05:42:02.896754 [ 442 ] {} <Fatal> BaseDaemon: 23. DB::IFunctionBase::execute(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName>> const&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long, bool) const @ 0x16fe0226 in /workspace/clickhouse
2023.01.07 05:42:02.909681 [ 442 ] {} <Fatal> BaseDaemon: 24.1. inlined from ./build_docker/../contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:115: intrusive_ptr
2023.01.07 05:42:02.909738 [ 442 ] {} <Fatal> BaseDaemon: 24.2. inlined from ./build_docker/../contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:122: boost::intrusive_ptr<DB::IColumn const>::operator=(boost::intrusive_ptr<DB::IColumn const>&&)
2023.01.07 05:42:02.909753 [ 442 ] {} <Fatal> BaseDaemon: 24.3. inlined from ./build_docker/../src/Common/COW.h:136: COW<DB::IColumn>::immutable_ptr<DB::IColumn>::operator=(COW<DB::IColumn>::immutable_ptr<DB::IColumn>&&)
2023.01.07 05:42:02.909767 [ 442 ] {} <Fatal> BaseDaemon: 24. ./build_docker/../src/Columns/ColumnFunction.cpp:310: DB::ColumnFunction::reduce() const @ 0x2de9b049 in /workspace/clickhouse
2023.01.07 05:42:04.007525 [ 442 ] {} <Fatal> BaseDaemon: 25. DB::FunctionArrayMapped<DB::ArrayMapImpl, DB::NameArrayMap>::executeImpl(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName>> const&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long) const @ 0x21079e22 in /workspace/clickhouse
2023.01.07 05:42:05.099321 [ 442 ] {} <Fatal> BaseDaemon: 26. DB::IFunction::executeImplDryRun(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName>> const&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long) const @ 0x16fe2b1f in /workspace/clickhouse
2023.01.07 05:42:06.202613 [ 442 ] {} <Fatal> BaseDaemon: 27. DB::FunctionToExecutableFunctionAdaptor::executeDryRunImpl(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName>> const&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long) const @ 0x16fe17a8 in /workspace/clickhouse
2023.01.07 05:42:06.216505 [ 442 ] {} <Fatal> BaseDaemon: 28. ./build_docker/../src/Functions/IFunction.cpp:0: DB::IExecutableFunction::executeWithoutLowCardinalityColumns(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName>> const&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long, bool) const @ 0x2bf3b499 in /workspace/clickhouse
2023.01.07 05:42:06.231404 [ 442 ] {} <Fatal> BaseDaemon: 29.1. inlined from ./build_docker/../contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:115: intrusive_ptr
2023.01.07 05:42:06.231475 [ 442 ] {} <Fatal> BaseDaemon: 29.2. inlined from ./build_docker/../contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:122: boost::intrusive_ptr<DB::IColumn const>::operator=(boost::intrusive_ptr<DB::IColumn const>&&)
2023.01.07 05:42:06.231493 [ 442 ] {} <Fatal> BaseDaemon: 29.3. inlined from ./build_docker/../src/Common/COW.h:136: COW<DB::IColumn>::immutable_ptr<DB::IColumn>::operator=(COW<DB::IColumn>::immutable_ptr<DB::IColumn>&&)
2023.01.07 05:42:06.231507 [ 442 ] {} <Fatal> BaseDaemon: 29. ./build_docker/../src/Functions/IFunction.cpp:302: DB::IExecutableFunction::executeWithoutSparseColumns(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName>> const&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long, bool) const @ 0x2bf3cd3b in /workspace/clickhouse
2023.01.07 05:42:06.246917 [ 442 ] {} <Fatal> BaseDaemon: 30. ./build_docker/../src/Functions/IFunction.cpp:0: DB::IExecutableFunction::execute(std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName>> const&, std::__1::shared_ptr<DB::IDataType const> const&, unsigned long, bool) const @ 0x2bf3e311 in /workspace/clickhouse
2023.01.07 05:42:06.438448 [ 442 ] {} <Fatal> BaseDaemon: 31.1. inlined from ./build_docker/../contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:115: intrusive_ptr
2023.01.07 05:42:06.438508 [ 442 ] {} <Fatal> BaseDaemon: 31.2. inlined from ./build_docker/../contrib/boost/boost/smart_ptr/intrusive_ptr.hpp:122: boost::intrusive_ptr<DB::IColumn const>::operator=(boost::intrusive_ptr<DB::IColumn const>&&)
2023.01.07 05:42:06.438524 [ 442 ] {} <Fatal> BaseDaemon: 31.3. inlined from ./build_docker/../src/Common/COW.h:136: COW<DB::IColumn>::immutable_ptr<DB::IColumn>::operator=(COW<DB::IColumn>::immutable_ptr<DB::IColumn>&&)
2023.01.07 05:42:06.438541 [ 442 ] {} <Fatal> BaseDaemon: 31.4. inlined from ./build_docker/../src/Interpreters/ActionsDAG.cpp:499: DB::executeActionForHeader(DB::ActionsDAG::Node const*, std::__1::vector<DB::ColumnWithTypeAndName, std::__1::allocator<DB::ColumnWithTypeAndName>>)
2023.01.07 05:42:06.438571 [ 442 ] {} <Fatal> BaseDaemon: 31. ./build_docker/../src/Interpreters/ActionsDAG.cpp:616: DB::ActionsDAG::updateHeader(DB::Block) const @ 0x2c869e1f in /workspace/clickhouse
2023.01.07 05:42:06.451238 [ 442 ] {} <Fatal> BaseDaemon: 32. ./build_docker/../src/Processors/Transforms/ExpressionTransform.cpp:0: DB::ExpressionTransform::transformHeader(DB::Block, DB::ActionsDAG const&) @ 0x2f5255a5 in /workspace/clickhouse
2023.01.07 05:42:06.474835 [ 442 ] {} <Fatal> BaseDaemon: 33.1. inlined from ./build_docker/../contrib/llvm-project/libcxx/include/__memory/shared_ptr.h:815: std::__1::shared_ptr<DB::ActionsDAG>::operator->[abi:v15000]() const
2023.01.07 05:42:06.474891 [ 442 ] {} <Fatal> BaseDaemon: 33.2. inlined from ./build_docker/../src/Processors/QueryPlan/ExpressionStep.cpp:18: DB::getTraits(std::__1::shared_ptr<DB::ActionsDAG> const&, DB::Block const&, DB::SortDescription const&)
2023.01.07 05:42:06.474919 [ 442 ] {} <Fatal> BaseDaemon: 33. ./build_docker/../src/Processors/QueryPlan/ExpressionStep.cpp:33: DB::ExpressionStep::ExpressionStep(DB::DataStream const&, std::__1::shared_ptr<DB::ActionsDAG> const&) @ 0x2f79277c in /workspace/clickhouse
2023.01.07 05:42:06.589942 [ 442 ] {} <Fatal> BaseDaemon: 34. ./build_docker/../src/Interpreters/InterpreterSelectQuery.cpp:2609: DB::InterpreterSelectQuery::executeExpression(DB::QueryPlan&, std::__1::shared_ptr<DB::ActionsDAG> const&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>> const&) @ 0x2d6fa63c in /workspace/clickhouse
2023.01.07 05:42:06.702325 [ 442 ] {} <Fatal> BaseDaemon: 35.1. inlined from ./build_docker/../contrib/llvm-project/libcxx/include/string:1499: std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>::__is_long[abi:v15000]() const
2023.01.07 05:42:06.702396 [ 442 ] {} <Fatal> BaseDaemon: 35.2. inlined from ./build_docker/../contrib/llvm-project/libcxx/include/string:2333: ~basic_string
2023.01.07 05:42:06.702427 [ 442 ] {} <Fatal> BaseDaemon: 35. ./build_docker/../src/Interpreters/InterpreterSelectQuery.cpp:1560: DB::InterpreterSelectQuery::executeImpl(DB::QueryPlan&, std::__1::optional<DB::Pipe>) @ 0x2d6e7fb7 in /workspace/clickhouse
2023.01.07 05:42:06.814037 [ 442 ] {} <Fatal> BaseDaemon: 36.1. inlined from ./build_docker/../contrib/llvm-project/libcxx/include/optional:260: ~__optional_destruct_base
2023.01.07 05:42:06.814115 [ 442 ] {} <Fatal> BaseDaemon: 36. ./build_docker/../src/Interpreters/InterpreterSelectQuery.cpp:731: DB::InterpreterSelectQuery::buildQueryPlan(DB::QueryPlan&) @ 0x2d6e47d6 in /workspace/clickhouse
2023.01.07 05:42:06.855142 [ 442 ] {} <Fatal> BaseDaemon: 37. ./build_docker/../src/Interpreters/InterpreterSelectWithUnionQuery.cpp:304: DB::InterpreterSelectWithUnionQuery::buildQueryPlan(DB::QueryPlan&) @ 0x2d7bdc3b in /workspace/clickhouse
2023.01.07 05:42:06.896131 [ 442 ] {} <Fatal> BaseDaemon: 38. ./build_docker/../src/Interpreters/InterpreterSelectWithUnionQuery.cpp:0: DB::InterpreterSelectWithUnionQuery::execute() @ 0x2d7bf0fb in /workspace/clickhouse
2023.01.07 05:42:06.954013 [ 442 ] {} <Fatal> BaseDaemon: 39. ./build_docker/../src/Interpreters/executeQuery.cpp:0: DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x2dc269da in /workspace/clickhouse
2023.01.07 05:42:07.015642 [ 442 ] {} <Fatal> BaseDaemon: 40. ./build_docker/../src/Interpreters/executeQuery.cpp:1104: DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>> const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x2dc2200c in /workspace/clickhouse
2023.01.07 05:42:07.071618 [ 442 ] {} <Fatal> BaseDaemon: 41. ./build_docker/../src/Server/TCPHandler.cpp:378: DB::TCPHandler::runImpl() @ 0x2f08e870 in /workspace/clickhouse
2023.01.07 05:42:07.140328 [ 442 ] {} <Fatal> BaseDaemon: 42. ./build_docker/../src/Server/TCPHandler.cpp:1933: DB::TCPHandler::run() @ 0x2f0afdba in /workspace/clickhouse
2023.01.07 05:42:07.146001 [ 442 ] {} <Fatal> BaseDaemon: 43. ./build_docker/../contrib/poco/Net/src/TCPServerConnection.cpp:57: Poco::Net::TCPServerConnection::start() @ 0x3010160c in /workspace/clickhouse
2023.01.07 05:42:07.153488 [ 442 ] {} <Fatal> BaseDaemon: 44.1. inlined from ./build_docker/../contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:48: std::__1::default_delete<Poco::Net::TCPServerConnection>::operator()[abi:v15000](Poco::Net::TCPServerConnection*) const
2023.01.07 05:42:07.153540 [ 442 ] {} <Fatal> BaseDaemon: 44.2. inlined from ./build_docker/../contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:305: std::__1::unique_ptr<Poco::Net::TCPServerConnection, std::__1::default_delete<Poco::Net::TCPServerConnection>>::reset[abi:v15000](Poco::Net::TCPServerConnection*)
2023.01.07 05:42:07.153567 [ 442 ] {} <Fatal> BaseDaemon: 44.3. inlined from ./build_docker/../contrib/llvm-project/libcxx/include/__memory/unique_ptr.h:259: ~unique_ptr
2023.01.07 05:42:07.153595 [ 442 ] {} <Fatal> BaseDaemon: 44. ./build_docker/../contrib/poco/Net/src/TCPServerDispatcher.cpp:116: Poco::Net::TCPServerDispatcher::run() @ 0x30101afa in /workspace/clickhouse
2023.01.07 05:42:07.153628 [ 442 ] {} <Fatal> BaseDaemon: Integrity check of the executable skipped because the reference checksum could not be read.
2023.01.07 05:43:02.587357 [ 133 ] {} <Fatal> Application: Child process was terminated by signal 6.
```
</issue>

I need you to solve the provided issue by generating a code fix that can be applied directly to the repository

Respond below:
