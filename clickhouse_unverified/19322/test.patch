diff --git a/tests/queries/0_stateless/01182_materialized_view_different_structure.reference b/tests/queries/0_stateless/01182_materialized_view_different_structure.reference
new file mode 100644
index 000000000000..a1f113394b28
--- /dev/null
+++ b/tests/queries/0_stateless/01182_materialized_view_different_structure.reference
@@ -0,0 +1,6 @@
+4999950000.000000
+4999950000
+1000	499500	499500	999	0
+1000	124716	499500	255	0
+1000	124716	99	0
+2000	249432	255	0
diff --git a/tests/queries/0_stateless/01182_materialized_view_different_structure.sql b/tests/queries/0_stateless/01182_materialized_view_different_structure.sql
new file mode 100644
index 000000000000..751bcc9e48e6
--- /dev/null
+++ b/tests/queries/0_stateless/01182_materialized_view_different_structure.sql
@@ -0,0 +1,42 @@
+DROP TABLE IF EXISTS test_table;
+DROP TABLE IF EXISTS numbers;
+DROP TABLE IF EXISTS test_mv;
+DROP TABLE IF EXISTS src;
+DROP TABLE IF EXISTS dst;
+DROP TABLE IF EXISTS mv;
+DROP TABLE IF EXISTS dist;
+
+CREATE TABLE test_table (key UInt32, value Decimal(16, 6)) ENGINE = SummingMergeTree() ORDER BY key;
+CREATE TABLE numbers (number UInt64) ENGINE=Memory;
+
+CREATE MATERIALIZED VIEW test_mv TO test_table (number UInt64, value Decimal(38, 6))
+AS SELECT number, sum(number) AS value FROM (SELECT *, toDecimal64(number, 6) AS val FROM numbers) GROUP BY number;
+
+INSERT INTO numbers SELECT * FROM numbers(100000);
+
+SELECT sum(value) FROM test_mv;
+SELECT sum(value) FROM (SELECT number, sum(number) AS value FROM (SELECT *, toDecimal64(number, 6) AS val FROM numbers) GROUP BY number);
+
+CREATE TABLE src (n UInt64, s FixedString(16)) ENGINE=Memory;
+CREATE TABLE dst (n UInt8, s String) ENGINE = Memory;
+CREATE MATERIALIZED VIEW mv TO dst (n String) AS SELECT * FROM src;
+SET allow_experimental_bigint_types=1;
+CREATE TABLE dist (n Int128) ENGINE=Distributed(test_cluster_two_shards, currentDatabase(), mv);
+
+INSERT INTO src SELECT number, toString(number) FROM numbers(1000);
+INSERT INTO mv SELECT toString(number + 1000) FROM numbers(1000); -- { serverError 53 }
+INSERT INTO mv SELECT arrayJoin(['42', 'test']); -- { serverError 53 }
+
+SELECT count(), sum(n), sum(toInt64(s)), max(n), min(n) FROM src;
+SELECT count(), sum(n), sum(toInt64(s)), max(n), min(n) FROM dst;
+SELECT count(), sum(toInt64(n)), max(n), min(n) FROM mv;
+SELECT count(), sum(toInt64(n)), max(n), min(n) FROM dist; -- { serverError 70 }
+SELECT count(), sum(toInt64(n)), max(toUInt32(n)), min(toInt128(n)) FROM dist;
+
+DROP TABLE test_table;
+DROP TABLE numbers;
+DROP TABLE test_mv;
+DROP TABLE src;
+DROP TABLE dst;
+DROP TABLE mv;
+DROP TABLE dist;
diff --git a/tests/queries/0_stateless/arcadia_skip_list.txt b/tests/queries/0_stateless/arcadia_skip_list.txt
index 4ac71596280c..2aeaa7b3ac21 100644
--- a/tests/queries/0_stateless/arcadia_skip_list.txt
+++ b/tests/queries/0_stateless/arcadia_skip_list.txt
@@ -189,4 +189,5 @@
 01650_fetch_patition_with_macro_in_zk_path
 01651_bugs_from_15889
 01655_agg_if_nullable
+01182_materialized_view_different_structure
 01660_sum_ubsan
