diff --git a/tools/pythonpkg/src/python_replacement_scan.cpp b/tools/pythonpkg/src/python_replacement_scan.cpp
index 8d1610534789..65eb8c009329 100644
--- a/tools/pythonpkg/src/python_replacement_scan.cpp
+++ b/tools/pythonpkg/src/python_replacement_scan.cpp
@@ -225,6 +225,9 @@ static unique_ptr<TableRef> ReplaceInternal(ClientContext &context, const string
 			}
 		}
 		current_frame = current_frame.attr("f_back");
+		if (py::none().is(current_frame)) {
+			break;
+		}
 	} while (scan_all_frames && (has_locals || has_globals));
 	return nullptr;
 }
