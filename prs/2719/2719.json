{
  "repo": "duckdb/duckdb",
  "pull_number": 2719,
  "instance_id": "duckdb__duckdb-2719",
  "issue_numbers": [
    "2713",
    "2713"
  ],
  "base_commit": "32060df047520f8dd0c7545963da11ace5f48d81",
  "patch": "diff --git a/src/planner/binder/expression/bind_function_expression.cpp b/src/planner/binder/expression/bind_function_expression.cpp\nindex 364d55b632c8..9f3d74227d9f 100644\n--- a/src/planner/binder/expression/bind_function_expression.cpp\n+++ b/src/planner/binder/expression/bind_function_expression.cpp\n@@ -56,7 +56,7 @@ BindResult ExpressionBinder::BindFunction(FunctionExpression &function, ScalarFu\n \tunique_ptr<Expression> result =\n \t    ScalarFunction::BindScalarFunction(context, *func, move(children), error, function.is_operator);\n \tif (!result) {\n-\t\tthrow BinderException(binder.FormatError(function, error));\n+\t\treturn BindResult(binder.FormatError(function, error));\n \t}\n \treturn BindResult(move(result));\n }\n",
  "test_patch": "diff --git a/test/sql/cte/recursive_cte_correlated_subquery.test_slow b/test/sql/cte/recursive_cte_correlated_subquery.test_slow\nnew file mode 100644\nindex 000000000000..9722fea9289c\n--- /dev/null\n+++ b/test/sql/cte/recursive_cte_correlated_subquery.test_slow\n@@ -0,0 +1,33 @@\n+# name: test/sql/cte/recursive_cte_correlated_subquery.test_slow\n+# description: Issue #2713: reports struct_extract error when run a sql\n+# group: [cte]\n+\n+query I\n+WITH RECURSIVE\n+input(sud) AS (\n+VALUES('53..7....6..195....98....6.8...6...34..8.3..17...2...6.6....28....419..5....8..79')\n+),\n+digits(z, lp) AS (\n+SELECT CAST(lp+1 AS TEXT), lp::int+1 FROM generate_series(0,8,1) t(lp)\n+),\n+x(s, ind) AS (\n+SELECT sud, instr(sud, '.') FROM input\n+UNION ALL\n+SELECT\n+substr(s, 1, ind::int-1) || z || substr(s, ind::int+1),\n+instr(substr(s, 1, ind::int-1) || z || substr(s, ind::int+1), '.' )\n+FROM x, digits AS z\n+WHERE ind::int>0\n+AND NOT EXISTS (\n+SELECT 1\n+FROM digits AS lp\n+WHERE z.z = substr(s, ((ind::int-1)/9)*9 + lp, 1)\n+OR z.z = substr(s, ((ind::int-1)%9) + (lp-1)*9 + 1, 1)\n+OR z.z = substr(s, (((ind::int-1)/3) % 3) * 3\n++ ((ind::int-1)/27) * 27 + lp\n++ ((lp-1) / 3) * 6, 1)\n+)\n+)\n+SELECT s FROM x WHERE ind::int=0;\n+----\n+534678912672195348198342567859761423426853791713924856961537284287419635345286179\n",
  "problem_statement": "reports struct_extract error when run  a sql\n#### What happens?\r\nreports struct_extract error when run  a sql in duckdb v0.3.2dev, that sql can run in v0.3.0 and v0.3.1 correctly\r\n\r\nseems related with https://github.com/duckdb/duckdb/issues/2554\r\n\r\n#### To Reproduce\r\n\r\n```sql\r\nWITH RECURSIVE\r\ninput(sud) AS (\r\nVALUES('53..7....6..195....98....6.8...6...34..8.3..17...2...6.6....28....419..5....8..79')\r\n),\r\ndigits(z, lp) AS (\r\nSELECT CAST(lp+1 AS TEXT), lp::int+1 FROM range(0,9) t(lp)\r\n),\r\nx(s, ind) AS (\r\nSELECT sud, instr(sud, '.') FROM input\r\nUNION ALL\r\nSELECT\r\nsubstr(s, 1, ind::int-1) || z || substr(s, ind::int+1),\r\ninstr( substr(s, 1, ind::int-1) || z || substr(s, ind::int+1), '.' )\r\nFROM x, digits AS z\r\nWHERE ind::int>0\r\nAND NOT EXISTS (\r\nSELECT 1\r\nFROM digits AS lp\r\nWHERE z.z = substr(s, ((ind::int-1)/9)*9 + lp, 1)\r\nOR z.z = substr(s, ((ind::int-1)%9) + (lp-1)*9 + 1, 1)\r\nOR z.z = substr(s, (((ind::int-1)/3) % 3) * 3\r\n+ ((ind::int-1)/27) * 27 + lp\r\n+ ((lp-1) / 3) * 6, 1)\r\n)\r\n)\r\nSELECT s FROM x WHERE ind::int=0;\r\n\r\n\r\n---run in v0.3.0 46a0fc50a /v0.3.1 88aa81c6b\r\n\r\n\u2502 5346789126721953481983425678597614234268537917139248569615372842874196353452861... \u2502\r\n\r\n---run in v0.3.2-dev173 a73d33c14 /v0.3.2-dev330 ae8562793\r\nError: Binder Error: No function matches the given name and argument types 'struct_extract(VARCHAR, VARCHAR)'. You might need to add explicit type cas\r\nts.\r\n        Candidate functions:\r\n        struct_extract(STRUCT, VARCHAR) -> ANY\r\n\r\n```\r\n\r\n#### Environment (please complete the following information):\r\n - OS: [e.g. iOS]windows7 x64\r\n - DuckDB Version: [e.g. 22]0.3.2dev\r\n - DuckDB Client: [e.g. Python]CLI\r\n\r\n#### Before Submitting\r\n\r\n- [x] **Have you tried this on the latest `master` branch?**\r\n* **Python**: `pip install duckdb --upgrade --pre`\r\n* **R**: `install.packages(\"https://github.com/duckdb/duckdb/releases/download/master-builds/duckdb_r_src.tar.gz\", repos = NULL)`\r\n* **Other Platforms**: You can find binaries [here](https://github.com/duckdb/duckdb/releases/tag/master-builds) or compile from source.\r\n\r\n- [x] **Have you tried the steps to reproduce? Do they include all relevant data and configuration? Does the issue you report still appear there?**\r\n\nreports struct_extract error when run  a sql\n#### What happens?\r\nreports struct_extract error when run  a sql in duckdb v0.3.2dev, that sql can run in v0.3.0 and v0.3.1 correctly\r\n\r\nseems related with https://github.com/duckdb/duckdb/issues/2554\r\n\r\n#### To Reproduce\r\n\r\n```sql\r\nWITH RECURSIVE\r\ninput(sud) AS (\r\nVALUES('53..7....6..195....98....6.8...6...34..8.3..17...2...6.6....28....419..5....8..79')\r\n),\r\ndigits(z, lp) AS (\r\nSELECT CAST(lp+1 AS TEXT), lp::int+1 FROM range(0,9) t(lp)\r\n),\r\nx(s, ind) AS (\r\nSELECT sud, instr(sud, '.') FROM input\r\nUNION ALL\r\nSELECT\r\nsubstr(s, 1, ind::int-1) || z || substr(s, ind::int+1),\r\ninstr( substr(s, 1, ind::int-1) || z || substr(s, ind::int+1), '.' )\r\nFROM x, digits AS z\r\nWHERE ind::int>0\r\nAND NOT EXISTS (\r\nSELECT 1\r\nFROM digits AS lp\r\nWHERE z.z = substr(s, ((ind::int-1)/9)*9 + lp, 1)\r\nOR z.z = substr(s, ((ind::int-1)%9) + (lp-1)*9 + 1, 1)\r\nOR z.z = substr(s, (((ind::int-1)/3) % 3) * 3\r\n+ ((ind::int-1)/27) * 27 + lp\r\n+ ((lp-1) / 3) * 6, 1)\r\n)\r\n)\r\nSELECT s FROM x WHERE ind::int=0;\r\n\r\n\r\n---run in v0.3.0 46a0fc50a /v0.3.1 88aa81c6b\r\n\r\n\u2502 5346789126721953481983425678597614234268537917139248569615372842874196353452861... \u2502\r\n\r\n---run in v0.3.2-dev173 a73d33c14 /v0.3.2-dev330 ae8562793\r\nError: Binder Error: No function matches the given name and argument types 'struct_extract(VARCHAR, VARCHAR)'. You might need to add explicit type cas\r\nts.\r\n        Candidate functions:\r\n        struct_extract(STRUCT, VARCHAR) -> ANY\r\n\r\n```\r\n\r\n#### Environment (please complete the following information):\r\n - OS: [e.g. iOS]windows7 x64\r\n - DuckDB Version: [e.g. 22]0.3.2dev\r\n - DuckDB Client: [e.g. Python]CLI\r\n\r\n#### Before Submitting\r\n\r\n- [x] **Have you tried this on the latest `master` branch?**\r\n* **Python**: `pip install duckdb --upgrade --pre`\r\n* **R**: `install.packages(\"https://github.com/duckdb/duckdb/releases/download/master-builds/duckdb_r_src.tar.gz\", repos = NULL)`\r\n* **Other Platforms**: You can find binaries [here](https://github.com/duckdb/duckdb/releases/tag/master-builds) or compile from source.\r\n\r\n- [x] **Have you tried the steps to reproduce? Do they include all relevant data and configuration? Does the issue you report still appear there?**\r\n\n",
  "hints_text": "\n",
  "created_at": "2021-12-02T09:03:07Z"
}