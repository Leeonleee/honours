diff --git a/src/main/capi/prepared-c.cpp b/src/main/capi/prepared-c.cpp
index 0b8ba116a808..a065f41a5350 100644
--- a/src/main/capi/prepared-c.cpp
+++ b/src/main/capi/prepared-c.cpp
@@ -139,8 +139,14 @@ duckdb_logical_type duckdb_param_logical_type(duckdb_prepared_statement prepared
 	if (!wrapper || !wrapper->statement || wrapper->statement->HasError()) {
 		return nullptr;
 	}
+
+	auto identifier = duckdb_parameter_name_internal(prepared_statement, param_idx);
+	if (identifier == duckdb::string()) {
+		return nullptr;
+	}
+
 	LogicalType param_type;
-	auto identifier = std::to_string(param_idx);
+
 	if (wrapper->statement->data->TryGetType(identifier, param_type)) {
 		return reinterpret_cast<duckdb_logical_type>(new LogicalType(param_type));
 	}
