{
  "repo": "duckdb/duckdb",
  "pull_number": 5939,
  "instance_id": "duckdb__duckdb-5939",
  "issue_numbers": [
    "5936",
    "5936"
  ],
  "base_commit": "e2dfc274b0a015eaad59de45ba30a834b99cfb42",
  "patch": "diff --git a/src/parser/transform/statement/transform_pragma.cpp b/src/parser/transform/statement/transform_pragma.cpp\nindex 1fcd432d7e82..de8f2dc0ab98 100644\n--- a/src/parser/transform/statement/transform_pragma.cpp\n+++ b/src/parser/transform/statement/transform_pragma.cpp\n@@ -36,6 +36,13 @@ unique_ptr<SQLStatement> Transformer::TransformPragma(duckdb_libpgquery::PGNode\n \t\t\t} else if (node->type == duckdb_libpgquery::T_PGAConst) {\n \t\t\t\tauto constant = TransformConstant((duckdb_libpgquery::PGAConst *)node);\n \t\t\t\tinfo.parameters.push_back(((ConstantExpression &)*constant).value);\n+\t\t\t} else if (expr->type == ExpressionType::COLUMN_REF) {\n+\t\t\t\tauto &colref = (ColumnRefExpression &)*expr;\n+\t\t\t\tif (!colref.IsQualified()) {\n+\t\t\t\t\tinfo.parameters.emplace_back(colref.GetColumnName());\n+\t\t\t\t} else {\n+\t\t\t\t\tinfo.parameters.emplace_back(expr->ToString());\n+\t\t\t\t}\n \t\t\t} else {\n \t\t\t\tinfo.parameters.emplace_back(expr->ToString());\n \t\t\t}\n",
  "test_patch": "diff --git a/test/sql/fts/test_issue_5936.test b/test/sql/fts/test_issue_5936.test\nnew file mode 100644\nindex 000000000000..8a9277d4afdd\n--- /dev/null\n+++ b/test/sql/fts/test_issue_5936.test\n@@ -0,0 +1,16 @@\n+# name: test/sql/fts/test_issue_5936.test\n+# description: Issue #5936 - Confusing \"column does not exist\" error when using column named \"document\" with full text search\n+# group: [fts]\n+\n+require skip_reload\n+\n+require fts\n+\n+statement ok\n+CREATE TABLE documents(document VARCHAR, url VARCHAR);\n+\n+statement ok\n+INSERT INTO documents VALUES ('hello world', 'https://example.com'), ('foobar', 'https://google.com');\n+\n+statement ok\n+PRAGMA create_fts_index(documents, url, document);\n",
  "problem_statement": "Confusing \"column does not exist\" error when using column named \"document\" with full text search\n### What happens?\n\n```python\r\nimport pandas as pd\r\nimport duckdb\r\n\r\ndf = pd.DataFrame(\r\n        {\r\n            \"document\": [\"hello world\", \"foobar\"],\r\n            \"url\": [\"https://example.com\", \"https://google.com\"],\r\n        }\r\n    )\r\n\r\ndb = duckdb.connect(database=\"/tmp/db3.duckdb\")\r\ndb.execute(\"CREATE TABLE documents AS (SELECT document AS document, url AS url FROM df);\")\r\ndb.execute(\"PRAGMA create_fts_index(documents, url, document);\")\r\n```\r\n\r\nthrows `CatalogException: Catalog Error: Table 'main.documents' does not have a column named '\"document\"'!`\r\n\r\nChanging the name of the column to `doc` resolves the issue.\n\n### To Reproduce\n\nSee above\n\n### OS:\n\nLinux x64\n\n### DuckDB Version:\n\nduckdb==0.6.1\n\n### DuckDB Client:\n\nPython\n\n### Full Name:\n\nConnor Clark\n\n### Affiliation:\n\nShopify\n\n### Have you tried this on the latest `master` branch?\n\n- [X] I agree\n\n### Have you tried the steps to reproduce? Do they include all relevant data and configuration? Does the issue you report still appear there?\n\n- [X] I agree\nConfusing \"column does not exist\" error when using column named \"document\" with full text search\n### What happens?\n\n```python\r\nimport pandas as pd\r\nimport duckdb\r\n\r\ndf = pd.DataFrame(\r\n        {\r\n            \"document\": [\"hello world\", \"foobar\"],\r\n            \"url\": [\"https://example.com\", \"https://google.com\"],\r\n        }\r\n    )\r\n\r\ndb = duckdb.connect(database=\"/tmp/db3.duckdb\")\r\ndb.execute(\"CREATE TABLE documents AS (SELECT document AS document, url AS url FROM df);\")\r\ndb.execute(\"PRAGMA create_fts_index(documents, url, document);\")\r\n```\r\n\r\nthrows `CatalogException: Catalog Error: Table 'main.documents' does not have a column named '\"document\"'!`\r\n\r\nChanging the name of the column to `doc` resolves the issue.\n\n### To Reproduce\n\nSee above\n\n### OS:\n\nLinux x64\n\n### DuckDB Version:\n\nduckdb==0.6.1\n\n### DuckDB Client:\n\nPython\n\n### Full Name:\n\nConnor Clark\n\n### Affiliation:\n\nShopify\n\n### Have you tried this on the latest `master` branch?\n\n- [X] I agree\n\n### Have you tried the steps to reproduce? Do they include all relevant data and configuration? Does the issue you report still appear there?\n\n- [X] I agree\n",
  "hints_text": "\n",
  "created_at": "2023-01-18T19:09:34Z"
}