diff --git a/test/sql/aggregate/aggregates/test_bigint_avg.test b/test/sql/aggregate/aggregates/test_bigint_avg.test
new file mode 100644
index 000000000000..5768f5daa609
--- /dev/null
+++ b/test/sql/aggregate/aggregates/test_bigint_avg.test
@@ -0,0 +1,17 @@
+# name: test/sql/aggregate/aggregates/test_bigint_avg.test
+# description: Test AVG on integers with no exact float64 representation
+# group: [aggregates]
+
+statement ok
+CREATE TABLE bigints(n HUGEINT);
+
+statement ok
+INSERT INTO bigints (n) VALUES ('9007199254740992'::HUGEINT), (1::HUGEINT), (0::HUGEINT);
+
+# this would give the wrong result with 'double' precision
+require longdouble
+
+query R
+SELECT AVG(n)::DOUBLE - '3002399751580331'::DOUBLE FROM bigints;
+----
+0
diff --git a/test/sql/aggregate/aggregates/test_kahan_avg.test b/test/sql/aggregate/aggregates/test_kahan_avg.test
new file mode 100644
index 000000000000..700d3ca21cb3
--- /dev/null
+++ b/test/sql/aggregate/aggregates/test_kahan_avg.test
@@ -0,0 +1,15 @@
+# name: test/sql/aggregate/aggregates/test_kahan_avg.test
+# description: Test averages in which the intermediate sums are not exact
+# group: [aggregates]
+
+statement ok
+CREATE TABLE doubles(n DOUBLE);
+
+statement ok
+INSERT INTO doubles (n) VALUES ('9007199254740992'::DOUBLE), (1::DOUBLE), (1::DOUBLE), (0::DOUBLE);
+
+# this would give the wrong result with a simple sum-and-divide
+query R
+SELECT AVG(n) - '2251799813685248.5'::DOUBLE FROM doubles;
+----
+0
diff --git a/test/sql/aggregate/aggregates/test_kahan_sum.test b/test/sql/aggregate/aggregates/test_kahan_sum.test
new file mode 100644
index 000000000000..911b0710cb0f
--- /dev/null
+++ b/test/sql/aggregate/aggregates/test_kahan_sum.test
@@ -0,0 +1,15 @@
+# name: test/sql/aggregate/aggregates/test_kahan_sum.test
+# description: Test sums in which temporary results are not exact
+# group: [aggregates]
+
+statement ok
+CREATE TABLE doubles(n DOUBLE);
+
+statement ok
+INSERT INTO doubles (n) VALUES ('9007199254740992'::DOUBLE), (1::DOUBLE), (1::DOUBLE), (0::DOUBLE);
+
+# this would give the wrong result with a simple sum
+query I
+SELECT SUM(n)::BIGINT FROM doubles;
+----
+9007199254740994
diff --git a/test/sqlite/test_sqllogictest.cpp b/test/sqlite/test_sqllogictest.cpp
index a50427abc0cb..1dab26bb4828 100644
--- a/test/sqlite/test_sqllogictest.cpp
+++ b/test/sqlite/test_sqllogictest.cpp
@@ -51,6 +51,7 @@
 #include <vector>
 #include <iostream>
 #include <thread>
+#include <cfloat>
 
 using namespace duckdb;
 using namespace std;
@@ -1553,6 +1554,10 @@ void SQLLogicTestRunner::ExecuteFile(string script) {
 			} else if (param == "windows") {
 #ifndef _WIN32
 				return;
+#endif
+			} else if (param == "longdouble") {
+#if LDBL_MANT_DIG < 54
+				return;
 #endif
 			} else if (param == "noforcestorage") {
 				if (TestForceStorage()) {
