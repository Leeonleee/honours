{
  "repo": "duckdb/duckdb",
  "pull_number": 8729,
  "instance_id": "duckdb__duckdb-8729",
  "issue_numbers": [
    "8539"
  ],
  "base_commit": "6451c6c0155ed09c4adaacad1f49c7f9ee453319",
  "patch": "diff --git a/data/csv/who.csv.gz b/data/csv/who.csv.gz\nnew file mode 100644\nindex 000000000000..1b39ee889476\nBinary files /dev/null and b/data/csv/who.csv.gz differ\ndiff --git a/src/function/pragma/pragma_queries.cpp b/src/function/pragma/pragma_queries.cpp\nindex eb3a78a9dd6a..8663fe880cd1 100644\n--- a/src/function/pragma/pragma_queries.cpp\n+++ b/src/function/pragma/pragma_queries.cpp\n@@ -123,7 +123,8 @@ string PragmaShow(ClientContext &context, const FunctionParameters &parameters)\n \tLEFT JOIN duckdb_columns cols \n \tON cols.column_name = pragma_table_info.name \n \tAND cols.table_name='%table_name%'\n-\tAND cols.schema_name='%table_schema%';)\";\n+\tAND cols.schema_name='%table_schema%'\n+\tORDER BY column_index;)\";\n \t// clang-format on\n \n \tsql = StringUtil::Replace(sql, \"%func_param_table%\", parameters.values[0].ToString());\n",
  "test_patch": "diff --git a/test/sql/copy/csv/auto/test_describe_order.test b/test/sql/copy/csv/auto/test_describe_order.test\nnew file mode 100644\nindex 000000000000..a86899c58557\n--- /dev/null\n+++ b/test/sql/copy/csv/auto/test_describe_order.test\n@@ -0,0 +1,137 @@\n+# name: test/sql/copy/csv/auto/test_describe_order.test\n+# group: [auto]\n+\n+statement ok\n+PRAGMA enable_verification\n+\n+statement ok\n+create view v as select * from read_csv_auto('data/csv/who.csv.gz');\n+\n+query IIIIII\n+describe v;\n+----\n+country\tVARCHAR\tYES\tNULL\tNULL\tNULL\n+iso2\tVARCHAR\tYES\tNULL\tNULL\tNULL\n+iso3\tVARCHAR\tYES\tNULL\tNULL\tNULL\n+year\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sp_m014\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sp_m1524\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sp_m2534\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sp_m3544\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sp_m4554\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sp_m5564\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sp_m65\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sp_f014\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sp_f1524\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sp_f2534\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sp_f3544\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sp_f4554\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sp_f5564\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sp_f65\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sn_m014\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sn_m1524\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sn_m2534\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sn_m3544\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sn_m4554\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sn_m5564\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sn_m65\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sn_f014\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sn_f1524\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sn_f2534\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sn_f3544\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sn_f4554\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sn_f5564\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sn_f65\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_ep_m014\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_ep_m1524\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_ep_m2534\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_ep_m3544\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_ep_m4554\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_ep_m5564\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_ep_m65\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_ep_f014\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_ep_f1524\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_ep_f2534\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_ep_f3544\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_ep_f4554\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_ep_f5564\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_ep_f65\tBIGINT\tYES\tNULL\tNULL\tNULL\n+newrel_m014\tBIGINT\tYES\tNULL\tNULL\tNULL\n+newrel_m1524\tBIGINT\tYES\tNULL\tNULL\tNULL\n+newrel_m2534\tBIGINT\tYES\tNULL\tNULL\tNULL\n+newrel_m3544\tBIGINT\tYES\tNULL\tNULL\tNULL\n+newrel_m4554\tBIGINT\tYES\tNULL\tNULL\tNULL\n+newrel_m5564\tBIGINT\tYES\tNULL\tNULL\tNULL\n+newrel_m65\tBIGINT\tYES\tNULL\tNULL\tNULL\n+newrel_f014\tBIGINT\tYES\tNULL\tNULL\tNULL\n+newrel_f1524\tBIGINT\tYES\tNULL\tNULL\tNULL\n+newrel_f2534\tBIGINT\tYES\tNULL\tNULL\tNULL\n+newrel_f3544\tBIGINT\tYES\tNULL\tNULL\tNULL\n+newrel_f4554\tBIGINT\tYES\tNULL\tNULL\tNULL\n+newrel_f5564\tBIGINT\tYES\tNULL\tNULL\tNULL\n+newrel_f65\tBIGINT\tYES\tNULL\tNULL\tNULL\n+\n+query IIIIII\n+describe select * from v;\n+----\n+country\tVARCHAR\tYES\tNULL\tNULL\tNULL\n+iso2\tVARCHAR\tYES\tNULL\tNULL\tNULL\n+iso3\tVARCHAR\tYES\tNULL\tNULL\tNULL\n+year\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sp_m014\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sp_m1524\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sp_m2534\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sp_m3544\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sp_m4554\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sp_m5564\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sp_m65\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sp_f014\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sp_f1524\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sp_f2534\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sp_f3544\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sp_f4554\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sp_f5564\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sp_f65\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sn_m014\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sn_m1524\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sn_m2534\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sn_m3544\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sn_m4554\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sn_m5564\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sn_m65\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sn_f014\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sn_f1524\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sn_f2534\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sn_f3544\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sn_f4554\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sn_f5564\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_sn_f65\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_ep_m014\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_ep_m1524\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_ep_m2534\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_ep_m3544\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_ep_m4554\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_ep_m5564\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_ep_m65\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_ep_f014\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_ep_f1524\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_ep_f2534\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_ep_f3544\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_ep_f4554\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_ep_f5564\tBIGINT\tYES\tNULL\tNULL\tNULL\n+new_ep_f65\tBIGINT\tYES\tNULL\tNULL\tNULL\n+newrel_m014\tBIGINT\tYES\tNULL\tNULL\tNULL\n+newrel_m1524\tBIGINT\tYES\tNULL\tNULL\tNULL\n+newrel_m2534\tBIGINT\tYES\tNULL\tNULL\tNULL\n+newrel_m3544\tBIGINT\tYES\tNULL\tNULL\tNULL\n+newrel_m4554\tBIGINT\tYES\tNULL\tNULL\tNULL\n+newrel_m5564\tBIGINT\tYES\tNULL\tNULL\tNULL\n+newrel_m65\tBIGINT\tYES\tNULL\tNULL\tNULL\n+newrel_f014\tBIGINT\tYES\tNULL\tNULL\tNULL\n+newrel_f1524\tBIGINT\tYES\tNULL\tNULL\tNULL\n+newrel_f2534\tBIGINT\tYES\tNULL\tNULL\tNULL\n+newrel_f3544\tBIGINT\tYES\tNULL\tNULL\tNULL\n+newrel_f4554\tBIGINT\tYES\tNULL\tNULL\tNULL\n+newrel_f5564\tBIGINT\tYES\tNULL\tNULL\tNULL\n+newrel_f65\tBIGINT\tYES\tNULL\tNULL\tNULL\n+\n",
  "problem_statement": "`DESCRIBE t` and `DESCRIBE SELECT * FROM t` give different column orders on a view from a CSV file\n### What happens?\n\nColumn names are returned in a different order for the same view, depending on whether the thing described is just the view name, or a `SELECT * FROM the_view`.\n\n### To Reproduce\n\n```bash\r\n$ duckdb -csv <<< \"create view v as select * from read_csv_auto('who.csv.gz'); describe v;\" | column -ts, > name.csv\r\n$ duckdb -csv <<< \"create view v as select * from read_csv_auto('who.csv.gz'); describe select * from v;\" | column -ts, > select.csv\r\n$ diff --unified --color name.csv select.csv\r\n```\r\n\r\nshows\r\n\r\n```patch\r\n\u276f diff --unified --color name.csv select.csv\r\n--- name.csv    2023-08-10 14:00:18.890417267 -0400\r\n+++ select.csv  2023-08-10 14:00:30.372672270 -0400\r\n@@ -54,8 +54,8 @@\r\n newrel_m65    BIGINT       YES\r\n newrel_f014   BIGINT       YES\r\n newrel_f1524  BIGINT       YES\r\n+newrel_f2534  BIGINT       YES\r\n newrel_f3544  BIGINT       YES\r\n newrel_f4554  BIGINT       YES\r\n newrel_f5564  BIGINT       YES\r\n newrel_f65    BIGINT       YES\r\n-newrel_f2534  BIGINT       YES\r\n```\r\n\r\nAccording to the header in the file `newrel_f65` should be last:\r\n\r\n```bash\r\n$ head -1 <(gzip -dc who.csv.gz) | tr ',' '\\n' | tail -1\r\nnewrel_f65\r\n```\n\n### OS:\n\nLinux x86-64 NixOS\n\n### DuckDB Version:\n\n0.8.1 and `master`\n\n### DuckDB Client:\n\nCLI\n\n### Full Name:\n\nPhillip Cloud\n\n### Affiliation:\n\nVoltron Data\n\n### Have you tried this on the latest `master` branch?\n\nI have tested with a master build\n\n### Have you tried the steps to reproduce? Do they include all relevant data and configuration? Does the issue you report still appear there?\n\n- [X] Yes, I have\n",
  "hints_text": "Here's the file in question: [who.csv.gz](https://github.com/duckdb/duckdb/files/12316018/who.csv.gz)\r\n",
  "created_at": "2023-08-30T12:14:04Z"
}