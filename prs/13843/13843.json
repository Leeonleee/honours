{
  "repo": "duckdb/duckdb",
  "pull_number": 13843,
  "instance_id": "duckdb__duckdb-13843",
  "issue_numbers": [
    "13856"
  ],
  "base_commit": "d9e89b5cc192ea052f038d8e7b26d253ec81bc49",
  "patch": "diff --git a/src/execution/operator/csv_scanner/state_machine/csv_state_machine_cache.cpp b/src/execution/operator/csv_scanner/state_machine/csv_state_machine_cache.cpp\nindex fc9d7f476bbe..6c93cc939f3c 100644\n--- a/src/execution/operator/csv_scanner/state_machine/csv_state_machine_cache.cpp\n+++ b/src/execution/operator/csv_scanner/state_machine/csv_state_machine_cache.cpp\n@@ -22,7 +22,7 @@ void CSVStateMachineCache::Insert(const CSVStateMachineOptions &state_machine_op\n \tauto &transition_array = state_machine_cache[state_machine_options];\n \n \tfor (uint32_t i = 0; i < StateMachine::NUM_STATES; i++) {\n-\t\tCSVState cur_state = CSVState(i);\n+\t\tCSVState cur_state = static_cast<CSVState>(i);\n \t\tswitch (cur_state) {\n \t\tcase CSVState::QUOTED:\n \t\tcase CSVState::QUOTED_NEW_LINE:\n@@ -234,11 +234,11 @@ CSVStateMachineCache::CSVStateMachineCache() {\n \tauto default_delimiter = DialectCandidates::GetDefaultDelimiter();\n \tauto default_comment = DialectCandidates::GetDefaultComment();\n \n-\tfor (auto quoterule : default_quote_rule) {\n-\t\tconst auto &quote_candidates = default_quote[static_cast<uint8_t>(quoterule)];\n+\tfor (auto quote_rule : default_quote_rule) {\n+\t\tconst auto &quote_candidates = default_quote[static_cast<uint8_t>(quote_rule)];\n \t\tfor (const auto &quote : quote_candidates) {\n \t\t\tfor (const auto &delimiter : default_delimiter) {\n-\t\t\t\tconst auto &escape_candidates = default_escape[static_cast<uint8_t>(quoterule)];\n+\t\t\t\tconst auto &escape_candidates = default_escape[static_cast<uint8_t>(quote_rule)];\n \t\t\t\tfor (const auto &escape : escape_candidates) {\n \t\t\t\t\tfor (const auto &comment : default_comment) {\n \t\t\t\t\t\tInsert({delimiter, quote, escape, comment, NewLineIdentifier::SINGLE_N});\ndiff --git a/src/function/table/sniff_csv.cpp b/src/function/table/sniff_csv.cpp\nindex 11e5cca83a20..2a1d1b98437b 100644\n--- a/src/function/table/sniff_csv.cpp\n+++ b/src/function/table/sniff_csv.cpp\n@@ -96,6 +96,9 @@ string FormatOptions(char opt) {\n \tif (opt == '\\'') {\n \t\treturn \"''\";\n \t}\n+\tif (opt == '\\0') {\n+\t\treturn \"\";\n+\t}\n \tstring result;\n \tresult += opt;\n \treturn result;\n@@ -214,7 +217,7 @@ static void CSVSniffFunction(ClientContext &context, TableFunctionInput &data_p,\n \t\t         << \"'\" << separator;\n \t}\n \t// 11.2. Quote\n-\tif (!sniffer_options.dialect_options.header.IsSetByUser()) {\n+\tif (!sniffer_options.dialect_options.state_machine_options.quote.IsSetByUser()) {\n \t\tcsv_read << \"quote=\"\n \t\t         << \"'\" << FormatOptions(sniffer_options.dialect_options.state_machine_options.quote.GetValue()) << \"'\"\n \t\t         << separator;\n",
  "test_patch": "diff --git a/test/sql/copy/csv/test_csv_remote.test b/test/sql/copy/csv/test_csv_remote.test\nindex a9e78796441b..162e61c43a70 100644\n--- a/test/sql/copy/csv/test_csv_remote.test\n+++ b/test/sql/copy/csv/test_csv_remote.test\n@@ -33,4 +33,4 @@ PRAGMA enable_verification\n query IIIIIIIIIIII\n FROM sniff_csv('https://github.com/duckdb/duckdb/raw/main/data/csv/customer.csv?v=1')\n ----\n-,\t\"\t\"\t\\n\t\\0\t0\tfalse\t[{'name': column00, 'type': BIGINT}, {'name': column01, 'type': VARCHAR}, {'name': column02, 'type': BIGINT}, {'name': column03, 'type': BIGINT}, {'name': column04, 'type': BIGINT}, {'name': column05, 'type': BIGINT}, {'name': column06, 'type': BIGINT}, {'name': column07, 'type': VARCHAR}, {'name': column08, 'type': VARCHAR}, {'name': column09, 'type': VARCHAR}, {'name': column10, 'type': VARCHAR}, {'name': column11, 'type': BIGINT}, {'name': column12, 'type': BIGINT}, {'name': column13, 'type': BIGINT}, {'name': column14, 'type': VARCHAR}, {'name': column15, 'type': VARCHAR}, {'name': column16, 'type': VARCHAR}, {'name': column17, 'type': BIGINT}]\tNULL\tNULL\tNULL\tFROM read_csv('https://github.com/duckdb/duckdb/raw/main/data/csv/customer.csv?v=1', auto_detect=false, delim=',', quote='\"', escape='\"', new_line='\\n', skip=0, comment='\\0', header=false, columns={'column00': 'BIGINT', 'column01': 'VARCHAR', 'column02': 'BIGINT', 'column03': 'BIGINT', 'column04': 'BIGINT', 'column05': 'BIGINT', 'column06': 'BIGINT', 'column07': 'VARCHAR', 'column08': 'VARCHAR', 'column09': 'VARCHAR', 'column10': 'VARCHAR', 'column11': 'BIGINT', 'column12': 'BIGINT', 'column13': 'BIGINT', 'column14': 'VARCHAR', 'column15': 'VARCHAR', 'column16': 'VARCHAR', 'column17': 'BIGINT'});\n+,\t\"\t\"\t\\n\t\\0\t0\t0\t[{'name': column00, 'type': BIGINT}, {'name': column01, 'type': VARCHAR}, {'name': column02, 'type': BIGINT}, {'name': column03, 'type': BIGINT}, {'name': column04, 'type': BIGINT}, {'name': column05, 'type': BIGINT}, {'name': column06, 'type': BIGINT}, {'name': column07, 'type': VARCHAR}, {'name': column08, 'type': VARCHAR}, {'name': column09, 'type': VARCHAR}, {'name': column10, 'type': VARCHAR}, {'name': column11, 'type': BIGINT}, {'name': column12, 'type': BIGINT}, {'name': column13, 'type': BIGINT}, {'name': column14, 'type': VARCHAR}, {'name': column15, 'type': VARCHAR}, {'name': column16, 'type': VARCHAR}, {'name': column17, 'type': BIGINT}]\tNULL\tNULL\tNULL\tFROM read_csv('https://github.com/duckdb/duckdb/raw/main/data/csv/customer.csv?v=1', auto_detect=false, delim=',', quote='\"', escape='\"', new_line='\\n', skip=0, comment='', header=false, columns={'column00': 'BIGINT', 'column01': 'VARCHAR', 'column02': 'BIGINT', 'column03': 'BIGINT', 'column04': 'BIGINT', 'column05': 'BIGINT', 'column06': 'BIGINT', 'column07': 'VARCHAR', 'column08': 'VARCHAR', 'column09': 'VARCHAR', 'column10': 'VARCHAR', 'column11': 'BIGINT', 'column12': 'BIGINT', 'column13': 'BIGINT', 'column14': 'VARCHAR', 'column15': 'VARCHAR', 'column16': 'VARCHAR', 'column17': 'BIGINT'});\ndiff --git a/test/sql/copy/csv/test_sniff_csv.test b/test/sql/copy/csv/test_sniff_csv.test\nindex ed65b4f06796..872162e68735 100644\n--- a/test/sql/copy/csv/test_sniff_csv.test\n+++ b/test/sql/copy/csv/test_sniff_csv.test\n@@ -11,17 +11,17 @@ require notwindows\n query I\n SELECT Prompt FROM sniff_csv('data/csv/real/lineitem_sample.csv');\n ----\n-FROM read_csv('data/csv/real/lineitem_sample.csv', auto_detect=false, delim='|', quote='\"', escape='\"', new_line='\\n', skip=0, comment='\\0', header=false, columns={'column00': 'BIGINT', 'column01': 'BIGINT', 'column02': 'BIGINT', 'column03': 'BIGINT', 'column04': 'BIGINT', 'column05': 'DOUBLE', 'column06': 'DOUBLE', 'column07': 'DOUBLE', 'column08': 'VARCHAR', 'column09': 'VARCHAR', 'column10': 'DATE', 'column11': 'DATE', 'column12': 'DATE', 'column13': 'VARCHAR', 'column14': 'VARCHAR', 'column15': 'VARCHAR'}, dateformat='%Y-%m-%d');\n+FROM read_csv('data/csv/real/lineitem_sample.csv', auto_detect=false, delim='|', quote='\"', escape='\"', new_line='\\n', skip=0, comment='', header=false, columns={'column00': 'BIGINT', 'column01': 'BIGINT', 'column02': 'BIGINT', 'column03': 'BIGINT', 'column04': 'BIGINT', 'column05': 'DOUBLE', 'column06': 'DOUBLE', 'column07': 'DOUBLE', 'column08': 'VARCHAR', 'column09': 'VARCHAR', 'column10': 'DATE', 'column11': 'DATE', 'column12': 'DATE', 'column13': 'VARCHAR', 'column14': 'VARCHAR', 'column15': 'VARCHAR'}, dateformat='%Y-%m-%d');\n \n query IIIIIIIIIIIIIIII\n-FROM read_csv('data/csv/real/lineitem_sample.csv', auto_detect=false, delim='|', quote='\"', escape='\"', new_line='\\n', skip=0, header=false, columns={'column00': 'BIGINT', 'column01': 'BIGINT', 'column02': 'BIGINT', 'column03': 'BIGINT', 'column04': 'BIGINT', 'column05': 'DOUBLE', 'column06': 'DOUBLE', 'column07': 'DOUBLE', 'column08': 'VARCHAR', 'column09': 'VARCHAR', 'column10': 'DATE', 'column11': 'DATE', 'column12': 'DATE', 'column13': 'VARCHAR', 'column14': 'VARCHAR', 'column15': 'VARCHAR'}, dateformat='%Y-%m-%d') limit 1;\n+FROM read_csv('data/csv/real/lineitem_sample.csv', auto_detect=false, delim='|', quote='\"', escape='\"', new_line='\\n', skip=0, comment='', header=false, columns={'column00': 'BIGINT', 'column01': 'BIGINT', 'column02': 'BIGINT', 'column03': 'BIGINT', 'column04': 'BIGINT', 'column05': 'DOUBLE', 'column06': 'DOUBLE', 'column07': 'DOUBLE', 'column08': 'VARCHAR', 'column09': 'VARCHAR', 'column10': 'DATE', 'column11': 'DATE', 'column12': 'DATE', 'column13': 'VARCHAR', 'column14': 'VARCHAR', 'column15': 'VARCHAR'}, dateformat='%Y-%m-%d')  limit 1;\n ----\n 1\t15519\t785\t1\t17\t24386.67\t0.04\t0.02\tN\tO\t1996-03-13\t1996-02-12\t1996-03-22\tDELIVER IN PERSON\tTRUCK\tegular courts above the\n \n query IIIIIIIIIIII\n FROM sniff_csv('data/csv/real/lineitem_sample.csv');\n ----\n-|\t\"\t\"\t\\n\t\\0\t0\tfalse\t[{'name': column00, 'type': BIGINT}, {'name': column01, 'type': BIGINT}, {'name': column02, 'type': BIGINT}, {'name': column03, 'type': BIGINT}, {'name': column04, 'type': BIGINT}, {'name': column05, 'type': DOUBLE}, {'name': column06, 'type': DOUBLE}, {'name': column07, 'type': DOUBLE}, {'name': column08, 'type': VARCHAR}, {'name': column09, 'type': VARCHAR}, {'name': column10, 'type': DATE}, {'name': column11, 'type': DATE}, {'name': column12, 'type': DATE}, {'name': column13, 'type': VARCHAR}, {'name': column14, 'type': VARCHAR}, {'name': column15, 'type': VARCHAR}]\t%Y-%m-%d\tNULL\tNULL\tFROM read_csv('data/csv/real/lineitem_sample.csv', auto_detect=false, delim='|', quote='\"', escape='\"', new_line='\\n', skip=0, comment='\\0', header=false, columns={'column00': 'BIGINT', 'column01': 'BIGINT', 'column02': 'BIGINT', 'column03': 'BIGINT', 'column04': 'BIGINT', 'column05': 'DOUBLE', 'column06': 'DOUBLE', 'column07': 'DOUBLE', 'column08': 'VARCHAR', 'column09': 'VARCHAR', 'column10': 'DATE', 'column11': 'DATE', 'column12': 'DATE', 'column13': 'VARCHAR', 'column14': 'VARCHAR', 'column15': 'VARCHAR'}, dateformat='%Y-%m-%d');\n+|\t\"\t\"\t\\n\t\\0\t0\t0\t[{'name': column00, 'type': BIGINT}, {'name': column01, 'type': BIGINT}, {'name': column02, 'type': BIGINT}, {'name': column03, 'type': BIGINT}, {'name': column04, 'type': BIGINT}, {'name': column05, 'type': DOUBLE}, {'name': column06, 'type': DOUBLE}, {'name': column07, 'type': DOUBLE}, {'name': column08, 'type': VARCHAR}, {'name': column09, 'type': VARCHAR}, {'name': column10, 'type': DATE}, {'name': column11, 'type': DATE}, {'name': column12, 'type': DATE}, {'name': column13, 'type': VARCHAR}, {'name': column14, 'type': VARCHAR}, {'name': column15, 'type': VARCHAR}]\t%Y-%m-%d\tNULL\tNULL\tFROM read_csv('data/csv/real/lineitem_sample.csv', auto_detect=false, delim='|', quote='\"', escape='\"', new_line='\\n', skip=0, comment='', header=false, columns={'column00': 'BIGINT', 'column01': 'BIGINT', 'column02': 'BIGINT', 'column03': 'BIGINT', 'column04': 'BIGINT', 'column05': 'DOUBLE', 'column06': 'DOUBLE', 'column07': 'DOUBLE', 'column08': 'VARCHAR', 'column09': 'VARCHAR', 'column10': 'DATE', 'column11': 'DATE', 'column12': 'DATE', 'column13': 'VARCHAR', 'column14': 'VARCHAR', 'column15': 'VARCHAR'}, dateformat='%Y-%m-%d');\n \n # Test Invalid Path\n statement error\n@@ -34,7 +34,7 @@ No files found that match the pattern \"data/csv/real/non_ecziste.csv\"\n query IIIIIIIIIIII\n FROM sniff_csv('data/csv/error/mismatch/big_bad.csv', sample_size=1);\n ----\n-,\t\"\t\"\t\\n\t\\0\t0\tfalse\t[{'name': column0, 'type': BIGINT}, {'name': column1, 'type': VARCHAR}]\tNULL\tNULL\tsample_size=1\tFROM read_csv('data/csv/error/mismatch/big_bad.csv', auto_detect=false, delim=',', quote='\"', escape='\"', new_line='\\n', skip=0, comment='\\0', header=false, columns={'column0': 'BIGINT', 'column1': 'VARCHAR'}, sample_size=1);\n+,\t\"\t\"\t\\n\t\\0\t0\t0\t[{'name': column0, 'type': BIGINT}, {'name': column1, 'type': VARCHAR}]\tNULL\tNULL\tsample_size=1\tFROM read_csv('data/csv/error/mismatch/big_bad.csv', auto_detect=false, delim=',', quote='\"', escape='\"', new_line='\\n', skip=0, comment='', header=false, columns={'column0': 'BIGINT', 'column1': 'VARCHAR'}, sample_size=1);\n \n statement error\n FROM read_csv('data/csv/error/mismatch/big_bad.csv', auto_detect=false, delim=',', quote='\"', escape='\"', new_line='\\n', skip=0, header=0, columns={'column0': 'BIGINT', 'column1': 'VARCHAR'}, sample_size=1);\n@@ -44,18 +44,18 @@ Conversion Error: CSV Error on Line: 2176\n query IIIIIIIIIIII\n FROM sniff_csv('data/csv/error/mismatch/big_bad.csv', sample_size=10000);\n ----\n-,\t\"\t\"\t\\n\t\\0\t0\ttrue\t[{'name': 1, 'type': VARCHAR}, {'name': A, 'type': VARCHAR}]\tNULL\tNULL\tsample_size=10000\tFROM read_csv('data/csv/error/mismatch/big_bad.csv', auto_detect=false, delim=',', quote='\"', escape='\"', new_line='\\n', skip=0, comment='\\0', header=true, columns={'1': 'VARCHAR', 'A': 'VARCHAR'}, sample_size=10000);\n+,\t\"\t\"\t\\n\t\\0\t0\t1\t[{'name': 1, 'type': VARCHAR}, {'name': A, 'type': VARCHAR}]\tNULL\tNULL\tsample_size=10000\tFROM read_csv('data/csv/error/mismatch/big_bad.csv', auto_detect=false, delim=',', quote='\"', escape='\"', new_line='\\n', skip=0, comment='', header=true, columns={'1': 'VARCHAR', 'A': 'VARCHAR'}, sample_size=10000);\n \n query IIIIIIIIIIII\n FROM sniff_csv('data/csv/error/mismatch/big_bad.csv', sample_size=-1);\n ----\n-,\t\"\t\"\t\\n\t\\0\t0\ttrue\t[{'name': 1, 'type': VARCHAR}, {'name': A, 'type': VARCHAR}]\tNULL\tNULL\tsample_size=-1\tFROM read_csv('data/csv/error/mismatch/big_bad.csv', auto_detect=false, delim=',', quote='\"', escape='\"', new_line='\\n', skip=0, comment='\\0', header=true, columns={'1': 'VARCHAR', 'A': 'VARCHAR'}, sample_size=-1);\n+,\t\"\t\"\t\\n\t\\0\t0\t1\t[{'name': 1, 'type': VARCHAR}, {'name': A, 'type': VARCHAR}]\tNULL\tNULL\tsample_size=-1\tFROM read_csv('data/csv/error/mismatch/big_bad.csv', auto_detect=false, delim=',', quote='\"', escape='\"', new_line='\\n', skip=0, comment='', header=true, columns={'1': 'VARCHAR', 'A': 'VARCHAR'}, sample_size=-1);\n \n # Test with defined time and timestamp\n query IIIIIIIIIIII\n FROM sniff_csv('data/csv/test/dateformat.csv')\n ----\n-,\t\"\t\"\t\\n\t\\0\t0\tfalse\t[{'name': column0, 'type': DATE}]\t%d/%m/%Y\tNULL\tNULL\tFROM read_csv('data/csv/test/dateformat.csv', auto_detect=false, delim=',', quote='\"', escape='\"', new_line='\\n', skip=0, comment='\\0', header=false, columns={'column0': 'DATE'}, dateformat='%d/%m/%Y');\n+,\t\"\t\"\t\\n\t\\0\t0\t0\t[{'name': column0, 'type': DATE}]\t%d/%m/%Y\tNULL\tNULL\tFROM read_csv('data/csv/test/dateformat.csv', auto_detect=false, delim=',', quote='\"', escape='\"', new_line='\\n', skip=0, comment='', header=false, columns={'column0': 'DATE'}, dateformat='%d/%m/%Y');\n \n query I\n FROM read_csv('data/csv/test/dateformat.csv', auto_detect=false, delim=',', quote='\"', escape='\"', new_line='\\n', skip=0, header=false, columns={'column0': 'DATE'}, dateformat='%d/%m/%Y');\n@@ -66,7 +66,7 @@ FROM read_csv('data/csv/test/dateformat.csv', auto_detect=false, delim=',', quot\n query IIIIIIIIIIII\n FROM sniff_csv('data/csv/auto/time_date_timestamp_yyyy.mm.dd.csv')\n ----\n-,\t\"\t\"\t\\n\t\\0\t0\ttrue\t[{'name': a, 'type': BIGINT}, {'name': b, 'type': VARCHAR}, {'name': t, 'type': TIME}, {'name': d, 'type': DATE}, {'name': ts, 'type': TIMESTAMP}]\t%Y.%m.%d\t%Y.%m.%d %H:%M:%S\tNULL\tFROM read_csv('data/csv/auto/time_date_timestamp_yyyy.mm.dd.csv', auto_detect=false, delim=',', quote='\"', escape='\"', new_line='\\n', skip=0, comment='\\0', header=true, columns={'a': 'BIGINT', 'b': 'VARCHAR', 't': 'TIME', 'd': 'DATE', 'ts': 'TIMESTAMP'}, dateformat='%Y.%m.%d', timestampformat='%Y.%m.%d %H:%M:%S');\n+,\t\"\t\"\t\\n\t\\0\t0\t1\t[{'name': a, 'type': BIGINT}, {'name': b, 'type': VARCHAR}, {'name': t, 'type': TIME}, {'name': d, 'type': DATE}, {'name': ts, 'type': TIMESTAMP}]\t%Y.%m.%d\t%Y.%m.%d %H:%M:%S\tNULL\tFROM read_csv('data/csv/auto/time_date_timestamp_yyyy.mm.dd.csv', auto_detect=false, delim=',', quote='\"', escape='\"', new_line='\\n', skip=0, comment='', header=true, columns={'a': 'BIGINT', 'b': 'VARCHAR', 't': 'TIME', 'd': 'DATE', 'ts': 'TIMESTAMP'}, dateformat='%Y.%m.%d', timestampformat='%Y.%m.%d %H:%M:%S');\n \n query IIIII\n FROM read_csv('data/csv/auto/time_date_timestamp_yyyy.mm.dd.csv', auto_detect=false, delim=',', quote='\"', escape='\"', new_line='\\n', skip=0, header=true, columns={'a': 'BIGINT', 'b': 'VARCHAR', 't': 'TIME', 'd': 'DATE', 'ts': 'TIMESTAMP'}, dateformat='%Y.%m.%d', timestampformat='%Y.%m.%d %H:%M:%S');\n@@ -79,7 +79,7 @@ FROM read_csv('data/csv/auto/time_date_timestamp_yyyy.mm.dd.csv', auto_detect=fa\n query IIIIIIIIIIII\n FROM sniff_csv('data/csv/inconsistent_cells.csv')\n ----\n-,\t\"\t\"\t\\n\t\\0\t3\tfalse\t[{'name': column0, 'type': BIGINT}, {'name': column1, 'type': BIGINT}, {'name': column2, 'type': BIGINT}, {'name': column3, 'type': BIGINT}, {'name': column4, 'type': BIGINT}]\tNULL\tNULL\tNULL\tFROM read_csv('data/csv/inconsistent_cells.csv', auto_detect=false, delim=',', quote='\"', escape='\"', new_line='\\n', skip=3, comment='\\0', header=false, columns={'column0': 'BIGINT', 'column1': 'BIGINT', 'column2': 'BIGINT', 'column3': 'BIGINT', 'column4': 'BIGINT'});\n+,\t\"\t\"\t\\n\t\\0\t3\t0\t[{'name': column0, 'type': BIGINT}, {'name': column1, 'type': BIGINT}, {'name': column2, 'type': BIGINT}, {'name': column3, 'type': BIGINT}, {'name': column4, 'type': BIGINT}]\tNULL\tNULL\tNULL\tFROM read_csv('data/csv/inconsistent_cells.csv', auto_detect=false, delim=',', quote='\"', escape='\"', new_line='\\n', skip=3, comment='', header=false, columns={'column0': 'BIGINT', 'column1': 'BIGINT', 'column2': 'BIGINT', 'column3': 'BIGINT', 'column4': 'BIGINT'});\n \n query IIIII\n FROM read_csv('data/csv/inconsistent_cells.csv', auto_detect=false, delim=',', quote='\"', escape='\"', new_line='\\n', skip=3, header=false, columns={'column0': 'BIGINT', 'column1': 'BIGINT', 'column2': 'BIGINT', 'column3': 'BIGINT', 'column4': 'BIGINT'});\n@@ -91,7 +91,7 @@ FROM read_csv('data/csv/inconsistent_cells.csv', auto_detect=false, delim=',', q\n query IIIIIIIIIIII\n FROM sniff_csv('data/csv/timings.csv')\n ----\n-|\t\"\t\"\t\\n\t\\0\t0\ttrue\t[{'name': tool, 'type': VARCHAR}, {'name': sf, 'type': BIGINT}, {'name': day, 'type': DATE}, {'name': batch_type, 'type': VARCHAR}, {'name': q, 'type': VARCHAR}, {'name': parameters, 'type': VARCHAR}, {'name': time, 'type': DOUBLE}]\t%Y-%m-%d\tNULL\tNULL\tFROM read_csv('data/csv/timings.csv', auto_detect=false, delim='|', quote='\"', escape='\"', new_line='\\n', skip=0, comment='\\0', header=true, columns={'tool': 'VARCHAR', 'sf': 'BIGINT', 'day': 'DATE', 'batch_type': 'VARCHAR', 'q': 'VARCHAR', 'parameters': 'VARCHAR', 'time': 'DOUBLE'}, dateformat='%Y-%m-%d');\n+|\t\"\t\"\t\\n\t\\0\t0\t1\t[{'name': tool, 'type': VARCHAR}, {'name': sf, 'type': BIGINT}, {'name': day, 'type': DATE}, {'name': batch_type, 'type': VARCHAR}, {'name': q, 'type': VARCHAR}, {'name': parameters, 'type': VARCHAR}, {'name': time, 'type': DOUBLE}]\t%Y-%m-%d\tNULL\tNULL\tFROM read_csv('data/csv/timings.csv', auto_detect=false, delim='|', quote='\"', escape='\"', new_line='\\n', skip=0, comment='', header=true, columns={'tool': 'VARCHAR', 'sf': 'BIGINT', 'day': 'DATE', 'batch_type': 'VARCHAR', 'q': 'VARCHAR', 'parameters': 'VARCHAR', 'time': 'DOUBLE'}, dateformat='%Y-%m-%d');\n \n query IIIIIII\n FROM read_csv('data/csv/timings.csv', auto_detect=false, delim='|', quote='\"', escape='\\', new_line='\\n', skip=0, header=true, columns={'tool': 'VARCHAR', 'sf': 'BIGINT', 'day': 'DATE', 'batch_type': 'VARCHAR', 'q': 'VARCHAR', 'parameters': 'VARCHAR', 'time': 'DOUBLE'}, dateformat='%Y-%m-%d') order by all limit 1;\n@@ -102,7 +102,7 @@ Umbra\t100\t2012-11-29\tpower\t1\t{\"datetime\": \"2010-02-26T03:51:21.000+00:00\"}\t0.054\n query IIIIIIIIIIII\n FROM sniff_csv('data/csv/auto/backslash_escape.csv')\n ----\n-|\t\"\t\\\t\\n\t\\0\t0\tfalse\t[{'name': column0, 'type': BIGINT}, {'name': column1, 'type': VARCHAR}, {'name': column2, 'type': VARCHAR}]\tNULL\tNULL\tNULL\tFROM read_csv('data/csv/auto/backslash_escape.csv', auto_detect=false, delim='|', quote='\"', escape='\\', new_line='\\n', skip=0, comment='\\0', header=false, columns={'column0': 'BIGINT', 'column1': 'VARCHAR', 'column2': 'VARCHAR'});\n+|\t\"\t\\\t\\n\t\\0\t0\t0\t[{'name': column0, 'type': BIGINT}, {'name': column1, 'type': VARCHAR}, {'name': column2, 'type': VARCHAR}]\tNULL\tNULL\tNULL\tFROM read_csv('data/csv/auto/backslash_escape.csv', auto_detect=false, delim='|', quote='\"', escape='\\', new_line='\\n', skip=0, comment='', header=false, columns={'column0': 'BIGINT', 'column1': 'VARCHAR', 'column2': 'VARCHAR'});\n \n query III\n FROM read_csv('data/csv/auto/backslash_escape.csv', auto_detect=false, delim='|', quote='\"', escape='\\', new_line='\\n', skip=0, header=false, columns={'column0': 'BIGINT', 'column1': 'VARCHAR', 'column2': 'VARCHAR'});\ndiff --git a/test/sql/copy/csv/test_sniff_csv_options.test b/test/sql/copy/csv/test_sniff_csv_options.test\nindex da8cdaa66f03..11d65ceb743f 100644\n--- a/test/sql/copy/csv/test_sniff_csv_options.test\n+++ b/test/sql/copy/csv/test_sniff_csv_options.test\n@@ -20,31 +20,31 @@ It was not possible to automatically detect the CSV Parsing dialect\n query IIIIIIIIIIII\n FROM sniff_csv('data/csv/real/lineitem_sample.csv', delim='|');\n ----\n-|\t\"\t\"\t\\n\t\\0\t0\tfalse\t[{'name': column00, 'type': BIGINT}, {'name': column01, 'type': BIGINT}, {'name': column02, 'type': BIGINT}, {'name': column03, 'type': BIGINT}, {'name': column04, 'type': BIGINT}, {'name': column05, 'type': DOUBLE}, {'name': column06, 'type': DOUBLE}, {'name': column07, 'type': DOUBLE}, {'name': column08, 'type': VARCHAR}, {'name': column09, 'type': VARCHAR}, {'name': column10, 'type': DATE}, {'name': column11, 'type': DATE}, {'name': column12, 'type': DATE}, {'name': column13, 'type': VARCHAR}, {'name': column14, 'type': VARCHAR}, {'name': column15, 'type': VARCHAR}]\t%Y-%m-%d\tNULL\tdelim='|'\tFROM read_csv('data/csv/real/lineitem_sample.csv', auto_detect=false, quote='\"', escape='\"', new_line='\\n', skip=0, comment='\\0', header=false, columns={'column00': 'BIGINT', 'column01': 'BIGINT', 'column02': 'BIGINT', 'column03': 'BIGINT', 'column04': 'BIGINT', 'column05': 'DOUBLE', 'column06': 'DOUBLE', 'column07': 'DOUBLE', 'column08': 'VARCHAR', 'column09': 'VARCHAR', 'column10': 'DATE', 'column11': 'DATE', 'column12': 'DATE', 'column13': 'VARCHAR', 'column14': 'VARCHAR', 'column15': 'VARCHAR'}, dateformat='%Y-%m-%d', delim='|');\n+|\t\"\t\"\t\\n\t\\0\t0\t0\t[{'name': column00, 'type': BIGINT}, {'name': column01, 'type': BIGINT}, {'name': column02, 'type': BIGINT}, {'name': column03, 'type': BIGINT}, {'name': column04, 'type': BIGINT}, {'name': column05, 'type': DOUBLE}, {'name': column06, 'type': DOUBLE}, {'name': column07, 'type': DOUBLE}, {'name': column08, 'type': VARCHAR}, {'name': column09, 'type': VARCHAR}, {'name': column10, 'type': DATE}, {'name': column11, 'type': DATE}, {'name': column12, 'type': DATE}, {'name': column13, 'type': VARCHAR}, {'name': column14, 'type': VARCHAR}, {'name': column15, 'type': VARCHAR}]\t%Y-%m-%d\tNULL\tdelim='|'\tFROM read_csv('data/csv/real/lineitem_sample.csv', auto_detect=false, quote='\"', escape='\"', new_line='\\n', skip=0, comment='', header=false, columns={'column00': 'BIGINT', 'column01': 'BIGINT', 'column02': 'BIGINT', 'column03': 'BIGINT', 'column04': 'BIGINT', 'column05': 'DOUBLE', 'column06': 'DOUBLE', 'column07': 'DOUBLE', 'column08': 'VARCHAR', 'column09': 'VARCHAR', 'column10': 'DATE', 'column11': 'DATE', 'column12': 'DATE', 'column13': 'VARCHAR', 'column14': 'VARCHAR', 'column15': 'VARCHAR'}, dateformat='%Y-%m-%d', delim='|');\n \n # quote\n query IIIIIIIIIIII\n FROM sniff_csv('data/csv/real/lineitem_sample.csv', quote='\"');\n ----\n-|\t\"\t\"\t\\n\t\\0\t0\tfalse\t[{'name': column00, 'type': BIGINT}, {'name': column01, 'type': BIGINT}, {'name': column02, 'type': BIGINT}, {'name': column03, 'type': BIGINT}, {'name': column04, 'type': BIGINT}, {'name': column05, 'type': DOUBLE}, {'name': column06, 'type': DOUBLE}, {'name': column07, 'type': DOUBLE}, {'name': column08, 'type': VARCHAR}, {'name': column09, 'type': VARCHAR}, {'name': column10, 'type': DATE}, {'name': column11, 'type': DATE}, {'name': column12, 'type': DATE}, {'name': column13, 'type': VARCHAR}, {'name': column14, 'type': VARCHAR}, {'name': column15, 'type': VARCHAR}]\t%Y-%m-%d\tNULL\tquote='\"'\tFROM read_csv('data/csv/real/lineitem_sample.csv', auto_detect=false, delim='|', quote='\"', escape='\"', new_line='\\n', skip=0, comment='\\0', header=false, columns={'column00': 'BIGINT', 'column01': 'BIGINT', 'column02': 'BIGINT', 'column03': 'BIGINT', 'column04': 'BIGINT', 'column05': 'DOUBLE', 'column06': 'DOUBLE', 'column07': 'DOUBLE', 'column08': 'VARCHAR', 'column09': 'VARCHAR', 'column10': 'DATE', 'column11': 'DATE', 'column12': 'DATE', 'column13': 'VARCHAR', 'column14': 'VARCHAR', 'column15': 'VARCHAR'}, dateformat='%Y-%m-%d', quote='\"');\n+|\t\"\t\"\t\\n\t\\0\t0\t0\t[{'name': column00, 'type': BIGINT}, {'name': column01, 'type': BIGINT}, {'name': column02, 'type': BIGINT}, {'name': column03, 'type': BIGINT}, {'name': column04, 'type': BIGINT}, {'name': column05, 'type': DOUBLE}, {'name': column06, 'type': DOUBLE}, {'name': column07, 'type': DOUBLE}, {'name': column08, 'type': VARCHAR}, {'name': column09, 'type': VARCHAR}, {'name': column10, 'type': DATE}, {'name': column11, 'type': DATE}, {'name': column12, 'type': DATE}, {'name': column13, 'type': VARCHAR}, {'name': column14, 'type': VARCHAR}, {'name': column15, 'type': VARCHAR}]\t%Y-%m-%d\tNULL\tquote='\"'\tFROM read_csv('data/csv/real/lineitem_sample.csv', auto_detect=false, delim='|', escape='\"', new_line='\\n', skip=0, comment='', header=false, columns={'column00': 'BIGINT', 'column01': 'BIGINT', 'column02': 'BIGINT', 'column03': 'BIGINT', 'column04': 'BIGINT', 'column05': 'DOUBLE', 'column06': 'DOUBLE', 'column07': 'DOUBLE', 'column08': 'VARCHAR', 'column09': 'VARCHAR', 'column10': 'DATE', 'column11': 'DATE', 'column12': 'DATE', 'column13': 'VARCHAR', 'column14': 'VARCHAR', 'column15': 'VARCHAR'}, dateformat='%Y-%m-%d', quote='\"');\n \n # escape\n query IIIIIIIIIIII\n FROM sniff_csv('data/csv/real/lineitem_sample.csv', escape='\"');\n ----\n-|\t\"\t\"\t\\n\t\\0\t0\tfalse\t[{'name': column00, 'type': BIGINT}, {'name': column01, 'type': BIGINT}, {'name': column02, 'type': BIGINT}, {'name': column03, 'type': BIGINT}, {'name': column04, 'type': BIGINT}, {'name': column05, 'type': DOUBLE}, {'name': column06, 'type': DOUBLE}, {'name': column07, 'type': DOUBLE}, {'name': column08, 'type': VARCHAR}, {'name': column09, 'type': VARCHAR}, {'name': column10, 'type': DATE}, {'name': column11, 'type': DATE}, {'name': column12, 'type': DATE}, {'name': column13, 'type': VARCHAR}, {'name': column14, 'type': VARCHAR}, {'name': column15, 'type': VARCHAR}]\t%Y-%m-%d\tNULL\tescape='\"'\tFROM read_csv('data/csv/real/lineitem_sample.csv', auto_detect=false, delim='|', quote='\"', new_line='\\n', skip=0, comment='\\0', header=false, columns={'column00': 'BIGINT', 'column01': 'BIGINT', 'column02': 'BIGINT', 'column03': 'BIGINT', 'column04': 'BIGINT', 'column05': 'DOUBLE', 'column06': 'DOUBLE', 'column07': 'DOUBLE', 'column08': 'VARCHAR', 'column09': 'VARCHAR', 'column10': 'DATE', 'column11': 'DATE', 'column12': 'DATE', 'column13': 'VARCHAR', 'column14': 'VARCHAR', 'column15': 'VARCHAR'}, dateformat='%Y-%m-%d', escape='\"');\n+|\t\"\t\"\t\\n\t\\0\t0\t0\t[{'name': column00, 'type': BIGINT}, {'name': column01, 'type': BIGINT}, {'name': column02, 'type': BIGINT}, {'name': column03, 'type': BIGINT}, {'name': column04, 'type': BIGINT}, {'name': column05, 'type': DOUBLE}, {'name': column06, 'type': DOUBLE}, {'name': column07, 'type': DOUBLE}, {'name': column08, 'type': VARCHAR}, {'name': column09, 'type': VARCHAR}, {'name': column10, 'type': DATE}, {'name': column11, 'type': DATE}, {'name': column12, 'type': DATE}, {'name': column13, 'type': VARCHAR}, {'name': column14, 'type': VARCHAR}, {'name': column15, 'type': VARCHAR}]\t%Y-%m-%d\tNULL\tescape='\"'\tFROM read_csv('data/csv/real/lineitem_sample.csv', auto_detect=false, delim='|', quote='\"', new_line='\\n', skip=0, comment='', header=false, columns={'column00': 'BIGINT', 'column01': 'BIGINT', 'column02': 'BIGINT', 'column03': 'BIGINT', 'column04': 'BIGINT', 'column05': 'DOUBLE', 'column06': 'DOUBLE', 'column07': 'DOUBLE', 'column08': 'VARCHAR', 'column09': 'VARCHAR', 'column10': 'DATE', 'column11': 'DATE', 'column12': 'DATE', 'column13': 'VARCHAR', 'column14': 'VARCHAR', 'column15': 'VARCHAR'}, dateformat='%Y-%m-%d', escape='\"');\n \n # column names\n query IIIIIIIIIIII\n FROM sniff_csv('data/csv/real/lineitem_sample.csv', escape='\"');\n ----\n-|\t\"\t\"\t\\n\t\\0\t0\tfalse\t[{'name': column00, 'type': BIGINT}, {'name': column01, 'type': BIGINT}, {'name': column02, 'type': BIGINT}, {'name': column03, 'type': BIGINT}, {'name': column04, 'type': BIGINT}, {'name': column05, 'type': DOUBLE}, {'name': column06, 'type': DOUBLE}, {'name': column07, 'type': DOUBLE}, {'name': column08, 'type': VARCHAR}, {'name': column09, 'type': VARCHAR}, {'name': column10, 'type': DATE}, {'name': column11, 'type': DATE}, {'name': column12, 'type': DATE}, {'name': column13, 'type': VARCHAR}, {'name': column14, 'type': VARCHAR}, {'name': column15, 'type': VARCHAR}]\t%Y-%m-%d\tNULL\tescape='\"'\tFROM read_csv('data/csv/real/lineitem_sample.csv', auto_detect=false, delim='|', quote='\"', new_line='\\n', skip=0, comment='\\0', header=false, columns={'column00': 'BIGINT', 'column01': 'BIGINT', 'column02': 'BIGINT', 'column03': 'BIGINT', 'column04': 'BIGINT', 'column05': 'DOUBLE', 'column06': 'DOUBLE', 'column07': 'DOUBLE', 'column08': 'VARCHAR', 'column09': 'VARCHAR', 'column10': 'DATE', 'column11': 'DATE', 'column12': 'DATE', 'column13': 'VARCHAR', 'column14': 'VARCHAR', 'column15': 'VARCHAR'}, dateformat='%Y-%m-%d', escape='\"');\n+|\t\"\t\"\t\\n\t\\0\t0\t0\t[{'name': column00, 'type': BIGINT}, {'name': column01, 'type': BIGINT}, {'name': column02, 'type': BIGINT}, {'name': column03, 'type': BIGINT}, {'name': column04, 'type': BIGINT}, {'name': column05, 'type': DOUBLE}, {'name': column06, 'type': DOUBLE}, {'name': column07, 'type': DOUBLE}, {'name': column08, 'type': VARCHAR}, {'name': column09, 'type': VARCHAR}, {'name': column10, 'type': DATE}, {'name': column11, 'type': DATE}, {'name': column12, 'type': DATE}, {'name': column13, 'type': VARCHAR}, {'name': column14, 'type': VARCHAR}, {'name': column15, 'type': VARCHAR}]\t%Y-%m-%d\tNULL\tescape='\"'\tFROM read_csv('data/csv/real/lineitem_sample.csv', auto_detect=false, delim='|', quote='\"', new_line='\\n', skip=0, comment='', header=false, columns={'column00': 'BIGINT', 'column01': 'BIGINT', 'column02': 'BIGINT', 'column03': 'BIGINT', 'column04': 'BIGINT', 'column05': 'DOUBLE', 'column06': 'DOUBLE', 'column07': 'DOUBLE', 'column08': 'VARCHAR', 'column09': 'VARCHAR', 'column10': 'DATE', 'column11': 'DATE', 'column12': 'DATE', 'column13': 'VARCHAR', 'column14': 'VARCHAR', 'column15': 'VARCHAR'}, dateformat='%Y-%m-%d', escape='\"');\n \n # column names and types\n query IIIIIIIIIIII\n FROM sniff_csv('data/csv/real/lineitem_sample.csv', names=['c1', 'c2', 'c3', 'c4', 'c5', 'c6', 'c7', 'c8', 'c9', 'c10', 'c11', 'c12', 'c13', 'c14', 'c15', 'c16']);\n ----\n-|\t\"\t\"\t\\n\t\\0\t0\tfalse\t[{'name': c1, 'type': BIGINT}, {'name': c2, 'type': BIGINT}, {'name': c3, 'type': BIGINT}, {'name': c4, 'type': BIGINT}, {'name': c5, 'type': BIGINT}, {'name': c6, 'type': DOUBLE}, {'name': c7, 'type': DOUBLE}, {'name': c8, 'type': DOUBLE}, {'name': c9, 'type': VARCHAR}, {'name': c10, 'type': VARCHAR}, {'name': c11, 'type': DATE}, {'name': c12, 'type': DATE}, {'name': c13, 'type': DATE}, {'name': c14, 'type': VARCHAR}, {'name': c15, 'type': VARCHAR}, {'name': c16, 'type': VARCHAR}]\t%Y-%m-%d\tNULL\tNULL\tFROM read_csv('data/csv/real/lineitem_sample.csv', auto_detect=false, delim='|', quote='\"', escape='\"', new_line='\\n', skip=0, comment='\\0', header=false, columns={'c1': 'BIGINT', 'c2': 'BIGINT', 'c3': 'BIGINT', 'c4': 'BIGINT', 'c5': 'BIGINT', 'c6': 'DOUBLE', 'c7': 'DOUBLE', 'c8': 'DOUBLE', 'c9': 'VARCHAR', 'c10': 'VARCHAR', 'c11': 'DATE', 'c12': 'DATE', 'c13': 'DATE', 'c14': 'VARCHAR', 'c15': 'VARCHAR', 'c16': 'VARCHAR'}, dateformat='%Y-%m-%d');\n+|\t\"\t\"\t\\n\t\\0\t0\t0\t[{'name': c1, 'type': BIGINT}, {'name': c2, 'type': BIGINT}, {'name': c3, 'type': BIGINT}, {'name': c4, 'type': BIGINT}, {'name': c5, 'type': BIGINT}, {'name': c6, 'type': DOUBLE}, {'name': c7, 'type': DOUBLE}, {'name': c8, 'type': DOUBLE}, {'name': c9, 'type': VARCHAR}, {'name': c10, 'type': VARCHAR}, {'name': c11, 'type': DATE}, {'name': c12, 'type': DATE}, {'name': c13, 'type': DATE}, {'name': c14, 'type': VARCHAR}, {'name': c15, 'type': VARCHAR}, {'name': c16, 'type': VARCHAR}]\t%Y-%m-%d\tNULL\tNULL\tFROM read_csv('data/csv/real/lineitem_sample.csv', auto_detect=false, delim='|', quote='\"', escape='\"', new_line='\\n', skip=0, comment='', header=false, columns={'c1': 'BIGINT', 'c2': 'BIGINT', 'c3': 'BIGINT', 'c4': 'BIGINT', 'c5': 'BIGINT', 'c6': 'DOUBLE', 'c7': 'DOUBLE', 'c8': 'DOUBLE', 'c9': 'VARCHAR', 'c10': 'VARCHAR', 'c11': 'DATE', 'c12': 'DATE', 'c13': 'DATE', 'c14': 'VARCHAR', 'c15': 'VARCHAR', 'c16': 'VARCHAR'}, dateformat='%Y-%m-%d');\n \n \n query IIIIIIIIIIIIIIII\n@@ -55,37 +55,37 @@ FROM read_csv('data/csv/real/lineitem_sample.csv', auto_detect=false, delim='|',\n query IIIIIIIIIIII\n FROM sniff_csv('data/csv/real/lineitem_sample.csv', columns={'c1': 'BIGINT', 'c2': 'BIGINT', 'c3': 'BIGINT', 'c4': 'BIGINT', 'c5': 'BIGINT', 'c6': 'DOUBLE', 'c7': 'DOUBLE', 'c8': 'DOUBLE', 'c9': 'VARCHAR', 'c10': 'VARCHAR', 'c11': 'DATE', 'c12': 'DATE', 'c13': 'DATE', 'c14': 'VARCHAR', 'c15': 'VARCHAR', 'c16': 'VARCHAR'});\n ----\n-|\t\"\t\"\t\\n\t\\0\t0\tfalse\t[{'name': c1, 'type': BIGINT}, {'name': c2, 'type': BIGINT}, {'name': c3, 'type': BIGINT}, {'name': c4, 'type': BIGINT}, {'name': c5, 'type': BIGINT}, {'name': c6, 'type': DOUBLE}, {'name': c7, 'type': DOUBLE}, {'name': c8, 'type': DOUBLE}, {'name': c9, 'type': VARCHAR}, {'name': c10, 'type': VARCHAR}, {'name': c11, 'type': DATE}, {'name': c12, 'type': DATE}, {'name': c13, 'type': DATE}, {'name': c14, 'type': VARCHAR}, {'name': c15, 'type': VARCHAR}, {'name': c16, 'type': VARCHAR}]\t%Y-%m-%d\tNULL\tNULL\tFROM read_csv('data/csv/real/lineitem_sample.csv', auto_detect=false, delim='|', quote='\"', escape='\"', new_line='\\n', skip=0, comment='\\0', header=false, columns={'c1': 'BIGINT', 'c2': 'BIGINT', 'c3': 'BIGINT', 'c4': 'BIGINT', 'c5': 'BIGINT', 'c6': 'DOUBLE', 'c7': 'DOUBLE', 'c8': 'DOUBLE', 'c9': 'VARCHAR', 'c10': 'VARCHAR', 'c11': 'DATE', 'c12': 'DATE', 'c13': 'DATE', 'c14': 'VARCHAR', 'c15': 'VARCHAR', 'c16': 'VARCHAR'}, dateformat='%Y-%m-%d');\n+|\t\"\t\"\t\\n\t\\0\t0\t0\t[{'name': c1, 'type': BIGINT}, {'name': c2, 'type': BIGINT}, {'name': c3, 'type': BIGINT}, {'name': c4, 'type': BIGINT}, {'name': c5, 'type': BIGINT}, {'name': c6, 'type': DOUBLE}, {'name': c7, 'type': DOUBLE}, {'name': c8, 'type': DOUBLE}, {'name': c9, 'type': VARCHAR}, {'name': c10, 'type': VARCHAR}, {'name': c11, 'type': DATE}, {'name': c12, 'type': DATE}, {'name': c13, 'type': DATE}, {'name': c14, 'type': VARCHAR}, {'name': c15, 'type': VARCHAR}, {'name': c16, 'type': VARCHAR}]\t%Y-%m-%d\tNULL\tNULL\tFROM read_csv('data/csv/real/lineitem_sample.csv', auto_detect=false, delim='|', quote='\"', escape='\"', new_line='\\n', skip=0, comment='', header=false, columns={'c1': 'BIGINT', 'c2': 'BIGINT', 'c3': 'BIGINT', 'c4': 'BIGINT', 'c5': 'BIGINT', 'c6': 'DOUBLE', 'c7': 'DOUBLE', 'c8': 'DOUBLE', 'c9': 'VARCHAR', 'c10': 'VARCHAR', 'c11': 'DATE', 'c12': 'DATE', 'c13': 'DATE', 'c14': 'VARCHAR', 'c15': 'VARCHAR', 'c16': 'VARCHAR'}, dateformat='%Y-%m-%d');\n \n # skip rows\n query IIIIIIIIIIII\n FROM sniff_csv('data/csv/real/lineitem_sample.csv', skip=1);\n ----\n-|\t\"\t\"\t\\n\t\\0\t1\tfalse\t[{'name': column00, 'type': BIGINT}, {'name': column01, 'type': BIGINT}, {'name': column02, 'type': BIGINT}, {'name': column03, 'type': BIGINT}, {'name': column04, 'type': BIGINT}, {'name': column05, 'type': DOUBLE}, {'name': column06, 'type': DOUBLE}, {'name': column07, 'type': DOUBLE}, {'name': column08, 'type': VARCHAR}, {'name': column09, 'type': VARCHAR}, {'name': column10, 'type': DATE}, {'name': column11, 'type': DATE}, {'name': column12, 'type': DATE}, {'name': column13, 'type': VARCHAR}, {'name': column14, 'type': VARCHAR}, {'name': column15, 'type': VARCHAR}]\t%Y-%m-%d\tNULL\tskip=1\tFROM read_csv('data/csv/real/lineitem_sample.csv', auto_detect=false, delim='|', quote='\"', escape='\"', new_line='\\n', comment='\\0', header=false, columns={'column00': 'BIGINT', 'column01': 'BIGINT', 'column02': 'BIGINT', 'column03': 'BIGINT', 'column04': 'BIGINT', 'column05': 'DOUBLE', 'column06': 'DOUBLE', 'column07': 'DOUBLE', 'column08': 'VARCHAR', 'column09': 'VARCHAR', 'column10': 'DATE', 'column11': 'DATE', 'column12': 'DATE', 'column13': 'VARCHAR', 'column14': 'VARCHAR', 'column15': 'VARCHAR'}, dateformat='%Y-%m-%d', skip=1);\n+|\t\"\t\"\t\\n\t\\0\t1\t0\t[{'name': column00, 'type': BIGINT}, {'name': column01, 'type': BIGINT}, {'name': column02, 'type': BIGINT}, {'name': column03, 'type': BIGINT}, {'name': column04, 'type': BIGINT}, {'name': column05, 'type': DOUBLE}, {'name': column06, 'type': DOUBLE}, {'name': column07, 'type': DOUBLE}, {'name': column08, 'type': VARCHAR}, {'name': column09, 'type': VARCHAR}, {'name': column10, 'type': DATE}, {'name': column11, 'type': DATE}, {'name': column12, 'type': DATE}, {'name': column13, 'type': VARCHAR}, {'name': column14, 'type': VARCHAR}, {'name': column15, 'type': VARCHAR}]\t%Y-%m-%d\tNULL\tskip=1\tFROM read_csv('data/csv/real/lineitem_sample.csv', auto_detect=false, delim='|', quote='\"', escape='\"', new_line='\\n', comment='', header=false, columns={'column00': 'BIGINT', 'column01': 'BIGINT', 'column02': 'BIGINT', 'column03': 'BIGINT', 'column04': 'BIGINT', 'column05': 'DOUBLE', 'column06': 'DOUBLE', 'column07': 'DOUBLE', 'column08': 'VARCHAR', 'column09': 'VARCHAR', 'column10': 'DATE', 'column11': 'DATE', 'column12': 'DATE', 'column13': 'VARCHAR', 'column14': 'VARCHAR', 'column15': 'VARCHAR'}, dateformat='%Y-%m-%d', skip=1);\n \n # header exists\n query IIIIIIIIIIII\n FROM sniff_csv('data/csv/real/lineitem_sample.csv', header=true);\n ----\n-|\t\"\t\"\t\\n\t\\0\t0\ttrue\t[{'name': 1, 'type': BIGINT}, {'name': 15519, 'type': BIGINT}, {'name': 785, 'type': BIGINT}, {'name': 1_1, 'type': BIGINT}, {'name': 17, 'type': BIGINT}, {'name': 24386.670000, 'type': DOUBLE}, {'name': 0.040000, 'type': DOUBLE}, {'name': 0.020000, 'type': DOUBLE}, {'name': N, 'type': VARCHAR}, {'name': O, 'type': VARCHAR}, {'name': 1996-03-13, 'type': DATE}, {'name': 1996-02-12, 'type': DATE}, {'name': 1996-03-22, 'type': DATE}, {'name': DELIVER IN PERSON, 'type': VARCHAR}, {'name': TRUCK, 'type': VARCHAR}, {'name': egular courts above the, 'type': VARCHAR}]\t%Y-%m-%d\tNULL\theader=true\tFROM read_csv('data/csv/real/lineitem_sample.csv', auto_detect=false, delim='|', escape='\"', new_line='\\n', skip=0, comment='\\0', columns={'1': 'BIGINT', '15519': 'BIGINT', '785': 'BIGINT', '1_1': 'BIGINT', '17': 'BIGINT', '24386.670000': 'DOUBLE', '0.040000': 'DOUBLE', '0.020000': 'DOUBLE', 'N': 'VARCHAR', 'O': 'VARCHAR', '1996-03-13': 'DATE', '1996-02-12': 'DATE', '1996-03-22': 'DATE', 'DELIVER IN PERSON': 'VARCHAR', 'TRUCK': 'VARCHAR', 'egular courts above the': 'VARCHAR'}, dateformat='%Y-%m-%d', header=true);\n+|\t\"\t\"\t\\n\t\\0\t0\t1\t[{'name': 1, 'type': BIGINT}, {'name': 15519, 'type': BIGINT}, {'name': 785, 'type': BIGINT}, {'name': 1_1, 'type': BIGINT}, {'name': 17, 'type': BIGINT}, {'name': 24386.670000, 'type': DOUBLE}, {'name': 0.040000, 'type': DOUBLE}, {'name': 0.020000, 'type': DOUBLE}, {'name': N, 'type': VARCHAR}, {'name': O, 'type': VARCHAR}, {'name': 1996-03-13, 'type': DATE}, {'name': 1996-02-12, 'type': DATE}, {'name': 1996-03-22, 'type': DATE}, {'name': DELIVER IN PERSON, 'type': VARCHAR}, {'name': TRUCK, 'type': VARCHAR}, {'name': egular courts above the, 'type': VARCHAR}]\t%Y-%m-%d\tNULL\theader=true\tFROM read_csv('data/csv/real/lineitem_sample.csv', auto_detect=false, delim='|', quote='\"', escape='\"', new_line='\\n', skip=0, comment='', columns={'1': 'BIGINT', '15519': 'BIGINT', '785': 'BIGINT', '1_1': 'BIGINT', '17': 'BIGINT', '24386.670000': 'DOUBLE', '0.040000': 'DOUBLE', '0.020000': 'DOUBLE', 'N': 'VARCHAR', 'O': 'VARCHAR', '1996-03-13': 'DATE', '1996-02-12': 'DATE', '1996-03-22': 'DATE', 'DELIVER IN PERSON': 'VARCHAR', 'TRUCK': 'VARCHAR', 'egular courts above the': 'VARCHAR'}, dateformat='%Y-%m-%d', header=true);\n \n # timestampformat\n query IIIIIIIIIIII\n FROM sniff_csv('data/csv/auto/time_date_timestamp_yyyy.mm.dd.csv', dateformat='%Y.%m.%d')\n ----\n-,\t\"\t\"\t\\n\t\\0\t0\ttrue\t[{'name': a, 'type': BIGINT}, {'name': b, 'type': VARCHAR}, {'name': t, 'type': TIME}, {'name': d, 'type': DATE}, {'name': ts, 'type': TIMESTAMP}]\t%Y.%m.%d\t%Y.%m.%d %H:%M:%S\tdateformat='%Y.%m.%d'\tFROM read_csv('data/csv/auto/time_date_timestamp_yyyy.mm.dd.csv', auto_detect=false, delim=',', quote='\"', escape='\"', new_line='\\n', skip=0, comment='\\0', header=true, columns={'a': 'BIGINT', 'b': 'VARCHAR', 't': 'TIME', 'd': 'DATE', 'ts': 'TIMESTAMP'}, timestampformat='%Y.%m.%d %H:%M:%S', dateformat='%Y.%m.%d');\n+,\t\"\t\"\t\\n\t\\0\t0\t1\t[{'name': a, 'type': BIGINT}, {'name': b, 'type': VARCHAR}, {'name': t, 'type': TIME}, {'name': d, 'type': DATE}, {'name': ts, 'type': TIMESTAMP}]\t%Y.%m.%d\t%Y.%m.%d %H:%M:%S\tdateformat='%Y.%m.%d'\tFROM read_csv('data/csv/auto/time_date_timestamp_yyyy.mm.dd.csv', auto_detect=false, delim=',', quote='\"', escape='\"', new_line='\\n', skip=0, comment='', header=true, columns={'a': 'BIGINT', 'b': 'VARCHAR', 't': 'TIME', 'd': 'DATE', 'ts': 'TIMESTAMP'}, timestampformat='%Y.%m.%d %H:%M:%S', dateformat='%Y.%m.%d');\n \n # dateformat\n query IIIIIIIIIIII\n FROM sniff_csv('data/csv/auto/time_date_timestamp_yyyy.mm.dd.csv', timestampformat='%Y.%m.%d %H:%M:%S')\n ----\n-,\t\"\t\"\t\\n\t\\0\t0\ttrue\t[{'name': a, 'type': BIGINT}, {'name': b, 'type': VARCHAR}, {'name': t, 'type': TIME}, {'name': d, 'type': DATE}, {'name': ts, 'type': TIMESTAMP}]\t%Y.%m.%d\t%Y.%m.%d %H:%M:%S\ttimestampformat='%Y.%m.%d %H:%M:%S'\tFROM read_csv('data/csv/auto/time_date_timestamp_yyyy.mm.dd.csv', auto_detect=false, delim=',', quote='\"', escape='\"', new_line='\\n', skip=0, comment='\\0', header=true, columns={'a': 'BIGINT', 'b': 'VARCHAR', 't': 'TIME', 'd': 'DATE', 'ts': 'TIMESTAMP'}, dateformat='%Y.%m.%d', timestampformat='%Y.%m.%d %H:%M:%S');\n+,\t\"\t\"\t\\n\t\\0\t0\t1\t[{'name': a, 'type': BIGINT}, {'name': b, 'type': VARCHAR}, {'name': t, 'type': TIME}, {'name': d, 'type': DATE}, {'name': ts, 'type': TIMESTAMP}]\t%Y.%m.%d\t%Y.%m.%d %H:%M:%S\ttimestampformat='%Y.%m.%d %H:%M:%S'\tFROM read_csv('data/csv/auto/time_date_timestamp_yyyy.mm.dd.csv', auto_detect=false, delim=',', quote='\"', escape='\"', new_line='\\n', skip=0, comment='', header=true, columns={'a': 'BIGINT', 'b': 'VARCHAR', 't': 'TIME', 'd': 'DATE', 'ts': 'TIMESTAMP'}, dateformat='%Y.%m.%d', timestampformat='%Y.%m.%d %H:%M:%S');\n \n # Test a combination\n query IIIIIIIIIIII\n FROM sniff_csv('data/csv/auto/time_date_timestamp_yyyy.mm.dd.csv', dateformat='%Y.%m.%d', timestampformat='%Y.%m.%d %H:%M:%S')\n ----\n-,\t\"\t\"\t\\n\t\\0\t0\ttrue\t[{'name': a, 'type': BIGINT}, {'name': b, 'type': VARCHAR}, {'name': t, 'type': TIME}, {'name': d, 'type': DATE}, {'name': ts, 'type': TIMESTAMP}]\t%Y.%m.%d\t%Y.%m.%d %H:%M:%S\tdateformat='%Y.%m.%d', timestampformat='%Y.%m.%d %H:%M:%S'\tFROM read_csv('data/csv/auto/time_date_timestamp_yyyy.mm.dd.csv', auto_detect=false, delim=',', quote='\"', escape='\"', new_line='\\n', skip=0, comment='\\0', header=true, columns={'a': 'BIGINT', 'b': 'VARCHAR', 't': 'TIME', 'd': 'DATE', 'ts': 'TIMESTAMP'}, dateformat='%Y.%m.%d', timestampformat='%Y.%m.%d %H:%M:%S');\n+,\t\"\t\"\t\\n\t\\0\t0\t1\t[{'name': a, 'type': BIGINT}, {'name': b, 'type': VARCHAR}, {'name': t, 'type': TIME}, {'name': d, 'type': DATE}, {'name': ts, 'type': TIMESTAMP}]\t%Y.%m.%d\t%Y.%m.%d %H:%M:%S\tdateformat='%Y.%m.%d', timestampformat='%Y.%m.%d %H:%M:%S'\tFROM read_csv('data/csv/auto/time_date_timestamp_yyyy.mm.dd.csv', auto_detect=false, delim=',', quote='\"', escape='\"', new_line='\\n', skip=0, comment='', header=true, columns={'a': 'BIGINT', 'b': 'VARCHAR', 't': 'TIME', 'd': 'DATE', 'ts': 'TIMESTAMP'}, dateformat='%Y.%m.%d', timestampformat='%Y.%m.%d %H:%M:%S');\n \n query IIIII\n FROM read_csv('data/csv/auto/time_date_timestamp_yyyy.mm.dd.csv', auto_detect=false, delim=',', quote='\"', escape='\"', new_line='\\n', skip=0, header=true, columns={'a': 'BIGINT', 'b': 'VARCHAR', 't': 'TIME', 'd': 'DATE', 'ts': 'TIMESTAMP'}, timestampformat='%Y.%m.%d %H:%M:%S', dateformat='%Y.%m.%d') order by all limit 1;\n@@ -101,13 +101,13 @@ sniff_csv function does not accept auto_detect variable set to false\n query IIIIIIIIIIII\n FROM sniff_csv('data/csv/real/lineitem_sample.csv', columns={'c1': 'BIGINT', 'c2': 'BIGINT', 'c3': 'BIGINT', 'c4': 'BIGINT', 'c5': 'BIGINT', 'c6': 'DOUBLE', 'c7': 'DOUBLE', 'c8': 'DOUBLE', 'c9': 'VARCHAR', 'c10': 'VARCHAR', 'c11': 'DATE', 'c12': 'DATE', 'c13': 'DATE', 'c14': 'VARCHAR', 'c15': 'VARCHAR', 'c16': 'VARCHAR'}, auto_detect = true);\n ----\n-|\t\"\t\"\t\\n\t\\0\t0\tfalse\t[{'name': c1, 'type': BIGINT}, {'name': c2, 'type': BIGINT}, {'name': c3, 'type': BIGINT}, {'name': c4, 'type': BIGINT}, {'name': c5, 'type': BIGINT}, {'name': c6, 'type': DOUBLE}, {'name': c7, 'type': DOUBLE}, {'name': c8, 'type': DOUBLE}, {'name': c9, 'type': VARCHAR}, {'name': c10, 'type': VARCHAR}, {'name': c11, 'type': DATE}, {'name': c12, 'type': DATE}, {'name': c13, 'type': DATE}, {'name': c14, 'type': VARCHAR}, {'name': c15, 'type': VARCHAR}, {'name': c16, 'type': VARCHAR}]\t%Y-%m-%d\tNULL\tNULL\tFROM read_csv('data/csv/real/lineitem_sample.csv', auto_detect=false, delim='|', quote='\"', escape='\"', new_line='\\n', skip=0, comment='\\0', header=false, columns={'c1': 'BIGINT', 'c2': 'BIGINT', 'c3': 'BIGINT', 'c4': 'BIGINT', 'c5': 'BIGINT', 'c6': 'DOUBLE', 'c7': 'DOUBLE', 'c8': 'DOUBLE', 'c9': 'VARCHAR', 'c10': 'VARCHAR', 'c11': 'DATE', 'c12': 'DATE', 'c13': 'DATE', 'c14': 'VARCHAR', 'c15': 'VARCHAR', 'c16': 'VARCHAR'}, dateformat='%Y-%m-%d');\n+|\t\"\t\"\t\\n\t\\0\t0\t0\t[{'name': c1, 'type': BIGINT}, {'name': c2, 'type': BIGINT}, {'name': c3, 'type': BIGINT}, {'name': c4, 'type': BIGINT}, {'name': c5, 'type': BIGINT}, {'name': c6, 'type': DOUBLE}, {'name': c7, 'type': DOUBLE}, {'name': c8, 'type': DOUBLE}, {'name': c9, 'type': VARCHAR}, {'name': c10, 'type': VARCHAR}, {'name': c11, 'type': DATE}, {'name': c12, 'type': DATE}, {'name': c13, 'type': DATE}, {'name': c14, 'type': VARCHAR}, {'name': c15, 'type': VARCHAR}, {'name': c16, 'type': VARCHAR}]\t%Y-%m-%d\tNULL\tNULL\tFROM read_csv('data/csv/real/lineitem_sample.csv', auto_detect=false, delim='|', quote='\"', escape='\"', new_line='\\n', skip=0, comment='', header=false, columns={'c1': 'BIGINT', 'c2': 'BIGINT', 'c3': 'BIGINT', 'c4': 'BIGINT', 'c5': 'BIGINT', 'c6': 'DOUBLE', 'c7': 'DOUBLE', 'c8': 'DOUBLE', 'c9': 'VARCHAR', 'c10': 'VARCHAR', 'c11': 'DATE', 'c12': 'DATE', 'c13': 'DATE', 'c14': 'VARCHAR', 'c15': 'VARCHAR', 'c16': 'VARCHAR'}, dateformat='%Y-%m-%d');\n \n # auto_type_candidates\n query IIIIIIIIIIII\n FROM sniff_csv('data/csv/autotypecandidates.csv', auto_type_candidates=['SMALLINT','BIGINT', 'DOUBLE', 'FLOAT','VARCHAR']);\n ----\n-|\t\"\t\"\t\\n\t\\0\t0\tfalse\t[{'name': column0, 'type': SMALLINT}, {'name': column1, 'type': FLOAT}, {'name': column2, 'type': VARCHAR}]\tNULL\tNULL\tNULL\tFROM read_csv('data/csv/autotypecandidates.csv', auto_detect=false, delim='|', quote='\"', escape='\"', new_line='\\n', skip=0, comment='\\0', header=false, columns={'column0': 'SMALLINT', 'column1': 'FLOAT', 'column2': 'VARCHAR'});\n+|\t\"\t\"\t\\n\t\\0\t0\t0\t[{'name': column0, 'type': SMALLINT}, {'name': column1, 'type': FLOAT}, {'name': column2, 'type': VARCHAR}]\tNULL\tNULL\tNULL\tFROM read_csv('data/csv/autotypecandidates.csv', auto_detect=false, delim='|', quote='\"', escape='\"', new_line='\\n', skip=0, comment='', header=false, columns={'column0': 'SMALLINT', 'column1': 'FLOAT', 'column2': 'VARCHAR'});\n \n query III\n FROM read_csv('data/csv/autotypecandidates.csv', auto_detect=false, delim='|', quote='\"', escape='\"', new_line='\\n', skip=0, header=false, columns={'column0': 'SMALLINT', 'column1': 'FLOAT', 'column2': 'VARCHAR'});\n@@ -130,24 +130,24 @@ Invalid named parameter \"oop\" for function sniff_csv\n query IIIIIIIIIIII\n FROM sniff_csv('data/csv/autotypecandidates.csv', HIVE_PARTITIONING=1);\n ----\n-|\t\"\t\"\t\\n\t\\0\t0\tfalse\t[{'name': column0, 'type': BIGINT}, {'name': column1, 'type': DOUBLE}, {'name': column2, 'type': VARCHAR}]\tNULL\tNULL\tNULL\tFROM read_csv('data/csv/autotypecandidates.csv', auto_detect=false, delim='|', quote='\"', escape='\"', new_line='\\n', skip=0, comment='\\0', header=false, columns={'column0': 'BIGINT', 'column1': 'DOUBLE', 'column2': 'VARCHAR'});\n+|\t\"\t\"\t\\n\t\\0\t0\t0\t[{'name': column0, 'type': BIGINT}, {'name': column1, 'type': DOUBLE}, {'name': column2, 'type': VARCHAR}]\tNULL\tNULL\tNULL\tFROM read_csv('data/csv/autotypecandidates.csv', auto_detect=false, delim='|', quote='\"', escape='\"', new_line='\\n', skip=0, comment='', header=false, columns={'column0': 'BIGINT', 'column1': 'DOUBLE', 'column2': 'VARCHAR'});\n \n query IIIIIIIIIIII\n FROM sniff_csv('data/csv/real/lineitem_sample.csv', types=['INTEGER','BIGINT','BIGINT','BIGINT','BIGINT', 'DOUBLE','DOUBLE','DOUBLE','VARCHAR', 'VARCHAR','DATE', 'DATE',  'DATE', 'VARCHAR',  'VARCHAR', 'VARCHAR']);\n ----\n-|\t\"\t\"\t\\n\t\\0\t0\tfalse\t[{'name': column00, 'type': INTEGER}, {'name': column01, 'type': BIGINT}, {'name': column02, 'type': BIGINT}, {'name': column03, 'type': BIGINT}, {'name': column04, 'type': BIGINT}, {'name': column05, 'type': DOUBLE}, {'name': column06, 'type': DOUBLE}, {'name': column07, 'type': DOUBLE}, {'name': column08, 'type': VARCHAR}, {'name': column09, 'type': VARCHAR}, {'name': column10, 'type': DATE}, {'name': column11, 'type': DATE}, {'name': column12, 'type': DATE}, {'name': column13, 'type': VARCHAR}, {'name': column14, 'type': VARCHAR}, {'name': column15, 'type': VARCHAR}]\t%Y-%m-%d\tNULL\tNULL\tFROM read_csv('data/csv/real/lineitem_sample.csv', auto_detect=false, delim='|', quote='\"', escape='\"', new_line='\\n', skip=0, comment='\\0', header=false, columns={'column00': 'INTEGER', 'column01': 'BIGINT', 'column02': 'BIGINT', 'column03': 'BIGINT', 'column04': 'BIGINT', 'column05': 'DOUBLE', 'column06': 'DOUBLE', 'column07': 'DOUBLE', 'column08': 'VARCHAR', 'column09': 'VARCHAR', 'column10': 'DATE', 'column11': 'DATE', 'column12': 'DATE', 'column13': 'VARCHAR', 'column14': 'VARCHAR', 'column15': 'VARCHAR'}, dateformat='%Y-%m-%d');\n+|\t\"\t\"\t\\n\t\\0\t0\t0\t[{'name': column00, 'type': INTEGER}, {'name': column01, 'type': BIGINT}, {'name': column02, 'type': BIGINT}, {'name': column03, 'type': BIGINT}, {'name': column04, 'type': BIGINT}, {'name': column05, 'type': DOUBLE}, {'name': column06, 'type': DOUBLE}, {'name': column07, 'type': DOUBLE}, {'name': column08, 'type': VARCHAR}, {'name': column09, 'type': VARCHAR}, {'name': column10, 'type': DATE}, {'name': column11, 'type': DATE}, {'name': column12, 'type': DATE}, {'name': column13, 'type': VARCHAR}, {'name': column14, 'type': VARCHAR}, {'name': column15, 'type': VARCHAR}]\t%Y-%m-%d\tNULL\tNULL\tFROM read_csv('data/csv/real/lineitem_sample.csv', auto_detect=false, delim='|', quote='\"', escape='\"', new_line='\\n', skip=0, comment='', header=false, columns={'column00': 'INTEGER', 'column01': 'BIGINT', 'column02': 'BIGINT', 'column03': 'BIGINT', 'column04': 'BIGINT', 'column05': 'DOUBLE', 'column06': 'DOUBLE', 'column07': 'DOUBLE', 'column08': 'VARCHAR', 'column09': 'VARCHAR', 'column10': 'DATE', 'column11': 'DATE', 'column12': 'DATE', 'column13': 'VARCHAR', 'column14': 'VARCHAR', 'column15': 'VARCHAR'}, dateformat='%Y-%m-%d');\n \n query IIIIIIIIIIII\n FROM sniff_csv('data/csv/real/lineitem_sample.csv', dtypes=['INTEGER','BIGINT','BIGINT','BIGINT','BIGINT', 'DOUBLE','DOUBLE','DOUBLE','VARCHAR', 'VARCHAR','DATE', 'DATE',  'DATE', 'VARCHAR',  'VARCHAR', 'VARCHAR']);\n ----\n-|\t\"\t\"\t\\n\t\\0\t0\tfalse\t[{'name': column00, 'type': INTEGER}, {'name': column01, 'type': BIGINT}, {'name': column02, 'type': BIGINT}, {'name': column03, 'type': BIGINT}, {'name': column04, 'type': BIGINT}, {'name': column05, 'type': DOUBLE}, {'name': column06, 'type': DOUBLE}, {'name': column07, 'type': DOUBLE}, {'name': column08, 'type': VARCHAR}, {'name': column09, 'type': VARCHAR}, {'name': column10, 'type': DATE}, {'name': column11, 'type': DATE}, {'name': column12, 'type': DATE}, {'name': column13, 'type': VARCHAR}, {'name': column14, 'type': VARCHAR}, {'name': column15, 'type': VARCHAR}]\t%Y-%m-%d\tNULL\tNULL\tFROM read_csv('data/csv/real/lineitem_sample.csv', auto_detect=false, delim='|', quote='\"', escape='\"', new_line='\\n', skip=0, comment='\\0', header=false, columns={'column00': 'INTEGER', 'column01': 'BIGINT', 'column02': 'BIGINT', 'column03': 'BIGINT', 'column04': 'BIGINT', 'column05': 'DOUBLE', 'column06': 'DOUBLE', 'column07': 'DOUBLE', 'column08': 'VARCHAR', 'column09': 'VARCHAR', 'column10': 'DATE', 'column11': 'DATE', 'column12': 'DATE', 'column13': 'VARCHAR', 'column14': 'VARCHAR', 'column15': 'VARCHAR'}, dateformat='%Y-%m-%d');\n+|\t\"\t\"\t\\n\t\\0\t0\t0\t[{'name': column00, 'type': INTEGER}, {'name': column01, 'type': BIGINT}, {'name': column02, 'type': BIGINT}, {'name': column03, 'type': BIGINT}, {'name': column04, 'type': BIGINT}, {'name': column05, 'type': DOUBLE}, {'name': column06, 'type': DOUBLE}, {'name': column07, 'type': DOUBLE}, {'name': column08, 'type': VARCHAR}, {'name': column09, 'type': VARCHAR}, {'name': column10, 'type': DATE}, {'name': column11, 'type': DATE}, {'name': column12, 'type': DATE}, {'name': column13, 'type': VARCHAR}, {'name': column14, 'type': VARCHAR}, {'name': column15, 'type': VARCHAR}]\t%Y-%m-%d\tNULL\tNULL\tFROM read_csv('data/csv/real/lineitem_sample.csv', auto_detect=false, delim='|', quote='\"', escape='\"', new_line='\\n', skip=0, comment='', header=false, columns={'column00': 'INTEGER', 'column01': 'BIGINT', 'column02': 'BIGINT', 'column03': 'BIGINT', 'column04': 'BIGINT', 'column05': 'DOUBLE', 'column06': 'DOUBLE', 'column07': 'DOUBLE', 'column08': 'VARCHAR', 'column09': 'VARCHAR', 'column10': 'DATE', 'column11': 'DATE', 'column12': 'DATE', 'column13': 'VARCHAR', 'column14': 'VARCHAR', 'column15': 'VARCHAR'}, dateformat='%Y-%m-%d');\n \n query IIIIIIIIIIII\n FROM sniff_csv('data/csv/real/lineitem_sample.csv', column_types=['INTEGER','BIGINT','BIGINT','BIGINT','BIGINT', 'DOUBLE','DOUBLE','DOUBLE','VARCHAR', 'VARCHAR','DATE', 'DATE',  'DATE', 'VARCHAR',  'VARCHAR', 'VARCHAR']);\n ----\n-|\t\"\t\"\t\\n\t\\0\t0\tfalse\t[{'name': column00, 'type': INTEGER}, {'name': column01, 'type': BIGINT}, {'name': column02, 'type': BIGINT}, {'name': column03, 'type': BIGINT}, {'name': column04, 'type': BIGINT}, {'name': column05, 'type': DOUBLE}, {'name': column06, 'type': DOUBLE}, {'name': column07, 'type': DOUBLE}, {'name': column08, 'type': VARCHAR}, {'name': column09, 'type': VARCHAR}, {'name': column10, 'type': DATE}, {'name': column11, 'type': DATE}, {'name': column12, 'type': DATE}, {'name': column13, 'type': VARCHAR}, {'name': column14, 'type': VARCHAR}, {'name': column15, 'type': VARCHAR}]\t%Y-%m-%d\tNULL\tNULL\tFROM read_csv('data/csv/real/lineitem_sample.csv', auto_detect=false, delim='|', quote='\"', escape='\"', new_line='\\n', skip=0, comment='\\0', header=false, columns={'column00': 'INTEGER', 'column01': 'BIGINT', 'column02': 'BIGINT', 'column03': 'BIGINT', 'column04': 'BIGINT', 'column05': 'DOUBLE', 'column06': 'DOUBLE', 'column07': 'DOUBLE', 'column08': 'VARCHAR', 'column09': 'VARCHAR', 'column10': 'DATE', 'column11': 'DATE', 'column12': 'DATE', 'column13': 'VARCHAR', 'column14': 'VARCHAR', 'column15': 'VARCHAR'}, dateformat='%Y-%m-%d');\n+|\t\"\t\"\t\\n\t\\0\t0\t0\t[{'name': column00, 'type': INTEGER}, {'name': column01, 'type': BIGINT}, {'name': column02, 'type': BIGINT}, {'name': column03, 'type': BIGINT}, {'name': column04, 'type': BIGINT}, {'name': column05, 'type': DOUBLE}, {'name': column06, 'type': DOUBLE}, {'name': column07, 'type': DOUBLE}, {'name': column08, 'type': VARCHAR}, {'name': column09, 'type': VARCHAR}, {'name': column10, 'type': DATE}, {'name': column11, 'type': DATE}, {'name': column12, 'type': DATE}, {'name': column13, 'type': VARCHAR}, {'name': column14, 'type': VARCHAR}, {'name': column15, 'type': VARCHAR}]\t%Y-%m-%d\tNULL\tNULL\tFROM read_csv('data/csv/real/lineitem_sample.csv', auto_detect=false, delim='|', quote='\"', escape='\"', new_line='\\n', skip=0, comment='', header=false, columns={'column00': 'INTEGER', 'column01': 'BIGINT', 'column02': 'BIGINT', 'column03': 'BIGINT', 'column04': 'BIGINT', 'column05': 'DOUBLE', 'column06': 'DOUBLE', 'column07': 'DOUBLE', 'column08': 'VARCHAR', 'column09': 'VARCHAR', 'column10': 'DATE', 'column11': 'DATE', 'column12': 'DATE', 'column13': 'VARCHAR', 'column14': 'VARCHAR', 'column15': 'VARCHAR'}, dateformat='%Y-%m-%d');\n \n query IIIIIIIIIIII\n FROM sniff_csv('data/csv/real/lineitem_sample.csv', names=['c01','c02','c03','c04','c5', 'c06','c07','c08','c09', 'c10','c11', 'c12',  'c13', 'c14',  'c15', 'c16']);\n ----\n-|\t\"\t\"\t\\n\t\\0\t0\tfalse\t[{'name': c01, 'type': BIGINT}, {'name': c02, 'type': BIGINT}, {'name': c03, 'type': BIGINT}, {'name': c04, 'type': BIGINT}, {'name': c5, 'type': BIGINT}, {'name': c06, 'type': DOUBLE}, {'name': c07, 'type': DOUBLE}, {'name': c08, 'type': DOUBLE}, {'name': c09, 'type': VARCHAR}, {'name': c10, 'type': VARCHAR}, {'name': c11, 'type': DATE}, {'name': c12, 'type': DATE}, {'name': c13, 'type': DATE}, {'name': c14, 'type': VARCHAR}, {'name': c15, 'type': VARCHAR}, {'name': c16, 'type': VARCHAR}]\t%Y-%m-%d\tNULL\tNULL\tFROM read_csv('data/csv/real/lineitem_sample.csv', auto_detect=false, delim='|', quote='\"', escape='\"', new_line='\\n', skip=0, comment='\\0', header=false, columns={'c01': 'BIGINT', 'c02': 'BIGINT', 'c03': 'BIGINT', 'c04': 'BIGINT', 'c5': 'BIGINT', 'c06': 'DOUBLE', 'c07': 'DOUBLE', 'c08': 'DOUBLE', 'c09': 'VARCHAR', 'c10': 'VARCHAR', 'c11': 'DATE', 'c12': 'DATE', 'c13': 'DATE', 'c14': 'VARCHAR', 'c15': 'VARCHAR', 'c16': 'VARCHAR'}, dateformat='%Y-%m-%d');\n+|\t\"\t\"\t\\n\t\\0\t0\t0\t[{'name': c01, 'type': BIGINT}, {'name': c02, 'type': BIGINT}, {'name': c03, 'type': BIGINT}, {'name': c04, 'type': BIGINT}, {'name': c5, 'type': BIGINT}, {'name': c06, 'type': DOUBLE}, {'name': c07, 'type': DOUBLE}, {'name': c08, 'type': DOUBLE}, {'name': c09, 'type': VARCHAR}, {'name': c10, 'type': VARCHAR}, {'name': c11, 'type': DATE}, {'name': c12, 'type': DATE}, {'name': c13, 'type': DATE}, {'name': c14, 'type': VARCHAR}, {'name': c15, 'type': VARCHAR}, {'name': c16, 'type': VARCHAR}]\t%Y-%m-%d\tNULL\tNULL\tFROM read_csv('data/csv/real/lineitem_sample.csv', auto_detect=false, delim='|', quote='\"', escape='\"', new_line='\\n', skip=0, comment='', header=false, columns={'c01': 'BIGINT', 'c02': 'BIGINT', 'c03': 'BIGINT', 'c04': 'BIGINT', 'c5': 'BIGINT', 'c06': 'DOUBLE', 'c07': 'DOUBLE', 'c08': 'DOUBLE', 'c09': 'VARCHAR', 'c10': 'VARCHAR', 'c11': 'DATE', 'c12': 'DATE', 'c13': 'DATE', 'c14': 'VARCHAR', 'c15': 'VARCHAR', 'c16': 'VARCHAR'}, dateformat='%Y-%m-%d');\n",
  "problem_statement": "`sniff_csv`'s Prompt column is truncated after `comment='`\n### What happens?\r\n\r\nWhen trying to visualize the `Prompt` in the call to `sniff_csv`, the output is invalid and truncated after `comment='`\r\n\r\n### To Reproduce\r\n\r\n```bash\r\ncat > test_prompt.csv <<EOF\r\na,b\r\n1,\"a\"\r\n2,\"b\"\r\nEOF\r\n```\r\n```\r\ncat test_prompt.csv \r\n```\r\n```text\r\na,b\r\n1,\"a\"\r\n2,\"b\"\r\n```\r\n```bash\r\nduckdb -line -c \"select Prompt from sniff_csv('test_prompt.csv')\"\r\n```\r\n```console\r\nPrompt = FROM read_csv('test_prompt.csv', auto_detect=false, delim=',', quote='\"', escape='\"', new_line='\\n', skip=0, comment='\r\n```\r\n\r\n### OS:\r\n\r\nubuntu 20.04\r\n\r\n### DuckDB Version:\r\n\r\nv1.1.0 fa5c2fe15f\r\n\r\n### DuckDB Client:\r\n\r\nDuckdb CLI\r\n\r\n### Hardware:\r\n\r\n_No response_\r\n\r\n### Full Name:\r\n\r\nFlorian Gaudin-Delrieu\r\n\r\n### Affiliation:\r\n\r\nFieldbox\r\n\r\n### What is the latest build you tested with? If possible, we recommend testing with the latest nightly build.\r\n\r\nI have tested with a stable release\r\n\r\n### Did you include all relevant data sets for reproducing the issue?\r\n\r\nYes\r\n\r\n### Did you include all code required to reproduce the issue?\r\n\r\n- [X] Yes, I have\r\n\r\n### Did you include all relevant configuration (e.g., CPU architecture, Python version, Linux distribution) to reproduce the issue?\r\n\r\n- [X] Yes, I have\n",
  "hints_text": "",
  "created_at": "2024-09-10T11:09:12Z"
}