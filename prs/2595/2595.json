{
  "repo": "duckdb/duckdb",
  "pull_number": 2595,
  "instance_id": "duckdb__duckdb-2595",
  "issue_numbers": [
    "2543",
    "2543"
  ],
  "base_commit": "ee7c56dc3b9833a3c8b7ab9cad7c724f31596280",
  "patch": "diff --git a/extension/parquet/parquet-extension.cpp b/extension/parquet/parquet-extension.cpp\nindex f038346e165e..b2ae084fc347 100644\n--- a/extension/parquet/parquet-extension.cpp\n+++ b/extension/parquet/parquet-extension.cpp\n@@ -471,7 +471,7 @@ unique_ptr<LocalFunctionData> ParquetWriteInitializeLocal(ClientContext &context\n }\n \n unique_ptr<TableFunctionRef> ParquetScanReplacement(const string &table_name, void *data) {\n-\tif (!StringUtil::EndsWith(table_name, \".parquet\")) {\n+\tif (!StringUtil::EndsWith(StringUtil::Lower(table_name), \".parquet\")) {\n \t\treturn nullptr;\n \t}\n \tauto table_function = make_unique<TableFunctionRef>();\ndiff --git a/src/function/table/read_csv.cpp b/src/function/table/read_csv.cpp\nindex 303f89aa1b35..54b1e7b10ca0 100644\n--- a/src/function/table/read_csv.cpp\n+++ b/src/function/table/read_csv.cpp\n@@ -255,8 +255,9 @@ void ReadCSVTableFunction::RegisterFunction(BuiltinFunctions &set) {\n }\n \n unique_ptr<TableFunctionRef> ReadCSVReplacement(const string &table_name, void *data) {\n-\tif (!StringUtil::EndsWith(table_name, \".csv\") && !StringUtil::EndsWith(table_name, \".tsv\") &&\n-\t    !StringUtil::EndsWith(table_name, \".csv.gz\")) {\n+\tauto lower_name = StringUtil::Lower(table_name);\n+\tif (!StringUtil::EndsWith(lower_name, \".csv\") && !StringUtil::EndsWith(lower_name, \".tsv\") &&\n+\t    !StringUtil::EndsWith(lower_name, \".csv.gz\")) {\n \t\treturn nullptr;\n \t}\n \tauto table_function = make_unique<TableFunctionRef>();\n",
  "test_patch": "diff --git a/data/parquet-testing/CASE_INSENSITIVE.PARQUET b/data/parquet-testing/CASE_INSENSITIVE.PARQUET\nnew file mode 100644\nindex 000000000000..b533c0fdcfbd\nBinary files /dev/null and b/data/parquet-testing/CASE_INSENSITIVE.PARQUET differ\ndiff --git a/test/sql/copy/parquet/case_insensitive_replacement.test b/test/sql/copy/parquet/case_insensitive_replacement.test\nnew file mode 100644\nindex 000000000000..2ddf80318032\n--- /dev/null\n+++ b/test/sql/copy/parquet/case_insensitive_replacement.test\n@@ -0,0 +1,10 @@\n+# name: test/sql/copy/parquet/case_insensitive_replacement.test\n+# description: Issue #2543: Case insensitive replacement scan\n+# group: [parquet]\n+\n+require parquet\n+\n+query I\n+SELECT data FROM 'data/parquet-testing/CASE_INSENSITIVE.PARQUET'\n+----\n+\\x00\\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\x09\\x0A\\x0B\\x0C\\x0D\\x0E\\x0F\n",
  "problem_statement": "suggest read the parquet file name case non sense\nif I have a a.Parquet file. \r\nselect * from 'a.Parquet' failed. \r\nI must rename it to a.parquet now. \r\n\nsuggest read the parquet file name case non sense\nif I have a a.Parquet file. \r\nselect * from 'a.Parquet' failed. \r\nI must rename it to a.parquet now. \r\n\n",
  "hints_text": "fair enough, this should be supported\nfair enough, this should be supported",
  "created_at": "2021-11-13T19:25:02Z"
}