diff --git a/tools/pythonpkg/tests/fast/test_replacement_scan.py b/tools/pythonpkg/tests/fast/test_replacement_scan.py
index f02db7e0338f..defb9c5d34bb 100644
--- a/tools/pythonpkg/tests/fast/test_replacement_scan.py
+++ b/tools/pythonpkg/tests/fast/test_replacement_scan.py
@@ -47,6 +47,16 @@ def fetch_relation(rel):
     return rel
 
 
+global_polars_df = pl.DataFrame(
+    {
+        "A": [1],
+        "fruits": ["banana"],
+        "B": [5],
+        "cars": ["beetle"],
+    }
+)
+
+
 def from_pandas():
     df = pd.DataFrame({'a': [1, 2, 3]})
     return df
@@ -91,6 +101,43 @@ def test_table_replacement_scans(self, duckdb_cursor, get_relation, fetch_method
         res = rel.fetchall()
         assert res == [(1, 2, 3)]
 
+    def test_scan_global(self, duckdb_cursor):
+        duckdb_cursor.execute("set python_enable_replacements=false")
+        with pytest.raises(duckdb.CatalogException, match='Table with name global_polars_df does not exist'):
+            # We set the depth to look for global variables to 0 so it's never found
+            duckdb_cursor.sql("select * from global_polars_df")
+        duckdb_cursor.execute("set python_enable_replacements=true")
+        # Now the depth is 1, which is enough to locate the variable
+        rel = duckdb_cursor.sql("select * from global_polars_df")
+        res = rel.fetchone()
+        assert res == (1, 'banana', 5, 'beetle')
+
+    def test_scan_local(self, duckdb_cursor):
+        df = pd.DataFrame({'a': [1, 2, 3]})
+
+        def inner_func(duckdb_cursor):
+            duckdb_cursor.execute("set python_enable_replacements=false")
+            with pytest.raises(duckdb.CatalogException, match='Table with name df does not exist'):
+                # We set the depth to look for local variables to 0 so it's never found
+                duckdb_cursor.sql("select * from df")
+            duckdb_cursor.execute("set python_enable_replacements=true")
+            with pytest.raises(duckdb.CatalogException, match='Table with name df does not exist'):
+                # We set the depth to look for local variables to 1 so it's still not found because it wasn't defined in this function
+                duckdb_cursor.sql("select * from df")
+            duckdb_cursor.execute("set python_enable_replacements=true")
+            with pytest.raises(duckdb.CatalogException, match='Table with name df does not exist'):
+                # Here it's still not found, because it's not visible to this frame
+                duckdb_cursor.sql("select * from df")
+
+            df = pd.DataFrame({'a': [4, 5, 6]})
+            duckdb_cursor.execute("set python_enable_replacements=true")
+            # We can find the newly defined 'df' with depth 1
+            rel = duckdb_cursor.sql("select * from df")
+            res = rel.fetchall()
+            assert res == [(4,), (5,), (6,)]
+
+        inner_func(duckdb_cursor)
+
     def test_replacement_scan_relapi(self):
         con = duckdb.connect()
         pyrel1 = con.query('from (values (42), (84), (120)) t(i)')
