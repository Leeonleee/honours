{
  "repo": "duckdb/duckdb",
  "pull_number": 11328,
  "instance_id": "duckdb__duckdb-11328",
  "issue_numbers": [
    "11319",
    "11319"
  ],
  "base_commit": "8ce3df950c0c6f25815ebd1dd92257a81223f618",
  "patch": "diff --git a/extension/excel/numformat/nf_calendar.cpp b/extension/excel/numformat/nf_calendar.cpp\nindex 5a22690e83bd..c33c795c2b3f 100644\n--- a/extension/excel/numformat/nf_calendar.cpp\n+++ b/extension/excel/numformat/nf_calendar.cpp\n@@ -185,8 +185,7 @@ std::wstring Calendar::getDisplayName(sal_Int16 displayIndex, sal_Int16 idx, sal\n \t\t\treturn L\"\";\n \t\tbreak;\n \tcase CalendarDisplayIndex::CDI_DAY:\n-\t\tif (idx >= pFormatter->getDayOfWeekSize())\n-\t\t\treturn L\"\";\n+\t\tidx %= pFormatter->getDayOfWeekSize();\n \t\tif (nameType == 0)\n \t\t\taStr = pFormatter->getDayOfWeekAbbrvName(idx);\n \t\telse if (nameType == 1)\n",
  "test_patch": "diff --git a/test/sql/excel/test_excel_numformat.test b/test/sql/excel/test_excel_numformat.test\nindex c35a6fc10638..5d900e32a41a 100644\n--- a/test/sql/excel/test_excel_numformat.test\n+++ b/test/sql/excel/test_excel_numformat.test\n@@ -554,3 +554,15 @@ SELECT text('hello', 1.0)\n statement error\n SELECT text('hello', '@')\n ----\n+\n+# Days\n+query T\n+SELECT excel_text(i, 'dddd') FROM range(7) as t(i);\n+----\n+Saturday\n+Sunday\n+Monday\n+Tuesday\n+Wednesday\n+Thursday\n+Friday\n",
  "problem_statement": "Excel Extension format for 'dddd' (day of week name) maps sundays to the empty string\n### What happens?\n\nWhen the excel format functions are used (as part of the excel extension) the day of week name formatter `dddd` seems to not map Sundays properly, instead mapping them to the empty String. \n\n### To Reproduce\n\n```\r\n> SELECT excel_text(i.generate_series, 'dddd') FROM generate_series(0, 14) as i;\r\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n\u2502 excel_text(i.generate_series, 'dddd') \u2502\r\n\u2502                varchar                \u2502\r\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\r\n\u2502 Saturday                              \u2502\r\n\u2502                                       \u2502\r\n\u2502 Monday                                \u2502\r\n\u2502 Tuesday                               \u2502\r\n\u2502 Wednesday                             \u2502\r\n\u2502 Thursday                              \u2502\r\n\u2502 Friday                                \u2502\r\n\u2502 Saturday                              \u2502\r\n\u2502                                       \u2502\r\n\u2502 Monday                                \u2502\r\n\u2502 Tuesday                               \u2502\r\n\u2502 Wednesday                             \u2502\r\n\u2502 Thursday                              \u2502\r\n\u2502 Friday                                \u2502\r\n\u2502 Saturday                              \u2502\r\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\r\n\u2502                15 rows                \u2502\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n```\n\n### OS:\n\nmac\n\n### DuckDB Version:\n\n0.10.1, 0.9.2\n\n### DuckDB Client:\n\nshell, cli, wasm\n\n### Full Name:\n\nJonathan Swenson\n\n### Affiliation:\n\nOmni\n\n### Have you tried this on the latest [nightly build](https://duckdb.org/docs/installation/?version=main)?\n\nI have tested with a release build (and could not test with a nightly build)\n\n### Have you tried the steps to reproduce? Do they include all relevant data and configuration? Does the issue you report still appear there?\n\n- [X] Yes, I have\nExcel Extension format for 'dddd' (day of week name) maps sundays to the empty string\n### What happens?\n\nWhen the excel format functions are used (as part of the excel extension) the day of week name formatter `dddd` seems to not map Sundays properly, instead mapping them to the empty String. \n\n### To Reproduce\n\n```\r\n> SELECT excel_text(i.generate_series, 'dddd') FROM generate_series(0, 14) as i;\r\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n\u2502 excel_text(i.generate_series, 'dddd') \u2502\r\n\u2502                varchar                \u2502\r\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\r\n\u2502 Saturday                              \u2502\r\n\u2502                                       \u2502\r\n\u2502 Monday                                \u2502\r\n\u2502 Tuesday                               \u2502\r\n\u2502 Wednesday                             \u2502\r\n\u2502 Thursday                              \u2502\r\n\u2502 Friday                                \u2502\r\n\u2502 Saturday                              \u2502\r\n\u2502                                       \u2502\r\n\u2502 Monday                                \u2502\r\n\u2502 Tuesday                               \u2502\r\n\u2502 Wednesday                             \u2502\r\n\u2502 Thursday                              \u2502\r\n\u2502 Friday                                \u2502\r\n\u2502 Saturday                              \u2502\r\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\r\n\u2502                15 rows                \u2502\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n```\n\n### OS:\n\nmac\n\n### DuckDB Version:\n\n0.10.1, 0.9.2\n\n### DuckDB Client:\n\nshell, cli, wasm\n\n### Full Name:\n\nJonathan Swenson\n\n### Affiliation:\n\nOmni\n\n### Have you tried this on the latest [nightly build](https://duckdb.org/docs/installation/?version=main)?\n\nI have tested with a release build (and could not test with a nightly build)\n\n### Have you tried the steps to reproduce? Do they include all relevant data and configuration? Does the issue you report still appear there?\n\n- [X] Yes, I have\n",
  "hints_text": "\n",
  "created_at": "2024-03-23T21:11:50Z"
}