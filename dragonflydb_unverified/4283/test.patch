diff --git a/src/core/compact_object_test.cc b/src/core/compact_object_test.cc
index bff60e3f43b9..601936dfb62b 100644
--- a/src/core/compact_object_test.cc
+++ b/src/core/compact_object_test.cc
@@ -16,6 +16,7 @@
 #include "core/detail/bitpacking.h"
 #include "core/flat_set.h"
 #include "core/mi_memory_resource.h"
+#include "core/string_set.h"
 
 extern "C" {
 #include "redis/intset.h"
@@ -575,6 +576,14 @@ TEST_F(CompactObjectTest, DefragHash) {
   }
 }
 
+TEST_F(CompactObjectTest, DefragSet) {
+  // This is still not implemented
+  StringSet* s = new StringSet();
+  s->Add("str");
+  cobj_.InitRobj(OBJ_SET, kEncodingStrMap2, s);
+  ASSERT_FALSE(cobj_.DefragIfNeeded(0.8));
+}
+
 TEST_F(CompactObjectTest, RawInterface) {
   string str(50, 'a'), tmp, owned;
   cobj_.SetString(str);
