diff --git a/src/server/acl/acl_family_test.cc b/src/server/acl/acl_family_test.cc
index cbee4061fe18..6cdd2b5241ad 100644
--- a/src/server/acl/acl_family_test.cc
+++ b/src/server/acl/acl_family_test.cc
@@ -198,8 +198,8 @@ TEST_F(AclFamilyTest, AclWhoAmI) {
 }
 
 TEST_F(AclFamilyTest, TestAllCategories) {
-  TestInitAclFam();
-  for (auto& cat : acl::REVERSE_CATEGORY_INDEX_TABLE) {
+  const auto* fam = TestInitAclFam();
+  for (auto& cat : fam->GetRevTable()) {
     if (cat != "_RESERVED") {
       auto resp = Run({"ACL", "SETUSER", "kostas", absl::StrCat("+@", cat)});
       EXPECT_THAT(resp, "OK");
@@ -222,7 +222,7 @@ TEST_F(AclFamilyTest, TestAllCategories) {
     }
   }
 
-  for (auto& cat : acl::REVERSE_CATEGORY_INDEX_TABLE) {
+  for (auto& cat : fam->GetRevTable()) {
     if (cat != "_RESERVED") {
       auto resp = Run({"ACL", "SETUSER", "kostas", absl::StrCat("+@", cat)});
       EXPECT_THAT(resp, "OK");
@@ -245,8 +245,8 @@ TEST_F(AclFamilyTest, TestAllCategories) {
 }
 
 TEST_F(AclFamilyTest, TestAllCommands) {
-  TestInitAclFam();
-  const auto& rev_indexer = acl::CommandsRevIndexer();
+  const auto* fam = TestInitAclFam();
+  const auto& rev_indexer = fam->GetCommandsRevIndexer();
   for (const auto& family : rev_indexer) {
     for (const auto& command_name : family) {
       auto resp = Run({"ACL", "SETUSER", "kostas", absl::StrCat("+", command_name)});
diff --git a/src/server/test_utils.cc b/src/server/test_utils.cc
index 39a18dbdf466..3150284ba197 100644
--- a/src/server/test_utils.cc
+++ b/src/server/test_utils.cc
@@ -5,6 +5,7 @@
 #include "server/test_utils.h"
 
 #include "server/acl/acl_commands_def.h"
+#include "server/acl/acl_family.h"
 #include "util/fibers/fibers.h"
 
 extern "C" {
@@ -702,9 +703,9 @@ void BaseFamilyTest::SetTestFlag(string_view flag_name, string_view new_value) {
   CHECK(flag->ParseFrom(new_value, &error)) << "Error: " << error;
 }
 
-void BaseFamilyTest::TestInitAclFam() {
+const acl::AclFamily* BaseFamilyTest::TestInitAclFam() {
   absl::SetFlag(&FLAGS_acllog_max_len, 0);
-  service_->TestInit();
+  return service_->TestInit();
 }
 
 }  // namespace dfly
diff --git a/src/server/test_utils.h b/src/server/test_utils.h
index 961d15e3d3a0..1c714926933b 100644
--- a/src/server/test_utils.h
+++ b/src/server/test_utils.h
@@ -154,7 +154,7 @@ class BaseFamilyTest : public ::testing::Test {
 
   static void SetTestFlag(std::string_view flag_name, std::string_view new_value);
 
-  void TestInitAclFam();
+  const acl::AclFamily* TestInitAclFam();
 
   std::unique_ptr<util::ProactorPool> pp_;
   std::unique_ptr<Service> service_;
